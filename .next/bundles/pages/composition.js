
          window.__NEXT_REGISTER_PAGE('/composition', function() {
            var comp = module.exports=webpackJsonp([0],[function(t,e,n){var r=n(4),i=n(38),o=n(23),a=n(24),s=n(31),u="prototype",l=function(t,e,n){var c,h,p,f,d=t&l.F,m=t&l.G,g=t&l.S,v=t&l.P,y=t&l.B,b=m?r:g?r[e]||(r[e]={}):(r[e]||{})[u],_=m?i:i[e]||(i[e]={}),x=_[u]||(_[u]={});m&&(n=e);for(c in n)p=((h=!d&&b&&void 0!==b[c])?b:n)[c],f=y&&h?s(p,r):v&&"function"==typeof p?s(Function.call,p):p,b&&a(b,c,p,t&l.U),_[c]!=p&&o(_,c,f),v&&x[c]!=p&&(x[c]=p)};r.core=i,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},,,function(t,e,n){var r=n(6);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){var r=n(122)("wks"),i=n(63),o=n(4).Symbol,a="function"==typeof o;(t.exports=function(t){return r[t]||(r[t]=a&&o[t]||(a?o:i)("Symbol."+t))}).store=r},,,,function(t,e,n){t.exports=!n(5)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,n){var r=n(3),i=n(304),o=n(39),a=Object.defineProperty;e.f=n(11)?Object.defineProperty:function(t,e,n){if(r(t),e=o(e,!0),r(n),i)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var r=n(41),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},function(t,e,n){var r=n(40);t.exports=function(t){return Object(r(t))}},,,function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},,,,,function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var r=n(12),i=n(62);t.exports=n(11)?function(t,e,n){return r.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var r=n(4),i=n(23),o=n(22),a=n(63)("src"),s="toString",u=Function[s],l=(""+u).split(s);n(38).inspectSource=function(t){return u.call(t)},(t.exports=function(t,e,n,s){var u="function"==typeof n;u&&(o(n,"name")||i(n,"name",e)),t[e]!==n&&(u&&(o(n,a)||i(n,a,t[e]?""+t[e]:l.join(String(e)))),t===r?t[e]=n:s?t[e]?t[e]=n:i(t,e,n):(delete t[e],i(t,e,n)))})(Function.prototype,s,function(){return"function"==typeof this&&this[a]||u.call(this)})},function(t,e,n){var r=n(0),i=n(5),o=n(40),a=/"/g,s=function(t,e,n,r){var i=String(o(t)),s="<"+e;return""!==n&&(s+=" "+n+'="'+String(r).replace(a,"&quot;")+'"'),s+">"+i+"</"+e+">"};t.exports=function(t,e){var n={};n[t]=e(s),r(r.P+r.F*i(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}),"String",n)}},function(t,e,n){"use strict";var r=n(295),i=n(664),o=Object.prototype.toString;function a(t){return"[object Array]"===o.call(t)}function s(t){return null!==t&&"object"==typeof t}function u(t){return"[object Function]"===o.call(t)}function l(t,e){if(null!==t&&void 0!==t)if("object"!=typeof t&&(t=[t]),a(t))for(var n=0,r=t.length;n<r;n++)e.call(null,t[n],n,t);else for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.call(null,t[i],i,t)}t.exports={isArray:a,isArrayBuffer:function(t){return"[object ArrayBuffer]"===o.call(t)},isBuffer:i,isFormData:function(t){return"undefined"!=typeof FormData&&t instanceof FormData},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:s,isUndefined:function(t){return void 0===t},isDate:function(t){return"[object Date]"===o.call(t)},isFile:function(t){return"[object File]"===o.call(t)},isBlob:function(t){return"[object Blob]"===o.call(t)},isFunction:u,isStream:function(t){return s(t)&&u(t.pipe)},isURLSearchParams:function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:l,merge:function t(){var e={};function n(n,r){"object"==typeof e[r]&&"object"==typeof n?e[r]=t(e[r],n):e[r]=n}for(var r=0,i=arguments.length;r<i;r++)l(arguments[r],n);return e},extend:function(t,e,n){return l(e,function(e,i){t[i]=n&&"function"==typeof e?r(e,n):e}),t},trim:function(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(t,e,n){var r=n(96),i=n(40);t.exports=function(t){return r(i(t))}},function(t,e,n){var r=n(97),i=n(62),o=n(27),a=n(39),s=n(22),u=n(304),l=Object.getOwnPropertyDescriptor;e.f=n(11)?l:function(t,e){if(t=o(t),e=a(e,!0),u)try{return l(t,e)}catch(t){}if(s(t,e))return i(!r.f.call(t,e),t[e])}},function(t,e,n){var r=n(22),i=n(14),o=n(189)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),r(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},,function(t,e,n){var r=n(17);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){"use strict";var r=n(5);t.exports=function(t,e){return!!t&&r(function(){e?t.call(null,function(){},1):t.call(null)})}},,,,function(t,e,n){var r=n(60),i=n(117);t.exports=function(t){return function e(n,o){switch(arguments.length){case 0:return e;case 1:return i(n)?e:r(function(e){return t(n,e)});default:return i(n)&&i(o)?e:i(n)?r(function(e){return t(e,o)}):i(o)?r(function(e){return t(n,e)}):t(n,o)}}}},function(t,e){var n=t.exports={version:"2.5.1"};"number"==typeof __e&&(__e=n)},function(t,e,n){var r=n(6);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e,n){var r=n(0),i=n(38),o=n(5);t.exports=function(t,e){var n=(i.Object||{})[t]||Object[t],a={};a[t]=e(n),r(r.S+r.F*o(function(){n(1)}),"Object",a)}},function(t,e,n){var r=n(31),i=n(96),o=n(14),a=n(13),s=n(206);t.exports=function(t,e){var n=1==t,u=2==t,l=3==t,c=4==t,h=6==t,p=5==t||h,f=e||s;return function(e,s,d){for(var m,g,v=o(e),y=i(v),b=r(s,d,3),_=a(y.length),x=0,w=n?f(e,_):u?f(e,0):void 0;_>x;x++)if((p||x in y)&&(g=b(m=y[x],x,v),t))if(n)w[x]=g;else if(g)switch(t){case 3:return!0;case 5:return m;case 6:return x;case 2:w.push(m)}else if(c)return!1;return h?-1:l||c?c:w}}},,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();e.default=function(t){var e,n;return n=e=function(e){function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,e),i(n,[{key:"render",value:function(){return a.default.createElement(t,r({},this.props,{media:this.context.media}))}}]),n}(o.Component),e.displayName="withMediaProps",e.contextTypes=s.default,n};var o=n(1),a=u(o),s=u(n(180));function u(t){return t&&t.__esModule?t:{default:t}}t.exports=e.default},function(t,e,n){"use strict";if(n(11)){var r=n(64),i=n(4),o=n(5),a=n(0),s=n(132),u=n(212),l=n(31),c=n(70),h=n(62),p=n(23),f=n(72),d=n(41),m=n(13),g=n(330),v=n(66),y=n(39),b=n(22),_=n(98),x=n(6),w=n(14),E=n(203),S=n(67),T=n(29),O=n(68).f,A=n(205),M=n(63),C=n(7),k=n(43),P=n(123),R=n(130),L=n(208),I=n(84),D=n(127),N=n(69),j=n(207),U=n(320),F=n(12),B=n(28),z=F.f,G=B.f,H=i.RangeError,V=i.TypeError,W=i.Uint8Array,q="ArrayBuffer",X="Shared"+q,Y="BYTES_PER_ELEMENT",$="prototype",Z=Array[$],J=u.ArrayBuffer,K=u.DataView,Q=k(0),tt=k(2),et=k(3),nt=k(4),rt=k(5),it=k(6),ot=P(!0),at=P(!1),st=L.values,ut=L.keys,lt=L.entries,ct=Z.lastIndexOf,ht=Z.reduce,pt=Z.reduceRight,ft=Z.join,dt=Z.sort,mt=Z.slice,gt=Z.toString,vt=Z.toLocaleString,yt=C("iterator"),bt=C("toStringTag"),_t=M("typed_constructor"),xt=M("def_constructor"),wt=s.CONSTR,Et=s.TYPED,St=s.VIEW,Tt="Wrong length!",Ot=k(1,function(t,e){return Pt(R(t,t[xt]),e)}),At=o(function(){return 1===new W(new Uint16Array([1]).buffer)[0]}),Mt=!!W&&!!W[$].set&&o(function(){new W(1).set({})}),Ct=function(t,e){var n=d(t);if(n<0||n%e)throw H("Wrong offset!");return n},kt=function(t){if(x(t)&&Et in t)return t;throw V(t+" is not a typed array!")},Pt=function(t,e){if(!(x(t)&&_t in t))throw V("It is not a typed array constructor!");return new t(e)},Rt=function(t,e){return Lt(R(t,t[xt]),e)},Lt=function(t,e){for(var n=0,r=e.length,i=Pt(t,r);r>n;)i[n]=e[n++];return i},It=function(t,e,n){z(t,e,{get:function(){return this._d[n]}})},Dt=function(t){var e,n,r,i,o,a,s=w(t),u=arguments.length,c=u>1?arguments[1]:void 0,h=void 0!==c,p=A(s);if(void 0!=p&&!E(p)){for(a=p.call(s),r=[],e=0;!(o=a.next()).done;e++)r.push(o.value);s=r}for(h&&u>2&&(c=l(c,arguments[2],2)),e=0,n=m(s.length),i=Pt(this,n);n>e;e++)i[e]=h?c(s[e],e):s[e];return i},Nt=function(){for(var t=0,e=arguments.length,n=Pt(this,e);e>t;)n[t]=arguments[t++];return n},jt=!!W&&o(function(){vt.call(new W(1))}),Ut=function(){return vt.apply(jt?mt.call(kt(this)):kt(this),arguments)},Ft={copyWithin:function(t,e){return U.call(kt(this),t,e,arguments.length>2?arguments[2]:void 0)},every:function(t){return nt(kt(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return j.apply(kt(this),arguments)},filter:function(t){return Rt(this,tt(kt(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return rt(kt(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return it(kt(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){Q(kt(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return at(kt(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return ot(kt(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return ft.apply(kt(this),arguments)},lastIndexOf:function(t){return ct.apply(kt(this),arguments)},map:function(t){return Ot(kt(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return ht.apply(kt(this),arguments)},reduceRight:function(t){return pt.apply(kt(this),arguments)},reverse:function(){for(var t,e=kt(this).length,n=Math.floor(e/2),r=0;r<n;)t=this[r],this[r++]=this[--e],this[e]=t;return this},some:function(t){return et(kt(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return dt.call(kt(this),t)},subarray:function(t,e){var n=kt(this),r=n.length,i=v(t,r);return new(R(n,n[xt]))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,m((void 0===e?r:v(e,r))-i))}},Bt=function(t,e){return Rt(this,mt.call(kt(this),t,e))},zt=function(t){kt(this);var e=Ct(arguments[1],1),n=this.length,r=w(t),i=m(r.length),o=0;if(i+e>n)throw H(Tt);for(;o<i;)this[e+o]=r[o++]},Gt={entries:function(){return lt.call(kt(this))},keys:function(){return ut.call(kt(this))},values:function(){return st.call(kt(this))}},Ht=function(t,e){return x(t)&&t[Et]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},Vt=function(t,e){return Ht(t,e=y(e,!0))?h(2,t[e]):G(t,e)},Wt=function(t,e,n){return!(Ht(t,e=y(e,!0))&&x(n)&&b(n,"value"))||b(n,"get")||b(n,"set")||n.configurable||b(n,"writable")&&!n.writable||b(n,"enumerable")&&!n.enumerable?z(t,e,n):(t[e]=n.value,t)};wt||(B.f=Vt,F.f=Wt),a(a.S+a.F*!wt,"Object",{getOwnPropertyDescriptor:Vt,defineProperty:Wt}),o(function(){gt.call({})})&&(gt=vt=function(){return ft.call(this)});var qt=f({},Ft);f(qt,Gt),p(qt,yt,Gt.values),f(qt,{slice:Bt,set:zt,constructor:function(){},toString:gt,toLocaleString:Ut}),It(qt,"buffer","b"),It(qt,"byteOffset","o"),It(qt,"byteLength","l"),It(qt,"length","e"),z(qt,bt,{get:function(){return this[Et]}}),t.exports=function(t,e,n,u){var l=t+((u=!!u)?"Clamped":"")+"Array",h="get"+t,f="set"+t,d=i[l],v=d||{},y=d&&T(d),b=!d||!s.ABV,w={},E=d&&d[$],A=function(t,n){z(t,n,{get:function(){return t=n,(r=this._d).v[h](t*e+r.o,At);var t,r},set:function(t){return r=n,i=t,o=this._d,u&&(i=(i=Math.round(i))<0?0:i>255?255:255&i),void o.v[f](r*e+o.o,i,At);var r,i,o},enumerable:!0})};b?(d=n(function(t,n,r,i){c(t,d,l,"_d");var o,a,s,u,h=0,f=0;if(x(n)){if(!(n instanceof J||(u=_(n))==q||u==X))return Et in n?Lt(d,n):Dt.call(d,n);o=n,f=Ct(r,e);var v=n.byteLength;if(void 0===i){if(v%e)throw H(Tt);if((a=v-f)<0)throw H(Tt)}else if((a=m(i)*e)+f>v)throw H(Tt);s=a/e}else s=g(n),o=new J(a=s*e);for(p(t,"_d",{b:o,o:f,l:a,e:s,v:new K(o)});h<s;)A(t,h++)}),E=d[$]=S(qt),p(E,"constructor",d)):o(function(){d(1)})&&o(function(){new d(-1)})&&D(function(t){new d,new d(null),new d(1.5),new d(t)},!0)||(d=n(function(t,n,r,i){var o;return c(t,d,l),x(n)?n instanceof J||(o=_(n))==q||o==X?void 0!==i?new v(n,Ct(r,e),i):void 0!==r?new v(n,Ct(r,e)):new v(n):Et in n?Lt(d,n):Dt.call(d,n):new v(g(n))}),Q(y!==Function.prototype?O(v).concat(O(y)):O(v),function(t){t in d||p(d,t,v[t])}),d[$]=E,r||(E.constructor=d));var M=E[yt],C=!!M&&("values"==M.name||void 0==M.name),k=Gt.values;p(d,_t,!0),p(E,Et,l),p(E,St,!0),p(E,xt,d),(u?new d(1)[bt]==l:bt in E)||z(E,bt,{get:function(){return l}}),w[l]=d,a(a.G+a.W+a.F*(d!=v),w),a(a.S,l,{BYTES_PER_ELEMENT:e}),a(a.S+a.F*o(function(){v.of.call(d,1)}),l,{from:Dt,of:Nt}),Y in E||p(E,Y,e),a(a.P,l,Ft),N(l),a(a.P+a.F*Mt,l,{set:zt}),a(a.P+a.F*!C,l,Gt),r||E.toString==gt||(E.toString=gt),a(a.P+a.F*o(function(){new d(1).slice()}),l,{slice:Bt}),a(a.P+a.F*(o(function(){return[1,2].toLocaleString()!=new d([1,2]).toLocaleString()})||!o(function(){E.toLocaleString.call([1,2])})),l,{toLocaleString:Ut}),I[l]=C?M:k,r||C||p(E,yt,k)}}else t.exports=function(){}},function(t,e,n){var r=n(325),i=n(0),o=n(122)("metadata"),a=o.store||(o.store=new(n(328))),s=function(t,e,n){var i=a.get(t);if(!i){if(!n)return;a.set(t,i=new r)}var o=i.get(e);if(!o){if(!n)return;i.set(e,o=new r)}return o};t.exports={store:a,map:s,has:function(t,e,n){var r=s(e,n,!1);return void 0!==r&&r.has(t)},get:function(t,e,n){var r=s(e,n,!1);return void 0===r?void 0:r.get(t)},set:function(t,e,n,r){s(n,r,!0).set(t,e)},keys:function(t,e){var n=s(t,e,!1),r=[];return n&&n.forEach(function(t,e){r.push(e)}),r},key:function(t){return void 0===t||"symbol"==typeof t?t:String(t)},exp:function(t){i(i.S,"Reflect",t)}}},,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.pickAsset=function(t,e,n){for(var r=0;r<e.length;){var i=e[r];if(-1===i.indexOf("_asset_id"))return{resourceDataField:i,asset:null};if(t.data[i]&&n[t.data[i]])return{resourceDataField:i,asset:n[t.data[i]]};r++}},e.pickSubAsset=function(t,e,n){for(var r=0;r<e.length;){var i=e[r];if(t[i]&&n[t[i]])return{resourceDataField:i,asset:n[t[i]]};r++}}},function(t,e,n){var r=n(63)("meta"),i=n(6),o=n(22),a=n(12).f,s=0,u=Object.isExtensible||function(){return!0},l=!n(5)(function(){return u(Object.preventExtensions({}))}),c=function(t){a(t,r,{value:{i:"O"+ ++s,w:{}}})},h=t.exports={KEY:r,NEED:!1,fastKey:function(t,e){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,r)){if(!u(t))return"F";if(!e)return"E";c(t)}return t[r].i},getWeak:function(t,e){if(!o(t,r)){if(!u(t))return!0;if(!e)return!1;c(t)}return t[r].w},onFreeze:function(t){return l&&h.NEED&&u(t)&&!o(t,r)&&c(t),t}}},function(t,e,n){var r=n(7)("unscopables"),i=Array.prototype;void 0==i[r]&&n(23)(i,r,{}),t.exports=function(t){i[r][t]=!0}},function(t,e){t.exports={shortLang:t=>t.toLowerCase().split(/[^a-z]/)[0],forceArray:function(t){return"string"==typeof t&&(t=[t]),t||[]},isPlainObject:function(t){return!(!t||"object"!=typeof t||t instanceof Array)},fixedEncodeURIComponent:function(t){return encodeURIComponent(t).replace(/[!'()*]/g,n)},replaceSpaceByUnderscores:t=>t.replace(/\s/g,"_"),uniq:t=>Array.from(new Set(t))};const n=t=>"%"+t.charCodeAt(0).toString(16)},,,,,,,function(t,e,n){var r=n(117);t.exports=function(t){return function e(n){return 0===arguments.length||r(n)?e:t.apply(this,arguments)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={};r.container={background:"rgba(0, 0, 0, 0.8)",gutter:{horizontal:10,vertical:10},zIndex:2001},r.header={height:40},r.close={fill:"white"},r.footer={color:"white",count:{color:"rgba(255, 255, 255, 0.75)",fontSize:"0.85em"},height:40,gutter:{horizontal:0,vertical:5}},r.thumbnail={activeBorderColor:"white",size:50,gutter:2},r.arrow={background:"none",fill:"white",height:120},e.default=r},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},function(t,e){t.exports=!1},function(t,e,n){var r=n(306),i=n(190);t.exports=Object.keys||function(t){return r(t,i)}},function(t,e,n){var r=n(41),i=Math.max,o=Math.min;t.exports=function(t,e){return(t=r(t))<0?i(t+e,0):o(t,e)}},function(t,e,n){var r=n(3),i=n(307),o=n(190),a=n(189)("IE_PROTO"),s=function(){},u="prototype",l=function(){var t,e=n(187)("iframe"),r=o.length;for(e.style.display="none",n(191).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),l=t.F;r--;)delete l[u][o[r]];return l()};t.exports=Object.create||function(t,e){var n;return null!==t?(s[u]=r(t),n=new s,s[u]=null,n[a]=t):n=l(),void 0===e?n:i(n,e)}},function(t,e,n){var r=n(306),i=n(190).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},function(t,e,n){"use strict";var r=n(4),i=n(12),o=n(11),a=n(7)("species");t.exports=function(t){var e=r[t];o&&e&&!e[a]&&i.f(e,a,{configurable:!0,get:function(){return this}})}},function(t,e){t.exports=function(t,e,n,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(n+": incorrect invocation!");return t}},function(t,e,n){var r=n(31),i=n(318),o=n(203),a=n(3),s=n(13),u=n(205),l={},c={};(e=t.exports=function(t,e,n,h,p){var f,d,m,g,v=p?function(){return t}:u(t),y=r(n,h,e?2:1),b=0;if("function"!=typeof v)throw TypeError(t+" is not iterable!");if(o(v)){for(f=s(t.length);f>b;b++)if((g=e?y(a(d=t[b])[0],d[1]):y(t[b]))===l||g===c)return g}else for(m=v.call(t);!(d=m.next()).done;)if((g=i(m,y,d.value,e))===l||g===c)return g}).BREAK=l,e.RETURN=c},function(t,e,n){var r=n(24);t.exports=function(t,e,n){for(var i in e)r(t,i,e[i],n);return t}},,,,,,,function(t,e,n){"use strict";var r=n(57),i=n(258),o=(n(116),n(257),Object.prototype.hasOwnProperty),a=n(259),s={key:!0,ref:!0,__self:!0,__source:!0};function u(t){return void 0!==t.ref}function l(t){return void 0!==t.key}var c=function(t,e,n,r,i,o,s){var u={$$typeof:a,type:t,key:e,ref:n,props:s,_owner:o};return u};c.createElement=function(t,e,n){var r,a={},h=null,p=null;if(null!=e){u(e)&&(p=e.ref),l(e)&&(h=""+e.key),void 0===e.__self?null:e.__self,void 0===e.__source?null:e.__source;for(r in e)o.call(e,r)&&!s.hasOwnProperty(r)&&(a[r]=e[r])}var f=arguments.length-2;if(1===f)a.children=n;else if(f>1){for(var d=Array(f),m=0;m<f;m++)d[m]=arguments[m+2];0,a.children=d}if(t&&t.defaultProps){var g=t.defaultProps;for(r in g)void 0===a[r]&&(a[r]=g[r])}return c(t,h,p,0,0,i.current,a)},c.createFactory=function(t){var e=c.createElement.bind(null,t);return e.type=t,e},c.cloneAndReplaceKey=function(t,e){return c(t.type,e,t.ref,t._self,t._source,t._owner,t.props)},c.cloneElement=function(t,e,n){var a,h=r({},t.props),p=t.key,f=t.ref,d=(t._self,t._source,t._owner);if(null!=e){var m;u(e)&&(f=e.ref,d=i.current),l(e)&&(p=""+e.key),t.type&&t.type.defaultProps&&(m=t.type.defaultProps);for(a in e)o.call(e,a)&&!s.hasOwnProperty(a)&&(void 0===e[a]&&void 0!==m?h[a]=m[a]:h[a]=e[a])}var g=arguments.length-2;if(1===g)h.children=n;else if(g>1){for(var v=Array(g),y=0;y<g;y++)v[y]=arguments[y+2];h.children=v}return c(t.type,p,f,0,0,d,h)},c.isValidElement=function(t){return"object"==typeof t&&null!==t&&t.$$typeof===a},t.exports=c},function(t,e,n){t.exports=n(597)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.default=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=Object.assign({},e);return Object.keys(n).forEach(function(o){"object"===r(n[o])&&n[o]&&e[o]?i[o]=t(e[o],n[o]):i[o]=n[o]}),i}},function(t,e,n){var r=n(12).f,i=n(22),o=n(7)("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,o)&&r(t,o,{configurable:!0,value:e})}},function(t,e,n){var r=n(0),i=n(40),o=n(5),a=n(193),s="["+a+"]",u=RegExp("^"+s+s+"*"),l=RegExp(s+s+"*$"),c=function(t,e,n){var i={},s=o(function(){return!!a[t]()||"​"!="​"[t]()}),u=i[t]=s?e(h):a[t];n&&(i[n]=u),r(r.P+r.F*s,"String",i)},h=c.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(u,"")),2&e&&(t=t.replace(l,"")),t};t.exports=c},function(t,e){t.exports={}},function(t,e,n){var r=n(6);t.exports=function(t,e){if(!r(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(t){return t.replace(/$|( )|(?!^)(?=[A-Z])/g,"\\.?$1")},o=function(t){return"(?:"+t.join("|")+")\\b"},a=function(t,e){return new RegExp("(?:^| )("+t+"$)",e)},s=o(["mr","mrs","ms","miss","dr","herr","monsieur","hr","frau","a v m","admiraal","admiral","air cdre","air commodore","air marshal","air vice marshal","alderman","alhaji","ambassador","baron","barones","brig","brig gen","brig general","brigadier","brigadier general","brother","canon","capt","captain","cardinal","cdr","chief","cik","cmdr","coach","col","col dr","colonel","commandant","commander","commissioner","commodore","comte","comtessa","congressman","conseiller","consul","conte","contessa","corporal","councillor","count","countess","crown prince","crown princess","dame","datin","dato","datuk","datuk seri","deacon","deaconess","dean","dhr","dipl ing","doctor","dott","dott sa","dr","dr ing","dra","drs","embajador","embajadora","en","encik","eng","eur ing","exma sra","exmo sr","f o","father","first lieutient","first officer","flt lieut","flying officer","fr","frau","fraulein","fru","gen","generaal","general","governor","graaf","gravin","group captain","grp capt","h e dr","h h","h m","h r h","hajah","haji","hajim","her highness","her majesty","herr","high chief","his highness","his holiness","his majesty","hon","hr","hra","ing","ir","jonkheer","judge","justice","khun ying","kolonel","lady","lcda","lic","lieut","lieut cdr","lieut col","lieut gen","lord","m","m l","m r","madame","mademoiselle","maj gen","major","master","mevrouw","miss","mlle","mme","monsieur","monsignor","mr","mrs","ms","mstr","nti","pastor","president","prince","princess","princesse","prinses","prof","prof dr","prof sir","professor","puan","puan sri","rabbi","rear admiral","rev","rev canon","rev dr","rev mother","reverend","rva","senator","sergeant","sheikh","sheikha","sig","sig na","sig ra","sir","sister","sqn ldr","sr","sr d","sra","srta","sultan","tan sri","tan sri dato","tengku","teuku","than puying","the hon dr","the hon justice","the hon miss","the hon mr","the hon mrs","the hon ms","the hon sir","the very rev","toh puan","tun","vice admiral","viscount","viscountess","wg cdr"].map(i)),u=o(["I","II","III","IV","V","Senior","Junior","Jr","Sr","PhD","Ph\\.D","APR","RPh","PE","MD","MA","DMD","CME","BVM","CFRE","CLU","CPA","CSC","CSJ","DC","DD","DDS","DO","DVM","EdD","Esq","JD","LLD","OD","OSB","PC","Ret","RGS","RN","RNC","SHCJ","SJ","SNJM","SSMO","USA","USAF","USAFR","USAR","USCG","USMC","USMCR","USN","USNR"].map(i)),l=o(["Vere","Von","Van","De","Del","Della","Di","Da","Pietro","Vanden","Du","St.","St","La","Lo","Ter","O","O'","Mac","Fitz"]),c=new RegExp("^((?:"+s+" )*)(.*)$","i"),h=a("(?:"+u+", )*(?:"+u+")","i"),p=a(/(?:[A-Z\xC0-\xD6\xD8-\xDE\u0100\u0102\u0104\u0106\u0108\u010A\u010C\u010E\u0110\u0112\u0114\u0116\u0118\u011A\u011C\u011E\u0120\u0122\u0124\u0126\u0128\u012A\u012C\u012E\u0130\u0132\u0134\u0136\u0139\u013B\u013D\u013F\u0141\u0143\u0145\u0147\u014A\u014C\u014E\u0150\u0152\u0154\u0156\u0158\u015A\u015C\u015E\u0160\u0162\u0164\u0166\u0168\u016A\u016C\u016E\u0170\u0172\u0174\u0176\u0178\u0179\u017B\u017D\u0181\u0182\u0184\u0186\u0187\u0189-\u018B\u018E-\u0191\u0193\u0194\u0196-\u0198\u019C\u019D\u019F\u01A0\u01A2\u01A4\u01A6\u01A7\u01A9\u01AC\u01AE\u01AF\u01B1-\u01B3\u01B5\u01B7\u01B8\u01BC\u01C4\u01C7\u01CA\u01CD\u01CF\u01D1\u01D3\u01D5\u01D7\u01D9\u01DB\u01DE\u01E0\u01E2\u01E4\u01E6\u01E8\u01EA\u01EC\u01EE\u01F1\u01F4\u01F6-\u01F8\u01FA\u01FC\u01FE\u0200\u0202\u0204\u0206\u0208\u020A\u020C\u020E\u0210\u0212\u0214\u0216\u0218\u021A\u021C\u021E\u0220\u0222\u0224\u0226\u0228\u022A\u022C\u022E\u0230\u0232\u023A\u023B\u023D\u023E\u0241\u0243-\u0246\u0248\u024A\u024C\u024E\u0370\u0372\u0376\u037F\u0386\u0388-\u038A\u038C\u038E\u038F\u0391-\u03A1\u03A3-\u03AB\u03CF\u03D2-\u03D4\u03D8\u03DA\u03DC\u03DE\u03E0\u03E2\u03E4\u03E6\u03E8\u03EA\u03EC\u03EE\u03F4\u03F7\u03F9\u03FA\u03FD-\u042F\u0460\u0462\u0464\u0466\u0468\u046A\u046C\u046E\u0470\u0472\u0474\u0476\u0478\u047A\u047C\u047E\u0480\u048A\u048C\u048E\u0490\u0492\u0494\u0496\u0498\u049A\u049C\u049E\u04A0\u04A2\u04A4\u04A6\u04A8\u04AA\u04AC\u04AE\u04B0\u04B2\u04B4\u04B6\u04B8\u04BA\u04BC\u04BE\u04C0\u04C1\u04C3\u04C5\u04C7\u04C9\u04CB\u04CD\u04D0\u04D2\u04D4\u04D6\u04D8\u04DA\u04DC\u04DE\u04E0\u04E2\u04E4\u04E6\u04E8\u04EA\u04EC\u04EE\u04F0\u04F2\u04F4\u04F6\u04F8\u04FA\u04FC\u04FE\u0500\u0502\u0504\u0506\u0508\u050A\u050C\u050E\u0510\u0512\u0514\u0516\u0518\u051A\u051C\u051E\u0520\u0522\u0524\u0526\u0528\u052A\u052C\u052E\u0531-\u0556\u10A0-\u10C5\u10C7\u10CD\u13A0-\u13F5\u1E00\u1E02\u1E04\u1E06\u1E08\u1E0A\u1E0C\u1E0E\u1E10\u1E12\u1E14\u1E16\u1E18\u1E1A\u1E1C\u1E1E\u1E20\u1E22\u1E24\u1E26\u1E28\u1E2A\u1E2C\u1E2E\u1E30\u1E32\u1E34\u1E36\u1E38\u1E3A\u1E3C\u1E3E\u1E40\u1E42\u1E44\u1E46\u1E48\u1E4A\u1E4C\u1E4E\u1E50\u1E52\u1E54\u1E56\u1E58\u1E5A\u1E5C\u1E5E\u1E60\u1E62\u1E64\u1E66\u1E68\u1E6A\u1E6C\u1E6E\u1E70\u1E72\u1E74\u1E76\u1E78\u1E7A\u1E7C\u1E7E\u1E80\u1E82\u1E84\u1E86\u1E88\u1E8A\u1E8C\u1E8E\u1E90\u1E92\u1E94\u1E9E\u1EA0\u1EA2\u1EA4\u1EA6\u1EA8\u1EAA\u1EAC\u1EAE\u1EB0\u1EB2\u1EB4\u1EB6\u1EB8\u1EBA\u1EBC\u1EBE\u1EC0\u1EC2\u1EC4\u1EC6\u1EC8\u1ECA\u1ECC\u1ECE\u1ED0\u1ED2\u1ED4\u1ED6\u1ED8\u1EDA\u1EDC\u1EDE\u1EE0\u1EE2\u1EE4\u1EE6\u1EE8\u1EEA\u1EEC\u1EEE\u1EF0\u1EF2\u1EF4\u1EF6\u1EF8\u1EFA\u1EFC\u1EFE\u1F08-\u1F0F\u1F18-\u1F1D\u1F28-\u1F2F\u1F38-\u1F3F\u1F48-\u1F4D\u1F59\u1F5B\u1F5D\u1F5F\u1F68-\u1F6F\u1FB8-\u1FBB\u1FC8-\u1FCB\u1FD8-\u1FDB\u1FE8-\u1FEC\u1FF8-\u1FFB\u2102\u2107\u210B-\u210D\u2110-\u2112\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u2130-\u2133\u213E\u213F\u2145\u2160-\u216F\u2183\u24B6-\u24CF\u2C00-\u2C2E\u2C60\u2C62-\u2C64\u2C67\u2C69\u2C6B\u2C6D-\u2C70\u2C72\u2C75\u2C7E-\u2C80\u2C82\u2C84\u2C86\u2C88\u2C8A\u2C8C\u2C8E\u2C90\u2C92\u2C94\u2C96\u2C98\u2C9A\u2C9C\u2C9E\u2CA0\u2CA2\u2CA4\u2CA6\u2CA8\u2CAA\u2CAC\u2CAE\u2CB0\u2CB2\u2CB4\u2CB6\u2CB8\u2CBA\u2CBC\u2CBE\u2CC0\u2CC2\u2CC4\u2CC6\u2CC8\u2CCA\u2CCC\u2CCE\u2CD0\u2CD2\u2CD4\u2CD6\u2CD8\u2CDA\u2CDC\u2CDE\u2CE0\u2CE2\u2CEB\u2CED\u2CF2\uA640\uA642\uA644\uA646\uA648\uA64A\uA64C\uA64E\uA650\uA652\uA654\uA656\uA658\uA65A\uA65C\uA65E\uA660\uA662\uA664\uA666\uA668\uA66A\uA66C\uA680\uA682\uA684\uA686\uA688\uA68A\uA68C\uA68E\uA690\uA692\uA694\uA696\uA698\uA69A\uA722\uA724\uA726\uA728\uA72A\uA72C\uA72E\uA732\uA734\uA736\uA738\uA73A\uA73C\uA73E\uA740\uA742\uA744\uA746\uA748\uA74A\uA74C\uA74E\uA750\uA752\uA754\uA756\uA758\uA75A\uA75C\uA75E\uA760\uA762\uA764\uA766\uA768\uA76A\uA76C\uA76E\uA779\uA77B\uA77D\uA77E\uA780\uA782\uA784\uA786\uA78B\uA78D\uA790\uA792\uA796\uA798\uA79A\uA79C\uA79E\uA7A0\uA7A2\uA7A4\uA7A6\uA7A8\uA7AA-\uA7AE\uA7B0-\uA7B4\uA7B6\uFF21-\uFF3A]|\uD801[\uDC00-\uDC27\uDCB0-\uDCD3]|\uD803[\uDC80-\uDCB2]|\uD806[\uDCA0-\uDCBF]|\uD835[\uDC00-\uDC19\uDC34-\uDC4D\uDC68-\uDC81\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB5\uDCD0-\uDCE9\uDD04\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD38\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD6C-\uDD85\uDDA0-\uDDB9\uDDD4-\uDDED\uDE08-\uDE21\uDE3C-\uDE55\uDE70-\uDE89\uDEA8-\uDEC0\uDEE2-\uDEFA\uDF1C-\uDF34\uDF56-\uDF6E\uDF90-\uDFA8\uDFCA]|\uD83A[\uDD00-\uDD21]|\uD83C[\uDD30-\uDD49\uDD50-\uDD69\uDD70-\uDD89])/.source+".*","u"),f=a("(?:"+/(?:[a-z\xAA\xB5\xBA\xDF-\xF6\xF8-\xFF\u0101\u0103\u0105\u0107\u0109\u010B\u010D\u010F\u0111\u0113\u0115\u0117\u0119\u011B\u011D\u011F\u0121\u0123\u0125\u0127\u0129\u012B\u012D\u012F\u0131\u0133\u0135\u0137\u0138\u013A\u013C\u013E\u0140\u0142\u0144\u0146\u0148\u0149\u014B\u014D\u014F\u0151\u0153\u0155\u0157\u0159\u015B\u015D\u015F\u0161\u0163\u0165\u0167\u0169\u016B\u016D\u016F\u0171\u0173\u0175\u0177\u017A\u017C\u017E-\u0180\u0183\u0185\u0188\u018C\u018D\u0192\u0195\u0199-\u019B\u019E\u01A1\u01A3\u01A5\u01A8\u01AA\u01AB\u01AD\u01B0\u01B4\u01B6\u01B9\u01BA\u01BD-\u01BF\u01C6\u01C9\u01CC\u01CE\u01D0\u01D2\u01D4\u01D6\u01D8\u01DA\u01DC\u01DD\u01DF\u01E1\u01E3\u01E5\u01E7\u01E9\u01EB\u01ED\u01EF\u01F0\u01F3\u01F5\u01F9\u01FB\u01FD\u01FF\u0201\u0203\u0205\u0207\u0209\u020B\u020D\u020F\u0211\u0213\u0215\u0217\u0219\u021B\u021D\u021F\u0221\u0223\u0225\u0227\u0229\u022B\u022D\u022F\u0231\u0233-\u0239\u023C\u023F\u0240\u0242\u0247\u0249\u024B\u024D\u024F-\u0293\u0295-\u02B8\u02C0\u02C1\u02E0-\u02E4\u0345\u0371\u0373\u0377\u037A-\u037D\u0390\u03AC-\u03CE\u03D0\u03D1\u03D5-\u03D7\u03D9\u03DB\u03DD\u03DF\u03E1\u03E3\u03E5\u03E7\u03E9\u03EB\u03ED\u03EF-\u03F3\u03F5\u03F8\u03FB\u03FC\u0430-\u045F\u0461\u0463\u0465\u0467\u0469\u046B\u046D\u046F\u0471\u0473\u0475\u0477\u0479\u047B\u047D\u047F\u0481\u048B\u048D\u048F\u0491\u0493\u0495\u0497\u0499\u049B\u049D\u049F\u04A1\u04A3\u04A5\u04A7\u04A9\u04AB\u04AD\u04AF\u04B1\u04B3\u04B5\u04B7\u04B9\u04BB\u04BD\u04BF\u04C2\u04C4\u04C6\u04C8\u04CA\u04CC\u04CE\u04CF\u04D1\u04D3\u04D5\u04D7\u04D9\u04DB\u04DD\u04DF\u04E1\u04E3\u04E5\u04E7\u04E9\u04EB\u04ED\u04EF\u04F1\u04F3\u04F5\u04F7\u04F9\u04FB\u04FD\u04FF\u0501\u0503\u0505\u0507\u0509\u050B\u050D\u050F\u0511\u0513\u0515\u0517\u0519\u051B\u051D\u051F\u0521\u0523\u0525\u0527\u0529\u052B\u052D\u052F\u0561-\u0587\u13F8-\u13FD\u1C80-\u1C88\u1D00-\u1DBF\u1E01\u1E03\u1E05\u1E07\u1E09\u1E0B\u1E0D\u1E0F\u1E11\u1E13\u1E15\u1E17\u1E19\u1E1B\u1E1D\u1E1F\u1E21\u1E23\u1E25\u1E27\u1E29\u1E2B\u1E2D\u1E2F\u1E31\u1E33\u1E35\u1E37\u1E39\u1E3B\u1E3D\u1E3F\u1E41\u1E43\u1E45\u1E47\u1E49\u1E4B\u1E4D\u1E4F\u1E51\u1E53\u1E55\u1E57\u1E59\u1E5B\u1E5D\u1E5F\u1E61\u1E63\u1E65\u1E67\u1E69\u1E6B\u1E6D\u1E6F\u1E71\u1E73\u1E75\u1E77\u1E79\u1E7B\u1E7D\u1E7F\u1E81\u1E83\u1E85\u1E87\u1E89\u1E8B\u1E8D\u1E8F\u1E91\u1E93\u1E95-\u1E9D\u1E9F\u1EA1\u1EA3\u1EA5\u1EA7\u1EA9\u1EAB\u1EAD\u1EAF\u1EB1\u1EB3\u1EB5\u1EB7\u1EB9\u1EBB\u1EBD\u1EBF\u1EC1\u1EC3\u1EC5\u1EC7\u1EC9\u1ECB\u1ECD\u1ECF\u1ED1\u1ED3\u1ED5\u1ED7\u1ED9\u1EDB\u1EDD\u1EDF\u1EE1\u1EE3\u1EE5\u1EE7\u1EE9\u1EEB\u1EED\u1EEF\u1EF1\u1EF3\u1EF5\u1EF7\u1EF9\u1EFB\u1EFD\u1EFF-\u1F07\u1F10-\u1F15\u1F20-\u1F27\u1F30-\u1F37\u1F40-\u1F45\u1F50-\u1F57\u1F60-\u1F67\u1F70-\u1F7D\u1F80-\u1F87\u1F90-\u1F97\u1FA0-\u1FA7\u1FB0-\u1FB4\u1FB6\u1FB7\u1FBE\u1FC2-\u1FC4\u1FC6\u1FC7\u1FD0-\u1FD3\u1FD6\u1FD7\u1FE0-\u1FE7\u1FF2-\u1FF4\u1FF6\u1FF7\u2071\u207F\u2090-\u209C\u210A\u210E\u210F\u2113\u212F\u2134\u2139\u213C\u213D\u2146-\u2149\u214E\u2170-\u217F\u2184\u24D0-\u24E9\u2C30-\u2C5E\u2C61\u2C65\u2C66\u2C68\u2C6A\u2C6C\u2C71\u2C73\u2C74\u2C76-\u2C7D\u2C81\u2C83\u2C85\u2C87\u2C89\u2C8B\u2C8D\u2C8F\u2C91\u2C93\u2C95\u2C97\u2C99\u2C9B\u2C9D\u2C9F\u2CA1\u2CA3\u2CA5\u2CA7\u2CA9\u2CAB\u2CAD\u2CAF\u2CB1\u2CB3\u2CB5\u2CB7\u2CB9\u2CBB\u2CBD\u2CBF\u2CC1\u2CC3\u2CC5\u2CC7\u2CC9\u2CCB\u2CCD\u2CCF\u2CD1\u2CD3\u2CD5\u2CD7\u2CD9\u2CDB\u2CDD\u2CDF\u2CE1\u2CE3\u2CE4\u2CEC\u2CEE\u2CF3\u2D00-\u2D25\u2D27\u2D2D\uA641\uA643\uA645\uA647\uA649\uA64B\uA64D\uA64F\uA651\uA653\uA655\uA657\uA659\uA65B\uA65D\uA65F\uA661\uA663\uA665\uA667\uA669\uA66B\uA66D\uA681\uA683\uA685\uA687\uA689\uA68B\uA68D\uA68F\uA691\uA693\uA695\uA697\uA699\uA69B-\uA69D\uA723\uA725\uA727\uA729\uA72B\uA72D\uA72F-\uA731\uA733\uA735\uA737\uA739\uA73B\uA73D\uA73F\uA741\uA743\uA745\uA747\uA749\uA74B\uA74D\uA74F\uA751\uA753\uA755\uA757\uA759\uA75B\uA75D\uA75F\uA761\uA763\uA765\uA767\uA769\uA76B\uA76D\uA76F-\uA778\uA77A\uA77C\uA77F\uA781\uA783\uA785\uA787\uA78C\uA78E\uA791\uA793-\uA795\uA797\uA799\uA79B\uA79D\uA79F\uA7A1\uA7A3\uA7A5\uA7A7\uA7A9\uA7B5\uA7B7\uA7F8-\uA7FA\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABBF\uFB00-\uFB06\uFB13-\uFB17\uFF41-\uFF5A]|\uD801[\uDC28-\uDC4F\uDCD8-\uDCFB]|\uD803[\uDCC0-\uDCF2]|\uD806[\uDCC0-\uDCDF]|\uD835[\uDC1A-\uDC33\uDC4E-\uDC54\uDC56-\uDC67\uDC82-\uDC9B\uDCB6-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDCCF\uDCEA-\uDD03\uDD1E-\uDD37\uDD52-\uDD6B\uDD86-\uDD9F\uDDBA-\uDDD3\uDDEE-\uDE07\uDE22-\uDE3B\uDE56-\uDE6F\uDE8A-\uDEA5\uDEC2-\uDEDA\uDEDC-\uDEE1\uDEFC-\uDF14\uDF16-\uDF1B\uDF36-\uDF4E\uDF50-\uDF55\uDF70-\uDF88\uDF8A-\uDF8F\uDFAA-\uDFC2\uDFC4-\uDFC9\uDFCB]|\uD83A[\uDD22-\uDD43])/.source+".*|"+l+".*|\\S*)","u");e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";"string"!=typeof t&&(t+="");var e="",n="",i="";if(/[^.], /.test(t)){var o=t.split(", ");i=o.shift();var a=RegExp(u).exec(o.join(", "));e=o.splice(a&&0!==a.index?0:-1,1)[0],n=o.join(", ")}else{var s=t.split(h,2),l=s.shift().split(f,2);e=l[0],i=l[1],n=s.pop()}var d=e.match(c),m=r(d,3),g=m[1],v=m[2],y=n,b=i.split(p,2).reverse(),_=r(b,2),x=_[0],w=_[1];if(!v&&x)return x.includes(" ")?{literal:x}:{family:x};if(x){var E={"dropping-particle":g,given:v,suffix:y,"non-dropping-particle":w,family:x};return Object.keys(E).forEach(function(t){E[t]||delete E[t]}),E}return console.warn("[set]","Could not parse name: '"+t+"', falling back to literal"),{literal:t}}},,,,,,,,,function(t,e,n){(function(t){var n,r,i,o,a,s,u,l,c,h={PROCESSOR_VERSION:"1.1.183",CONDITION_LEVEL_TOP:1,CONDITION_LEVEL_BOTTOM:2,PLAIN_HYPHEN_REGEX:/(?:[^\\]-|\u2013)/,LOCATOR_LABELS_REGEXP:new RegExp("^((art|ch|subch|col|fig|l|n|no|op|p|pp|para|subpara|pt|r|sec|subsec|sv|sch|tit|vrs|vol)\\.)\\s+(.*)"),STATUTE_SUBDIV_GROUPED_REGEX:/((?:^| )(?:art|bk|ch|subch|col|fig|fol|l|n|no|op|p|pp|para|subpara|pt|r|sec|subsec|sv|sch|tit|vrs|vol)\. *)/g,STATUTE_SUBDIV_PLAIN_REGEX:/(?:(?:^| )(?:art|bk|ch|subch|col|fig|fol|l|n|no|op|p|pp|para|subpara|pt|r|sec|subsec|sv|sch|tit|vrs|vol)\. *)/,STATUTE_SUBDIV_STRINGS:{"art.":"article","bk.":"book","ch.":"chapter","subch.":"subchapter","p.":"page","pp.":"page","para.":"paragraph","subpara.":"subparagraph","pt.":"part","r.":"rule","sec.":"section","subsec.":"subsection","sch.":"schedule","tit.":"title","col.":"column","fig.":"figure","fol.":"folio","l.":"line","n.":"note","no.":"issue","op.":"opus","sv.":"sub-verbo","vrs.":"verse","vol.":"volume"},STATUTE_SUBDIV_STRINGS_REVERSE:{article:"art.",book:"bk.",chapter:"ch.",subchapter:"subch.",page:"p.",paragraph:"para.",subparagraph:"subpara.",part:"pt.",rule:"r.",section:"sec.",subsection:"subsec.",schedule:"sch.",title:"tit.",column:"col.",figure:"fig.",folio:"fol.",line:"l.",note:"n.",issue:"no.",opus:"op.","sub-verbo":"sv.","sub verbo":"sv.",verse:"vrs.",volume:"vol."},LOCATOR_LABELS_MAP:{art:"article",bk:"book",ch:"chapter",subch:"subchapter",col:"column",fig:"figure",fol:"folio",l:"line",n:"note",no:"issue",op:"opus",p:"page",pp:"page",para:"paragraph",subpara:"subparagraph",pt:"part",r:"rule",sec:"section",subsec:"subsection",sv:"sub-verbo",sch:"schedule",tit:"title",vrs:"verse",vol:"volume"},MODULE_MACROS:{"juris-pretitle":!0,"juris-title":!0,"juris-pretitle-short":!0,"juris-title-short":!0,"juris-main":!0,"juris-main-short":!0,"juris-tail":!0,"juris-tail-short":!0,"juris-locator":!0},MODULE_TYPES:{legal_case:!0,legislation:!0,bill:!0,hearing:!0,gazette:!0,report:!0,regulation:!0,standard:!0},NestedBraces:[["(","["],[")","]"]],checkNestedBrace:function(t){"note"===t.opt.xclass?(this.depth=0,this.update=function(t){for(var e=(t=t||"").split(/([\(\)])/),n=1,r=e.length;n<r;n+=2)"("===e[n]?(1==this.depth%2&&(e[n]="["),this.depth+=1):")"===e[n]&&(0==this.depth%2&&(e[n]="]"),this.depth-=1);return e.join("")}):this.update=function(t){return t}},MULTI_FIELDS:["event","publisher","publisher-place","event-place","title","container-title","collection-title","authority","genre","title-short","medium","jurisdiction","archive","archive-place"],LangPrefsMap:{title:"titles","title-short":"titles",event:"titles",genre:"titles",medium:"titles","container-title":"journals","collection-title":"journals",archive:"journals",publisher:"publishers",authority:"publishers","publisher-place":"places","event-place":"places","archive-place":"places",jurisdiction:"places",number:"number",edition:"number",issue:"number",volume:"number"},AbbreviationSegments:function(){this["container-title"]={},this["collection-title"]={},this["institution-entire"]={},this["institution-part"]={},this.nickname={},this.number={},this.title={},this.place={},this.hereinafter={},this.classic={},this["container-phrase"]={},this["title-phrase"]={}},FIELD_CATEGORY_REMAP:{title:"title","container-title":"container-title","collection-title":"collection-title",number:"number",place:"place",archive:"collection-title","title-short":"title",genre:"title",event:"title",medium:"title","archive-place":"place","publisher-place":"place","event-place":"place",jurisdiction:"place","language-name":"place","language-name-original":"place","call-number":"number","chapter-number":"number","collection-number":"number",edition:"number",page:"number",issue:"number",locator:"number","number-of-pages":"number","number-of-volumes":"number",volume:"number","citation-number":"number",publisher:"institution-part"},parseLocator:function(t){if(this.opt.development_extensions.locator_date_and_revision&&t.locator){t.locator=""+t.locator;var e=t.locator.indexOf("|");if(e>-1){var n=t.locator;t.locator=n.slice(0,e);var r=(n=n.slice(e+1)).match(/^([0-9]{4}-[0-9]{2}-[0-9]{2}).*/);r&&(t["locator-date"]=this.fun.dateparser.parseDateToObject(r[1]),n=n.slice(r[1].length)),t["locator-extra"]=n.replace(/^\s+/,"").replace(/\s+$/,"")}}return t.locator&&(t.locator=(""+t.locator).replace(/\s+$/,"")),t},normalizeLocaleStr:function(t){if(t){var e=t.split("-");return e[0]=e[0].toLowerCase(),e[1]&&(e[1]=e[1].toUpperCase()),e.join("-")}},parseNoteFieldHacks:function(t,e,n){if("string"==typeof t.note){for(var r=[],i=t.note.split("\n"),o=0,a=i.length;o<a;o++){r=[];var s=(d=i[o]).match(h.NOTE_FIELDS_REGEXP);if(s){for(var u=d.split(h.NOTE_FIELDS_REGEXP),l=0,c=u.length-1;l<c;l++)r.push(u[l]),r.push(s[l]);r.push(u[u.length-1]);for(l=1,c=r.length;l<c&&(!r[l-1].trim()||!(o>0||l>1)||r[l-1].match(h.NOTE_FIELD_REGEXP));l+=2)r[l]="\n"+r[l].slice(2,-1).trim()+"\n";i[o]=r.join("")}}var p=0,f={};for(o=0,a=(i=i.join("\n").split("\n")).length;o<a;o++){var d,m=(d=i[o]).match(h.NOTE_FIELD_REGEXP);if(d.trim()){if(!m){if(0===o)continue;p=o;break}var g=m[1],v=m[2].replace(/^\s+/,"").replace(/\s+$/,"");if("type"===g)t.type=v,i[o]="";else if(h.DATE_VARIABLES.indexOf(g)>-1)n&&(t[g]={raw:v},(!e||e[g]&&v.match(/^[0-9]{4}(?:-[0-9]{1,2}(?:-[0-9]{1,2})*)*$/))&&(i[o]=""));else if(!t[g]){if(h.NAME_VARIABLES.indexOf(g)>-1){f[g]||(f[g]=[]);var y=v.split(/\s*\|\|\s*/);if(1===y.length)f[g].push({literal:y[0]});else if(2===y.length){var b={family:y[0],given:y[1]};h.parseParticles(b),f[g].push(b)}}else t[g]=v;e&&!e[g]||(i[o]="")}}}for(var g in f)t[g]=f[g];if(e){i[p].trim()&&(i[p]="\n"+i[p]);for(o=p-1;o>-1;o--)i[o].trim()||(i=i.slice(0,o).concat(i.slice(o+1)))}t.note=i.join("\n").trim()}},GENDERS:["masculine","feminine"],ERROR_NO_RENDERED_FORM:1,PREVIEW:"Just for laughs.",ASSUME_ALL_ITEMS_REGISTERED:2,START:0,END:1,SINGLETON:2,SEEN:6,SUCCESSOR:3,SUCCESSOR_OF_SUCCESSOR:4,SUPPRESS:5,SINGULAR:0,PLURAL:1,LITERAL:!0,BEFORE:1,AFTER:2,DESCENDING:1,ASCENDING:2,ONLY_FIRST:1,ALWAYS:2,ONLY_LAST:3,FINISH:1,POSITION_FIRST:0,POSITION_SUBSEQUENT:1,POSITION_IBID:2,POSITION_IBID_WITH_LOCATOR:3,MARK_TRAILING_NAMES:!0,POSITION_TEST_VARS:["position","first-reference-note-number","near-note"],AREAS:["citation","citation_sort","bibliography","bibliography_sort"],CITE_FIELDS:["first-reference-note-number","locator","locator-extra"],MINIMAL_NAME_FIELDS:["literal","family"],SWAPPING_PUNCTUATION:[".","!","?",":",","],TERMINAL_PUNCTUATION:[":",".",";","!","?"," "],NONE:0,NUMERIC:1,POSITION:2,COLLAPSE_VALUES:["citation-number","year","year-suffix"],DATE_PARTS:["year","month","day"],DATE_PARTS_ALL:["year","month","day","season"],DATE_PARTS_INTERNAL:["year","month","day","year_end","month_end","day_end"],NAME_PARTS:["non-dropping-particle","family","given","dropping-particle","suffix","literal"],DECORABLE_NAME_PARTS:["given","family","suffix"],DISAMBIGUATE_OPTIONS:["disambiguate-add-names","disambiguate-add-givenname","disambiguate-add-year-suffix"],GIVENNAME_DISAMBIGUATION_RULES:["all-names","all-names-with-initials","primary-name","primary-name-with-initials","by-cite"],NAME_ATTRIBUTES:["and","delimiter-precedes-last","delimiter-precedes-et-al","initialize-with","initialize","name-as-sort-order","sort-separator","et-al-min","et-al-use-first","et-al-subsequent-min","et-al-subsequent-use-first","form","prefix","suffix","delimiter"],PARALLEL_MATCH_VARS:["container-title"],PARALLEL_TYPES:["bill","gazette","regulation","legislation","legal_case","treaty","article-magazine","article-journal"],PARALLEL_COLLAPSING_MID_VARSET:["volume","issue","container-title","section","collection-number"],LOOSE:0,STRICT:1,TOLERANT:2,PREFIX_PUNCTUATION:/[.;:]\s*$/,SUFFIX_PUNCTUATION:/^\s*[.;:,\(\)]/,NUMBER_REGEXP:/(?:^\d+|\d+$)/,NAME_INITIAL_REGEXP:/^([A-Z\u0590-\u05ff\u00c0-\u017f\u0400-\u042f\u0600-\u06ff\u0370\u0372\u0376\u0386\u0388-\u03ab\u03e2\u03e4\u03e6\u03e8\u03ea\u03ec\u03ee\u03f4\u03f7\u03fd-\u03ff])([a-zA-Z\u00c0-\u017f\u0400-\u052f\u0600-\u06ff\u0370-\u03ff\u1f00-\u1fff]*|)/,ROMANESQUE_REGEXP:/[-0-9a-zA-Z\u0590-\u05d4\u05d6-\u05ff\u0080-\u017f\u0400-\u052f\u0370-\u03ff\u1f00-\u1fff\u0600-\u06ff\u200c\u200d\u200e\u0218\u0219\u021a\u021b\u202a-\u202e]/,ROMANESQUE_NOT_REGEXP:/[^a-zA-Z\u0590-\u05ff\u00c0-\u017f\u0400-\u052f\u0370-\u03ff\u1f00-\u1fff\u0600-\u06ff\u200c\u200d\u200e\u0218\u0219\u021a\u021b\u202a-\u202e]/g,STARTSWITH_ROMANESQUE_REGEXP:/^[&a-zA-Z\u0590-\u05d4\u05d6-\u05ff\u00c0-\u017f\u0400-\u052f\u0370-\u03ff\u1f00-\u1fff\u0600-\u06ff\u200c\u200d\u200e\u0218\u0219\u021a\u021b\u202a-\u202e]/,ENDSWITH_ROMANESQUE_REGEXP:/[.;:&a-zA-Z\u0590-\u05d4\u05d6-\u05ff\u00c0-\u017f\u0400-\u052f\u0370-\u03ff\u1f00-\u1fff\u0600-\u06ff\u200c\u200d\u200e\u0218\u0219\u021a\u021b\u202a-\u202e]$/,ALL_ROMANESQUE_REGEXP:/^[a-zA-Z\u0590-\u05ff\u00c0-\u017f\u0400-\u052f\u0370-\u03ff\u1f00-\u1fff\u0600-\u06ff\u200c\u200d\u200e\u0218\u0219\u021a\u021b\u202a-\u202e]+$/,VIETNAMESE_SPECIALS:/[\u00c0-\u00c3\u00c8-\u00ca\u00cc\u00cd\u00d2-\u00d5\u00d9\u00da\u00dd\u00e0-\u00e3\u00e8-\u00ea\u00ec\u00ed\u00f2-\u00f5\u00f9\u00fa\u00fd\u0101\u0103\u0110\u0111\u0128\u0129\u0168\u0169\u01a0\u01a1\u01af\u01b0\u1ea0-\u1ef9]/,VIETNAMESE_NAMES:/^(?:(?:[.AaBbCcDdEeGgHhIiKkLlMmNnOoPpQqRrSsTtUuVvXxYy \u00c0-\u00c3\u00c8-\u00ca\u00cc\u00cd\u00d2-\u00d5\u00d9\u00da\u00dd\u00e0-\u00e3\u00e8-\u00ea\u00ec\u00ed\u00f2-\u00f5\u00f9\u00fa\u00fd\u0101\u0103\u0110\u0111\u0128\u0129\u0168\u0169\u01a0\u01a1\u01af\u01b0\u1ea0-\u1ef9]{2,6})(\s+|$))+$/,NOTE_FIELDS_REGEXP:/\{:(?:[\-_a-z]+|[A-Z]+):[^\}]+\}/g,NOTE_FIELD_REGEXP:/^([\-_a-z]+|[A-Z]+):\s*([^\}]+)$/,PARTICLE_GIVEN_REGEXP:/^([^ ]+(?:\u02bb |\u2019 | |\' ) *)(.+)$/,PARTICLE_FAMILY_REGEXP:/^([^ ]+(?:\-|\u02bb|\u2019| |\') *)(.+)$/,DISPLAY_CLASSES:["block","left-margin","right-inline","indent"],NAME_VARIABLES:["author","editor","translator","contributor","collection-editor","composer","container-author","director","editorial-director","interviewer","original-author","recipient"],NUMERIC_VARIABLES:["call-number","chapter-number","collection-number","edition","page","issue","locator","number","number-of-pages","number-of-volumes","volume","citation-number"],DATE_VARIABLES:["locator-date","issued","event-date","accessed","container","original-date","publication-date","original-date","available-date","submitted"],TITLE_FIELD_SPLITS:function(t){for(var e=["title","short","main","sub"],n={},r=0,i=e.length;r<i;r++)n[e[r]]=t+"title"+("title"===e[r]?"":"-"+e[r]);return n},TAG_USEALL:function(t){var e,n,r,i;for(e=[""],n=t.indexOf("<"),r=t.indexOf(">");n>-1&&r>-1;)i=n>r?n+1:r+1,n<r&&-1===t.slice(n+1,r).indexOf("<")?(e[e.length-1]+=t.slice(0,n),e.push(t.slice(n,r+1)),e.push(""),t=t.slice(i)):(e[e.length-1]+=t.slice(0,r+1),t=t.slice(i)),n=t.indexOf("<"),r=t.indexOf(">");return e[e.length-1]+=t,e},demoteNoiseWords:function(t,e,n){var r=t.locale[t.opt.lang].opts["leading-noise-words"];if(e&&n){(e=e.split(/\s+/)).reverse();for(var i=[],o=e.length-1;o>-1&&r.indexOf(e[o].toLowerCase())>-1;o+=-1)i.push(e.pop());e.reverse();var a=e.join(" "),s=i.join(" ");"drop"!==n&&s?"demote"===n&&(e=[a,s].join(", ")):e=a}return e},extractTitleAndSubtitle:function(t){for(var e=["","container-"],n=0,r=e.length;n<r;n++){var i=e[n],o=h.TITLE_FIELD_SPLITS(i),a=[!1];if(t.multi)for(var s in t.multi._keys[o.short])a.push(s);var u=0;for(a.length;u<r;u++){var l={};if((s=a[u])?(t.multi._keys[o.title]&&(l[o.title]=t.multi._keys[o.title][s]),t.multi._keys[o.short]&&(l[o.short]=t.multi._keys[o.short][s])):(l[o.title]=t[o.title],l[o.short]=t[o.short]),l[o.main]=l[o.title],l[o.sub]=!1,l[o.title]&&l[o.short]){var c=l[o.short],p=c.length;l[o.title].slice(0,p)===c&&l[o.title].slice(p).match(/^\s*:/)&&(l[o.main]=l[o.title].slice(0,p).replace(/\s+$/,""),l[o.sub]=l[o.title].slice(p).replace(/^\s*:\s*/,""))}if(s)for(var f in l)t.multi._keys[f]||(t.multi._keys[f]={}),t.multi._keys[f][s]=l[f];else for(var f in l)t[f]=l[f]}}},titlecaseSentenceOrNormal:function(t,e,n,r,i){var o=h.TITLE_FIELD_SPLITS(n),a={};if(r&&e.multi?(e.multi._keys[o.title]&&(a[o.title]=e.multi._keys[o.title][r]),e.multi._keys[o.main]&&(a[o.main]=e.multi._keys[o.main][r]),e.multi._keys[o.sub]&&(a[o.sub]=e.multi._keys[o.sub][r])):(a[o.title]=e[o.title],a[o.main]=e[o.main],a[o.sub]=e[o.sub]),a[o.main]&&a[o.sub]){var s=a[o.main],u=a[o.sub];return i?(s=h.Output.Formatters.sentence(t,s),u=h.Output.Formatters.sentence(t,u)):u=h.Output.Formatters["capitalize-first"](t,u),[s,u].join(a[o.title].slice(s.length,-1*u.length))}return i?h.Output.Formatters.sentence(t,a[o.title]):a[o.title]},getSafeEscape:function(t){if(["bibliography","citation"].indexOf(t.tmp.area)>-1){var e=[];return t.opt.development_extensions.thin_non_breaking_space_html_hack&&"html"===t.opt.mode&&e.push(function(t){return t.replace(/\u202f/g,'<span style="white-space:nowrap">&thinsp;</span>')}),e.length?function(n){for(var r=0,i=e.length;r<i;r+=1)n=e[r](n);return h.Output.Formats[t.opt.mode].text_escape(n)}:h.Output.Formats[t.opt.mode].text_escape}return function(t){return t}},SKIP_WORDS:["about","above","across","afore","after","against","along","alongside","amid","amidst","among","amongst","anenst","apropos","apud","around","as","aside","astride","at","athwart","atop","barring","before","behind","below","beneath","beside","besides","between","beyond","but","by","circa","despite","down","during","except","for","forenenst","from","given","in","inside","into","lest","like","modulo","near","next","notwithstanding","of","off","on","onto","out","over","per","plus","pro","qua","sans","since","than","through"," thru","throughout","thruout","till","to","toward","towards","under","underneath","until","unto","up","upon","versus","vs.","v.","vs","v","via","vis-à-vis","with","within","without","according to","ahead of","apart from","as for","as of","as per","as regards","aside from","back to","because of","close to","due to","except for","far from","inside of","instead of","near to","next to","on to","out from","out of","outside of","prior to","pursuant to","rather than","regardless of","such as","that of","up to","where as","or","yet","so","for","and","nor","a","an","the","de","d'","von","van","c","et","ca"],FORMAT_KEY_SEQUENCE:["@strip-periods","@font-style","@font-variant","@font-weight","@text-decoration","@vertical-align","@quotes"],INSTITUTION_KEYS:["font-style","font-variant","font-weight","text-decoration","text-case"],SUFFIX_CHARS:"a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z",ROMAN_NUMERALS:[["","i","ii","iii","iv","v","vi","vii","viii","ix"],["","x","xx","xxx","xl","l","lx","lxx","lxxx","xc"],["","c","cc","ccc","cd","d","dc","dcc","dccc","cm"],["","m","mm","mmm","mmmm","mmmmm"]],CREATORS:["author","editor","contributor","translator","recipient","interviewer","composer","original-author","container-author","collection-editor"],LANGS:{"af-ZA":"Afrikaans",ar:"Arabic","bg-BG":"Bulgarian","ca-AD":"Catalan","cs-CZ":"Czech","da-DK":"Danish","de-AT":"Austrian","de-CH":"German (CH)","de-DE":"German (DE)","el-GR":"Greek","en-GB":"English (GB)","en-US":"English (US)","es-ES":"Spanish","et-EE":"Estonian",eu:"European","fa-IR":"Persian","fi-FI":"Finnish","fr-CA":"French (CA)","fr-FR":"French (FR)","he-IL":"Hebrew","hr-HR":"Croatian","hu-HU":"Hungarian","is-IS":"Icelandic","it-IT":"Italian","ja-JP":"Japanese","km-KH":"Khmer","ko-KR":"Korean","lt-LT":"Lithuanian","lv-LV":"Latvian","mn-MN":"Mongolian","nb-NO":"Norwegian (Bokmål)","nl-NL":"Dutch","nn-NO":"Norwegian (Nynorsk)","pl-PL":"Polish","pt-BR":"Portuguese (BR)","pt-PT":"Portuguese (PT)","ro-RO":"Romanian","ru-RU":"Russian","sk-SK":"Slovak","sl-SI":"Slovenian","sr-RS":"Serbian","sv-SE":"Swedish","th-TH":"Thai","tr-TR":"Turkish","uk-UA":"Ukranian","vi-VN":"Vietnamese","zh-CN":"Chinese (CN)","zh-TW":"Chinese (TW)"},LANG_BASES:{af:"af_ZA",ar:"ar",bg:"bg_BG",ca:"ca_AD",cs:"cs_CZ",da:"da_DK",de:"de_DE",el:"el_GR",en:"en_US",es:"es_ES",et:"et_EE",eu:"eu",fa:"fa_IR",fi:"fi_FI",fr:"fr_FR",he:"he_IL",hr:"hr-HR",hu:"hu_HU",is:"is_IS",it:"it_IT",ja:"ja_JP",km:"km_KH",ko:"ko_KR",lt:"lt_LT",lv:"lv-LV",mn:"mn_MN",nb:"nb_NO",nl:"nl_NL",nn:"nn-NO",pl:"pl_PL",pt:"pt_PT",ro:"ro_RO",ru:"ru_RU",sk:"sk_SK",sl:"sl_SI",sr:"sr_RS",sv:"sv_SE",th:"th_TH",tr:"tr_TR",uk:"uk_UA",vi:"vi_VN",zh:"zh_CN"},SUPERSCRIPTS:{"ª":"a","²":"2","³":"3","¹":"1","º":"o","ʰ":"h","ʱ":"ɦ","ʲ":"j","ʳ":"r","ʴ":"ɹ","ʵ":"ɻ","ʶ":"ʁ","ʷ":"w","ʸ":"y","ˠ":"ɣ","ˡ":"l","ˢ":"s","ˣ":"x","ˤ":"ʕ","ᴬ":"A","ᴭ":"Æ","ᴮ":"B","ᴰ":"D","ᴱ":"E","ᴲ":"Ǝ","ᴳ":"G","ᴴ":"H","ᴵ":"I","ᴶ":"J","ᴷ":"K","ᴸ":"L","ᴹ":"M","ᴺ":"N","ᴼ":"O","ᴽ":"Ȣ","ᴾ":"P","ᴿ":"R","ᵀ":"T","ᵁ":"U","ᵂ":"W","ᵃ":"a","ᵄ":"ɐ","ᵅ":"ɑ","ᵆ":"ᴂ","ᵇ":"b","ᵈ":"d","ᵉ":"e","ᵊ":"ə","ᵋ":"ɛ","ᵌ":"ɜ","ᵍ":"g","ᵏ":"k","ᵐ":"m","ᵑ":"ŋ","ᵒ":"o","ᵓ":"ɔ","ᵔ":"ᴖ","ᵕ":"ᴗ","ᵖ":"p","ᵗ":"t","ᵘ":"u","ᵙ":"ᴝ","ᵚ":"ɯ","ᵛ":"v","ᵜ":"ᴥ","ᵝ":"β","ᵞ":"γ","ᵟ":"δ","ᵠ":"φ","ᵡ":"χ","⁰":"0","ⁱ":"i","⁴":"4","⁵":"5","⁶":"6","⁷":"7","⁸":"8","⁹":"9","⁺":"+","⁻":"−","⁼":"=","⁽":"(","⁾":")","ⁿ":"n","℠":"SM","™":"TM","㆒":"一","㆓":"二","㆔":"三","㆕":"四","㆖":"上","㆗":"中","㆘":"下","㆙":"甲","㆚":"乙","㆛":"丙","㆜":"丁","㆝":"天","㆞":"地","㆟":"人","ˀ":"ʔ","ˁ":"ʕ","ۥ":"و","ۦ":"ي"},SUPERSCRIPTS_REGEXP:new RegExp("[ª²³¹ºʰʱʲʳʴʵʶʷʸˠˡˢˣˤᴬᴭᴮᴰᴱᴲᴳᴴᴵᴶᴷᴸᴹᴺᴼᴽᴾᴿᵀᵁᵂᵃᵄᵅᵆᵇᵈᵉᵊᵋᵌᵍᵏᵐᵑᵒᵓᵔᵕᵖᵗᵘᵙᵚᵛᵜᵝᵞᵟᵠᵡ⁰ⁱ⁴⁵⁶⁷⁸⁹⁺⁻⁼⁽⁾ⁿ℠™㆒㆓㆔㆕㆖㆗㆘㆙㆚㆛㆜㆝㆞㆟ˀˁۥۦ]","g"),UPDATE_GROUP_CONTEXT_CONDITION:function(t,e,n){if(t.tmp.group_context.tip.condition){if(t.tmp.group_context.tip.condition.test){var r;if("empty-label"===t.tmp.group_context.tip.condition.test)r=!e;else if("comma-safe"===t.tmp.group_context.tip.condition.test){var i=!e,o=e.slice(0,1).match(h.ALL_ROMANESQUE_REGEXP);t.tmp.just_did_number;r=!!i||!(!o||n)}t.tmp.group_context.tip.force_suppress=!r,t.tmp.group_context.tip.condition.not&&(t.tmp.group_context.tip.force_suppress=!t.tmp.group_context.tip.force_suppress)}}else e.slice(-1).match(/[0-9]/)?t.tmp.just_did_number=!0:t.tmp.just_did_number=!1},locale:{},locale_opts:{},locale_dates:{}};if(void 0!==t&&"exports"in t){e.CSL=h}h.TERMINAL_PUNCTUATION_REGEXP=new RegExp("^(["+h.TERMINAL_PUNCTUATION.slice(0,-1).join("")+"])(.*)"),h.CLOSURES=new RegExp(".*[\\]\\)]"),t.exports=h,"undefined"==typeof console?(h.debug=function(t){dump("CSL: "+t+"\n")},h.error=function(t){dump("CSL error: "+t+"\n")}):(h.debug=function(t){console.log("CSL: "+t)},h.error=function(t){console.log("CSL error: "+t)}),t.exports=h,h.XmlJSON=function(t){this.dataObj=t,this.institution={name:"institution",attrs:{"institution-parts":"long",delimiter:", ","substitute-use-first":"1","use-last":"1"},children:[{name:"institution-part",attrs:{name:"long"},children:[]}]}},h.XmlJSON.prototype.clean=function(t){return t},h.XmlJSON.prototype.getStyleId=function(t,e){var n="id";e&&(n="title");for(var r="",i=t.children,o=0,a=i.length;o<a;o++)if("info"===i[o].name)for(var s=i[o].children,u=0,l=s.length;u<l;u++)s[u].name===n&&(r=s[u].children[0]);return r},h.XmlJSON.prototype.children=function(t){return!(!t||!t.children.length)&&t.children.slice()},h.XmlJSON.prototype.nodename=function(t){return t?t.name:null},h.XmlJSON.prototype.attributes=function(t){var e={};for(var n in t.attrs)e["@"+n]=t.attrs[n];return e},h.XmlJSON.prototype.content=function(t){var e="";if(!t||!t.children)return e;for(var n=0,r=t.children.length;n<r;n+=1)"string"==typeof t.children[n]&&(e+=t.children[n]);return e},h.XmlJSON.prototype.namespace={},h.XmlJSON.prototype.numberofnodes=function(t){return t&&"number"==typeof t.length?t.length:0},h.XmlJSON.prototype.getAttributeValue=function(t,e,n){var r="";return n&&(e=n+":"+e),t&&t.attrs&&(r=t.attrs[e]?t.attrs[e]:""),r},h.XmlJSON.prototype.getNodeValue=function(t,e){var n="";if(e)for(var r=0,i=t.children.length;r<i;r+=1)t.children[r].name===e&&(n=t.children[r].children.length?t.children[r]:"");else t&&(n=t);return n&&n.children&&1==n.children.length&&"string"==typeof n.children[0]&&(n=n.children[0]),n},h.XmlJSON.prototype.setAttributeOnNodeIdentifiedByNameAttribute=function(t,e,n,r,i){"@"===r.slice(0,1)&&(r=r.slice(1));for(var o=0,a=t.children.length;o<a;o+=1)t.children[o].name===e&&t.children[o].attrs.name===n&&(t.children[o].attrs[r]=i)},h.XmlJSON.prototype.deleteNodeByNameAttribute=function(t,e){var n,r;for(n=0,r=t.children.length;n<r;n+=1)t.children[n]&&"string"!=typeof t.children[n]&&t.children[n].attrs.name==e&&(t.children=t.children.slice(0,n).concat(t.children.slice(n+1)))},h.XmlJSON.prototype.deleteAttribute=function(t,e){void 0!==t.attrs[e]&&t.attrs.pop(e)},h.XmlJSON.prototype.setAttribute=function(t,e,n){return t.attrs[e]=n,!1},h.XmlJSON.prototype.nodeCopy=function(t,e){if(!e)e={};if("object"==typeof e&&void 0===e.length)for(var n in t)"string"==typeof t[n]?e[n]=t[n]:"object"==typeof t[n]&&(void 0===t[n].length?e[n]=this.nodeCopy(t[n],{}):e[n]=this.nodeCopy(t[n],[]));else for(var r=0,i=t.length;r<i;r+=1)"string"==typeof t[r]?e[r]=t[r]:e[r]=this.nodeCopy(t[r],{});return e},h.XmlJSON.prototype.getNodesByName=function(t,e,n,r){if(!r)r=[];if(!t||!t.children)return r;e===t.name&&(n?n===t.attrs.name&&r.push(t):r.push(t));for(var i=0,o=t.children.length;i<o;i+=1)"object"==typeof t.children[i]&&this.getNodesByName(t.children[i],e,n,r);return r},h.XmlJSON.prototype.nodeNameIs=function(t,e){return void 0!==t&&e==t.name},h.XmlJSON.prototype.makeXml=function(t){return"string"==typeof t&&(t="<"===t.slice(0,1)?this.jsonStringWalker.walkToObject(t):JSON.parse(t)),t},h.XmlJSON.prototype.insertChildNodeAfter=function(t,e,n,r){for(var i=0,o=t.children.length;i<o;i+=1)if(e===t.children[i]){t.children=t.children.slice(0,i).concat([r]).concat(t.children.slice(i+1));break}return t},h.XmlJSON.prototype.insertPublisherAndPlace=function(t){if("group"===t.name){for(var e=!0,n=["publisher","publisher-place"],r=0,i=t.children.length;r<i;r+=1){var o=n.indexOf(t.children[r].attrs.variable);if(!("text"===t.children[r].name&&o>-1)||t.children[r].attrs.prefix||t.children[r].attrs.suffix){e=!1;break}n=n.slice(0,o).concat(n.slice(o+1))}e&&!n.length&&(t.attrs["has-publisher-and-publisher-place"]=!0)}for(r=0,i=t.children.length;r<i;r+=1)"object"==typeof t.children[r]&&this.insertPublisherAndPlace(t.children[r])},h.XmlJSON.prototype.isChildOfSubstitute=function(t){if(t.length>0){var e=t.slice();return"substitute"===e.pop()||this.isChildOfSubstitute(e)}return!1},h.XmlJSON.prototype.addMissingNameNodes=function(t,e){if(e||(e=[]),"names"===t.name&&!this.isChildOfSubstitute(e)){for(var n=!0,r=0,i=t.children.length;r<i;r++)if("name"===t.children[r].name){n=!1;break}n&&(t.children=[{name:"name",attrs:{},children:[]}].concat(t.children))}e.push(t.name);for(r=0,i=t.children.length;r<i;r+=1)"object"==typeof t.children[r]&&this.addMissingNameNodes(t.children[r],e);e.pop()},h.XmlJSON.prototype.addInstitutionNodes=function(t){if("names"===t.name){for(var e={},n=-1,r=0,i=t.children.length;r<i;r+=1){if("name"==t.children[r].name){for(var o in t.children[r].attrs)e[o]=t.children[r].attrs[o];e.delimiter=t.children[r].attrs.delimiter,e.and=t.children[r].attrs.and,n=r;for(var a=0,s=t.children[r].children.length;a<s;a+=1)if("family"===t.children[r].children[a].attrs.name)for(var o in t.children[r].children[a].attrs)e[o]=t.children[r].children[a].attrs[o]}if("institution"==t.children[r].name){n=-1;break}}if(n>-1){var u=this.nodeCopy(this.institution);for(r=0,i=h.INSTITUTION_KEYS.length;r<i;r+=1){var l=h.INSTITUTION_KEYS[r];void 0!==e[l]&&(u.children[0].attrs[l]=e[l]),e.delimiter&&(u.attrs.delimiter=e.delimiter),e.and&&(u.attrs.and="text")}t.children=t.children.slice(0,n+1).concat([u]).concat(t.children.slice(n+1))}}for(r=0,i=t.children.length;r<i;r+=1)"string"!=typeof t.children[r]&&this.addInstitutionNodes(t.children[r])},h.XmlJSON.prototype.flagDateMacros=function(t){for(var e=0,n=t.children.length;e<n;e+=1)"macro"===t.children[e].name&&this.inspectDateMacros(t.children[e])&&(t.children[e].attrs["macro-has-date"]="true")},h.XmlJSON.prototype.inspectDateMacros=function(t){if(!t||!t.children)return!1;if("date"===t.name)return!0;for(var e=0,n=t.children.length;e<n;e+=1)if(this.inspectDateMacros(t.children[e]))return!0;return!1},h.stripXmlProcessingInstruction=function(t){return t?t=(t=(t=(t=t.replace(/^<\?[^?]+\?>/,"")).replace(/<!--[^>]+-->/g,"")).replace(/^\s+/g,"")).replace(/\s+$/g,""):t},h.parseXml=function(t){var e={children:[]},n=[e.children];function r(t){return t.split("&amp;").join("&").split("&quot;").join('"').split("&gt;").join(">").split("&lt;").join("<").replace(/&#([0-9]{1,6});/gi,function(t,e){var n=parseInt(e,10);return String.fromCharCode(n)}).replace(/&#x([a-f0-9]{1,6});/gi,function(t,e){var n=parseInt(e,16);return String.fromCharCode(n)})}function i(t){var e=RegExp("^<([^\t />]+)"),n=t.match(e);return n?n[1]:null}function o(t){var e={};e.name=i(t),e.attrs={};var n,o,a,s,u=function(t){var e=t.match(/([^\'\"=	 ]+)=(?:\"[^\"]*\"|\'[^\']*\')/g);if(e)for(var n=0,r=e.length;n<r;n++)e[n]=e[n].replace(/=.*/,"");return e}(t);if(u)for(var l=0,c=u.length;l<c;l++){var h={name:u[l],value:(n=t,o=u[l],void 0,s=void 0,a=RegExp("^.*[\t ]+"+o+"=(\"(?:[^\"]*)\"|'(?:[^']*)').*$"),s=n.match(a),s?s[1].slice(1,-1):null)};e.attrs[h.name]=r(h.value)}return e.children=[],e}function a(t){n.slice(-1)[0].push(t)}function s(t){var e,s,u;t.slice(1).indexOf("<")>-1?((e=o(t.slice(0,t.indexOf(">")+1))).children=[(u=t,r(u.match(/^.*>([^<]*)<.*$/)[1]))],a(e)):"/>"===t.slice(-2)?(e=o(t),"term"===i(t)&&e.children.push(""),a(e)):"</"===t.slice(0,2)?n.pop():(a(e=o(t)),s=e,n.push(s.children))}for(var u=function(t){for(var e=(t=t.split(/(?:\r\n|\n|\r)/).join(" ").replace(/>[	 ]+</g,"><").replace(/<\!--.*?-->/g,"")).split("><"),n=null,r=0,i=e.length;r<i;r++)r>0&&(e[r]="<"+e[r]),r<e.length-1&&(e[r]=e[r]+">"),"number"!=typeof n&&("<style "!==e[r].slice(0,7)&&"<locale "!=e[r].slice(0,8)||(n=r));for(r=(e=e.slice(n)).length-2;r>-1;r--)if(-1===e[r].slice(1).indexOf("<")){var o=e[r].slice(0,5);"/>"!==e[r].slice(-2)&&("<term"===o?"</term"===e[r+1].slice(0,6)&&(e[r]=e[r]+e[r+1],e=e.slice(0,r+1).concat(e.slice(r+2))):["<sing","<mult"].indexOf(o)>-1&&"/>"!==e[r].slice(-2)&&"<"===e[r+1].slice(0,1)&&(e[r]=e[r]+e[r+1],e=e.slice(0,r+1).concat(e.slice(r+2))))}return e}(t),l=0,c=u.length;l<c;l++){s(u[l])}return e.children[0]},t.exports=h,h.XmlDOM=function(t){this.dataObj=t,"undefined"==typeof DOMParser?(DOMParser=function(){},DOMParser.prototype.parseFromString=function(t,e){if("undefined"!=typeof ActiveXObject)return(n=new ActiveXObject("MSXML.DomDocument")).async=!1,n.loadXML(t),n;if("undefined"!=typeof XMLHttpRequest){var n=new XMLHttpRequest;return e||(e="text/xml"),n.open("GET","data:"+e+";charset=utf-8,"+encodeURIComponent(t),!1),n.overrideMimeType&&n.overrideMimeType(e),n.send(null),n.responseXML}return"undefined"!=typeof marknote?(new marknote.Parser).parse(t):void 0},this.hasAttributes=function(t){return!(!t.attributes||!t.attributes.length)}):this.hasAttributes=function(t){return!(!t.attributes||!t.attributes.length)},this.importNode=function(t,e){if(void 0===t.importNode)var n=this._importNode(t,e,!0);else n=t.importNode(e,!0);return n},this._importNode=function(t,e,n){switch(e.nodeType){case 1:var r=t.createElement(e.nodeName);if(e.attributes&&e.attributes.length>0)for(var i=0,o=e.attributes.length;i<o;)r.setAttribute(e.attributes[i].nodeName,e.getAttribute(e.attributes[i++].nodeName));if(n&&e.childNodes&&e.childNodes.length>0)for(i=0,o=e.childNodes.length;i<o;)r.appendChild(this._importNode(t,e.childNodes[i++],n));return r}},this.parser=new DOMParser;var e=this.parser.parseFromString('<docco><institution institution-parts="long" delimiter=", " substitute-use-first="1" use-last="1"><institution-part name="long"/></institution></docco>',"text/xml"),n=e.getElementsByTagName("institution");this.institution=n.item(0);var r=e.getElementsByTagName("institution-part");this.institutionpart=r.item(0),this.ns="http://purl.org/net/xbiblio/csl"},h.XmlDOM.prototype.clean=function(t){return t=(t=(t=(t=(t=t.replace(/<\?[^?]+\?>/g,"")).replace(/<![^>]+>/g,"")).replace(/^\s+/,"")).replace(/\s+$/,"")).replace(/^\n*/,"")},h.XmlDOM.prototype.getStyleId=function(t,e){var n="",r="id";e&&(r="title");var i=t.getElementsByTagName(r);return i&&i.length&&(i=i.item(0)),i&&(n=i.textContent),n||(n=i.innerText),n||(n=i.innerHTML),n},h.XmlDOM.prototype.children=function(t){var e,n,r,i;if(t){for(i=[],n=0,r=(e=t.childNodes).length;n<r;n+=1)"#text"!=e[n].nodeName&&i.push(e[n]);return i}return[]},h.XmlDOM.prototype.nodename=function(t){return t.nodeName},h.XmlDOM.prototype.attributes=function(t){var e,n,r,i,o;if(e=new Object,t&&this.hasAttributes(t))for(i=0,o=(n=t.attributes).length;i<o;i+=1)e["@"+(r=n[i]).name]=r.value;return e},h.XmlDOM.prototype.content=function(t){return void 0!==t.textContent?t.textContent:void 0!==t.innerText?t.innerText:t.txt},h.XmlDOM.prototype.namespace={xml:"http://www.w3.org/XML/1998/namespace"},h.XmlDOM.prototype.numberofnodes=function(t){return t?t.length:0},h.XmlDOM.prototype.getAttributeName=function(t){return t.name},h.XmlDOM.prototype.getAttributeValue=function(t,e,n){var r="";return n&&(e=n+":"+e),t&&this.hasAttributes(t)&&t.getAttribute(e)&&(r=t.getAttribute(e)),r},h.XmlDOM.prototype.getNodeValue=function(t,e){var n=null;if(e){var r=t.getElementsByTagName(e);r.length>0&&(n=void 0!==r[0].textContent?r[0].textContent:void 0!==r[0].innerText?r[0].innerText:r[0].text)}return null===n&&t&&t.childNodes&&(0==t.childNodes.length||1==t.childNodes.length&&"#text"==t.firstChild.nodeName)&&(n=void 0!==t.textContent?t.textContent:void 0!==t.innerText?t.innerText:t.text),null===n&&(n=t),n},h.XmlDOM.prototype.setAttributeOnNodeIdentifiedByNameAttribute=function(t,e,n,r,i){var o,a,s,u;for("@"===r.slice(0,1)&&(r=r.slice(1)),o=0,a=(s=t.getElementsByTagName(e)).length;o<a;o+=1)(u=s[o]).getAttribute("name")==n&&u.setAttribute(r,i)},h.XmlDOM.prototype.deleteNodeByNameAttribute=function(t,e){var n,r,i,o;for(n=0,r=(o=t.childNodes).length;n<r;n+=1)(i=o[n])&&i.nodeType!=i.TEXT_NODE&&this.hasAttributes(i)&&i.getAttribute("name")==e&&t.removeChild(o[n])},h.XmlDOM.prototype.deleteAttribute=function(t,e){t.removeAttribute(e)},h.XmlDOM.prototype.setAttribute=function(t,e,n){return t.ownerDocument||(t=t.firstChild),["function","unknown"].indexOf(typeof t.setAttribute)>-1&&t.setAttribute(e,n),!1},h.XmlDOM.prototype.nodeCopy=function(t){return t.cloneNode(!0)},h.XmlDOM.prototype.getNodesByName=function(t,e,n){var r,i,o,a,s;for(r=[],a=0,s=(i=t.getElementsByTagName(e)).length;a<s;a+=1)o=i.item(a),(!n||this.hasAttributes(o)&&o.getAttribute("name")==n)&&r.push(o);return r},h.XmlDOM.prototype.nodeNameIs=function(t,e){return e==t.nodeName},h.XmlDOM.prototype.makeXml=function(t){return t||(t="<docco><bogus/></docco>"),t=t.replace(/\s*<\?[^>]*\?>\s*\n*/g,""),this.parser.parseFromString(t,"application/xml").firstChild},h.XmlDOM.prototype.insertChildNodeAfter=function(t,e,n,r){var i;return i=this.importNode(e.ownerDocument,r),t.replaceChild(i,e),t},h.XmlDOM.prototype.insertPublisherAndPlace=function(t){for(var e=t.getElementsByTagName("group"),n=0,r=e.length;n<r;n+=1){for(var i=e.item(n),o=[],a=0,s=i.childNodes.length;a<s;a+=1)1!==i.childNodes.item(a).nodeType&&o.push(a);if(i.childNodes.length-o.length==2){var u=[];for(a=0,s=2;a<s;a+=1)if(!(o.indexOf(a)>-1)){for(var l=i.childNodes.item(a),c=[],h=0,p=l.childNodes.length;h<p;h+=1)1!==l.childNodes.item(h).nodeType&&c.push(h);if(l.childNodes.length-c.length==0&&(u.push(l.getAttribute("variable")),l.getAttribute("suffix")||l.getAttribute("prefix"))){u=[];break}}u.indexOf("publisher")>-1&&u.indexOf("publisher-place")>-1&&i.setAttribute("has-publisher-and-publisher-place",!0)}}},h.XmlDOM.prototype.isChildOfSubstitute=function(t){return!!t.parentNode&&("substitute"===t.parentNode.tagName.toLowerCase()||this.isChildOfSubstitute(t.parentNode))},h.XmlDOM.prototype.addMissingNameNodes=function(t){for(var e=t.getElementsByTagName("names"),n=0,r=e.length;n<r;n+=1){var i=e.item(n),o=i.getElementsByTagName("name");if(!(o&&0!==o.length||this.isChildOfSubstitute(i))){var a=i.ownerDocument.createElement("name");i.appendChild(a)}}},h.XmlDOM.prototype.addInstitutionNodes=function(t){var e,n,r,i,o,a,s;for(a=0,s=(e=t.getElementsByTagName("names")).length;a<s;a+=1)if(0!=(i=(n=e.item(a)).getElementsByTagName("name")).length&&0==n.getElementsByTagName("institution").length){r=this.importNode(t.ownerDocument,this.institution),theinstitutionpart=r.getElementsByTagName("institution-part").item(0),o=i.item(0),n.insertBefore(r,o.nextSibling);for(var u=0,l=h.INSTITUTION_KEYS.length;u<l;u+=1){var c=h.INSTITUTION_KEYS[u];(m=o.getAttribute(c))&&theinstitutionpart.setAttribute(c,m)}var p=o.getElementsByTagName("name-part");for(u=0,l=p.length;u<l;u+=1)if("family"===p[u].getAttribute("name"))for(var f=0,d=h.INSTITUTION_KEYS.length;f<d;f+=1){var m;c=h.INSTITUTION_KEYS[f];(m=p[u].getAttribute(c))&&theinstitutionpart.setAttribute(c,m)}}},h.XmlDOM.prototype.flagDateMacros=function(t){var e,n,r;for(nodes=t.getElementsByTagName("macro"),e=0,n=nodes.length;e<n;e+=1)(r=nodes.item(e)).getElementsByTagName("date").length&&r.setAttribute("macro-has-date","true")},t.exports=h,t.exports=h,h.setupXml=function(t){var e={},n=null;if(void 0!==t?"string"==typeof t?(e="<"===(t=t.replace("^\ufeff","").replace(/^\s+/,"")).slice(0,1)?h.parseXml(t):JSON.parse(t),n=new h.XmlJSON(e)):n=void 0!==t.getAttribute?new h.XmlDOM(t):void 0!==t.toXMLString?new h.XmlE4X(t):new h.XmlJSON(t):h.error("unable to parse XML input"),!n)throw"citeproc-js error: unable to parse CSL style or locale object";return n},t.exports=h,h.getSortCompare=function(t){if(h.stringCompare)return h.stringCompare;var e,n={sensitivity:"base",ignorePunctuation:!0,numeric:!0};t||(t="en-US");var r=function(t){return t.replace(/^[\[\]\'\"]*/g,"")},i=!!(e=function(e,r){return e.toLocaleLowerCase().localeCompare(r.toLocaleLowerCase(),t,n)})("[x","x")&&function(t,n){return e(r(t),r(n))};return function(t,n){return i?i(t,n):e(t,n)}},t.exports=h,h.ambigConfigDiff=function(t,e){var n,r,i,o;if(t.names.length!==e.names.length)return 1;for(n=0,r=t.names.length;n<r;n+=1){if(t.names[n]!==e.names[n])return 1;for(i=0,o=t.givens[n];i<o;i+=1)if(t.givens[n][i]!==e.givens[n][i])return 1}return t.disambiguate!=e.disambiguate?1:t.year_suffix!==e.year_suffix?1:0},h.cloneAmbigConfig=function(t,e,n){var r,i,o,a,s,u={};for(u.names=[],u.givens=[],u.year_suffix=!1,u.disambiguate=!1,r=0,i=t.names.length;r<i;r+=1)s=t.names[r],u.names[r]=s;for(r=0,i=t.givens.length;r<i;r+=1){for(s=[],o=0,a=t.givens[r].length;o<a;o+=1)s.push(t.givens[r][o]);u.givens.push(s)}return e?(u.year_suffix=e.year_suffix,u.disambiguate=e.disambiguate):(u.year_suffix=t.year_suffix,u.disambiguate=t.disambiguate),u},h.getAmbigConfig=function(){var t;return(t=this.tmp.disambig_request)||(t=this.tmp.disambig_settings),h.cloneAmbigConfig(t)},h.getMaxVals=function(){return this.tmp.names_max.mystack.slice()},h.getMinVal=function(){return this.tmp["et-al-min"]},t.exports=h,h.tokenExec=function(t,e,n){var r,i;r=t.next,i=!1;t.test&&(r=function(e){return e?(this.tmp.jump.replace("succeed"),t.succeed):(this.tmp.jump.replace("fail"),t.fail)}.call(this,t.test(e,n)));for(var o=0,a=t.execs.length;o<a;o++)(i=t.execs[o].call(t,this,e,n))&&(r=i);return r},h.expandMacro=function(t,e){var n,r,i;n=t.postponed_macro,t=new h.Token("group",h.START);var o=!1,a=!1;if((r=this.cslXml.getNodesByName(this.cslXml.dataObj,"macro",n)).length&&(a=this.cslXml.getAttributeValue(r[0],"cslid"),o=this.cslXml.getAttributeValue(r[0],"macro-has-date")),o&&(n=n+"@"+this.build.current_default_locale,l=function(t,e){t.tmp.extension&&(t.tmp["doing-macro-with-date"]=!0)},t.execs.push(l)),this.build.macro_stack.indexOf(n)>-1)throw'CSL processor error: call to macro "'+n+'" would cause an infinite loop';if(this.build.macro_stack.push(n),t.cslid=a,h.MODULE_MACROS[n]&&(t.juris=n,this.opt.update_mode=h.POSITION),h.Node.group.build.call(t,this,e,!0),!this.cslXml.getNodeValue(r))throw'CSL style error: undefined macro "'+n+'"';var s,u=h.getMacroTarget.call(this,n);if(u&&(h.buildMacro.call(this,u,r),h.configureMacro.call(this,u)),!this.build.extension){var l=(s=n,function(t,e,n){for(var r=0;r<t.macros[s].length;)r=h.tokenExec.call(t,t.macros[s][r],e,n)}),c=new h.Token("text",h.SINGLETON);c.execs.push(l),e.push(c)}i=new h.Token("group",h.END),o&&(l=function(t,e){t.tmp.extension&&(t.tmp["doing-macro-with-date"]=!1)},i.execs.push(l)),t.juris&&(i.juris=n),h.Node.group.build.call(i,this,e,!0),this.build.macro_stack.pop()},h.getMacroTarget=function(t){var e=!1;return this.build.extension?e=this[this.build.root+this.build.extension].tokens:this.macros[t]||(e=[],this.macros[t]=e),e},h.buildMacro=function(t,e){h.makeBuilder(this,t)(void 0===e.length?e:e[0])},h.configureMacro=function(t){this.build.extension||this.configureTokenList(t)},h.XmlToToken=function(t,e,n){var r,i,o,a,s,u;if(r=t.cslXml.nodename(this),!t.build.skip||t.build.skip===r)if(r){if(!h.Node[t.cslXml.nodename(this)])throw'Undefined node name "'+r+'".';if([],o=t.cslXml.attributes(this),a=h.setDecorations.call(this,t,o),s=new h.Token(r,e),e!==h.END||"if"===r||"else-if"===r||"layout"===r){for(var l in o)if(o.hasOwnProperty(l)){if(e===h.END&&"@language"!==l&&"@locale"!==l)continue;if(o.hasOwnProperty(l))if(h.Attributes[l])try{h.Attributes[l].call(s,t,""+o[l])}catch(t){throw h.error(t),"CSL processor error, "+l+" attribute: "+t}else h.debug('warning: undefined attribute "'+l+'" in style')}s.decorations=a}else e===h.END&&o["@variable"]&&(s.hasVariable=!0,h.DATE_VARIABLES.indexOf(o["@variable"])>-1&&(s.variables=o["@variable"].split(/\s+/)));u=n||t[t.build.area].tokens,h.Node[r].build.call(s,t,u,!0)}else(i=t.cslXml.content(this))&&(t.build.text=i)},t.exports=h,h.DateParser=new function(){for(var t=[["明治",1867],["大正",1911],["昭和",1925],["平成",1988]],e={},n=0,r=t.length;n<r;n++){var i=t[n][0],o=t[n][1];e[i]=o}var a=[];for(n=0,r=t.length;n<r;n++){o=t[n][0];a.push(o)}var s=a.join("|"),u=new RegExp("(?:"+s+")(?:[0-9]+)"),l=new RegExp("(?:"+s+")(?:[0-9]+)","g"),c=/(\u6708|\u5E74)/g,p=/\u65E5/g,f=/\u301c/g,d="([?0-9]{4}(?:%%NUMD%%[?0-9]{1,2}){0,2}(?![0-9])|(?:[?0-9]{1,2}%%NUMD%%){0,2}[?0-9]{4}(?![0-9])|[?0-9]{1,3}|[%%DATED%%]|[?~]|[^-/~?0-9]+)",m=new RegExp(d.replace(/%%NUMD%%/g,"-").replace(/%%DATED%%/g,"-")),g=new RegExp(d.replace(/%%NUMD%%/g,"-").replace(/%%DATED%%/g,"/")),v=new RegExp(d.replace(/%%NUMD%%/g,"/").replace(/%%DATED%%/g,"-"));this.monthStrings="january february march april may june july august september october november december spring summer fall winter spring summer".split(" "),this.setOrderDayMonth=function(){this.monthGuess=1,this.dayGuess=0},this.setOrderMonthDay=function(){this.monthGuess=0,this.dayGuess=1},this.resetDateParserMonths=function(){this.monthSets=[];for(var t=0,e=this.monthStrings.length;t<e;t++)this.monthSets.push([this.monthStrings[t]]);this.monthAbbrevs=[];for(t=0,e=this.monthSets.length;t<e;t++){this.monthAbbrevs.push([]);for(var n=0,r=this.monthSets[t].length;n<r;n++)this.monthAbbrevs[t].push(this.monthSets[t][0].slice(0,3))}this.monthRexes=[];for(t=0,e=this.monthAbbrevs.length;t<e;t++)this.monthRexes.push(new RegExp("(?:"+this.monthAbbrevs[t].join("|")+")"))},this.addDateParserMonths=function(t){if("string"==typeof t&&(t=t.split(/\s+/)),12===t.length||16===t.length){for(var e=0,n=t.length;e<n;e++){for(var r=null,i=!1,o=3,a={},s=0,u=this.monthAbbrevs.length;s<u;s++){if(a[s]={},s===e){for(var l=0,c=this.monthAbbrevs[e].length;l<c;l++)if(this.monthAbbrevs[e][l]===t[e].slice(0,this.monthAbbrevs[e][l].length)){i=!0;break}}else for(l=0,c=this.monthAbbrevs[s].length;l<c;l++)if(r=this.monthAbbrevs[s][l].length,this.monthAbbrevs[s][l]===t[e].slice(0,r)){for(;this.monthSets[s][l].slice(0,r)===t[e].slice(0,r);){if(r>t[e].length||r>this.monthSets[s][l].length){h.debug("unable to disambiguate month string in date parser: "+t[e]);break}r+=1}o=r,a[s][l]=r}for(var p in a)for(kKey in a[p])r=a[p][kKey],p=parseInt(p,10),kKey=parseInt(kKey,10),this.monthAbbrevs[p][kKey]=this.monthSets[p][kKey].slice(0,r)}i||(this.monthSets[e].push(t[e]),this.monthAbbrevs[e].push(t[e].slice(0,o)))}this.monthRexes=[],this.monthRexStrs=[];for(e=0,n=this.monthAbbrevs.length;e<n;e++)this.monthRexes.push(new RegExp("^(?:"+this.monthAbbrevs[e].join("|")+")")),this.monthRexStrs.push("^(?:"+this.monthAbbrevs[e].join("|")+")");if(18===this.monthAbbrevs.length)for(e=12,n=14;e<n;e++)this.monthRexes[e+4]=new RegExp("^(?:"+this.monthAbbrevs[e].join("|")+")"),this.monthRexStrs[e+4]="^(?:"+this.monthAbbrevs[e].join("|")+")"}else h.debug("month [+season] list of "+t.length+", expected 12 or 16. Ignoring.")},this.convertDateObjectToArray=function(t){t["date-parts"]=[],t["date-parts"].push([]);for(var e=0,n=0,r=3;n<r;n++){var i=["year","month","day"][n];if(!t[i])break;e+=1,t["date-parts"][0].push(t[i]),delete t[i]}t["date-parts"].push([]);for(n=0,r=e;n<r&&t[i=["year_end","month_end","day_end"][n]];n++)t["date-parts"][1].push(t[i]),delete t[i];return t["date-parts"][0].length!==t["date-parts"][1].length&&t["date-parts"].pop(),t},this.convertDateObjectToString=function(t){for(var e=[],n=0;n<3&&t[DATE_PARTS_ALL[n]];n+=1)e.push(t[DATE_PARTS_ALL[n]]);return e.join("-")},this._parseNumericDate=function(t,e,n,r){n||(n="");for(var i=r.split(e),o=0,a=i.length;o<a;o++)if(4===i[o].length){t["year"+n]=i[o].replace(/^0*/,""),i=o?i.slice(0,o):i.slice(1);break}for(o=0,a=i.length;o<a;o++)i[o]=parseInt(i[o],10);1===i.length||2===i.length&&!i[1]?t["month"+n]=""+i[0]:2===i.length&&(i[this.monthGuess]>12?(t["month"+n]=""+i[this.dayGuess],t["day"+n]=""+i[this.monthGuess]):(t["month"+n]=""+i[this.monthGuess],t["day"+n]=""+i[this.dayGuess]))},this.parseDateToObject=function(t){var e,n=t,r=-1,i=-1,o=!1;if(t){if("-"===t.slice(0,1)&&(o=!0,t=t.slice(1)),t.match(/^[0-9]{1,3}$/))for(;t.length<4;)t="0"+t;if(A=(t=(t=""+t).replace(/\s*[0-9]{2}:[0-9]{2}(?::[0-9]+)/,"")).match(c)){var a=(t=(t=(t=(t=(t=(t=t.replace(/\s+/g,"")).replace(p,"")).replace(c,"-")).replace(f,"/")).replace(/\-\//g,"/")).replace(/-$/g,"")).split(u);e=[];var s=t.match(l);if(s){for(var d=[],y=0,b=s.length;y<b;y++)d=d.concat(s[y].match(/([^0-9]+)([0-9]+)/).slice(1));for(y=0,b=a.length;y<b;y++)if(e.push(a[y]),y!==len-1){var _=2*pos;e.push(d[_]),e.push(d[_+1])}}else e=a;for(y=1,b=e.length;y<b;y+=3)e[y+1]=jiy[e[y]]+parseInt(e[y+1],10),e[y]="";r=(t=(t=(t=(t=e.join("")).replace(/\s*-\s*$/,"").replace(/\s*-\s*\//,"/")).replace(/\.\s*$/,"")).replace(/\.(?! )/,"")).indexOf("/"),i=t.indexOf("-")}}var x,w,E="",S="",T={};if('"'===(t=t.replace(/([A-Za-z])\./g,"$1")).slice(0,1)&&'"'===t.slice(-1))return T.literal=t.slice(1,-1),T;r>-1&&i>-1?t.split("/").length>3?(x="-",w="/",e=(t=t.replace(/\_/g,"-")).split(v)):(x="/",w="-",e=(t=t.replace(/\_/g,"/")).split(g)):(x="-",w="-",e=(t=(t=t.replace(/\//g,"-")).replace(/\_/g,"-")).split(m));var O=[];for(y=0,b=e.length;y<b;y++){var A;(A=e[y].match(/^\s*([\-\/]|[^\-\/\~\?0-9]+|[\-~?0-9]+)\s*$/))&&O.push(A[1])}var M=O.indexOf(x),C=[],k=!1;M>-1?(C.push([0,M]),C.push([M+1,O.length]),k=!0):C.push([0,O.length]);var P="";for(y=0,b=C.length;y<b;y++){var R=C[y],L=O.slice(R[0],R[1]);t:for(var I=0,D=L.length;I<D;I++){var N=L[I];if(N.indexOf(w)>-1)this._parseNumericDate(T,w,P,N);else if(N.match(/[0-9]{4}/))T["year"+P]=N.replace(/^0*/,"");else{for(var j=0,U=this.monthRexes.length;j<U;j++)if(N.toLocaleLowerCase().match(this.monthRexes[j])){T["month"+P]=""+(parseInt(j,10)+1);continue t}N.match(/^[0-9]+$/)&&(E=N),N.toLocaleLowerCase().match(/^bc/)&&E?(T["year"+P]=""+-1*E,E=""):N.toLocaleLowerCase().match(/^ad/)&&E?(T["year"+P]=""+E,E=""):"~"===N||"?"===N||"c"===N||N.match(/^cir/)?T.circa="1":!N.toLocaleLowerCase().match(/(?:mic|tri|hil|eas)/)||T["season"+P]||(S=N)}}E&&(T["day"+P]=E,E=""),S&&!T["season"+P]&&(T["season"+P]=S,S=""),P="_end"}if(k)for(I=0,D=h.DATE_PARTS_ALL.length;I<D;I++){var F=h.DATE_PARTS_ALL[I];T[F]&&!T[F+"_end"]?T[F+"_end"]=T[F]:!T[F]&&T[F+"_end"]&&(T[F]=T[F+"_end"])}(!T.year||T.year&&T.day&&!T.month)&&(T={literal:n});var B=["year","month","day","year_end","month_end","day_end"];for(y=0,b=B.length;y<b;y++){var z=B[y];"string"==typeof T[z]&&T[z].match(/^[0-9]+$/)&&(T[z]=parseInt(T[z],10))}return o&&Object.keys(T).indexOf("year")>-1&&(T.year=-1*T.year),T},this.parseDateToArray=function(t){return this.convertDateObjectToArray(this.parseDateToObject(t))},this.parseDateToString=function(t){return this.convertDateObjectToString(this.parseDateToObject(t))},this.parse=function(t){return this.parseDateToObject(t)},this.setOrderMonthDay(),this.resetDateParserMonths()},t.exports=h,h.Engine=function(t,e,n,r){var i,o;this.processor_version=h.PROCESSOR_VERSION,this.csl_version="1.0",this.sys=t,t.variableWrapper&&(h.VARIABLE_WRAPPER_PREPUNCT_REX=new RegExp("^(["+[" "].concat(h.SWAPPING_PUNCTUATION).join("")+"]*)(.*)")),h.retrieveStyleModule&&(this.sys.retrieveStyleModule=h.retrieveStyleModule),h.getAbbreviation&&(this.sys.getAbbreviation=h.getAbbreviation),this.sys.stringCompare&&(h.stringCompare=this.sys.stringCompare),this.sys.AbbreviationSegments=h.AbbreviationSegments,this.parallel=new h.Parallel(this),this.transform=new h.Transform(this),this.setParseNames=function(t){this.opt["parse-names"]=t},this.opt=new h.Engine.Opt,this.tmp=new h.Engine.Tmp,this.build=new h.Engine.Build,this.fun=new h.Engine.Fun(this),this.configure=new h.Engine.Configure,this.citation_sort=new h.Engine.CitationSort,this.bibliography_sort=new h.Engine.BibliographySort,this.citation=new h.Engine.Citation(this),this.bibliography=new h.Engine.Bibliography,this.output=new h.Output.Queue(this),this.dateput=new h.Output.Queue(this),this.cslXml=h.setupXml(e),(this.opt.development_extensions.csl_reverse_lookup_support||this.sys.csl_reverse_lookup_support)&&(this.build.cslNodeId=0,this.setCslNodeIds=function(t,e){var n=this.cslXml.children(t);this.cslXml.setAttribute(t,"cslid",this.build.cslNodeId),this.opt.nodenames.push(e),this.build.cslNodeId+=1;for(var r=0,i=this.cslXml.numberofnodes(n);r<i;r+=1)(e=this.cslXml.nodename(n[r]))&&this.setCslNodeIds(n[r],e)},this.setCslNodeIds(this.cslXml.dataObj,"style")),this.cslXml.addMissingNameNodes(this.cslXml.dataObj),this.cslXml.addInstitutionNodes(this.cslXml.dataObj),this.cslXml.insertPublisherAndPlace(this.cslXml.dataObj),this.cslXml.flagDateMacros(this.cslXml.dataObj),void 0===this.cslXml.attributes(this.cslXml.dataObj)["@sort-separator"]&&this.cslXml.setAttribute(this.cslXml.dataObj,"sort-separator",", "),this.opt["initialize-with-hyphen"]=!0,this.setStyleAttributes(),this.opt.xclass=this.cslXml.getAttributeValue(this.cslXml.dataObj,"class"),this.opt.class=this.opt.xclass,this.opt.styleID=this.cslXml.getStyleId(this.cslXml.dataObj),h.setSuppressedJurisdictions&&h.setSuppressedJurisdictions(this.opt.styleID,this.opt.suppressedJurisdictions),this.opt.styleName=this.cslXml.getStyleId(this.cslXml.dataObj,!0),"1.1m"===this.opt.version.slice(0,4)&&(this.opt.development_extensions.static_statute_locator=!0,this.opt.development_extensions.handle_parallel_articles=!0,this.opt.development_extensions.main_title_from_short_title=!0,this.opt.development_extensions.rtl_support=!0,this.opt.development_extensions.expect_and_symbol_form=!0,this.opt.development_extensions.require_explicit_legal_case_title_short=!0,this.opt.development_extensions.force_jurisdiction=!0),n&&(n=n.replace("_","-"),n=h.normalizeLocaleStr(n)),this.opt["default-locale"][0]&&(this.opt["default-locale"][0]=this.opt["default-locale"][0].replace("_","-"),this.opt["default-locale"][0]=h.normalizeLocaleStr(this.opt["default-locale"][0])),n&&r&&(this.opt["default-locale"]=[n]),n&&!r&&this.opt["default-locale"][0]&&(n=this.opt["default-locale"][0]),0===this.opt["default-locale"].length&&(n||(n="en-US"),this.opt["default-locale"].push("en-US")),n||(n=this.opt["default-locale"][0]),i=h.localeResolve(n),this.opt.lang=i.best,this.opt["default-locale"][0]=i.best,this.locale={},this.opt["default-locale-sort"]||(this.opt["default-locale-sort"]=this.opt["default-locale"][0]),"dale|".localeCompare("daleb",this.opt["default-locale-sort"])>-1?this.opt.sort_sep="@":this.opt.sort_sep="|",this.localeConfigure(i),this.locale[this.opt.lang].opts["skip-words-regexp"]=(o=(o=this.locale[this.opt.lang].opts["skip-words"]).slice(),new RegExp("(?:(?:[?!:]*\\s+|-|^)(?:"+o.join("|")+")(?=[!?:]*\\s+|-|$))","g")),this.output.adjust=new h.Output.Queue.adjust(this.getOpt("punctuation-in-quote")),this.registry=new h.Registry(this),this.macros={},this.build.area="citation";var a=this.cslXml.getNodesByName(this.cslXml.dataObj,this.build.area);this.buildTokenLists(a,this[this.build.area].tokens),this.build.area="bibliography";a=this.cslXml.getNodesByName(this.cslXml.dataObj,this.build.area);this.buildTokenLists(a,this[this.build.area].tokens),this.juris={},this.configureTokenLists(),this.disambiguate=new h.Disambiguation(this),this.splice_delimiter=!1,this.fun.dateparser=h.DateParser,this.fun.flipflopper=new h.Util.FlipFlopper(this),this.setCloseQuotesArray(),this.fun.ordinalizer.init(this),this.fun.long_ordinalizer.init(this),this.fun.page_mangler=h.Util.PageRangeMangler.getFunction(this,"page"),this.fun.year_mangler=h.Util.PageRangeMangler.getFunction(this,"year"),this.setOutputFormat("html")},h.Engine.prototype.setCloseQuotesArray=function(){var t;(t=[]).push(this.getTerm("close-quote")),t.push(this.getTerm("close-inner-quote")),t.push('"'),t.push("'"),this.opt.close_quotes_array=t},h.makeBuilder=function(t,e){function n(n){h.XmlToToken.call(n,t,h.START,e)}function r(n){h.XmlToToken.call(n,t,h.END,e)}function i(n){h.XmlToToken.call(n,t,h.SINGLETON,e)}return function e(o){var a;if(t.cslXml.numberofnodes(t.cslXml.children(o))){n(a=o);for(var s=0;s<t.cslXml.numberofnodes(t.cslXml.children(a));s+=1)o=t.cslXml.children(a)[s],null!==t.cslXml.nodename(o)&&("date"===t.cslXml.nodename(o)&&(h.Util.fixDateNode.call(t,a,s,o),o=t.cslXml.children(a)[s]),e(o));r(a)}else i(o)}},h.Engine.prototype.buildTokenLists=function(t,e){this.cslXml.getNodeValue(t)&&h.makeBuilder(this,e)(void 0===t.length?t:t[0])},h.Engine.prototype.setStyleAttributes=function(){var t,e,n;(n={}).name=this.cslXml.nodename(this.cslXml.dataObj),t=this.cslXml.attributes(this.cslXml.dataObj);for(e in t)t.hasOwnProperty(e)&&h.Attributes[e].call(n,this,t[e])},h.Engine.prototype.getTerm=function(t,e,n,r,i,o){var a;t&&t.match(/[A-Z]/)&&t===t.toUpperCase()&&(h.debug("Warning: term key is in uppercase form: "+t),t=t.toLowerCase()),a=o?this.opt["default-locale"][0]:this.opt.lang;var s=h.Engine.getField(h.LOOSE,this.locale[a].terms,t,e,n,r);if(s||"range-delimiter"!==t||(s="–"),void 0===s){if(i===h.STRICT)throw'Error in getTerm: term "'+t+'" does not exist.';i===h.TOLERANT&&(s="")}return s&&(this.tmp.cite_renders_content=!0),s},h.Engine.prototype.getDate=function(t,e){var n;return n=e?this.opt["default-locale"]:this.opt.lang,!!this.locale[n].dates[t]&&this.locale[n].dates[t]},h.Engine.prototype.getOpt=function(t){return void 0!==this.locale[this.opt.lang].opts[t]&&this.locale[this.opt.lang].opts[t]},h.Engine.prototype.getVariable=function(t,e,n,r){return h.Engine.getField(h.LOOSE,t,e,n,r)},h.Engine.prototype.getDateNum=function(t,e){return void 0===t?0:t[e]},h.Engine.getField=function(t,e,n,r,i,o){var a,s,u,l,c,p;if(a="",void 0!==e[n]){for(p=o&&e[n][o]?e[n][o]:e[n],s=[],"symbol"===r?s=["symbol","short"]:"verb-short"===r?s=["verb-short","verb"]:"long"!==r&&(s=[r]),c=(s=s.concat(["long"])).length,l=0;l<c;l+=1)if(u=s[l],"string"==typeof p||"number"==typeof p)a=p;else if(void 0!==p[u]){a="string"==typeof p[u]||"number"==typeof p[u]?p[u]:"number"==typeof i?p[u][i]:p[u][0];break}return a}if(t===h.STRICT)throw'Error in getField: term "'+n+'" does not exist.'},h.Engine.prototype.configureTokenLists=function(){var t,e;for(e=h.AREAS.length,t=0;t<e;t+=1){var n=this[h.AREAS[t]].tokens;this.configureTokenList(n)}return this.version=h.version,this.state},h.Engine.prototype.configureTokenList=function(t){var e,n,r,i,o,a;for(e=["year","month","day"],i=t.length-1;i>-1;i+=-1){if("date"===(n=t[i]).name&&h.END===n.tokentype&&(r=[]),"date-part"===n.name&&n.strings.name)for(a=e.length,o=0;o<a;o+=1)e[o]===n.strings.name&&r.push(n.strings.name);"date"===n.name&&h.START===n.tokentype&&(r.reverse(),n.dateparts=r),n.next=i+1,n.name&&h.Node[n.name].configure&&h.Node[n.name].configure.call(n,this,i)}},h.Engine.prototype.retrieveItems=function(t){var e;e=[];for(var n=0,r=t.length;n<r;n+=1)e.push(this.retrieveItem(""+t[n]));return e},h.ITERATION=0,h.Engine.prototype.retrieveItem=function(t){var e,n;if(this.tmp.loadedItemIDs[t])return this.registry.refhash[t];if(this.tmp.loadedItemIDs[t]=!0,this.opt.development_extensions.normalize_lang_keys_to_lowercase&&"boolean"==typeof this.opt.development_extensions.normalize_lang_keys_to_lowercase){for(var r=0,i=this.opt["default-locale"].length;r<i;r+=1)this.opt["default-locale"][r]=this.opt["default-locale"][r].toLowerCase();for(r=0,i=this.opt["locale-translit"].length;r<i;r+=1)this.opt["locale-translit"][r]=this.opt["locale-translit"][r].toLowerCase();for(r=0,i=this.opt["locale-translat"].length;r<i;r+=1)this.opt["locale-translat"][r]=this.opt["locale-translat"][r].toLowerCase();this.opt.development_extensions.normalize_lang_keys_to_lowercase=100}if(h.ITERATION+=1,e=JSON.parse(JSON.stringify(this.sys.retrieveItem(""+t))),this.opt.development_extensions.normalize_lang_keys_to_lowercase){if(e.multi){if(e.multi._keys)for(var o in e.multi._keys)for(var a in e.multi._keys[o])a!==a.toLowerCase()&&(e.multi._keys[o][a.toLowerCase()]=e.multi._keys[o][a],delete e.multi._keys[o][a]);if(e.multi.main)for(var o in e.multi.main)e.multi.main[o]=e.multi.main[o].toLowerCase()}for(r=0,i=h.CREATORS.length;r>i;r+=1){var s=h.CREATORS[r];if(e[s]&&e[s].multi)for(var u=0,l=e[s].length;u<l;u+=1){var c=e[s][u];if(c.multi){if(c.multi._key)for(var a in c.multi._key)a!==a.toLowerCase()&&(c.multi._key[a.toLowerCase()]=c.multi._key[a],delete c.multi._key[a]);c.multi.main&&(c.multi.main=c.multi.main.toLowerCase())}}}}if(this.sys.getLanguageName&&e.language&&e.language){e.language=e.language.toLowerCase();var p=e.language.split("<");if(p.length>0){var f=this.sys.getLanguageName(p[0]);f&&(e["language-name"]=f)}if(2===p.length){var d=this.sys.getLanguageName(p[1]);d&&(e["language-name-original"]=d)}}e.page&&(e["page-first"]=e.page,"\\"!==(n=(""+e.page).split(/\s*(?:&|, |-|\u2013)\s*/))[0].slice(-1)&&(e["page-first"]=n[0]));this.opt.development_extensions.field_hack&&e.note&&h.parseNoteFieldHacks(e,!1,this.opt.development_extensions.allow_field_hack_date_override);for(r=1,i=h.DATE_VARIABLES.length;r<i;r+=1){var m=e[h.DATE_VARIABLES[r]];m&&(this.opt.development_extensions.raw_date_parsing&&m.raw&&(m=this.fun.dateparser.parseDateToObject(m.raw)),e[h.DATE_VARIABLES[r]]=this.dateParseArray(m))}if(this.opt.development_extensions.static_statute_locator&&e.type&&["bill","gazette","legislation","regulation","treaty"].indexOf(e.type)>-1){var g,v=["type","title","jurisdiction","genre","volume","container-title"],y=[];for(r=0,i=v.length;r<i;r+=1)e[g=v[r]]&&y.push(e[g]);for(r=0,(v=["original-date","issued"]).length;r<i;r+=1)if(e[g=v[r]]&&e[g].year){var b=e[g].year;y.push(b);break}e.legislation_id=y.join("::")}this.opt.development_extensions.force_jurisdiction&&"string"==typeof e.authority&&(e.authority=[{literal:e.authority}]),e["title-short"]||(e["title-short"]=e.shortTitle),this.opt.development_extensions.main_title_from_short_title&&h.extractTitleAndSubtitle(e);var _=["bill","legal_case","legislation","gazette","regulation"].indexOf(e.type)>-1;if(this.opt.development_extensions.force_jurisdiction&&_&&(e.jurisdiction||(e.jurisdiction="us")),!_&&e.title&&this.sys.getAbbreviation){e.jurisdiction||!0;var x=this.transform.loadAbbreviation(e.jurisdiction,"title",e.title,e.type,!0);this.transform.abbrevs[x].title&&this.transform.abbrevs[x].title[e.title]&&(e["title-short"]=this.transform.abbrevs[x].title[e.title])}if(e["container-title-short"]||(e["container-title-short"]=e.journalAbbreviation),e["container-title"]&&this.sys.getAbbreviation){x=this.transform.loadAbbreviation(e.jurisdiction,"container-title",e["container-title"]);this.transform.abbrevs[x]["container-title"]&&this.transform.abbrevs[x]["container-title"][e["container-title"]]&&(e["container-title-short"]=this.transform.abbrevs[x]["container-title"][e["container-title"]])}return this.registry.refhash[t]=e,e},h.Engine.prototype.setOpt=function(t,e,n){"style"===t.name||"cslstyle"===t.name?(this.opt.inheritedAttributes[e]=n,this.citation.opt.inheritedAttributes[e]=n,this.bibliography.opt.inheritedAttributes[e]=n):["citation","bibliography"].indexOf(t.name)>-1?this[t.name].opt.inheritedAttributes[e]=n:t.strings[e]=n},h.Engine.prototype.inheritOpt=function(t,e,n,r){if(void 0!==t.strings[e])return t.strings[e];var i=this[this.tmp.root].opt.inheritedAttributes[n||e];return void 0!==i?i:r},t.exports=h,h.Engine.prototype.remapSectionVariable=function(t){for(var e=0,n=t.length;e<n;e+=1){var r=t[e][0],i=t[e][1];if(["bill","gazette","legislation","regulation","treaty"].indexOf(r.type)>-1){if(i.locator)i.locator=i.locator.trim(),(a=i.locator.match(h.STATUTE_SUBDIV_PLAIN_REGEX))||(i.label?i.locator=h.STATUTE_SUBDIV_STRINGS_REVERSE[i.label]+" "+i.locator:i.locator="p. "+i.locator);var o=null;if(r.section)r.section=r.section.trim(),(a=r.section.match(h.STATUTE_SUBDIV_PLAIN_REGEX))?o=a[0].trim():(r.section="sec. "+r.section,o="sec.");if(r.section)if(i.locator){var a,s=" ";(a=i.locator.match(/^([^ ]*)\s*(.*)/))?("p."===a[1]&&"p."!==o&&(i.locator=a[2]),["[","(",".",",",";",":","?"].indexOf(i.locator.slice(0,1))>-1&&(s="")):s="",i.locator=r.section+s+i.locator}else i.locator=r.section;i.label=""}}},h.Engine.prototype.setNumberLabels=function(t){if(t.number&&["bill","gazette","legislation","regulation","treaty"].indexOf(t.type)>-1&&this.opt.development_extensions.static_statute_locator&&!this.tmp.shadow_numbers.number){this.tmp.shadow_numbers.number={},this.tmp.shadow_numbers.number.values=[],this.tmp.shadow_numbers.number.plural=0,this.tmp.shadow_numbers.number.numeric=!1,this.tmp.shadow_numbers.number.label=!1;var e=""+t.number,n=(e=e.split("\\").join("")).split(/\s+/)[0],r=h.STATUTE_SUBDIV_STRINGS[n];if(r){var i=e.match(h.STATUTE_SUBDIV_GROUPED_REGEX),o=e.split(h.STATUTE_SUBDIV_PLAIN_REGEX);if(o.length>1){for(var a=[],s=1,u=o.length;s<u;s+=1){i[s-1].replace(/^\s*/,"");a.push(o[s].replace(/\s*$/,"").replace(/^\s*/,""))}e=a.join(" ")}else e=o[0];this.tmp.shadow_numbers.number.label=r,this.tmp.shadow_numbers.number.values.push(["Blob",e,!1]),this.tmp.shadow_numbers.number.numeric=!1}else this.tmp.shadow_numbers.number.values.push(["Blob",e,!1]),this.tmp.shadow_numbers.number.numeric=!0}},t.exports=h,h.substituteOne=function(t){return function(e,n){return n?t.replace("%%STRING%%",n):""}},h.substituteTwo=function(t){return function(e){var n=t.replace("%%PARAM%%",e);return function(t,e){return e?n.replace("%%STRING%%",e):""}}},h.Mode=function(t){var e,n,r,i,o,a;e={},n=h.Output.Formats[t];for(r in n)if("@"===r.slice(0,1)){if(i=!1,o=n[r],a=r.split("/"),"string"==typeof o&&o.indexOf("%%STRING%%")>-1)i=o.indexOf("%%PARAM%%")>-1?h.substituteTwo(o):h.substituteOne(o);else if("boolean"!=typeof o||o){if("function"!=typeof o)throw"CSL.Compiler: Bad "+t+" config entry for "+r+": "+o;i=o}else i=h.Output.Formatters.passthrough;1===a.length?e[a[0]]=i:2===a.length&&(e[a[0]]||(e[a[0]]={}),e[a[0]][a[1]]=i)}else e[r]=n[r];return e},h.setDecorations=function(t,e){var n,r;n=[];for(r in h.FORMAT_KEY_SEQUENCE){var i;e[i=h.FORMAT_KEY_SEQUENCE[r]]&&(n.push([i,e[i]]),delete e[i])}return n},h.Doppeler=function(t,e){this.split=function(t){e&&(t=e(t));var i=t.match(n);if(!i)return{tags:[],strings:[t]};for(var o=t.split(r),a=i.length-1;a>-1;a--){var s=i[a];"'"===s&&o[a+1].length>0&&(o[a+1]=i[a]+o[a+1],i[a]="")}return{tags:i,strings:o,origStrings:o.slice()}},this.join=function(t){for(var e=t.strings.slice(-1),n=t.tags.length-1;n>-1;n--)e.push(t.tags[n]),e.push(t.strings[n]);return e.reverse(),e.join("")};var n=new RegExp("("+t+")","g"),r=new RegExp(t,"g")},h.Engine.prototype.normalDecorIsOrphan=function(t,e){if("normal"===e[1]){for(var n,r=!1,i=(n="citation"===this.tmp.area?[this.citation.opt.layout_decorations].concat(t.alldecor):t.alldecor).length-1;i>-1;i+=-1)for(var o=n[i].length-1;o>-1;o+=-1)n[i][o][0]===e[0]&&"normal"!==n[i][o][1]&&(r=!0);if(!r)return!0}return!1},h.getJurisdictionNameAndSuppress=function(t,e,n,r){var i=null;if(r&&(e=e.split(":").slice(0,r).join(":"),n=t.sys.getHumanForm(e)),n||(n=t.sys.getHumanForm(e)),n){var o=e.split(":"),a=n.split("|"),s=!1;if(1===o.length&&2===a.length?s=!0:o.length>1&&a.length===o.length&&(s=!0),s){for(var u,l=0,c=0,h=o.length;c<h;c++)u=o.slice(0,c+1).join(":"),t.opt.suppressedJurisdictions[u]&&(l=c+1);i=0===l?1===o.length?a[0]:a.join("|"):1===l&&1===o.length?"":a.slice(l).join("|")}else i=a.join("|")}else i=e;return i},t.exports=h,h.Engine.prototype.getCitationLabel=function(t){var e="",n=this.getTrigraphParams(),r=n[0],i=this.getTerm("reference","short",0);void 0===i&&(i="reference"),i=(i=i.replace(".","")).slice(0,1).toUpperCase()+i.slice(1);for(var o=0,a=h.CREATORS.length;o<a;o+=1){var s=h.CREATORS[o];if(t[s]){var u=t[s];r=u.length>n.length?n[n.length-1]:n[u.length-1];for(var l=0,c=u.length;l<c&&l!==r.authors.length;l+=1){var p=this.nameOutput.getName(u[l],"locale-translit",!0).name;p&&p.family?i=(i=p.family).replace(/^([ \'\u2019a-z]+\s+)/,""):p&&p.literal&&(i=p.literal);var f=i.toLowerCase().match(/^(a\s+|the\s+|an\s+)/);if(f&&(i=i.slice(f[1].length)),!(i=i.replace(h.ROMANESQUE_NOT_REGEXP,"")))break;(i=i.slice(0,r.authors[l])).length>1?i=i.slice(0,1).toUpperCase()+i.slice(1).toLowerCase():1===i.length&&(i=i.toUpperCase()),e+=i}break}}if(!e&&t.title){var d=this.locale[this.opt.lang].opts["skip-words"],m=t.title.split(/\s+/);for(o=m.length-1;o>-1;o--)d.indexOf(m[o])>-1&&(m=m.slice(0,o).concat(m.slice(o+1)));var g=m.join("");(g=g.slice(0,n[0].authors[0])).length>1?g=g.slice(0,1).toUpperCase()+g.slice(1).toLowerCase():1===g.length&&(g=g.toUpperCase()),e=g}var v="0000";return t.issued&&t.issued.year&&(v=""+t.issued.year),e+=v=v.slice(-1*r.year)},h.Engine.prototype.getTrigraphParams=function(){var t=[],e=this.opt.trigraph.split(":");if(!this.opt.trigraph||"A"!==this.opt.trigraph.slice(0,1))throw"Bad trigraph definition: "+this.opt.trigraph;for(var n=0,r=e.length;n<r;n+=1){for(var i=e[n],o={authors:[],year:0},a=0,s=i.length;a<s;a+=1)switch(i.slice(a,a+1)){case"A":o.authors.push(1);break;case"a":o.authors[o.authors.length-1]+=1;break;case"0":o.year+=1;break;default:throw"Invalid character in trigraph definition: "+this.opt.trigraph}t.push(o)}return t},t.exports=h,h.Engine.prototype.setOutputFormat=function(t){this.opt.mode=t,this.fun.decorate=h.Mode(t),this.output[t]||(this.output[t]={},this.output[t].tmp={})},h.Engine.prototype.getSortFunc=function(){return function(t,e){return t=t.split("-"),e=e.split("-"),t.length<e.length?1:t.length>e.length?-1:(t=t.slice(-1)[0],e=e.slice(-1)[0],t.length<e.length?1:t.length>e.length?-1:0)}},h.Engine.prototype.setLangTagsForCslSort=function(t){var e,n;if(t)for(this.opt["locale-sort"]=[],e=0,n=t.length;e<n;e+=1)this.opt["locale-sort"].push(t[e]);this.opt["locale-sort"].sort(this.getSortFunc())},h.Engine.prototype.setLangTagsForCslTransliteration=function(t){var e,n;if(this.opt["locale-translit"]=[],t)for(e=0,n=t.length;e<n;e+=1)this.opt["locale-translit"].push(t[e]);this.opt["locale-translit"].sort(this.getSortFunc())},h.Engine.prototype.setLangTagsForCslTranslation=function(t){var e,n;if(this.opt["locale-translat"]=[],t)for(e=0,n=t.length;e<n;e+=1)this.opt["locale-translat"].push(t[e]);this.opt["locale-translat"].sort(this.getSortFunc())},h.Engine.prototype.setLangPrefsForCites=function(t,e){var n=this.opt["cite-lang-prefs"];e||(e=function(t){return t.toLowerCase()});for(var r=["Persons","Institutions","Titles","Journals","Publishers","Places"],i=0,o=r.length;i<o;i+=1){var a=e(r[i]),s=r[i].toLowerCase();if(t[a]){for(var u=[];t[a].length>1;)u.push(t[a].pop());var l={orig:1,translit:2,translat:3};for(2===u.length&&l[u[0]]<l[u[1]]&&u.reverse();u.length;)t[a].push(u.pop());for(var c=n[s];c.length;)c.pop();for(var h=0,p=t[a].length;h<p;h+=1)c.push(t[a][h])}}},h.Engine.prototype.setLangPrefsForCiteAffixes=function(t){if(t&&48===t.length){for(var e,n=this.opt.citeAffixes,r=0,i=["persons","institutions","titles","journals","publishers","places"],o=["translit","orig","translit","translat"],a=0,s=i.length;a<s;a+=1)for(var u=0,l=o.length;u<l;u+=1)e="",r%8==4?n[i[a]]["locale-"+o[u]].prefix||n[i[a]]["locale-"+o[u]].suffix||(e=t[r]?t[r]:"",n[i[a]]["locale-"+o[u]].prefix=e,e=t[r]?t[r+1]:"",n[i[a]]["locale-"+o[u]].suffix=e):(e=t[r]?t[r]:"",n[i[a]]["locale-"+o[u]].prefix=e,e=t[r]?t[r+1]:"",n[i[a]]["locale-"+o[u]].suffix=e),r+=2;this.opt.citeAffixes=n}},h.Engine.prototype.setAutoVietnameseNamesOption=function(t){this.opt["auto-vietnamese-names"]=!!t},h.Engine.prototype.setAbbreviations=function(t){this.sys.setAbbreviations&&this.sys.setAbbreviations(t)},h.Engine.prototype.setSuppressTrailingPunctuation=function(t){this.citation.opt.suppressTrailingPunctuation=!!t},t.exports=h,h.Output={},h.Output.Queue=function(t){this.levelname=["top"],this.state=t,this.queue=[],this.empty=new h.Token("empty");var e={};e.empty=this.empty,this.formats=new h.Stack(e),this.current=new h.Stack(this.queue)},h.Output.Queue.prototype.pop=function(){var t=this.current.value();return t.length?t.pop():t.blobs.pop()},h.Output.Queue.prototype.getToken=function(t){return this.formats.value()[t]},h.Output.Queue.prototype.mergeTokenStrings=function(t,e){var n,r,i;if(i=n=this.formats.value()[t],r=this.formats.value()[e]){n||((n=new h.Token(t,h.SINGLETON)).decorations=[]),i=new h.Token(t,h.SINGLETON);var o="";for(var o in n.strings)n.strings.hasOwnProperty(o)&&(i.strings[o]=n.strings[o]);for(var o in r.strings)r.strings.hasOwnProperty(o)&&(i.strings[o]=r.strings[o]);i.decorations=n.decorations.concat(r.decorations)}return i},h.Output.Queue.prototype.addToken=function(t,e,n){var r,i;if(r=new h.Token("output"),"string"==typeof n&&(n=this.formats.value()[n]),n&&n.strings){for(i in n.strings)n.strings.hasOwnProperty(i)&&(r.strings[i]=n.strings[i]);r.decorations=n.decorations}"string"==typeof e&&(r.strings.delimiter=e),this.formats.value()[t]=r},h.Output.Queue.prototype.pushFormats=function(t){t||(t={}),t.empty=this.empty,this.formats.push(t)},h.Output.Queue.prototype.popFormats=function(t){this.formats.pop()},h.Output.Queue.prototype.startTag=function(t,e){var n={};this.state.tmp["doing-macro-with-date"]&&this.state.tmp.extension&&(e=this.empty,t="empty"),n[t]=e,this.pushFormats(n),this.openLevel(t)},h.Output.Queue.prototype.endTag=function(t){this.closeLevel(t),this.popFormats()},h.Output.Queue.prototype.openLevel=function(t,e){var n,r;if("object"==typeof t)n=new h.Blob(void 0,t);else if(void 0===t)n=new h.Blob(void 0,this.formats.value().empty,"empty");else{if(!this.formats.value()||!this.formats.value()[t])throw'CSL processor error: call to nonexistent format token "'+t+'"';n=new h.Blob(void 0,this.formats.value()[t],t)}r=this.current.value(),!this.state.tmp.just_looking&&this.checkNestedBrace&&(n.strings.prefix=this.checkNestedBrace.update(n.strings.prefix)),r.push(n),this.current.push(n)},h.Output.Queue.prototype.closeLevel=function(t){t&&t!==this.current.value().levelname&&h.error("Level mismatch error:  wanted "+t+" but found "+this.current.value().levelname);var e=this.current.pop();!this.state.tmp.just_looking&&this.checkNestedBrace&&(e.strings.suffix=this.checkNestedBrace.update(e.strings.suffix))},h.Output.Queue.prototype.append=function(t,e,n,r,i){var o,a,s,u=!0;if(n&&(r=!0),this.state.tmp["doing-macro-with-date"]&&!n){if("macro-with-date"!==e)return!1;"macro-with-date"===e&&(e="empty")}if(void 0===t)return!1;if("number"==typeof t&&(t=""+t),!n&&this.state.tmp.element_trace&&"suppress-me"===this.state.tmp.element_trace.value())return!1;if(a=!1,e?"literal"===e?(o=!0,u=!1):o="string"==typeof e?this.formats.value()[e]:e:o=this.formats.value().empty,!o)throw"CSL processor error: unknown format token name: "+e;if(o.strings&&void 0===o.strings.delimiter&&(o.strings.delimiter=""),"string"==typeof t&&t.length&&(t=t.replace(/ ([:;?!\u00bb])/g," $1").replace(/\u00ab /g,"« "),this.last_char_rendered=t.slice(-1),t=t.replace(/\s+'/g," '"),n||(t=t.replace(/^'/g," '")),r?n&&(this.state.tmp.term_predecessor_name=!0):(this.state.tmp.term_predecessor=!0,this.state.tmp.in_cite_predecessor=!0)),a=new h.Blob(t,o),void 0===(s=this.current.value())&&0===this.current.mystack.length&&(this.current.mystack.push([]),s=this.current.value()),"string"==typeof a.blobs&&(r?n&&(this.state.tmp.term_predecessor_name=!0):(this.state.tmp.term_predecessor=!0,this.state.tmp.in_cite_predecessor=!0)),n||this.state.parallel.AppendBlobPointer(s),"string"==typeof t){if("string"==typeof a.blobs&&" "!==a.blobs.slice(0,1)){for(var l="",c=a.blobs;h.TERMINAL_PUNCTUATION.indexOf(c.slice(0,1))>-1;)l+=c.slice(0,1),c=c.slice(1);c&&l&&(a.strings.prefix=a.strings.prefix+l,a.blobs=c)}a.strings["text-case"]&&(a.blobs=h.Output.Formatters[a.strings["text-case"]](this.state,t)),this.state.tmp.strip_periods&&!i&&(a.blobs=a.blobs.replace(/\.([^a-z]|$)/g,"$1"));for(var p=a.decorations.length-1;p>-1;p+=-1)"@quotes"===a.decorations[p][0]&&"false"!==a.decorations[p][1]&&(a.punctuation_in_quote=this.state.getOpt("punctuation-in-quote")),a.blobs.match(h.ROMANESQUE_REGEXP)||"@font-style"===a.decorations[p][0]&&(a.decorations=a.decorations.slice(0,p).concat(a.decorations.slice(p+1)));s.push(a),this.state.fun.flipflopper.processTags(a)}else u?s.push(a):s.push(t);return!0},h.Output.Queue.prototype.string=function(t,e,n){var r,i=h.getSafeEscape(this.state),o=e.slice(),a=[];if(0===o.length)return a;var s,u,l,c,p="";n?p=n.strings.delimiter:(t.tmp.count_offset_characters=!1,t.tmp.offset_characters=0),n&&n.new_locale&&(n.old_locale=t.opt.lang,t.opt.lang=n.new_locale);for(var f=0,d=o.length;f<d;f+=1){if((s=o[f]).strings.first_blob&&(t.tmp.count_offset_characters=s.strings.first_blob),"string"==typeof s.blobs){if("number"==typeof s.num)a.push(s);else if(s.blobs){var m=(r=i(s.blobs)).length;if(!t.tmp.suppress_decorations)for(y=0,b=s.decorations.length;y<b;y+=1)"@showid"!==(c=s.decorations[y])[0]&&(t.normalDecorIsOrphan(s,c)||(r=t.fun.decorate[c[0]][c[1]].call(s,t,r,c[2])));if(r&&r.length){if(r=i(s.strings.prefix)+r+i(s.strings.suffix),(t.opt.development_extensions.csl_reverse_lookup_support||t.sys.csl_reverse_lookup_support)&&!t.tmp.suppress_decorations)for(y=0,b=s.decorations.length;y<b;y+=1)"@showid"===(c=s.decorations[y])[0]&&(r=t.fun.decorate[c[0]][c[1]].call(s,t,r,c[2]));a.push(r),t.tmp.count_offset_characters&&(t.tmp.offset_characters+=m+s.strings.suffix.length+s.strings.prefix.length)}}}else if(s.blobs.length){var g=t.output.string(t,s.blobs,s);if(n&&"string"!==g&&g.length>1&&s.strings.delimiter)for(var v=!1,y=0,b=g.length;y<b;y++)"string"!=typeof g[y]?v=!0:v&&(g[y]=s.strings.delimiter+g[y]);a=a.concat(g)}s.strings.first_blob&&t.registry.registry[s.strings.first_blob]&&(t.registry.registry[s.strings.first_blob].offset=t.tmp.offset_characters,t.tmp.count_offset_characters=!1)}for(f=0,d=a.length-1;f<d;f+=1)"number"!=typeof a[f].num||"number"!=typeof a[f+1].num||a[f+1].UGLY_DELIMITER_SUPPRESS_HACK||(a[f].strings.suffix=a[f].strings.suffix+(p||""),a[f+1].successor_prefix="",a[f+1].UGLY_DELIMITER_SUPPRESS_HACK=!0);var _=0;for(f=0,d=a.length;f<d;f+=1)"string"==typeof a[f]&&(_=parseInt(f,10)+1,f<a.length-1&&"object"==typeof a[f+1]&&(p&&!a[f+1].UGLY_DELIMITER_SUPPRESS_HACK&&(a[f]+=i(p)),a[f+1].UGLY_DELIMITER_SUPPRESS_HACK=!0));if(n&&(n.decorations.length||n.strings.suffix))_=a.length;else if(n&&n.strings.prefix)for(f=0,d=a.length;f<d;f++)if(void 0!==a[f].num){_=f,0===f&&(a[f].strings.prefix=n.strings.prefix+a[f].strings.prefix);break}var x=t.output.renderBlobs(a.slice(0,_),p,!1,n);if(x&&n&&(n.decorations.length||n.strings.suffix||n.strings.prefix)){if(!t.tmp.suppress_decorations)for(f=0,d=n.decorations.length;f<d;f+=1)c=n.decorations[f],["@cite","@bibliography","@display","@showid"].indexOf(c[0])>-1||t.normalDecorIsOrphan(s,c)||"string"==typeof x&&(x=t.fun.decorate[c[0]][c[1]].call(n,t,x,c[2]));if(r=x,u=n.strings.suffix,r&&r.length&&(r=i(l=n.strings.prefix)+r+i(u),t.tmp.count_offset_characters&&(t.tmp.offset_characters+=l.length+u.length)),x=r,!t.tmp.suppress_decorations)for(f=0,d=n.decorations.length;f<d;f+=1)c=n.decorations[f],-1!==["@cite","@bibliography","@display","@showid"].indexOf(c[0])&&"string"==typeof x&&(x=t.fun.decorate[c[0]][c[1]].call(n,t,x,c[2]))}var w=a.slice(_,a.length);return!w.length&&x?a=[x]:w.length&&!x?a=w:x&&w.length&&(a=[x].concat(w)),void 0===n?(this.queue=[],this.current.mystack=[],this.current.mystack.push(this.queue),t.tmp.suppress_decorations&&(a=t.output.renderBlobs(a,void 0,!1))):"boolean"==typeof n&&(a=t.output.renderBlobs(a,void 0,!0)),n&&n.new_locale&&(t.opt.lang=n.old_locale),a},h.Output.Queue.prototype.clearlevel=function(){var t,e,n;for(n=(t=this.current.value()).blobs.length,e=0;e<n;e+=1)t.blobs.pop()},h.Output.Queue.prototype.renderBlobs=function(t,e,n,r){var i,o,a,s,u,l,c,p,f,d,m;if(m=h.getSafeEscape(this.state),e||(e=""),i=this.state,o="",[],a="",l=t.length,"citation"===this.state.tmp.area&&!this.state.tmp.just_looking&&1===l&&"object"==typeof t[0]&&r)return t[0].strings.prefix=r.strings.prefix+t[0].strings.prefix,t[0].strings.suffix=t[0].strings.suffix+r.strings.suffix,t[0].decorations=t[0].decorations.concat(r.decorations),t[0].params=r.params,t[0];var g=!0;for(u=0;u<l;u+=1)t[u].checkNext?(t[u].checkNext(t[u+1],g),g=!1):g=!t[u+1]||!t[u+1].splice_prefix;var v=!0;for(u=t.length-1;u>0;u+=-1)t[u].checkLast?v&&t[u].checkLast(t[u-1])&&(v=!1):v=!0;for(l=t.length,u=0;u<l;u+=1)if(s=t[u],o&&(a=e),"string"==typeof s)o+=m(a),o+=s,i.tmp.count_offset_characters&&(i.tmp.offset_characters+=a.length);else if(n)o=o?[o,s]:[s];else if(s.status!==h.SUPPRESS){var y=(f=s.particle?s.particle+s.num:s.formatter.format(s.num,s.gender)).replace(/<[^>]*>/g,"").length;this.append(f,"empty",!0);var b=this.pop(),_=i.tmp.count_offset_characters;if(f=this.string(i,[b],!1),i.tmp.count_offset_characters=_,s.strings["text-case"]&&(f=h.Output.Formatters[s.strings["text-case"]](this.state,f)),f&&this.state.tmp.strip_periods&&(f=f.replace(/\.([^a-z]|$)/g,"$1")),!i.tmp.suppress_decorations)for(p=s.decorations.length,c=0;c<p;c+=1)d=s.decorations[c],i.normalDecorIsOrphan(s,d)||(f=i.fun.decorate[d[0]][d[1]].call(s,i,f,d[2]));f=m(s.strings.prefix)+f+m(s.strings.suffix);var x="";s.status===h.END?x=m(s.range_prefix):s.status===h.SUCCESSOR?x=m(s.successor_prefix):s.status===h.START?x=u>0&&!s.suppress_splice_prefix?m(s.splice_prefix):"":s.status===h.SEEN&&(x=m(s.splice_prefix)),o+=x,o+=f,i.tmp.count_offset_characters&&(i.tmp.offset_characters+=x.length+s.strings.prefix.length+y+s.strings.suffix.length)}return o},h.Output.Queue.purgeEmptyBlobs=function(t){if("object"==typeof t&&"object"==typeof t.blobs&&t.blobs.length)for(var e=t.blobs.length-1;e>-1;e--){h.Output.Queue.purgeEmptyBlobs(t.blobs[e]);var n=t.blobs[e];if(!n||!n.blobs||!n.blobs.length){for(var r=[];t.blobs.length-1>e;)r.push(t.blobs.pop());for(t.blobs.pop();r.length;)t.blobs.push(r.pop())}}},h.Output.Queue.adjust=function(t){var e={";":!0,":":!0},n={".":!0,"!":!0,"?":!0};this.upward=function(t){if(t.blobs&&"string"==typeof t.blobs)return void(a[t.strings.suffix.slice(0,1)]&&t.strings.suffix.slice(0,1)===t.blobs.slice(-1)&&(t.strings.suffix=t.strings.suffix.slice(1)));if("object"!=typeof t||"object"!=typeof t.blobs||!t.blobs.length)return;for(var e=f(t,!0),n=t.blobs.length-1;n>-1;n--){t.blobs.length;this.upward(t.blobs[n]);var r=t.strings,i=t.blobs[n].strings;if(0===n){" "===r.prefix.slice(-1)&&" "===i.prefix.slice(0,1)&&(i.prefix=i.prefix.slice(1));var o=i.prefix.slice(0,1);e||!s[o]||r.prefix||(r.prefix+=o,i.prefix=i.prefix.slice(1))}if(n===t.blobs.length-1){var o=i.suffix.slice(-1);!e&&[" "].indexOf(o)>-1&&(r.suffix.slice(0,1)!==o&&(r.suffix=o+r.suffix),i.suffix=i.suffix.slice(0,-1))}r.delimiter&&n>0&&s[r.delimiter.slice(-1)]&&r.delimiter.slice(-1)===i.prefix.slice(0,1)&&(i.prefix=i.prefix.slice(1))}},this.leftward=function(t){if("object"!=typeof t||"object"!=typeof t.blobs||!t.blobs.length)return;for(var e=t.blobs.length-1;e>-1;e--)if(this.leftward(t.blobs[e]),e<t.blobs.length-1&&!t.strings.delimiter){var n=t.blobs[e],r=n.strings.suffix.slice(-1),i=t.blobs[e+1],o=i.strings.prefix.slice(0,1),s=f(n)||f(i),u="number"==typeof r||"number"==typeof o;if(!s&&!u&&a[o]&&!u){var l=o===n.strings.suffix.slice(-1),c=!n.strings.suffix&&"string"==typeof n.blobs&&n.blobs.slice(-1)===o;l||c?i.strings.prefix=i.strings.prefix.slice(1):v(n,"suffix",i,"prefix")}}},this.downward=function(e,n){if(e.blobs&&"string"==typeof e.blobs)return void(a[e.strings.suffix.slice(0,1)]&&e.strings.suffix.slice(0,1)===e.blobs.slice(-1)&&(e.strings.suffix=e.strings.suffix.slice(1)));if("object"!=typeof e||"object"!=typeof e.blobs||!e.blobs.length)return;for(var r=e.strings,i=0,o=e.blobs.length;i<o;i++)if(h(e.blobs[i])){!0;break}if(r.delimiter&&a[r.delimiter.slice(0,1)]){for(var u=r.delimiter.slice(0,1),i=e.blobs.length-2;i>-1;i--){var l=e.blobs[i].strings;l.suffix.slice(-1)!==u&&(l.suffix+=u)}r.delimiter=r.delimiter.slice(1)}f(e,!0),h(e);for(var i=e.blobs.length-1;i>-1;i--){var c=e.blobs[i],l=e.blobs[i].strings,y=f(c,!0),b=h(c);if(i===e.blobs.length-1){var _=r.suffix.slice(0,1),x=!1;a[_]&&!(x=m(_,c))&&t&&(x=d(c)),x&&a[_]&&(p(c)||("string"==typeof c.blobs?v(c,"blobs",e,"suffix"):v(c,"suffix",e,"suffix"),"."===r.suffix.slice(0,1)&&(l.suffix+=r.suffix.slice(0,1),r.suffix=r.suffix.slice(1))))," "===l.suffix.slice(-1)&&" "===r.suffix.slice(0,1)&&(r.suffix=r.suffix.slice(1)),s[l.suffix.slice(0,1)]&&("string"==typeof c.blobs&&c.blobs.slice(-1)===l.suffix.slice(0,1)&&(l.suffix=l.suffix.slice(1)),l.suffix.slice(-1)===r.suffix.slice(0,1)&&(r.suffix=r.suffix.slice(0,-1))),g(e,e.strings.suffix.slice(0,1))&&(e.strings.suffix=e.strings.suffix.slice(1))}else if(r.delimiter)s[r.delimiter.slice(0,1)]&&r.delimiter.slice(0,1)===l.suffix.slice(-1)&&(e.blobs[i].strings.suffix=e.blobs[i].strings.suffix.slice(0,-1));else{var w=e.blobs[i+1].strings;h(c)||y||!s[l.suffix.slice(-1)]||l.suffix.slice(-1)!==w.prefix.slice(0,1)||(w.prefix=w.prefix.slice(1))}b||y||!a[l.suffix.slice(0,1)]||"string"!=typeof c.blobs||v(c,"blobs",c,"suffix"),this.downward(e.blobs[i])}},this.fix=function(e){if("object"!=typeof e||"object"!=typeof e.blobs||!e.blobs.length)return;for(var n,r=0,i=e.blobs.length;r<i;r++){for(var o=e.blobs[r],a=!1,s=0,u=o.decorations.length;s<u;s++){var l=o.decorations[s];"@quotes"===l[0]&&"false"!==l[1]&&(a=!0)}a&&(t?y(o):b(o)),n=this.fix(e.blobs[r]),o.blobs&&"string"==typeof o.blobs&&(n=o.blobs.slice(-1))}return n};var r={"!":{".":"!","?":"!?",":":"!",",":"!,",";":"!;"},"?":{"!":"?!",".":"?",":":"?",",":"?,",";":"?;"},".":{"!":".!","?":".?",":":".:",",":".,",";":".;"},":":{"!":"!","?":"?",".":":",",":":,",";":":;"},",":{"!":",!","?":",?",":":",:",".":",.",";":",;"},";":{"!":"!","?":"?",":":";",",":";,",".":";"}},i={},o={},a={},s={};for(var u in r)a[u]=!0,s[u]=!0,e[u]||(i[u]=!0),n[u]||(o[u]=!0);s[" "]=!0,s[" "]=!0;var l={};for(var u in r)for(var c in r[u])l[c]||(l[c]={}),l[c][u]=r[u][c];function h(t){return"number"==typeof t.num||t.blobs&&1===t.blobs.length&&"number"==typeof t.blobs[0].num}function p(t){return"number"==typeof t.num||!(!t.blobs||"object"!=typeof t.blobs)&&(!!p(t.blobs[t.blobs.length-1])||void 0)}function f(t,e){var n=!1,r=["@font-style","@font-variant","@font-weight","@text-decoration","@vertical-align"];if(e&&r.push("@quotes"),t.decorations)for(var i=0,o=t.decorations.length;i<o;i++)if(r.indexOf(t.decorations[i][0])>-1){n=!0;break}return n}function d(t){if(t.decorations)for(var e=0,n=t.decorations.length;e<n;e++)if("@quotes"===t.decorations[e][0]&&"false"!==t.decorations[e][1])return!0;return"object"==typeof t.blobs&&d(t.blobs[t.blobs.length-1])}function m(t,e){var n=e.strings.suffix.slice(-1);n||"string"!=typeof e.blobs||(n=e.blobs.slice(-1));var r=l[t][n];return!(!r||1!==r.length)||"object"==typeof e.blobs&&!!m(t,e.blobs[e.blobs.length-1])}function g(t,e){if(!a[e])return!1;if("string"==typeof t.blobs)return t.blobs.slice(-1)===e;var n=t.blobs[t.blobs.length-1];return!!n&&(n.strings.suffix.slice(-1)?n.strings.suffix.slice(-1)==e:g(n,e))}function v(t,e,n,i,o){var a="blobs"===e?t:t.strings,s="blobs"===i?n:n.strings,u=a[e].slice(-1),c=s[i].slice(0,1);function h(){s[i]=s[i].slice(1)}function p(){a[e]=a[e].slice(0,-1)}function f(t){s[i]=t+s[i]}function d(t){a[e]+=t}var m=o?function(){return r[u]}:function(){return l[c]};var g=o?function(){var t=r[u][c];"string"==typeof t?(p(),h(),f(t)):(f(u),p())}:function(){var t=l[c][u];"string"==typeof t?(p(),h(),d(t)):(d(c),h())};u===c?(o?p:h)():m()&&g()}function y(t){var e=t.strings.suffix.slice(0,1);if("string"==typeof t.blobs)for(;i[e];)v(t,"blobs",t,"suffix"),e=t.strings.suffix.slice(0,1);else for(;i[e];)v(t.blobs[t.blobs.length-1],"suffix",t,"suffix"),e=t.strings.suffix.slice(0,1)}function b(t){if("string"==typeof t.blobs)for(var e=t.blobs.slice(-1);o[e];)v(t,"blobs",t,"suffix",!0),e=t.blobs.slice(-1);else for(e=t.blobs[t.blobs.length-1].strings.suffix.slice(-1);o[e];)v(t.blobs[t.blobs.length-1],"suffix",t,"suffix",!0),e=t.blobs[t.blobs.length-1].strings.suffix.slice(-1)}},t.exports=h,h.Engine.Opt=function(){this.has_disambiguate=!1,this.mode="html",this.dates={},this.jurisdictions_seen={},this.suppressedJurisdictions={},this.inheritedAttributes={},this["locale-sort"]=[],this["locale-translit"]=[],this["locale-translat"]=[],this.citeAffixes={persons:{"locale-orig":{prefix:"",suffix:""},"locale-translit":{prefix:"",suffix:""},"locale-translat":{prefix:"",suffix:""}},institutions:{"locale-orig":{prefix:"",suffix:""},"locale-translit":{prefix:"",suffix:""},"locale-translat":{prefix:"",suffix:""}},titles:{"locale-orig":{prefix:"",suffix:""},"locale-translit":{prefix:"",suffix:""},"locale-translat":{prefix:"",suffix:""}},journals:{"locale-orig":{prefix:"",suffix:""},"locale-translit":{prefix:"",suffix:""},"locale-translat":{prefix:"",suffix:""}},publishers:{"locale-orig":{prefix:"",suffix:""},"locale-translit":{prefix:"",suffix:""},"locale-translat":{prefix:"",suffix:""}},places:{"locale-orig":{prefix:"",suffix:""},"locale-translit":{prefix:"",suffix:""},"locale-translat":{prefix:"",suffix:""}}},this["default-locale"]=[],this.update_mode=h.NONE,this.bib_mode=h.NONE,this.sort_citations=!1,this["et-al-min"]=0,this["et-al-use-first"]=1,this["et-al-use-last"]=!1,this["et-al-subsequent-min"]=!1,this["et-al-subsequent-use-first"]=!1,this["demote-non-dropping-particle"]="display-and-sort",this["parse-names"]=!0,this.citation_number_slug=!1,this.trigraph="Aaaa00:AaAa00:AaAA00:AAAA00",this.nodenames=[],this.gender={},this["cite-lang-prefs"]={persons:["orig"],institutions:["orig"],titles:["orig"],journals:["orig"],publishers:["orig"],places:["orig"],number:["orig"]},this.has_layout_locale=!1,this.development_extensions={},this.development_extensions.field_hack=!0,this.development_extensions.allow_field_hack_date_override=!0,this.development_extensions.locator_date_and_revision=!0,this.development_extensions.locator_parsing_for_plurals=!0,this.development_extensions.locator_label_parse=!0,this.development_extensions.raw_date_parsing=!0,this.development_extensions.clean_up_csl_flaws=!0,this.development_extensions.flip_parentheses_to_braces=!0,this.development_extensions.jurisdiction_subfield=!0,this.development_extensions.static_statute_locator=!1,this.development_extensions.csl_reverse_lookup_support=!1,this.development_extensions.clobber_locator_if_no_statute_section=!1,this.development_extensions.wrap_url_and_doi=!1,this.development_extensions.allow_force_lowercase=!1,this.development_extensions.handle_parallel_articles=!1,this.development_extensions.thin_non_breaking_space_html_hack=!1,this.development_extensions.apply_citation_wrapper=!1,this.development_extensions.main_title_from_short_title=!1,this.development_extensions.uppercase_subtitles=!1,this.development_extensions.normalize_lang_keys_to_lowercase=!1,this.development_extensions.strict_text_case_locales=!1,this.development_extensions.rtl_support=!1,this.development_extensions.expect_and_symbol_form=!1,this.development_extensions.require_explicit_legal_case_title_short=!1,this.development_extensions.spoof_institutional_affiliations=!1,this.development_extensions.force_jurisdiction=!1,this.development_extensions.parse_names=!0},h.Engine.Tmp=function(){this.names_max=new h.Stack,this.names_base=new h.Stack,this.givens_base=new h.Stack,this.value=[],this.namepart_decorations={},this.namepart_type=!1,this.area="citation",this.root="citation",this.extension="",this.can_substitute=new h.Stack(0,h.LITERAL),this.element_rendered_ok=!1,this.element_trace=new h.Stack("style"),this.nameset_counter=0,this.group_context=new h.Stack({term_intended:!1,variable_attempt:!1,variable_success:!1,output_tip:void 0,label_form:void 0,parallel_conditions:void 0,condition:!1,force_suppress:!1,done_vars:[]}),this.term_predecessor=!1,this.in_cite_predecessor=!1,this.jump=new h.Stack(0,h.LITERAL),this.decorations=new h.Stack,this.tokenstore_stack=new h.Stack,this.last_suffix_used="",this.last_names_used=[],this.last_years_used=[],this.years_used=[],this.names_used=[],this.taintedItemIDs={},this.taintedCitationIDs={},this.initialize_with=new h.Stack,this.disambig_request=!1,this["name-as-sort-order"]=!1,this.suppress_decorations=!1,this.disambig_settings=new h.AmbigConfig,this.bib_sort_keys=[],this.prefix=new h.Stack("",h.LITERAL),this.suffix=new h.Stack("",h.LITERAL),this.delimiter=new h.Stack("",h.LITERAL),this.cite_locales=[],this.cite_affixes={citation:!1,bibliography:!1,citation_sort:!1,bibliography_sort:!1},this.strip_periods=0,this.shadow_numbers={},this.authority_stop_last=0,this.loadedItemIDs={}},h.Engine.Fun=function(t){this.match=new h.Util.Match,this.suffixator=new h.Util.Suffixator(h.SUFFIX_CHARS),this.romanizer=new h.Util.Romanizer,this.ordinalizer=new h.Util.Ordinalizer(t),this.long_ordinalizer=new h.Util.LongOrdinalizer},h.Engine.Build=function(){this["alternate-term"]=!1,this.in_bibliography=!1,this.in_style=!1,this.skip=!1,this.postponed_macro=!1,this.layout_flag=!1,this.name=!1,this.form=!1,this.term=!1,this.macro={},this.macro_stack=[],this.text=!1,this.lang=!1,this.area="citation",this.root="citation",this.extension="",this.substitute_level=new h.Stack(0,h.LITERAL),this.names_level=0,this.render_nesting_level=0,this.render_seen=!1},h.Engine.Configure=function(){this.fail=[],this.succeed=[]},h.Engine.Citation=function(t){this.opt={inheritedAttributes:{}},this.tokens=[],this.srt=new h.Registry.Comparifier(t,"citation_sort"),this.opt.collapse=[],this.opt["disambiguate-add-names"]=!1,this.opt["disambiguate-add-givenname"]=!1,this.opt["disambiguate-add-year-suffix"]=!1,this.opt["givenname-disambiguation-rule"]="by-cite",this.opt["near-note-distance"]=5,this.opt.topdecor=[],this.opt.layout_decorations=[],this.opt.layout_prefix="",this.opt.layout_suffix="",this.opt.layout_delimiter="",this.opt.sort_locales=[],this.opt.max_number_of_names=0,this.root="citation"},h.Engine.Bibliography=function(){this.opt={inheritedAttributes:{}},this.tokens=[],this.opt.collapse=[],this.opt.topdecor=[],this.opt.layout_decorations=[],this.opt.layout_prefix="",this.opt.layout_suffix="",this.opt.layout_delimiter="",this.opt["line-spacing"]=1,this.opt["entry-spacing"]=1,this.opt.sort_locales=[],this.opt.max_number_of_names=0,this.root="bibliography"},h.Engine.BibliographySort=function(){this.tokens=[],this.opt={},this.opt.sort_directions=[],this.keys=[],this.opt.topdecor=[],this.root="bibliography"},h.Engine.CitationSort=function(){this.tokens=[],this.opt={},this.opt.sort_directions=[],this.keys=[],this.opt.topdecor=[],this.root="citation"},t.exports=h,h.Engine.prototype.previewCitationCluster=function(t,e,n,r){var i=this.opt.mode;this.setOutputFormat(r);var o=this.processCitationCluster(t,e,n,h.PREVIEW);return this.setOutputFormat(i),o[1]},h.Engine.prototype.appendCitationCluster=function(t){for(var e=[],n=this.registry.citationreg.citationByIndex.length,r=0;r<n;r+=1){var i=this.registry.citationreg.citationByIndex[r];e.push([""+i.citationID,i.properties.noteIndex])}return this.processCitationCluster(t,e,[])[1]},h.Engine.prototype.processCitationCluster=function(t,e,n,r){var i,o,a,s,u,l,c,p,f,d,m,g;this.debug=!1,this.tmp.loadedItemIDs={},this.tmp.citation_errors=[];var v,y,b,_={bibchange:!1};if(this.setCitationId(t),r===h.PREVIEW){v=this.registry.citationreg.citationByIndex.slice(),y=this.registry.reflist.slice();for(var x=e.concat([[""+t.citationID,t.properties.noteIndex]]).concat(n),w={},E=[],S=0,T=x.length;S<T;S+=1)for(o=0,a=(i=this.registry.citationreg.citationById[x[S][0]]).citationItems.length;o<a;o+=1)w[i.citationItems[o].id]=!0,E.push(""+i.citationItems[o].id);b={};for(S=0,T=y.length;S<T;S+=1)if(!w[y[S].id]){var O=this.registry.registry[y[S].id].ambig,A=this.registry.ambigcites[O];if(A)for(o=0,a=A.length;o<a;o+=1)b[A[o]]=h.cloneAmbigConfig(this.registry.registry[A[o]].disambig)}}this.tmp.taintedCitationIDs={};var M=[],C={};for(S=0,T=t.citationItems.length;S<T;S+=1){f={};for(var k in t.citationItems[S])f[k]=t.citationItems[S][k];var P;if((p=this.retrieveItem(""+f.id)).id&&this.transform.loadAbbreviation("default","hereinafter",p.id),f=h.parseLocator.call(this,f),this.opt.development_extensions.static_statute_locator&&this.remapSectionVariable([[p,f]]),this.opt.development_extensions.locator_label_parse)if(f.locator&&-1===["bill","gazette","legislation","regulation","treaty"].indexOf(p.type)&&(!f.label||"page"===f.label))if(P=h.LOCATOR_LABELS_REGEXP.exec(f.locator)){var R=h.LOCATOR_LABELS_MAP[P[2]];this.getTerm(R)&&(f.label=R,f.locator=P[3])}var L=[p,f];M.push(L),t.citationItems[S].item=p}t.sortedItems=M;var I=[];for(S=0,T=e.length;S<T;S+=1)i=e[S],this.registry.citationreg.citationById[i[0]].properties.noteIndex=i[1],I.push(this.registry.citationreg.citationById[i[0]]);I.push(t);for(S=0,T=n.length;S<T;S+=1)i=n[S],this.registry.citationreg.citationById[i[0]].properties.noteIndex=i[1],I.push(this.registry.citationreg.citationById[i[0]]);this.registry.citationreg.citationByIndex=I,this.registry.citationreg.citationsByItemId={},this.opt.update_mode===h.POSITION&&(m=[],d=[],g={});var D,N=[];for(S=0,T=I.length;S<T;S+=1){for(I[S].properties||(I[S].properties={}),I[S].properties.index=S,o=0,a=I[S].sortedItems.length;o<a;o+=1)f=I[S].sortedItems[o],this.registry.citationreg.citationsByItemId[f[1].id]||(this.registry.citationreg.citationsByItemId[f[1].id]=[],N.push(""+f[1].id)),-1===this.registry.citationreg.citationsByItemId[f[1].id].indexOf(I[S])&&this.registry.citationreg.citationsByItemId[f[1].id].push(I[S]);this.opt.update_mode===h.POSITION&&(I[S].properties.noteIndex?d.push(I[S]):(I[S].properties.noteIndex=0,m.push(I[S])))}if(r!==h.ASSUME_ALL_ITEMS_REGISTERED&&this.updateItems(N,null,null,!0),!this.opt.citation_number_sort&&M&&M.length>1&&this.citation_sort.tokens.length>0){for(S=0,T=M.length;S<T;S+=1)M[S][1].sortkeys=h.getSortKeys.call(this,M[S][0],"citation_sort");if(this.opt.grouped_sort&&!t.properties.unsorted){for(S=0,T=M.length;S<T;S+=1){var j=M[S][1].sortkeys;this.tmp.authorstring_request=!0;var U=this.registry.registry[M[S][0].id].disambig;this.tmp.authorstring_request=!0,h.getAmbiguousCite.call(this,M[S][0],U);var F=this.registry.authorstrings[M[S][0].id];this.tmp.authorstring_request=!1,M[S][1].sortkeys=[F].concat(j)}M.sort(this.citation.srt.compareCompositeKeys);var B=!1,z=!1,G=!1;for(S=0,T=M.length;S<T;S+=1)M[S][1].sortkeys[0]!==B&&(G=M[S][1].sortkeys[0],z=M[S][1].sortkeys[1]),M[S][1].sortkeys[0]=""+z+S,B=G}t.properties.unsorted||M.sort(this.citation.srt.compareCompositeKeys)}if(this.opt.update_mode===h.POSITION)for(S=0;S<2;S+=1){var H={},V={};for(o=0,a=(D=[m,d][S]).length;o<a;o+=1){var W=D[o];for(D[o].properties.noteIndex||(D[o].properties.noteIndex=0),D[o].properties.noteIndex=parseInt(D[o].properties.noteIndex,10),o>0&&D[o-1].properties.noteIndex>D[o].properties.noteIndex&&(g={},H={},V={}),s=0,u=W.sortedItems.length;s<u;s+=1)this.registry.registry[W.sortedItems[s][1].id].parallel||(g[W.properties.noteIndex]?g[W.properties.noteIndex]+=1:g[W.properties.noteIndex]=1);for(s=0,u=D[o].sortedItems.length;s<u;s+=1){var q,X=(f=D[o].sortedItems[s])[0].id,Y=f[1].locator,$=f[1].label;if(f[0].legislation_id&&(X=f[0].legislation_id),s>0&&(q=W.sortedItems[s-1][0].legislation_id?W.sortedItems[s-1][0].legislation_id:W.sortedItems[s-1][1].id),r!==h.PREVIEW||W.citationID==t.citationID){var Z,J={};if(J.position=f[1].position,J["first-reference-note-number"]=f[1]["first-reference-note-number"],J["near-note"]=f[1]["near-note"],f[1]["first-reference-note-number"]=0,f[1]["near-note"]=!1,this.registry.citationreg.citationsByItemId[X]&&"note"===this.opt.xclass&&this.opt.has_disambiguate){var K=this.registry.registry[X]["citation-count"],Q=this.registry.citationreg.citationsByItemId[X].length;if(this.registry.registry[X]["citation-count"]=this.registry.citationreg.citationsByItemId[X].length,"number"==typeof K){if(K<2!==Q<2)for(var tt=0,et=this.registry.citationreg.citationsByItemId[X].length;tt<et;tt++)C[this.registry.registry[X].ambig]=!0,this.tmp.taintedCitationIDs[this.registry.citationreg.citationsByItemId[X][tt].citationID]=!0}else for(tt=0,et=this.registry.citationreg.citationsByItemId[X].length;tt<et;tt++)C[this.registry.registry[X].ambig]=!0,this.tmp.taintedCitationIDs[this.registry.citationreg.citationsByItemId[X][tt].citationID]=!0}if(void 0===H[X])H[X]=W.properties.noteIndex,this.registry.registry[X]&&(this.registry.registry[X]["first-reference-note-number"]=W.properties.noteIndex),V[X]=W.properties.noteIndex,f[1].position=h.POSITION_FIRST;else{var nt,rt,it,ot,at=!1,st=!1;if(o>0&&(Z=D[o-1].sortedItems.slice(-1)[0][1].id,D[o-1].sortedItems[0].slice(-1)[0].legislation_id&&(Z=D[o-1].sortedItems[0].slice(-1)[0].legislation_id)),o>0&&0===parseInt(s,10)&&D[o-1].properties.noteIndex!==D[o].properties.noteIndex){var ut=D[o-1].sortedItems,lt=!1,ct=D[o-1].sortedItems[0][0].id;for(D[o-1].sortedItems[0][0].legislation_id&&(ct=D[o-1].sortedItems[0][0].legislation_id),(ct==X&&D[o-1].properties.noteIndex>=D[o].properties.noteIndex-1||D[o-1].sortedItems[0][1].id==this.registry.registry[f[1].id].parallel)&&(1!==g[D[o-1].properties.noteIndex]&&0!==D[o-1].properties.noteIndex||(lt=!0)),l=0,c=ut.slice(1).length;l<c;l+=1){var ht=ut.slice(1)[l];this.registry.registry[ht[1].id].parallel&&this.registry.registry[ht[1].id].parallel!=this.registry.registry[ht[1].id]||(lt=!1)}lt?at=!0:st=!0}else s>0&&q==X?at=!0:0===s&&D[o-1].properties.noteIndex==D[o].properties.noteIndex&&D[o-1].sortedItems.length&&Z==X?at=!0:st=!0;if(at&&((nt=s>0?W.sortedItems[s-1][1]:D[o-1].sortedItems[0][1]).locator?(it=nt.label?nt.label:"",rt=""+nt.locator+it):rt=nt.locator,ot=Y?""+Y+($||""):Y),at&&rt&&!ot&&(at=!1,st=!0),at&&(!rt&&ot?f[1].position=h.POSITION_IBID_WITH_LOCATOR:rt||ot?rt&&ot===rt?f[1].position=h.POSITION_IBID:rt&&ot&&ot!==rt?f[1].position=h.POSITION_IBID_WITH_LOCATOR:(at=!1,st=!0):f[1].position=h.POSITION_IBID),st&&(f[1].position=h.POSITION_SUBSEQUENT),(st||at)&&H[X]!=W.properties.noteIndex&&(f[1]["first-reference-note-number"]=H[X],this.registry.registry[X])){var pt=this.registry.citationreg.citationsByItemId[X][0].properties.noteIndex,ft=W.properties.noteIndex;this.registry.registry[X]["first-reference-note-number"]=ft<pt?ft:pt}}if(W.properties.noteIndex){var dt=parseInt(W.properties.noteIndex,10)-parseInt(V[X],10);f[1].position!==h.POSITION_FIRST&&dt<=this.citation.opt["near-note-distance"]&&(f[1]["near-note"]=!0),V[X]=W.properties.noteIndex}if(W.citationID!=t.citationID)for(l=0,c=h.POSITION_TEST_VARS.length;l<c;l+=1){var mt=h.POSITION_TEST_VARS[l];f[1][mt]!==J[mt]&&(this.registry.registry[X]&&"first-reference-note-number"===mt&&(C[this.registry.registry[X].ambig]=!0,this.tmp.taintedItemIDs[X]=!0),this.tmp.taintedCitationIDs[W.citationID]=!0)}this.sys.variableWrapper&&(f[1].index=W.properties.index,f[1].noteIndex=W.properties.noteIndex)}else void 0===H[f[1].id]?(H[X]=W.properties.noteIndex,V[X]=W.properties.noteIndex):V[X]=W.properties.noteIndex}}}if(this.opt.citation_number_sort&&M&&M.length>1&&this.citation_sort.tokens.length>0&&!t.properties.unsorted){for(S=0,T=M.length;S<T;S+=1)M[S][1].sortkeys=h.getSortKeys.call(this,M[S][0],"citation_sort");M.sort(this.citation.srt.compareCompositeKeys)}for(var k in this.tmp.taintedItemIDs)if(this.tmp.taintedItemIDs.hasOwnProperty(k)&&(D=this.registry.citationreg.citationsByItemId[k]))for(S=0,T=D.length;S<T;S+=1)this.tmp.taintedCitationIDs[D[S].citationID]=!0;var gt=[];if(r===h.PREVIEW){try{gt=this.process_CitationCluster.call(this,t.sortedItems,t.citationID)}catch(t){h.error("Error running CSL processor for preview: "+t)}this.registry.citationreg.citationByIndex=v,this.registry.citationreg.citationById={};for(S=0,T=v.length;S<T;S+=1)this.registry.citationreg.citationById[v[S].citationID]=v[S];var vt=[];for(S=0,T=y.length;S<T;S+=1)vt.push(""+y[S].id);this.updateItems(vt,null,null,!0);for(var k in b)b.hasOwnProperty(k)&&(this.registry.registry[k].disambig=b[k])}else{for(var yt in C)this.disambiguate.run(yt,t);var bt;for(var k in this.tmp.taintedCitationIDs)if(k!=t.citationID){var _t=this.registry.citationreg.citationById[k];if(!_t.properties.unsorted){for(S=0,T=_t.sortedItems.length;S<T;S+=1)_t.sortedItems[S][1].sortkeys=h.getSortKeys.call(this,_t.sortedItems[S][0],"citation_sort");_t.sortedItems.sort(this.citation.srt.compareCompositeKeys)}this.tmp.citation_pos=_t.properties.index,this.tmp.citation_note_index=_t.properties.noteIndex,this.tmp.citation_id=""+_t.citationID,(bt=[]).push(_t.properties.index),bt.push(this.process_CitationCluster.call(this,_t.sortedItems,_t.citationID)),bt.push(_t.citationID),gt.push(bt)}this.tmp.taintedItemIDs={},this.tmp.taintedCitationIDs={},this.tmp.citation_pos=t.properties.index,this.tmp.citation_note_index=t.properties.noteIndex,this.tmp.citation_id=""+t.citationID,(bt=[]).push(e.length),bt.push(this.process_CitationCluster.call(this,M,t.citationID)),bt.push(t.citationID),gt.push(bt),gt.sort(function(t,e){return t[0]>e[0]?1:t[0]<e[0]?-1:0})}return _.citation_errors=this.tmp.citation_errors.slice(),[_,gt]},h.Engine.prototype.process_CitationCluster=function(t,e){return this.parallel.StartCitation(t),h.getCitationCluster.call(this,t,e)},h.Engine.prototype.makeCitationCluster=function(t){var e,n,r,i,o,a;for(e=[],i=t.length,r=0;r<i;r+=1){o={};for(var s in t[r])o[s]=t[r][s];if(a=this.retrieveItem(""+o.id),this.opt.development_extensions.locator_label_parse&&o.locator&&-1===["bill","gazette","legislation","regulation","treaty"].indexOf(a.type)&&(!o.label||"page"===o.label)){var u=h.LOCATOR_LABELS_REGEXP.exec(o.locator);if(u){var l=h.LOCATOR_LABELS_MAP[u[2]];this.getTerm(l)&&(o.label=l,o.locator=u[3])}}o.locator&&(o.locator=(""+o.locator).replace(/\s+$/,"")),n=[a,o],e.push(n)}if(this.opt.development_extensions.static_statute_locator&&this.remapSectionVariable(e),e&&e.length>1&&this.citation_sort.tokens.length>0){for(i=e.length,r=0;r<i;r+=1)e[r][1].sortkeys=h.getSortKeys.call(this,e[r][0],"citation_sort");e.sort(this.citation.srt.compareCompositeKeys)}return this.tmp.citation_errors=[],this.parallel.StartCitation(e),h.getCitationCluster.call(this,e)},h.getAmbiguousCite=function(t,e,n,r){var i=this.tmp.group_context.tip,o={term_intended:i.term_intended,variable_attempt:i.variable_attempt,variable_success:i.variable_success,output_tip:i.output_tip,label_form:i.label_form,parallel_conditions:i.parallel_conditions,condition:i.condition,force_suppress:i.force_suppress,done_vars:i.done_vars.slice()};this.tmp.disambig_request=e||!1;var a={position:1,"near-note":!0};r&&(a.locator=r.locator,a.label=r.label),this.registry.registry[t.id]&&this.registry.citationreg.citationsByItemId&&this.registry.citationreg.citationsByItemId[t.id]&&this.registry.citationreg.citationsByItemId[t.id].length&&n&&"by-cite"===this.citation.opt["givenname-disambiguation-rule"]&&(a["first-reference-note-number"]=this.registry.registry[t.id]["first-reference-note-number"]),this.tmp.area="citation",this.tmp.root="citation",this.parallel.use_parallels=(!0===this.parallel.use_parallels||null===this.parallel.use_parallels)&&null,this.tmp.suppress_decorations=!0,this.tmp.just_looking=!0,h.getCite.call(this,t,a,null,!1);for(var s=0,u=this.output.queue.length;s<u;s+=1)h.Output.Queue.purgeEmptyBlobs(this.output.queue[s]);if(this.opt.development_extensions.clean_up_csl_flaws)for(var l=0,c=this.output.queue.length;l<c;l+=1)this.output.adjust.upward(this.output.queue[l]),this.output.adjust.leftward(this.output.queue[l]),this.output.adjust.downward(this.output.queue[l]),this.output.adjust.fix(this.output.queue[l]);var p=this.output.string(this,this.output.queue);return this.tmp.just_looking=!1,this.tmp.suppress_decorations=!1,this.parallel.use_parallels=null===this.parallel.use_parallels,this.tmp.group_context.replace(o),p},h.getSpliceDelimiter=function(t,e){if(t&&!this.tmp.have_collapsed&&"string"==typeof this.citation.opt["after-collapse-delimiter"])this.tmp.splice_delimiter=this.citation.opt["after-collapse-delimiter"];else if(this.tmp.use_cite_group_delimiter)this.tmp.splice_delimiter=this.citation.opt.cite_group_delimiter;else if(this.tmp.have_collapsed&&"in-text"===this.opt.xclass&&this.opt.update_mode!==h.NUMERIC)this.tmp.splice_delimiter=", ";else if(this.tmp.cite_locales[e-1]){var n=this.tmp.cite_affixes[this.tmp.area][this.tmp.cite_locales[e-1]];n&&n.delimiter&&(this.tmp.splice_delimiter=n.delimiter)}else this.tmp.splice_delimiter||(this.tmp.splice_delimiter="");return this.tmp.splice_delimiter},h.getCitationCluster=function(t,e){var n,r,i,o,a,s,u,l,c,p,f,d,m,g,v,y,b,_;t=t||[],this.tmp.last_primary_names_string=!1,b=h.getSafeEscape(this),this.tmp.area="citation",this.tmp.root="citation",n="",r=[],this.tmp.last_suffix_used="",this.tmp.last_names_used=[],this.tmp.last_years_used=[],this.tmp.backref_index=[],this.tmp.cite_locales=[],this.output.checkNestedBrace=new h.checkNestedBrace(this);var x=this.output.checkNestedBrace.update(this.citation.opt.layout_prefix),w=!1;if("note"===this.opt.xclass&&this.citation.opt.suppressTrailingPunctuation&&(w=!0),e&&this.registry.citationreg.citationById[e].properties["suppress-trailing-punctuation"]&&(w=!0),"note"===this.opt.xclass){for(var E=[],S=!1,T=!1,O=[],A=0,M=t.length;A<M;A+=1){var C=t[A][0].type,k=t[A][0].title,P=t[A][1].position,R=t[A][0].id;k&&"legal_case"===C&&R!==T&&P&&(k===S&&0!==E.length||(O=[],E.push(O)),O.push(t[A][1])),S=k,P,T=R}for(A=0,M=E.length;A<M;A+=1)if(!((O=E[A]).length<2)){var L=O.slice(-1)[0].locator;if(L)for(var I=0,D=O.length-1;I<D;I+=1)O[I].locator&&(L=!1);L&&(O[0].locator=L,delete O.slice(-1)[0].locator,O[0].label=O.slice(-1)[0].label,O.slice(-1)[0].label&&delete O.slice(-1)[0].label)}}for(i=[],o=t.length,a=0;a<o;a+=1){if(d=t[a][0],s=t[a][1],s=h.parseLocator.call(this,s),u=this.tmp.have_collapsed,l={},this.tmp.shadow_numbers={},!this.tmp.just_looking&&this.opt.hasPlaceholderTerm){var N=this.output;this.output=new h.Output.Queue(this),this.output.adjust=new h.Output.Queue.adjust,h.getAmbiguousCite.call(this,d,null,!1,s),this.output=N}if(this.tmp.in_cite_predecessor=!1,a>0?h.getCite.call(this,d,s,""+t[a-1][0].id,!0):(this.tmp.term_predecessor=!1,h.getCite.call(this,d,s,null,!0)),this.tmp.cite_renders_content||(_={citationID:""+this.tmp.citation_id,index:this.tmp.citation_pos,noteIndex:this.tmp.citation_note_index,itemID:""+d.id,citationItems_pos:a,error_code:h.ERROR_NO_RENDERED_FORM},this.tmp.citation_errors.push(_)),a===t.length-1&&this.parallel.ComposeSet(),l.splice_delimiter=h.getSpliceDelimiter.call(this,u,a),s&&s["author-only"]&&(this.tmp.suppress_decorations=!0),a>0){var j=(y=t[a-1][1]).suffix&&[".",","].indexOf(y.suffix.slice(-1))>-1,U=!y.suffix&&s.prefix&&[".",","].indexOf(s.prefix.slice(0,1))>-1;if(j||U){var F=l.splice_delimiter.indexOf(" ");l.splice_delimiter=F>-1&&!U?l.splice_delimiter.slice(F):""}}l.suppress_decorations=this.tmp.suppress_decorations,l.have_collapsed=this.tmp.have_collapsed,i.push(l)}this.tmp.has_purged_parallel=!1,this.parallel.PruneOutputQueue(this),f=this.output.queue.slice();this.citation.opt.layout_suffix,this.citation.opt.layout_delimiter;var B=this.citation.opt.layout_suffix,z=this.tmp.cite_locales[this.tmp.cite_locales.length-1];z&&this.tmp.cite_affixes[this.tmp.area][z]&&this.tmp.cite_affixes[this.tmp.area][z].suffix&&(B=this.tmp.cite_affixes[this.tmp.area][z].suffix),h.TERMINAL_PUNCTUATION.slice(0,-1).indexOf(B.slice(0,1))>-1&&(B=B.slice(0,1));var G=this.citation.opt.layout_delimiter;G||(G=""),h.TERMINAL_PUNCTUATION.slice(0,-1).indexOf(G.slice(0,1))>-1&&(G=G.slice(0,1)),B=this.output.checkNestedBrace.update(B);for(A=0,M=this.output.queue.length;A<M;A+=1)h.Output.Queue.purgeEmptyBlobs(this.output.queue[A]);if(!this.tmp.suppress_decorations&&this.output.queue.length&&(this.opt.development_extensions.apply_citation_wrapper&&this.sys.wrapCitationEntry&&!this.tmp.just_looking&&"citation"===this.tmp.area||(w||(this.output.queue[this.output.queue.length-1].strings.suffix=B),this.output.queue[0].strings.prefix=x)),this.opt.development_extensions.clean_up_csl_flaws)for(I=0,D=this.output.queue.length;I<D;I+=1)this.output.adjust.upward(this.output.queue[I]),this.output.adjust.leftward(this.output.queue[I]),this.output.adjust.downward(this.output.queue[I]),this.tmp.last_chr=this.output.adjust.fix(this.output.queue[I]);for(a=0,o=f.length;a<o;a+=1){var H=[];if(this.output.queue=[f[a]],this.tmp.suppress_decorations=i[a].suppress_decorations,this.tmp.splice_delimiter=i[a].splice_delimiter,f[a].parallel_delimiter&&(this.tmp.splice_delimiter=f[a].parallel_delimiter),this.tmp.have_collapsed=i[a].have_collapsed,c=this.output.string(this,this.output.queue),this.tmp.suppress_decorations=!1,"string"==typeof c)return this.tmp.suppress_decorations=!1,c;if("object"==typeof c&&0===c.length&&!s["suppress-author"])if(this.tmp.has_purged_parallel)c.push("");else{var V=0===a?b(this.citation.opt.layout_prefix):"",W=a===f.length-1?b(this.citation.opt.layout_suffix):"";c.push(V+"[CSL STYLE ERROR: reference with no printed form.]"+W)}if(H.length&&"string"==typeof c[0]){c.reverse();var q=c.pop();q&&","===q.slice(0,1)?H.push(q):"string"==typeof H.slice(-1)[0]&&","===H.slice(-1)[0].slice(-1)?H.push(" "+q):q&&H.push(b(this.tmp.splice_delimiter)+q)}else c.reverse(),void 0!==(p=c.pop())&&(H.length&&"string"==typeof H[H.length-1]&&(H[H.length-1]+=p.successor_prefix),H.push(p));for(m=c.length,g=0;g<m;g+=1)"string"!=typeof(v=c[g])?void 0!==(p=c.pop())&&H.push(p):H.push(b(this.tmp.splice_delimiter)+v);0!==H.length||t[a][1]["suppress-author"]||1,H.length>1&&"string"!=typeof H[0]&&(H=[this.output.renderBlobs(H)]),H.length&&("string"==typeof H[0]?a>0&&(f.length-1>a&&i[a+1].have_collapsed&&!i[a].have_collapsed&&(this.tmp.splice_delimiter=i[a-1].splice_delimiter),H[0]=b(this.tmp.splice_delimiter)+H[0]):H[0].splice_prefix=a>0?this.tmp.splice_delimiter:""),r=r.concat(H)}if((n+=this.output.renderBlobs(r))&&!this.tmp.suppress_decorations)for(o=this.citation.opt.layout_decorations.length,a=0;a<o;a+=1)"normal"!==(l=this.citation.opt.layout_decorations[a])[1]&&(s&&s["author-only"]||(n=this.fun.decorate[l[0]][l[1]](this,n)));return this.tmp.suppress_decorations=!1,n},h.getCite=function(t,e,n,r){var i,o;for(this.tmp.cite_renders_content=!1,this.parallel.StartCite(t,e,n),h.citeStart.call(this,t,e,r),i=0,this.tmp.name_node={},this.nameOutput=new h.NameOutput(this,t,e);i<this[this.tmp.area].tokens.length;)i=h.tokenExec.call(this,this[this.tmp.area].tokens[i],t,e);return h.citeEnd.call(this,t,e),this.parallel.CloseCite(this),this.tmp.cite_renders_content||this.tmp.just_looking||"bibliography"===this.tmp.area&&(o={index:this.tmp.bibliography_pos,itemID:""+t.id,error_code:h.ERROR_NO_RENDERED_FORM},this.tmp.bibliography_errors.push(o)),""+t.id},h.citeStart=function(t,e,n){if(n||(this.tmp.shadow_numbers={}),this.tmp.disambiguate_count=0,this.tmp.disambiguate_maxMax=0,this.tmp.same_author_as_previous_cite=!1,this.tmp.suppress_decorations?this.tmp.subsequent_author_substitute_ok=!1:this.tmp.subsequent_author_substitute_ok=!0,this.tmp.lastchr="","citation"===this.tmp.area&&this.citation.opt.collapse&&this.citation.opt.collapse.length?this.tmp.have_collapsed=!0:this.tmp.have_collapsed=!1,this.tmp.render_seen=!1,this.tmp.disambig_request&&!this.tmp.disambig_override?this.tmp.disambig_settings=this.tmp.disambig_request:this.registry.registry[t.id]&&!this.tmp.disambig_override?(this.tmp.disambig_request=this.registry.registry[t.id].disambig,this.tmp.disambig_settings=this.registry.registry[t.id].disambig):this.tmp.disambig_settings=new h.AmbigConfig,"citation"!==this.tmp.area)if(this.registry.registry[t.id]){if(this.tmp.disambig_restore=h.cloneAmbigConfig(this.registry.registry[t.id].disambig),"bibliography"===this.tmp.area&&this.tmp.disambig_settings&&this.tmp.disambig_override&&(this.opt["disambiguate-add-names"]&&(this.tmp.disambig_settings.names=this.registry.registry[t.id].disambig.names.slice(),this.tmp.disambig_request&&(this.tmp.disambig_request.names=this.registry.registry[t.id].disambig.names.slice())),this.opt["disambiguate-add-givenname"])){this.tmp.disambig_request=this.tmp.disambig_settings,this.tmp.disambig_settings.givens=this.registry.registry[t.id].disambig.givens.slice(),this.tmp.disambig_request.givens=this.registry.registry[t.id].disambig.givens.slice();for(var r=0,i=this.tmp.disambig_settings.givens.length;r<i;r+=1)this.tmp.disambig_settings.givens[r]=this.registry.registry[t.id].disambig.givens[r].slice();for(r=0,i=this.tmp.disambig_request.givens.length;r<i;r+=1)this.tmp.disambig_request.givens[r]=this.registry.registry[t.id].disambig.givens[r].slice()}}else this.tmp.disambig_restore=new h.AmbigConfig;this.tmp.names_used=[],this.tmp.nameset_counter=0,this.tmp.years_used=[],this.tmp.names_max.clear(),this.tmp.splice_delimiter=this[this.tmp.area].opt.layout_delimiter,this.bibliography_sort.keys=[],this.citation_sort.keys=[],this.tmp.has_done_year_suffix=!1,this.tmp.last_cite_locale=!1,!this.tmp.just_looking&&e&&!e.position&&this.registry.registry[t.id]&&(this.tmp.disambig_restore=h.cloneAmbigConfig(this.registry.registry[t.id].disambig)),this.tmp.first_name_string=!1,this.tmp.authority_stop_last=0},h.citeEnd=function(t,e){if(this.tmp.disambig_restore&&this.registry.registry[t.id]){this.registry.registry[t.id].disambig.names=this.tmp.disambig_restore.names.slice(),this.registry.registry[t.id].disambig.givens=this.tmp.disambig_restore.givens.slice();for(var n=0,r=this.registry.registry[t.id].disambig.givens.length;n<r;n+=1)this.registry.registry[t.id].disambig.givens[n]=this.tmp.disambig_restore.givens[n].slice()}if(this.tmp.disambig_restore=!1,e&&e.suffix?this.tmp.last_suffix_used=e.suffix:this.tmp.last_suffix_used="",this.tmp.last_years_used=this.tmp.years_used.slice(),this.tmp.last_names_used=this.tmp.names_used.slice(),this.tmp.cut_var=!1,this.tmp.disambig_request=!1,this.tmp.cite_locales.push(this.tmp.last_cite_locale),this.tmp.issued_date&&this.tmp.renders_collection_number){var i=[];for(n=this.tmp.issued_date.list.length-1;n>this.tmp.issued_date.pos;n+=-1)i.push(this.tmp.issued_date.list.pop());for(this.tmp.issued_date.list.pop(),n=i.length-1;n>-1;n+=-1)this.tmp.issued_date.list.push(i.pop());this.parallel.use_parallels&&(this.parallel.cite.issued=!1)}this.tmp.issued_date=!1,this.tmp.renders_collection_number=!1},t.exports=h,h.Engine.prototype.makeBibliography=function(t){var e,n,r,i,o,a,s;if(!1,!this.bibliography.tokens.length)return!1;"string"==typeof t&&(this.opt.citation_number_slug=t,t=!1),a=(e=h.getBibliographyEntries.call(this,t))[0],s=e[1];var u=e[2];for(n={maxoffset:0,entryspacing:this.bibliography.opt["entry-spacing"],linespacing:this.bibliography.opt["line-spacing"],"second-field-align":!1,entry_ids:a,bibliography_errors:this.tmp.bibliography_errors.slice(),done:u},this.bibliography.opt["second-field-align"]&&(n["second-field-align"]=this.bibliography.opt["second-field-align"]),0,i=this.registry.reflist.length,o=0;o<i;o+=1)(r=this.registry.reflist[o]).offset>n.maxoffset&&(n.maxoffset=r.offset);return this.bibliography.opt.hangingindent&&(n.hangingindent=this.bibliography.opt.hangingindent),n.bibstart=this.fun.decorate.bibstart,n.bibend=this.fun.decorate.bibend,this.opt.citation_number_slug=!1,[n,s]},h.getBibliographyEntries=function(t){var e,n,r,i,o,a,s,u,l,c,p,f,d,m,g,v,y,b;function _(t,e){return t===e}function x(t,e){return!("none"!==t&&t||e)||("string"==typeof e?_(t,e):!!e&&function(t,e){for(l=e.length,c=0;c<l;c+=1)if(_(t,e[c]))return!0;return!1}(t,e))}if(e=[],y=[],this.tmp.area="bibliography",this.tmp.root="bibliography",this.tmp.last_rendered_name=!1,this.tmp.bibliography_errors=[],this.tmp.bibliography_pos=0,n=t&&t.page_start&&t.page_length?this.registry.getSortedIds():this.retrieveItems(this.registry.getSortedIds()),this.tmp.disambig_override=!0,m={},t&&t.page_start&&t.page_length&&(b=0,!0!==t.page_start))for(var w=0,E=n.length;w<E&&(m[n[w]]=!0,t.page_start!=n[w]);w+=1);var S=[];for(w=0,E=n.length;w<E;w+=1){if(t&&t.page_start&&t.page_length){if(m[n[w]])continue;if(s=this.retrieveItem(n[w]),b===t.page_length)break}else if(m[(s=n[w]).id])continue;if(t){if(r=!0,t.include){for(r=!1,O=0,A=t.include.length;O<A;O+=1)if(x((u=t.include[O]).value,s[u.field])){r=!0;break}}else if(t.exclude){for(i=!1,O=0,A=t.exclude.length;O<A;O+=1)if(x((u=t.exclude[O]).value,s[u.field])){i=!0;break}i&&(r=!1)}else if(t.select){for(r=!1,o=!0,O=0,A=t.select.length;O<A;O+=1)x((u=t.select[O]).value,s[u.field])||(o=!1);o&&(r=!0)}if(t.quash){for(o=!0,O=0,A=t.quash.length;O<A;O+=1)x((u=t.quash[O]).value,s[u.field])||(o=!1);o&&(r=!1)}if(!r)continue}if((a=new h.Token("group",h.START)).decorations=[["@bibliography","entry"]].concat(this.bibliography.opt.layout_decorations),this.output.startTag("bib_entry",a),s.system_id&&this.sys.embedBibliographyEntry?this.output.current.value().item_id=s.system_id:this.output.current.value().system_id=s.id,g=[[{id:""+s.id},s]],f=[],!this.registry.registry[s.id].master||t&&t.page_start&&t.page_length)this.registry.registry[s.id].siblings||(this.parallel.StartCitation(g),this.tmp.term_predecessor=!1,f.push(""+h.getCite.call(this,s)),t&&t.page_start&&t.page_length&&(b+=1));else{for(d=!0,this.parallel.StartCitation(g),this.output.queue[0].strings.delimiter=", ",this.tmp.term_predecessor=!1,f.push(""+h.getCite.call(this,s)),m[s.id]=!0,O=0,A=this.registry.registry[s.id].siblings.length;O<A;O+=1){var T=this.registry.registry[s.id].siblings[O];v=this.retrieveItem(T),f.push(""+h.getCite.call(this,v)),m[v.id]=!0}this.parallel.ComposeSet(),this.parallel.PruneOutputQueue()}y.push(""),this.tmp.bibliography_pos+=1,S.push(f),this.output.endTag("bib_entry"),this.output.queue[0].blobs.length&&this.output.queue[0].blobs[0].blobs.length&&(d||!this.output.queue[0].blobs[0].blobs[0].strings?(p=this.output.queue[0].blobs,d=!1):p=this.output.queue[0].blobs[0].blobs,p[0].strings.prefix=this.bibliography.opt.layout_prefix+p[0].strings.prefix);for(var O=0,A=this.output.queue.length;O<A;O+=1)h.Output.Queue.purgeEmptyBlobs(this.output.queue[O]);for(O=0,A=this.output.queue.length;O<A;O+=1)this.output.adjust.upward(this.output.queue[O]),this.output.adjust.leftward(this.output.queue[O]),this.output.adjust.downward(this.output.queue[O],!0),this.output.adjust.fix(this.output.queue[O]);var M;if(!(M=this.output.string(this,this.output.queue)[0])&&this.opt.update_mode===h.NUMERIC){var C=e.length+1+". [CSL STYLE ERROR: reference with no printed form.]";M=h.Output.Formats[this.opt.mode]["@bibliography/entry"](this,C)}M&&e.push(M)}var k=!1;if(t&&t.page_start&&t.page_length){var P=n.slice(-1)[0],R=S.slice(-1)[0];P&&R&&P!=R||(k=!0)}return this.tmp.disambig_override=!1,[S,e,k]},t.exports=h,h.Engine.prototype.setCitationId=function(t,e){var n,r,i;if(n=!1,!t.citationID||e){for(r=Math.floor(1e14*Math.random());;){if(i=0,!this.registry.citationreg.citationById[r]){t.citationID="a"+r.toString(32);break}r+=1===(i=!i&&r<5e13?1:-1)?1:-1}n=""+r}return this.registry.citationreg.citationById[t.citationID]=t,n},t.exports=h,h.Engine.prototype.rebuildProcessorState=function(t,e,n){t||(t=[]),e||(e="html");for(var r={},i=[],o=0,a=t.length;o<a;o+=1)for(var s=0,u=t[o].citationItems.length;s<u;s+=1){var l=""+t[o].citationItems[s].id;r[l]||i.push(l),r[l]=!0}this.updateItems(i);var c=[],p=[],f=[],d=this.opt.mode;this.setOutputFormat(e);for(o=0,a=t.length;o<a;o+=1){var m=this.processCitationCluster(t[o],c,p,h.ASSUME_ALL_ITEMS_REGISTERED);c.push([t[o].citationID,t[o].properties.noteIndex]);for(s=0,u=m[1].length;s<u;s+=1){var g=m[1][s][0];f[g]=[c[g][0],c[g][1],m[1][s][1]]}}return this.updateUncitedItems(n),this.setOutputFormat(d),f},h.Engine.prototype.restoreProcessorState=function(t){var e,n,r,i,o,a,s,u,l,c;u=[],l=[],t||(t=[]);var p=[],f={};for(e=0,n=t.length;e<n;e+=1)f[t[e].citationID]&&this.setCitationId(t[e],!0),f[t[e].citationID]=!0,p.push(t[e].properties.index);var d=t.slice();for(d.sort(function(t,e){return t.properties.index<e.properties.index?-1:t.properties.index>e.properties.index?1:0}),e=0,n=d.length;e<n;e+=1)d[e].properties.index=e;for(e=0,n=d.length;e<n;e+=1){for(c=[],r=0,i=d[e].citationItems.length;r<i;r+=1)void 0===(o=d[e].citationItems[r]).sortkeys&&(o.sortkeys=[]),s=[a=this.retrieveItem(""+o.id),o],c.push(s),d[e].citationItems[r].item=a,l.push(""+o.id);d[e].properties.unsorted||c.sort(this.citation.srt.compareCompositeKeys),d[e].sortedItems=c,this.registry.citationreg.citationById[d[e].citationID]=d[e]}for(this.updateItems(l),e=0,n=t.length;e<n;e+=1)u.push([""+t[e].citationID,t[e].properties.noteIndex]);var m=[];return t&&t.length?m=this.processCitationCluster(t[0],[],u.slice(1)):(this.registry=new h.Registry(this),this.tmp=new h.Engine.Tmp,this.disambiguate=new h.Disambiguation(this)),m},h.Engine.prototype.updateItems=function(t,e,n,r){var i=this.tmp.area,o=this.tmp.root,a=this.tmp.extension;if(this.tmp.area="citation",this.tmp.root="citation",this.tmp.extension="",r||(this.tmp.loadedItemIDs={}),this.registry.init(t),n)for(var s in this.registry.ambigcites)this.registry.ambigsTouched[s]=!0;return this.registry.dodeletes(this.registry.myhash),this.registry.doinserts(this.registry.mylist),this.registry.dorefreshes(),this.registry.rebuildlist(),this.registry.setsortkeys(),this.registry.setdisambigs(),e||this.registry.sorttokens(),this.registry.renumber(),this.tmp.extension=a,this.tmp.area=i,this.tmp.root=o,this.registry.getSortedIds()},h.Engine.prototype.updateUncitedItems=function(t,e){var n=this.tmp.area,r=this.tmp.root,i=this.tmp.extension;if(this.tmp.area="citation",this.tmp.root="citation",this.tmp.extension="",this.tmp.loadedItemIDs={},t||(t=[]),"object"==typeof t)if(void 0===t.length){var o=t;t=[];for(var a in o)t.push(a)}else if("number"==typeof t.length){o={};for(var s=0,u=t.length;s<u;s+=1)o[t[s]]=!0}return this.registry.init(t,!0),this.registry.dopurge(o),this.registry.doinserts(this.registry.mylist),this.registry.dorefreshes(),this.registry.rebuildlist(),this.registry.setsortkeys(),this.registry.setdisambigs(),e||this.registry.sorttokens(),this.registry.renumber(),this.tmp.extension=i,this.tmp.area=n,this.tmp.root=r,this.registry.getSortedIds()},t.exports=h,h.localeResolve=function(t,e){var n,r;return e||(e="en-US"),t||(t=e),n={},r=t.split(/[\-_]/),n.base=h.LANG_BASES[r[0]],void 0===n.base?{base:e,best:t,bare:r[0]}:(1===r.length&&(n.generic=!0),1===r.length||"x"===r[1]?n.best=n.base.replace("_","-"):n.best=r.slice(0,2).join("-"),n.base=n.base.replace("_","-"),n.bare=r[0],n)},h.Engine.prototype.localeConfigure=function(t,e){var n;if((!e||!this.locale[t.best])&&("en-US"===t.best?(n=h.setupXml(this.sys.retrieveLocale("en-US")),this.localeSet(n,"en-US",t.best)):"en-US"!==t.best&&(t.base!==t.best&&(n=h.setupXml(this.sys.retrieveLocale(t.base)),this.localeSet(n,t.base,t.best)),n=h.setupXml(this.sys.retrieveLocale(t.best)),this.localeSet(n,t.best,t.best)),this.localeSet(this.cslXml,"",t.best),this.localeSet(this.cslXml,t.bare,t.best),t.base!==t.best&&this.localeSet(this.cslXml,t.base,t.best),this.localeSet(this.cslXml,t.best,t.best),void 0===this.locale[t.best].terms["page-range-delimiter"]&&(["fr","pt"].indexOf(t.best.slice(0,2).toLowerCase())>-1?this.locale[t.best].terms["page-range-delimiter"]="-":this.locale[t.best].terms["page-range-delimiter"]="–"),void 0===this.locale[t.best].terms["year-range-delimiter"]&&(this.locale[t.best].terms["year-range-delimiter"]="–"),void 0===this.locale[t.best].terms["citation-range-delimiter"]&&(this.locale[t.best].terms["citation-range-delimiter"]="–"),this.opt.development_extensions.normalize_lang_keys_to_lowercase)){for(var r=["default-locale","locale-sort","locale-translit","locale-translat"],i=0,o=r.length;i<o;i+=1)for(var a=0,s=this.opt[r[i]].length;a<s;a+=1)this.opt[r[i]][a]=this.opt[r[i]][a].toLowerCase();this.opt.lang=this.opt.lang.toLowerCase()}},h.Engine.prototype.localeSet=function(t,e,n){var r,i,o,a,s,u,l,c,p,f,d,m;if(e=e.replace("_","-"),n=n.replace("_","-"),this.opt.development_extensions.normalize_lang_keys_to_lowercase&&(e=e.toLowerCase(),n=n.toLowerCase()),this.locale[n]||(this.locale[n]={},this.locale[n].terms={},this.locale[n].opts={},this.locale[n].opts["skip-words"]=h.SKIP_WORDS,this.locale[n].opts["leading-noise-words"]||(this.locale[n].opts["leading-noise-words"]=[]),this.locale[n].dates={},this.locale[n].ord={"1.0.1":!1,keys:{}},this.locale[n]["noun-genders"]={}),i=t.makeXml(),t.nodeNameIs(t.dataObj,"locale"))i=t.dataObj;else for(o=t.getNodesByName(t.dataObj,"locale"),s=0,d=t.numberofnodes(o);s<d;s+=1)if(r=o[s],t.getAttributeValue(r,"lang","xml")===e){i=r;break}for(o=t.getNodesByName(i,"type"),L=0,I=t.numberofnodes(o);L<I;L+=1){var g=o[L],v=t.getAttributeValue(g,"name"),y=t.getAttributeValue(g,"gender");this.opt.gender[v]=y}if(t.getNodesByName(i,"term","ordinal").length){for(var b in this.locale[n].ord.keys)delete this.locale[n].terms[b];this.locale[n].ord={"1.0.1":!1,keys:{}}}o=t.getNodesByName(i,"term");var _={"last-digit":{},"last-two-digits":{},"whole-number":{}},x=!1,w={};for(s=0,d=t.numberofnodes(o);s<d;s+=1){if(u=o[s],"sub verbo"===(c=t.getAttributeValue(u,"name"))&&(c="sub-verbo"),"ordinal"===c.slice(0,7)){t.getNodeValue(u);if("ordinal"===c)x=!0;else{var E,S=t.getAttributeValue(u,"match"),T=c.slice(8);(E=t.getAttributeValue(u,"gender-form"))||(E="neuter"),S||(S="last-two-digits","0"===T.slice(0,1)&&(S="last-digit")),"0"===T.slice(0,1)&&(T=T.slice(1)),_[S][T]||(_[S][T]={}),_[S][T][E]=c}this.locale[n].ord.keys[c]=!0}void 0===this.locale[n].terms[c]&&(this.locale[n].terms[c]={}),l="long",E=!1,t.getAttributeValue(u,"form")&&(l=t.getAttributeValue(u,"form")),t.getAttributeValue(u,"gender-form")&&(E=t.getAttributeValue(u,"gender-form")),t.getAttributeValue(u,"gender")&&(this.locale[n]["noun-genders"][c]=t.getAttributeValue(u,"gender")),E?(this.locale[n].terms[c][E]={},this.locale[n].terms[c][E][l]=[],m=this.locale[n].terms[c][E],w[c]=!0):(this.locale[n].terms[c][l]=[],m=this.locale[n].terms[c]),t.numberofnodes(t.getNodesByName(u,"multiple"))?(m[l][0]=t.getNodeValue(u,"single"),m[l][0].indexOf("%s")>-1&&(this.opt.hasPlaceholderTerm=!0),m[l][1]=t.getNodeValue(u,"multiple"),m[l][1].indexOf("%s")>-1&&(this.opt.hasPlaceholderTerm=!0)):(m[l]=t.getNodeValue(u),m[l].indexOf("%s")>-1&&(this.opt.hasPlaceholderTerm=!0))}if(x){for(var O in w){var A={},M=0;for(var C in this.locale[n].terms[O])["masculine","feminine"].indexOf(C)>-1?A[C]=this.locale[n].terms[O][C]:M+=1;if(!M)if(A.feminine)for(var C in A.feminine)this.locale[n].terms[O][C]=A.feminine[C];else if(A.masculine)for(var C in A.masculine)this.locale[n].terms[O][C]=A.masculine[C]}this.locale[n].ord["1.0.1"]=_}for(c in this.locale[n].terms)for(L=0,I=2;L<I;L+=1)if(E=h.GENDERS[L],this.locale[n].terms[c][E])for(l in this.locale[n].terms[c])this.locale[n].terms[c][E][l]||(this.locale[n].terms[c][E][l]=this.locale[n].terms[c][l]);for(o=t.getNodesByName(i,"style-options"),s=0,d=t.numberofnodes(o);s<d;s+=1){p=o[s],a=t.attributes(p);for(f in a)if(a.hasOwnProperty(f))if("@punctuation-in-quote"===f||"@limit-day-ordinals-to-day-1"===f)"true"===a[f]?this.locale[n].opts[f.slice(1)]=!0:this.locale[n].opts[f.slice(1)]=!1;else if("@jurisdiction-preference"===f){var k=a[f].split(/\s*,\s*/);this.locale[n].opts[f.slice(1)]=k}else if("@skip-words"===f){var P=a[f].split(/\s*,\s*/);this.locale[n].opts[f.slice(1)]=P}else if("@leading-noise-words"===f){var R=a[f].split(/\s*,\s*/);this.locale[n].opts["leading-noise-words"]=R}else if("@name-as-sort-order"===f){this.locale[n].opts["name-as-sort-order"]={};for(var L=0,I=(D=a[f].split(/\s+/)).length;L<I;L+=1)this.locale[n].opts["name-as-sort-order"][D[L]]=!0}else if("@name-as-reverse-order"===f){this.locale[n].opts["name-as-reverse-order"]={};for(L=0,I=(D=a[f].split(/\s+/)).length;L<I;L+=1)this.locale[n].opts["name-as-reverse-order"][D[L]]=!0}else if("@name-never-short"===f){this.locale[n].opts["name-never-short"]={};var D;for(L=0,I=(D=a[f].split(/\s+/)).length;L<I;L+=1)this.locale[n].opts["name-never-short"][D[L]]=!0}}for(o=t.getNodesByName(i,"date"),s=0,d=t.numberofnodes(o);s<d;s+=1){var N=o[s];this.locale[n].dates[t.getAttributeValue(N,"form")]=N}},t.exports=h,h.getLocaleNames=function(t,e){var n=h.setupXml(t);function r(t,e){var n=["base","best"];if(e){normalizedLocale=h.localeResolve(e);for(var r=0,i=n.length;r<i;r++)normalizedLocale[n[r]]&&-1===t.indexOf(normalizedLocale[n[r]])&&t.push(normalizedLocale[n[r]])}}function i(t){for(var e=n.getNodesByName(n.dataObj,t),r=0,i=e.length;r<i;r++){var a=n.getAttributeValue(e[r],"locale");if(a)for(var s=0,u=(a=a.split(/ +/)).length;s<u;s++)this.extendLocaleList(o,a[s])}}var o=["en-US"];r(o,e);var a=n.getNodesByName(n.dataObj,"style")[0],s=n.getAttributeValue(a,"default-locale");r(o,s);for(var u=["layout","if","else-if","condition"],l=0,c=u.length;l<c;l++)i(n);return o},t.exports=h,h.Node={},h.Node.bibliography={build:function(t,e){if(this.tokentype===h.START){t.build.area="bibliography",t.build.root="bibliography",t.build.extension="";this.execs.push(function(t,e){t.tmp.area="bibliography",t.tmp.root="bibliography",t.tmp.extension=""})}e.push(this)}},t.exports=h,h.Node.choose={build:function(t,e){var n;this.tokentype===h.START&&(n=function(t,e){t.tmp.jump.push(void 0,h.LITERAL)}),this.tokentype===h.END&&(n=function(t,e){t.tmp.jump.pop()}),this.execs.push(n),e.push(this)},configure:function(t,e){this.tokentype===h.END?(t.configure.fail.push(e),t.configure.succeed.push(e)):(t.configure.fail.pop(),t.configure.succeed.pop())}},t.exports=h,h.Node.citation={build:function(t,e){if(this.tokentype===h.START){t.build.area="citation",t.build.root="citation",t.build.extension="";this.execs.push(function(t,e){t.tmp.area="citation",t.tmp.root="citation",t.tmp.extension=""})}if(this.tokentype===h.END){if(t.opt.grouped_sort="in-text"===t.opt.xclass&&t.citation.opt.collapse&&t.citation.opt.collapse.length||t.citation.opt.cite_group_delimiter&&t.citation.opt.cite_group_delimiter.length&&t.opt.update_mode!==h.POSITION&&t.opt.update_mode!==h.NUMERIC,t.opt.grouped_sort&&t.citation_sort.opt.sort_directions.length){var n=t.citation_sort.opt.sort_directions[0].slice();t.citation_sort.opt.sort_directions=[n].concat(t.citation_sort.opt.sort_directions)}t.citation.srt=new h.Registry.Comparifier(t,"citation_sort")}e.push(this)}},t.exports=h,h.Node["#comment"]={build:function(t,e){}},t.exports=h,h.Node.date={build:function(t,e){var n,r,i,o,a,s,u,l,c,p;this.tokentype!==h.START&&this.tokentype!==h.SINGLETON||(t.build.date_parts=[],t.build.date_variables=this.variables,t.build.extension||h.Util.substituteStart.call(this,t,e),n=t.build.extension?h.dateMacroAsSortKey:function(t,e,n){var h;if(t.tmp.element_rendered_ok=!1,t.tmp.donesies=[],t.tmp.dateparts=[],h=[],!this.variables.length||t.tmp.just_looking&&"accessed"===this.variables[0])t.tmp.date_object=!1;else{for(void 0===(r=e[this.variables[0]])&&(r={"date-parts":[[0]]},t.opt.development_extensions.locator_date_and_revision&&n&&"locator-date"===this.variables[0]&&n["locator-date"]&&(r=n["locator-date"])),t.tmp.date_object=r,i=this.dateparts.length,o=0;o<i;o+=1)a=this.dateparts[o],void 0!==t.tmp.date_object[a+"_end"]?h.push(a):"month"===a&&void 0!==t.tmp.date_object.season_end&&h.push(a);for(s=[],i=(u=["year","month","day"]).length,o=0;o<i;o+=1)h.indexOf(u[o])>-1&&s.push(u[o]);for(h=s.slice(),l=2,i=h.length,o=0;o<i;o+=1)if(a=h[o],c=t.tmp.date_object[a],p=t.tmp.date_object[a+"_end"],c!==p){l=o;break}t.tmp.date_collapse_at=h.slice(l)}},this.execs.push(n),n=function(t,e){if(e[this.variables[0]]&&(t.parallel.StartVariable(this.variables[0]),t.output.startTag("date",this),"issued"===this.variables[0]&&"legal_case"===e.type&&!t.tmp.extension&&""+e["collection-number"]==""+t.tmp.date_object.year&&1===this.dateparts.length&&"year"===this.dateparts[0]))for(var n in t.tmp.date_object)if(t.tmp.date_object.hasOwnProperty(n)&&"year"===n.slice(0,4)){t.tmp.issued_date={};var r=t.output.current.mystack.slice(-2)[0].blobs;t.tmp.issued_date.list=r,t.tmp.issued_date.pos=r.length-1}},this.execs.push(n)),t.build.extension||this.tokentype!==h.END&&this.tokentype!==h.SINGLETON||(n=function(t,e){e[this.variables[0]]&&(t.output.endTag(),t.parallel.CloseVariable(this.variables[0]))},this.execs.push(n)),e.push(this),this.tokentype!==h.END&&this.tokentype!==h.SINGLETON||t.build.extension||h.Util.substituteEnd.call(this,t,e)}},t.exports=h,h.Node["date-part"]={build:function(t,e){var n,r,i,o,a,s,u,l,c,p,f,d,m,g,v,y,b,_,x;this.strings.form||(this.strings.form="long"),t.build.date_parts.push(this.strings.name);var w=t.build.date_variables[0];n=function(t,e){if(t.tmp.date_object){if(o=!0,a="",s="",t.tmp.donesies.push(this.strings.name),t.tmp.date_object.literal&&"year"===this.strings.name&&(t.parallel.AppendToVariable(t.tmp.date_object.literal),t.output.append(t.tmp.date_object.literal,this)),t.tmp.date_object&&(a=t.tmp.date_object[this.strings.name],s=t.tmp.date_object[this.strings.name+"_end"]),"year"!==this.strings.name||0!==a||t.tmp.suppress_decorations||(a=!1),u=!t.tmp.suppress_decorations,l=t.tmp.have_collapsed,c="year-suffix"===t[t.tmp.area].opt.collapse||"year-suffix-ranged"===t[t.tmp.area].opt.collapse,p=t.opt["disambiguate-add-year-suffix"],u&&p&&c&&(t.tmp.years_used.push(a),t.tmp.last_years_used.length>=t.tmp.years_used.length&&l&&t.tmp.last_years_used[t.tmp.years_used.length-1]===a&&(a=!1)),void 0!==a){f=!1,d=!1,!1,!1,"year"===this.strings.name&&(parseInt(a,10)<500&&parseInt(a,10)>0&&(d=t.getTerm("ad")),parseInt(a,10)<0&&(f=t.getTerm("bc"),a=-1*parseInt(a,10)),s&&(parseInt(s,10)<500&&parseInt(s,10)>0&&t.getTerm("ad"),parseInt(s,10)<0&&(t.getTerm("bc"),s=-1*parseInt(s,10)))),t.parallel.AppendToVariable(a);for(var n=""+t.tmp.date_object.month;n.length<2;)n="0"+n;n="month-"+n;var E=t.locale[t.opt.lang]["noun-genders"][n];if(this.strings.form){var S=this.strings.form;if("day"===this.strings.name&&"ordinal"===S&&t.locale[t.opt.lang].opts["limit-day-ordinals-to-day-1"]&&""+a!="1"&&(S="numeric"),a=h.Util.Dates[this.strings.name][S](t,a,E,this.default_locale),"month"===this.strings.name)if(t.tmp.strip_periods)a=a.replace(/\./g,"");else for(var T=0,O=this.decorations.length;T<O;T+=1)if("@strip-periods"===this.decorations[T][0]&&"true"===this.decorations[T][1]){a=a.replace(/\./g,"");break}if(s)if(s=h.Util.Dates[this.strings.name][S](t,s,E,"accessed"===w,"_end"),t.tmp.strip_periods)s=s.replace(/\./g,"");else for(T=0,O=this.decorations.length;T<O;T+=1)if("@strip-periods"===this.decorations[T][0]&&"true"===this.decorations[T][1]){s=s.replace(/\./g,"");break}}if(t.output.openLevel("empty"),t.tmp.date_collapse_at.length){for(m=!0,i=t.tmp.date_collapse_at.length,r=0;r<i;r+=1)if(x=t.tmp.date_collapse_at[r],-1===t.tmp.donesies.indexOf(x)){m=!1;break}if(m){if(""+s!="0"){if(0===t.dateput.queue.length&&(o=!0),t.opt["year-range-format"]&&"expanded"!==t.opt["year-range-format"]&&!t.tmp.date_object.day&&!t.tmp.date_object.month&&!t.tmp.date_object.season&&"year"===this.strings.name&&a&&s){s=t.fun.year_mangler(a+"-"+s,!0);var A=t.getTerm("year-range-delimiter");s=s.slice(s.indexOf(A)+1)}t.dateput.append(s,this),o&&(t.dateput.current.value()[0].strings.prefix="")}t.output.append(a,this),(g=t.output.current.value()).blobs[g.blobs.length-1].strings.suffix="",t.output.append(t.getTerm("year-range-delimiter"),"empty"),v=t.dateput.current.value(),g.blobs=g.blobs.concat(v),t.dateput.string(t,t.dateput.queue),t.tmp.date_collapse_at=[]}else t.output.append(a,this),t.tmp.date_collapse_at.indexOf(this.strings.name)>-1&&""+s!="0"&&(0===t.dateput.queue.length&&(o=!0),t.dateput.openLevel("empty"),t.dateput.append(s,this),o&&(t.dateput.current.value().blobs[0].strings.prefix=""),f&&t.dateput.append(f),d&&t.dateput.append(d),t.dateput.closeLevel())}else t.output.append(a,this);f&&t.output.append(f),d&&t.output.append(d),t.output.closeLevel()}else"month"===this.strings.name&&t.tmp.date_object.season&&((a=""+t.tmp.date_object.season)&&a.match(/^[1-4]$/)?(t.tmp.group_context.tip.variable_success=!0,t.output.append(t.getTerm("season-0"+a),this)):a&&t.output.append(a,this));t.tmp.value=[],!e[w]||!a&&!t.tmp.have_collapsed||t.opt.has_year_suffix||"year"!==this.strings.name||t.tmp.just_looking||t.registry.registry[e.id]&&!1!==t.registry.registry[e.id].disambig.year_suffix&&!t.tmp.has_done_year_suffix&&(t.tmp.has_done_year_suffix=!0,b=parseInt(t.registry.registry[e.id].disambig.year_suffix,10),y=new h.NumericBlob(!1,b,this,e.id),this.successor_prefix=t[t.build.area].opt.layout_delimiter,this.splice_prefix=t[t.build.area].opt.layout_delimiter,_=new h.Util.Suffixator(h.SUFFIX_CHARS),y.setFormatter(_),"year-suffix-ranged"===t[t.tmp.area].opt.collapse&&(y.range_prefix=t.getTerm("citation-range-delimiter")),t[t.tmp.area].opt.cite_group_delimiter?y.successor_prefix=t[t.tmp.area].opt.cite_group_delimiter:t[t.tmp.area].opt["year-suffix-delimiter"]?y.successor_prefix=t[t.tmp.area].opt["year-suffix-delimiter"]:y.successor_prefix=t[t.tmp.area].opt.layout_delimiter,y.UGLY_DELIMITER_SUPPRESS_HACK=!0,t.output.append(y,"literal"))}},this.execs.push(n),e.push(this)}},t.exports=h,h.Node["else-if"]={build:function(t,e){h.Conditions.TopNode.call(this,t,e),e.push(this)},configure:function(t,e){h.Conditions.Configure.call(this,t,e)}},t.exports=h,h.Node.else={build:function(t,e){e.push(this)},configure:function(t,e){this.tokentype===h.START&&(t.configure.fail[t.configure.fail.length-1]=e)}},t.exports=h,h.Node["et-al"]={build:function(t,e){if("citation"===t.build.area||"bibliography"===t.build.area){this.execs.push(function(t,e,n){t.tmp.etal_node=this,"string"==typeof this.strings.term&&(t.tmp.etal_term=this.strings.term)})}e.push(this)}},t.exports=h,h.Node.group={build:function(t,e,n){var r,i,o;if(this.realGroup=n,this.tokentype===h.START&&(h.Util.substituteStart.call(this,t,e),t.build.substitute_level.value()&&t.build.substitute_level.replace(t.build.substitute_level.value()+1),this.juris||e.push(this),(i=[]).push(r=function(t,e){if(t.output.startTag("group",this),this.strings.label_form_override&&(t.tmp.group_context.tip.label_form||(t.tmp.group_context.tip.label_form=this.strings.label_form_override)),this.realGroup){var n=!1,r=!1;t.tmp.group_context.mystack.length&&(t.output.current.value().parent=t.tmp.group_context.tip.output_tip);var i=t.tmp.group_context.tip.label_form;i||(i=this.strings.label_form_override),t.tmp.group_context.tip.condition?(n=t.tmp.group_context.tip.condition,r=t.tmp.group_context.tip.force_suppress):this.strings.reject?(n={test:this.strings.reject,not:!0},r=!0,[]):this.strings.require&&(n={test:this.strings.require,not:!1},[]),t.tmp.group_context.push({term_intended:!1,variable_attempt:!1,variable_success:!1,variable_success_parent:t.tmp.group_context.tip.variable_success,output_tip:t.output.current.tip,label_form:i,parallel_conditions:this.strings.set_parallel_condition,condition:n,force_suppress:r,done_vars:t.tmp.group_context.tip.done_vars.slice()})}}),this.execs=i.concat(this.execs),this.strings["has-publisher-and-publisher-place"]&&(t.build["publisher-special"]=!0,r=function(t,e){if(this.strings["subgroup-delimiter"]&&e.publisher&&e["publisher-place"]){var n=e.publisher.split(/;\s*/),r=e["publisher-place"].split(/;\s*/);n.length>1&&n.length===r.length&&(t.publisherOutput=new h.PublisherOutput(t,this),t.publisherOutput["publisher-list"]=n,t.publisherOutput["publisher-place-list"]=r)}},this.execs.push(r)),this.juris)){for(var a=0,s=e.length;a<s;a++)e[a];var u=new h.Token("choose",h.START);h.Node.choose.build.call(u,t,e);var l=new h.Token("if",h.START);o=this.juris,r=function(e){if(!t.sys.retrieveStyleModule||!h.MODULE_MACROS[o]||!e.jurisdiction)return!1;var n=t.getJurisdictionList(e.jurisdiction);if(!t.opt.jurisdictions_seen[n[0]]){var r=t.retrieveAllStyleModules(n);for(var i in r){t.juris[i]={};for(var a=h.setupXml(r[i]),s=0,u=(f=a.getNodesByName(a.dataObj,"law-module")).length;s<u;s++){var l=a.getAttributeValue(f[s],"types");if(l){t.juris[i].types={};for(var c=0,p=(l=l.split(/\s+/)).length;c<p;c++)t.juris[i].types[l[c]]=!0}}var f;for(t.juris[i].types||(t.juris[i].types=h.MODULE_TYPES),s=0,u=(f=a.getNodesByName(a.dataObj,"macro")).length;s<u;s++){var d=a.getAttributeValue(f[s],"name");h.MODULE_MACROS[d]?(t.juris[i][d]=[],t.buildTokenLists(f[s],t.juris[i][d]),t.configureTokenList(t.juris[i][d])):h.debug('CSL: skipping non-modular macro name "'+d+'" in module context')}}}for(s=0,u=n.length;s<u;s++)if(i=n[s],t.juris[i]&&t.juris[i].types[e.type])return e["best-jurisdiction"]=i,!0;return!1},l.tests.push(r),l.test=t.fun.match.any(l,t,l.tests),e.push(l);var c=new h.Token("text",h.SINGLETON);r=function(t,e,n){var r=0;if(t.juris[e["best-jurisdiction"]][this.juris])for(;r<t.juris[e["best-jurisdiction"]][this.juris].length;)r=h.tokenExec.call(t,t.juris[e["best-jurisdiction"]][this.juris][r],e,n)},c.juris=this.juris,c.execs.push(r),e.push(c);var p=new h.Token("if",h.END);h.Node.if.build.call(p,t,e);var f=new h.Token("else",h.START);h.Node.else.build.call(f,t,e)}if(this.tokentype===h.END&&(t.build["publisher-special"]&&(t.build["publisher-special"]=!1,"string"==typeof t[t.build.root].opt["name-delimiter"]&&(r=function(t,e){t.publisherOutput&&(t.publisherOutput.render(),t.publisherOutput=!1)},this.execs.push(r))),r=function(t,e){if(t.output.endTag(),this.realGroup){var n=t.tmp.group_context.pop();if(t.tmp.group_context.tip.condition&&(t.tmp.group_context.tip.force_suppress=n.force_suppress),!n.force_suppress&&(n.variable_success||n.term_intended&&!n.variable_attempt)){this.isJurisLocatorLabel||(t.tmp.group_context.tip.variable_success=!0);var r=t.output.current.value().blobs,i=t.output.current.value().blobs.length-1;if(!t.tmp.just_looking&&void 0!==n.parallel_conditions){var o={blobs:r,conditions:n.parallel_conditions,id:e.id,pos:i};t.parallel.parallel_conditional_blobs_list.push(o)}}else{if(t.tmp.group_context.tip.variable_attempt=n.variable_attempt,n.force_suppress&&!t.tmp.group_context.tip.condition){t.tmp.group_context.tip.variable_attempt=!0,t.tmp.group_context.tip.variable_success=n.variable_success_parent;for(var a=0,s=n.done_vars.length;a<s;a++)t.tmp.done_vars.indexOf(n.done_vars[a])>-1&&(t.tmp.done_vars=t.tmp.done_vars.slice(0,a).concat(t.tmp.done_vars.slice(a+1)))}t.output.current.value().blobs&&t.output.current.value().blobs.pop()}}},this.execs.push(r),this.juris)){var d=new h.Token("else",h.END);h.Node.else.build.call(d,t,e);var m=new h.Token("choose",h.END);h.Node.choose.build.call(m,t,e)}this.tokentype===h.END&&(this.juris||e.push(this),t.build.substitute_level.value()&&t.build.substitute_level.replace(t.build.substitute_level.value()-1),h.Util.substituteEnd.call(this,t,e))}},t.exports=h,h.Node.if={build:function(t,e){h.Conditions.TopNode.call(this,t,e),e.push(this)},configure:function(t,e){h.Conditions.Configure.call(this,t,e)}},t.exports=h,h.Node.conditions={build:function(t,e){this.tokentype===h.START&&t.tmp.conditions.addMatch(this.match),this.tokentype===h.END&&t.tmp.conditions.matchCombine()}},t.exports=h,h.Node.condition={build:function(t,e){if(this.tokentype===h.SINGLETON){var n=t.fun.match[this.match](this,t,this.tests);t.tmp.conditions.addTest(n)}}},t.exports=h,h.Conditions={},h.Conditions.TopNode=function(t,e){var n;this.tokentype!==h.START&&this.tokentype!==h.SINGLETON||(this.locale&&(t.opt.lang=this.locale),this.tests&&this.tests.length?this.test=t.fun.match[this.match](this,t,this.tests):t.tmp.conditions=new h.Conditions.Engine(t,this)),this.tokentype!==h.END&&this.tokentype!==h.SINGLETON||(n=function(t,e){return this.locale_default&&(t.output.current.value().old_locale=this.locale_default,t.output.closeLevel("empty"),t.opt.lang=this.locale_default),this[t.tmp.jump.value()]},this.execs.push(n),this.locale_default&&(t.opt.lang=this.locale_default))},h.Conditions.Configure=function(t,e){this.tokentype===h.START?(this.fail=t.configure.fail.slice(-1)[0],this.succeed=this.next,t.configure.fail[t.configure.fail.length-1]=e):this.tokentype===h.SINGLETON?(this.fail=this.next,this.succeed=t.configure.succeed.slice(-1)[0],t.configure.fail[t.configure.fail.length-1]=e):(this.succeed=t.configure.succeed.slice(-1)[0],this.fail=this.next)},h.Conditions.Engine=function(t,e){this.token=e,this.state=t},h.Conditions.Engine.prototype.addTest=function(t){this.token.tests.push(t)},h.Conditions.Engine.prototype.addMatch=function(t){this.token.match=t},h.Conditions.Engine.prototype.matchCombine=function(){this.token.test=this.state.fun.match[this.token.match](this.token,this.state,this.token.tests)},t.exports=h,h.Node.info={build:function(t,e){this.tokentype===h.START?t.build.skip="info":t.build.skip=!1}},t.exports=h,h.Node.institution={build:function(t,e){if([h.SINGLETON,h.START].indexOf(this.tokentype)>-1){this.execs.push(function(t,e){"string"==typeof this.strings.delimiter?t.tmp.institution_delimiter=this.strings.delimiter:t.tmp.institution_delimiter=t.tmp.name_delimiter,"text"===t.inheritOpt(this,"and")?this.and_term=t.getTerm("and","long",0):"symbol"===t.inheritOpt(this,"and")?t.opt.development_extensions.expect_and_symbol_form?this.and_term=t.getTerm("and","symbol",0):this.and_term="&":"none"===t.inheritOpt(this,"and")&&(this.and_term=t.tmp.institution_delimiter),void 0===this.and_term&&t.tmp.and_term&&(this.and_term=t.getTerm("and","long",0)),h.STARTSWITH_ROMANESQUE_REGEXP.test(this.and_term)?(this.and_prefix_single=" ",this.and_prefix_multiple=", ","string"==typeof t.tmp.institution_delimiter&&(this.and_prefix_multiple=t.tmp.institution_delimiter),this.and_suffix=" "):(this.and_prefix_single="",this.and_prefix_multiple="",this.and_suffix=""),"always"===t.inheritOpt(this,"delimiter-precedes-last")?this.and_prefix_single=t.tmp.institution_delimiter:"never"===t.inheritOpt(this,"delimiter-precedes-last")&&this.and_prefix_multiple&&(this.and_prefix_multiple=" "),this.and={},void 0!==this.and_term?(t.output.append(this.and_term,"empty",!0),this.and.single=t.output.pop(),this.and.single.strings.prefix=this.and_prefix_single,this.and.single.strings.suffix=this.and_suffix,t.output.append(this.and_term,"empty",!0),this.and.multiple=t.output.pop(),this.and.multiple.strings.prefix=this.and_prefix_multiple,this.and.multiple.strings.suffix=this.and_suffix):"undefined"!==this.strings.delimiter&&(this.and.single=new h.Blob(t.tmp.institution_delimiter),this.and.single.strings.prefix="",this.and.single.strings.suffix="",this.and.multiple=new h.Blob(t.tmp.institution_delimiter),this.and.multiple.strings.prefix="",this.and.multiple.strings.suffix=""),t.nameOutput.institution=this})}e.push(this)},configure:function(t,e){[h.SINGLETON,h.START].indexOf(this.tokentype)>-1&&(t.build.has_institution=!0)}},t.exports=h,h.Node["institution-part"]={build:function(t,e){var n;"long"===this.strings.name?n=this.strings["if-short"]?function(t,e){t.nameOutput.institutionpart["long-with-short"]=this}:function(t,e){t.nameOutput.institutionpart.long=this}:"short"===this.strings.name&&(n=function(t,e){t.nameOutput.institutionpart.short=this}),this.execs.push(n),e.push(this)}},t.exports=h,h.Node.key={build:function(t,e){var n;e=t[t.build.root+"_sort"].tokens;var r=new h.Token("key",h.START);t.tmp.root=t.build.root,r.strings["et-al-min"]=t.inheritOpt(this,"et-al-min"),r.strings["et-al-use-first"]=t.inheritOpt(this,"et-al-use-first"),r.strings["et-al-use-last"]=t.inheritOpt(this,"et-al-use-last"),n=function(t,e){t.tmp.done_vars=[]},r.execs.push(n),t.opt.citation_number_sort_direction=this.strings.sort_direction,n=function(t,e){t.output.openLevel("empty")},r.execs.push(n);var i=[];if(this.strings.sort_direction===h.DESCENDING?(i.push(1),i.push(-1)):(i.push(-1),i.push(1)),t[t.build.area].opt.sort_directions.push(i),h.DATE_VARIABLES.indexOf(this.variables[0])>-1&&(t.build.date_key=!0),n=function(t,e){t.tmp.sort_key_flag=!0,t.inheritOpt(this,"et-al-min")&&(t.tmp["et-al-min"]=t.inheritOpt(this,"et-al-min")),t.inheritOpt(this,"et-al-use-first")&&(t.tmp["et-al-use-first"]=t.inheritOpt(this,"et-al-use-first")),"boolean"==typeof t.inheritOpt(this,"et-al-use-last")&&(t.tmp["et-al-use-last"]=t.inheritOpt(this,"et-al-use-last"))},r.execs.push(n),e.push(r),this.variables.length){var o=this.variables[0];if("citation-number"===o&&("citation"===t.build.area&&"_sort"===t.build.extension&&(t.opt.citation_number_sort=!1),"bibliography"===t.build.root&&"_sort"===t.build.extension&&(t.opt.citation_number_sort_used=!1)),h.CREATORS.indexOf(o)>-1){var a=new h.Token("names",h.START);a.tokentype=h.START,a.variables=this.variables,h.Node.names.build.call(a,t,e);var s=new h.Token("name",h.SINGLETON);s.tokentype=h.SINGLETON,s.strings["name-as-sort-order"]="all",s.strings["sort-separator"]=" ",s.strings["et-al-use-last"]=t.inheritOpt(this,"et-al-use-last"),s.strings["et-al-min"]=t.inheritOpt(this,"et-al-min"),s.strings["et-al-use-first"]=t.inheritOpt(this,"et-al-use-first"),h.Node.name.build.call(s,t,e);var u=new h.Token("institution",h.SINGLETON);u.tokentype=h.SINGLETON,h.Node.institution.build.call(u,t,e);var l=new h.Token("names",h.END);l.tokentype=h.END,h.Node.names.build.call(l,t,e)}else{var c=new h.Token("text",h.SINGLETON);if(c.dateparts=this.dateparts,h.NUMERIC_VARIABLES.indexOf(o)>-1)n=function(t,e){var n;n=!1,(n="citation-number"===o?t.registry.registry[e.id].seq.toString():e[o])&&(n=h.Util.padding(n)),t.output.append(n,this)};else if("citation-label"===o)n=function(t,e){var n=t.getCitationLabel(e);t.output.append(n,this)};else if(h.DATE_VARIABLES.indexOf(o)>-1)n=h.dateAsSortKey,c.variables=this.variables;else if("title"===o){n=t.transform.getOutputFunction(this.variables,"title",!1,!1,!0)}else n=function(t,e){var n=e[o];t.output.append(n,"empty")};c.execs.push(n),e.push(c)}}else{var p=new h.Token("text",h.SINGLETON);p.postponed_macro=this.postponed_macro,h.expandMacro.call(t,p,e)}var f=new h.Token("key",h.END);n=function(t,e){var n=t.output.string(t,t.output.queue);t.sys.normalizeUnicode&&(n=t.sys.normalizeUnicode(n)),""===(n=n?n.split(" ").join(t.opt.sort_sep)+t.opt.sort_sep:"")&&(n=void 0),("string"!=typeof n||t.tmp.empty_date)&&(n=void 0,t.tmp.empty_date=!1),t[t[t.tmp.area].root+"_sort"].keys.push(n),t.tmp.value=[]},f.execs.push(n),t.build.date_key&&("citation"===t.build.area&&"_sort"===t.build.extension&&(t[t.build.area].opt.sort_directions.push([-1,1]),n=function(t,e){var n=t.registry.registry[e.id].disambig.year_suffix;n||(n=0);var r=h.Util.padding(""+n);t[t.tmp.area].keys.push(r)},f.execs.push(n)),t.build.date_key=!1),n=function(t,e){t.tmp["et-al-min"]=void 0,t.tmp["et-al-use-first"]=void 0,t.tmp["et-al-use-last"]=void 0,t.tmp.sort_key_flag=!1},f.execs.push(n),e.push(f)}},t.exports=h,h.Node.label={build:function(t,e){if(this.strings.term){this.strings.form;this.execs.push(function(t,e,n){var r=h.evaluateLabel(this,t,e,n);n&&"locator"===this.strings.term&&(t.parallel.StartVariable("label"),t.parallel.AppendToVariable(n.label),n.section_form_override=this.strings.form),r&&(t.tmp.group_context.tip.term_intended=!0),h.UPDATE_GROUP_CONTEXT_CONDITION(t,r),-1===r.indexOf("%s")&&t.output.append(r,this),n&&"locator"===this.strings.term&&t.parallel.CloseVariable()})}else{var n=t.build.names_variables.slice(-1)[0];t.build.name_label||(t.build.name_label={});for(var r=0,i=n.length;r<i;r+=1)t.build.name_label[n[r]]||(t.build.name_label[n[r]]={});if(t.build.name_flag)for(r=0,i=n.length;r<i;r+=1)t.build.name_label[n[r]].after=this;else for(var r=0,i=n.length;r<i;r+=1)t.build.name_label[n[r]].before=this}e.push(this)}},t.exports=h,h.Node.layout={build:function(t,e){var n,r,i,o,a;function s(){"bibliography"===t.build.area&&(i=new h.Token("text",h.SINGLETON),n=function(t,e,n){var r;t.tmp.cite_locales[t.tmp.cite_locales.length-1];r=t.tmp.cite_affixes[t.tmp.area][t.tmp.last_cite_locale]?t.tmp.cite_affixes[t.tmp.area][t.tmp.last_cite_locale].suffix:t.bibliography.opt.layout_suffix;var i=t.output.current.value();t.opt.using_display?i.blobs[i.blobs.length-1].strings.suffix=r:i.strings.suffix=r,t.bibliography.opt["second-field-align"]&&t.output.endTag("bib_other")},i.execs.push(n),e.push(i))}if(this.tokentype===h.START&&(this.locale_raw?t.build.current_default_locale=this.locale_raw:t.build.current_default_locale=t.opt["default-locale"],n=function(t,e,n){t.opt.development_extensions.apply_citation_wrapper&&t.sys.wrapCitationEntry&&!t.tmp.just_looking&&e.system_id&&"citation"===t.tmp.area&&(cite_entry=new h.Token("group",h.START),cite_entry.decorations=[["@cite","entry"]],t.output.startTag("cite_entry",cite_entry),t.output.current.value().item_id=e.system_id,n&&(t.output.current.value().locator_txt=n.locator_txt,t.output.current.value().suffix_txt=n.suffix_txt))},this.execs.push(n)),this.tokentype!==h.START||t.tmp.cite_affixes[t.build.area]||(n=function(t,e){t.tmp.done_vars=[],!t.tmp.just_looking&&t.registry.registry[e.id]&&t.registry.registry[e.id].parallel&&t.tmp.done_vars.push("first-reference-note-number"),t.tmp.rendered_name=!1},this.execs.push(n),n=function(t,e){t.tmp.sort_key_flag=!1},this.execs.push(n),n=function(t,e){t.tmp.nameset_counter=0},this.execs.push(n),n=function(t,e){var n=new h.Token;t.opt.development_extensions.rtl_support&&["ar","he","fa","ur","yi","ps","syr"].indexOf(e.language)>-1&&((n=new h.Token).strings.prefix="‫",n.strings.suffix="‬"),t.output.openLevel(n)},this.execs.push(n),e.push(this),t.opt.development_extensions.rtl_support,"citation"===t.build.area&&(r=new h.Token("text",h.SINGLETON),n=function(t,e,n){var r;if(n&&n.prefix){r="";var i=n.prefix.replace(/<[^>]+>/g,"").replace(/["'\u201d\u2019\u00bb\u202f\u00a0 ]+$/g,""),o=i.slice(-1);i.match(h.ENDSWITH_ROMANESQUE_REGEXP)?r=" ":h.TERMINAL_PUNCTUATION.slice(0,-1).indexOf(o)>-1?r=" ":o.match(/[\)\],0-9]/)&&(r=" ");var a=!1;h.TERMINAL_PUNCTUATION.slice(0,-1).indexOf(o)>-1&&n.prefix.trim().indexOf(" ")>-1&&(t.tmp.term_predecessor=!1,a=!0);var s=(n.prefix+r).replace(/\s+/g," ");t.tmp.just_looking||(s=t.output.checkNestedBrace.update(s)),t.output.append(s,this,!1,a)}},r.execs.push(n),e.push(r))),this.locale_raw&&((a=new h.Token("dummy",h.START)).locale=this.locale_raw,a.strings.delimiter=this.strings.delimiter,a.strings.suffix=this.strings.suffix,t.tmp.cite_affixes[t.build.area]||(t.tmp.cite_affixes[t.build.area]={})),this.tokentype===h.START&&(t.build.layout_flag=!0,this.locale_raw||(t[t.tmp.area].opt.topdecor=[this.decorations],t[t.tmp.area+"_sort"].opt.topdecor=[this.decorations],t[t.build.area].opt.layout_prefix=this.strings.prefix,t[t.build.area].opt.layout_suffix=this.strings.suffix,t[t.build.area].opt.layout_delimiter=this.strings.delimiter,t[t.build.area].opt.layout_decorations=this.decorations,t.tmp.cite_affixes[t.build.area]&&(o=new h.Token("else",h.START),h.Node.else.build.call(o,t,e))),this.locale_raw)){if(t.build.layout_locale_flag)a.name="else-if",h.Attributes["@locale-internal"].call(a,t,this.locale_raw),h.Node["else-if"].build.call(a,t,e);else{var u=new h.Token("choose",h.START);h.Node.choose.build.call(u,t,e),a.name="if",h.Attributes["@locale-internal"].call(a,t,this.locale_raw),h.Node.if.build.call(a,t,e)}t.tmp.cite_affixes[t.build.area][a.locale]={},t.tmp.cite_affixes[t.build.area][a.locale].delimiter=this.strings.delimiter,t.tmp.cite_affixes[t.build.area][a.locale].suffix=this.strings.suffix}this.tokentype===h.END&&(this.locale_raw&&(s(),t.build.layout_locale_flag?(a.name="else-if",a.tokentype=h.END,h.Attributes["@locale-internal"].call(a,t,this.locale_raw),h.Node["else-if"].build.call(a,t,e)):(a.name="if",a.tokentype=h.END,h.Attributes["@locale-internal"].call(a,t,this.locale_raw),h.Node.if.build.call(a,t,e),t.build.layout_locale_flag=!0)),this.locale_raw||(s(),t.tmp.cite_affixes[t.build.area]&&t.build.layout_locale_flag&&(o=new h.Token("else",h.END),h.Node.else.build.call(o,t,e),o=new h.Token("choose",h.END),h.Node.choose.build.call(o,t,e)),t.build_layout_locale_flag=!0,"citation"===t.build.area&&(i=new h.Token("text",h.SINGLETON),n=function(t,e,n){var r;if(n&&n.suffix){r="",(n.suffix.match(h.STARTSWITH_ROMANESQUE_REGEXP)||["[","("].indexOf(n.suffix.slice(0,1))>-1)&&(r=" ");var i=n.suffix;t.tmp.just_looking||(i=t.output.checkNestedBrace.update(i)),t.output.append(r+i,this)}},i.execs.push(n),e.push(i)),n=function(t,e){t.output.closeLevel()},this.execs.push(n),n=function(t,e){t.opt.development_extensions.apply_citation_wrapper&&t.sys.wrapCitationEntry&&!t.tmp.just_looking&&e.system_id&&"citation"===t.tmp.area&&t.output.endTag()},this.execs.push(n),e.push(this),t.build.layout_flag=!1,t.build.layout_locale_flag=!1))}},t.exports=h,h.Node.macro={build:function(t,e){}},t.exports=h,h.NameOutput=function(t,e,n,r){this.debug=!1,this.state=t,this.Item=e,this.item=n,this.nameset_base=0,this.etal_spec={},this._first_creator_variable=!1,this._please_chop=!1},h.NameOutput.prototype.init=function(t){this.state.tmp.term_predecessor&&(this.state.tmp.subsequent_author_substitute_ok=!1),this.nameset_offset&&(this.nameset_base=this.nameset_base+this.nameset_offset),this.nameset_offset=0,this.names=t,this.variables=t.variables,this.state.tmp.value=[],this.state.tmp.rendered_name=[],this.state.tmp.label_blob=!1,this.state.tmp.etal_node=!1,this.state.tmp.etal_term=!1;for(var e=0,n=this.variables.length;e<n;e+=1)this.Item[this.variables[e]]&&this.Item[this.variables[e]].length&&(this.state.tmp.value=this.state.tmp.value.concat(this.Item[this.variables[e]]));this["et-al"]=void 0,this.with=void 0,this.name=void 0,this.institutionpart={},this.state.tmp.group_context.tip.variable_attempt=!0,this.labelVariable=this.variables[0],this.state.tmp.value.length},h.NameOutput.prototype.reinit=function(t,e){if(this.labelVariable=e,this.state.tmp.can_substitute.value()){this.nameset_offset=0,this.variables=t.variables;var n=this.state.tmp.value.slice();this.state.tmp.value=[];for(var r=0,i=this.variables.length;r<i;r+=1)this.Item[this.variables[r]]&&this.Item[this.variables[r]].length&&(this.state.tmp.value=this.state.tmp.value.concat(this.Item[this.variables[r]]));this.state.tmp.value.length&&this.state.tmp.can_substitute.replace(!1,h.LITERAL),this.state.tmp.value=n}},h.NameOutput.prototype.outputNames=function(){var t=this.variables;if(this.institution.and&&(this.institution.and.single.blobs&&this.institution.and.single.blobs.length||(this.institution.and.single.blobs=this.name.and.single.blobs),this.institution.and.multiple.blobs&&this.institution.and.multiple.blobs.length||(this.institution.and.multiple.blobs=this.name.and.multiple.blobs)),this.variable_offset={},this.family)for(this.family_decor=h.Util.cloneToken(this.family),this.family_decor.strings.prefix="",this.family_decor.strings.suffix="",d=0,m=this.family.execs.length;d<m;d+=1)this.family.execs[d].call(this.family_decor,this.state,this.Item);else this.family_decor=!1;if(this.given)for(this.given_decor=h.Util.cloneToken(this.given),this.given_decor.strings.prefix="",this.given_decor.strings.suffix="",d=0,m=this.given.execs.length;d<m;d+=1)this.given.execs[d].call(this.given_decor,this.state,this.Item);else this.given_decor=!1;if(this.getEtAlConfig(),this.divideAndTransliterateNames(),this.truncatePersonalNameLists(),this.disambigNames(),this.constrainNames(),"count"!==this.name.strings.form){this.setEtAlParameters(),this.setCommonTerm(),this.state.tmp.name_node={},this.state.tmp.name_node.children=[],this.renderAllNames();var e=[];for(d=0,m=t.length;d<m;d+=1){var n=t[d],r=[],i=!1,o=null;if(this.state.opt.development_extensions.spoof_institutional_affiliations){for(var a=0,s=this.institutions[n].length;a<s;a+=1)r.push(this.joinPersonsAndInstitutions([this.persons[n][a],this.institutions[n][a]]));if(this.institutions[n].length){var u=this.nameset_base+this.variable_offset[n];this.freeters[n].length&&(u+=1),i=this.joinInstitutionSets(r,u)}o=this.joinFreetersAndInstitutionSets([this.freeters[n],i])}else o=this._join([this.freeters[n]],"");if(o&&(this.state.tmp.extension||(o=this._applyLabels(o,n)),e.push(o)),this.common_term)break}for(this.state.output.openLevel("empty"),this.state.output.current.value().strings.delimiter=this.state.inheritOpt(this.names,"delimiter","names-delimiter"),d=0,m=e.length;d<m;d+=1)this.state.output.append(e[d],"literal",!0);this.state.output.closeLevel("empty");var l=this.state.output.pop(),c=h.Util.cloneToken(this.names);if(this.state.output.append(l,c),this.state.tmp.term_predecessor_name&&(this.state.tmp.term_predecessor=!0),this.state.tmp.name_node.top=this.state.output.current.value(),"authority"!==t[0]){var p=[],f=this.Item[t[0]];if(f)for(var d=0,m=f.length;d<m;d+=1){var g=h.Util.Names.getRawName(f[d]);g&&p.push(g)}(p=p.join(", "))&&(this.state.tmp.name_node.string=p)}if(this.state.tmp.name_node.string&&!this.state.tmp.first_name_string&&(this.state.tmp.first_name_string=this.state.tmp.name_node.string),"classic"===this.Item.type){var v=[];this.state.tmp.first_name_string&&v.push(this.state.tmp.first_name_string),this.Item.title&&v.push(this.Item.title),(v=v.join(", "))&&this.state.sys.getAbbreviation&&(this.state.transform.loadAbbreviation("default","classic",v),this.state.transform.abbrevs.default.classic[v]&&(this.state.tmp.done_vars.push("title"),this.state.output.append(this.state.transform.abbrevs.default.classic[v],"empty",!0),l=this.state.output.pop(),this.state.tmp.name_node.top.blobs.pop(),this.state.tmp.name_node.top.blobs.push(l)))}this._collapseAuthor(),this.variables=[]}else(this.state.tmp.extension||0!=this.names_count)&&(this.state.output.append(this.names_count,"empty"),this.state.tmp.group_context.tip.variable_success=!0)},h.NameOutput.prototype._applyLabels=function(t,e){var n;if(!this.label||!this.label[this.labelVariable])return t;var r=0,i=this.freeters_count[e]+this.institutions_count[e];if(i>1)r=1;else{for(var o=0,a=this.persons[e].length;o<a;o+=1)i+=this.persons_count[e][o];i>1&&(r=1)}return this.label[this.labelVariable].before?("number"==typeof this.label[this.labelVariable].before.strings.plural&&(r=this.label[this.labelVariable].before.strings.plural),n=this._buildLabel(e,r,"before",this.labelVariable),this.state.output.openLevel("empty"),this.state.output.append(n,this.label[this.labelVariable].before,!0),this.state.output.append(t,"literal",!0),this.state.output.closeLevel("empty"),t=this.state.output.pop()):this.label[this.labelVariable].after&&("number"==typeof this.label[this.labelVariable].after.strings.plural&&(r=this.label[this.labelVariable].after.strings.plural),n=this._buildLabel(e,r,"after",this.labelVariable),this.state.output.openLevel("empty"),this.state.output.append(t,"literal",!0),this.state.output.append(n,this.label[this.labelVariable].after,!0),this.state.tmp.label_blob=this.state.output.pop(),this.state.output.append(this.state.tmp.label_blob,"literal",!0),this.state.output.closeLevel("empty"),t=this.state.output.pop()),t},h.NameOutput.prototype._buildLabel=function(t,e,n,r){this.common_term&&(t=this.common_term);var i=!1,o=this.label[r][n];return o&&(i=h.castLabel(this.state,o,t,e,h.TOLERANT)),i},h.NameOutput.prototype._collapseAuthor=function(){var t,e,n;0===this.nameset_base&&this.Item[this.variables[0]]&&!this._first_creator_variable&&(this._first_creator_variable=this.variables[0]),(this.item&&this.item["suppress-author"]&&this._first_creator_variable==this.variables[0]||this.state[this.state.tmp.area].opt.collapse&&this.state[this.state.tmp.area].opt.collapse.length||this.state[this.state.tmp.area].opt.cite_group_delimiter&&this.state[this.state.tmp.area].opt.cite_group_delimiter.length)&&(this.state.tmp.authorstring_request?(e="",t=this.state.tmp.name_node.top.blobs.slice(-1)[0].blobs,n=this.state.tmp.offset_characters,t&&(e=this.state.output.string(this.state,t,!1)),this.state.tmp.offset_characters=n,this.state.registry.authorstrings[this.Item.id]=e):this.state.tmp.just_looking||this.state.tmp.suppress_decorations||!(this.item["suppress-author"]||this.state[this.state.tmp.area].opt.collapse&&this.state[this.state.tmp.area].opt.collapse.length||this.state[this.state.tmp.area].opt.cite_group_delimiter&&this.state[this.state.tmp.area].opt.cite_group_delimiter)||(e="",t=this.state.tmp.name_node.top.blobs.slice(-1)[0].blobs,n=this.state.tmp.offset_characters,t&&(e=this.state.output.string(this.state,t,!1)),e===this.state.tmp.last_primary_names_string?((this.item["suppress-author"]||this.state[this.state.tmp.area].opt.collapse&&this.state[this.state.tmp.area].opt.collapse.length)&&(this.state.tmp.name_node.top.blobs.pop(),this.state.tmp.name_node.children=[],this.state.tmp.offset_characters=n),this.state[this.state.tmp.area].opt.cite_group_delimiter&&this.state[this.state.tmp.area].opt.cite_group_delimiter&&(this.state.tmp.use_cite_group_delimiter=!0)):(this.state.tmp.last_primary_names_string=e,this.variables.indexOf(this._first_creator_variable)>-1&&this.item&&this.item["suppress-author"]&&"legal_case"!==this.Item.type&&(this.state.tmp.name_node.top.blobs.pop(),this.state.tmp.name_node.children=[],this.state.tmp.offset_characters=n,this.state.tmp.term_predecessor=!1),this.state.tmp.have_collapsed=!1,this.state[this.state.tmp.area].opt.cite_group_delimiter&&this.state[this.state.tmp.area].opt.cite_group_delimiter&&(this.state.tmp.use_cite_group_delimiter=!1))))},t.exports=h,h.NameOutput.prototype.isPerson=function(t){return!(t.literal||!t.given&&t.family&&t.isInstitution)},t.exports=h,h.NameOutput.prototype.truncatePersonalNameLists=function(){var t,e,n,r;this.freeters_count={},this.persons_count={},this.institutions_count={};for(t in this.freeters)this.freeters.hasOwnProperty(t)&&(this.freeters_count[t]=this.freeters[t].length,this.freeters[t]=this._truncateNameList(this.freeters,t));for(t in this.persons)if(this.persons.hasOwnProperty(t))for(this.institutions_count[t]=this.institutions[t].length,this._truncateNameList(this.institutions,t),this.persons[t]=this.persons[t].slice(0,this.institutions[t].length),this.persons_count[t]=[],i=0,o=this.persons[t].length;i<o;i+=1)this.persons_count[t][i]=this.persons[t][i].length,this.persons[t][i]=this._truncateNameList(this.persons,t,i);if((r=1===this.etal_min&&1===this.etal_use_first&&!this.state.tmp.extension&&!this.state.tmp.just_looking&&t)||this._please_chop)for(e=0,n=this.variables.length;e<n;e+=1){t=this.variables[e],this.freeters[t].length&&(this._please_chop===t?(this.freeters[t]=this.freeters[t].slice(1),this.freeters_count[t]+=-1,this._please_chop=!1):r&&!this._please_chop&&(this.freeters[t]=this.freeters[t].slice(0,1),this.freeters_count[t]=1,this.institutions[t]=[],this.persons[t]=[],this._please_chop=r));for(var i=0,o=this.persons[t].length;i<o;i++)if(this.persons[t][i].length){if(this._please_chop===t){this.persons[t][i]=this.persons[t][i].slice(1),this.persons_count[t][i]+=-1,this._please_chop=!1;break}if(r&&!this._please_chop){this.freeters[t]=this.persons[t][i].slice(0,1),this.freeters_count[t]=1,this.institutions[t]=[],this.persons[t]=[],[],this._please_chop=r;break}}this.institutions[t].length&&(this._please_chop===t?(this.institutions[t]=this.institutions[t].slice(1),this.institutions_count[t]+=-1,this._please_chop=!1):r&&!this._please_chop&&(this.institutions[t]=this.institutions[t].slice(0,1),this.institutions_count[t]=1,[],this._please_chop=r))}for(e=0,n=this.variables.length;e<n;e+=1){this.institutions[t].length&&(this.nameset_offset+=1);for(i=0,o=this.persons[t].length;i<o;i++)this.persons[t][i].length&&(this.nameset_offset+=1)}},h.NameOutput.prototype._truncateNameList=function(t,e,n){var r;if(r=void 0===n?t[e]:t[e][n],this.state[this.state[this.state.tmp.area].root].opt.max_number_of_names&&r.length>50&&r.length>this.state[this.state[this.state.tmp.area].root].opt.max_number_of_names+2){var i=this.state[this.state[this.state.tmp.area].root].opt.max_number_of_names;r=r.slice(0,i+1).concat(r.slice(-1))}return r},t.exports=h,h.NameOutput.prototype.divideAndTransliterateNames=function(){var t,e,n,r,i=this.Item,o=this.variables;for(this.varnames=o.slice(),this.freeters={},this.persons={},this.institutions={},t=0,e=o.length;t<e;t+=1){var a=o[t];this.variable_offset[a]=this.nameset_offset;var s=this._normalizeVariableValue(i,a);if(this.name.strings["suppress-min"]&&s.length>=this.name.strings["suppress-min"]&&(s=[]),this.name.strings["suppress-max"]&&s.length<=this.name.strings["suppress-max"]&&(s=[]),this._getFreeters(a,s),this._getPersonsAndInstitutions(a,s),this.state.opt.development_extensions.spoof_institutional_affiliations)if(0===this.name.strings["suppress-min"])for(this.freeters[a]=[],n=0,r=this.persons[a].length;n<r;n+=1)this.persons[a][n]=[];else if(0===this.institution.strings["suppress-min"]){for(this.institutions[a]=[],this.freeters[a]=this.freeters[a].concat(this.persons[a]),n=0,r=this.persons[a].length;n<r;n+=1)for(var u=0,l=this.persons[a][n].length;u<l;u+=1)this.freeters[a].push(this.persons[a][n][u]);this.persons[a]=[]}}},h.NameOutput.prototype._normalizeVariableValue=function(t,e){var n;return"string"==typeof t[e]||"number"==typeof t[e]?(h.debug('name variable "'+e+'" is string or number, not array. Attempting to fix.'),n=[{literal:t[e]+""}]):t[e]?"number"!=typeof t[e].length?(h.debug('name variable "'+e+'" is object, not array. Attempting to fix.'),t[e]=[t[e]],n=t[e].slice()):n=t[e].slice():n=[],n},h.NameOutput.prototype._getFreeters=function(t,e){if(this.freeters[t]=[],this.state.opt.development_extensions.spoof_institutional_affiliations)for(var n=e.length-1;n>-1&&this.isPerson(e[n]);n--){(r=this._checkNickname(e.pop()))&&this.freeters[t].push(r)}else for(n=e.length-1;n>-1;n--){var r=e.pop();if(this.isPerson(r))r=this._checkNickname(r);this.freeters[t].push(r)}this.freeters[t].reverse(),this.freeters[t].length&&(this.nameset_offset+=1)},h.NameOutput.prototype._getPersonsAndInstitutions=function(t,e){if(this.persons[t]=[],this.institutions[t]=[],this.state.opt.development_extensions.spoof_institutional_affiliations){for(var n=[],r=!1,i=!0,o=e.length-1;o>-1;o+=-1)if(this.isPerson(e[o])){var a=this._checkNickname(e[o]);a&&n.push(a)}else r=!0,this.institutions[t].push(e[o]),i||(n.reverse(),this.persons[t].push(n),n=[]),i=!1;r&&(n.reverse(),this.persons[t].push(n),this.persons[t].reverse(),this.institutions[t].reverse())}},h.NameOutput.prototype._clearValues=function(t){for(var e=t.length-1;e>-1;e+=-1)t.pop()},h.NameOutput.prototype._checkNickname=function(t){if(["interview","personal_communication"].indexOf(this.Item.type)>-1){var e;if((e=h.Util.Names.getRawName(t))&&this.state.sys.getAbbreviation&&(!this.item||!this.item["suppress-author"])){var n=e;this.state.sys.normalizeAbbrevsKey&&(n=this.state.sys.normalizeAbbrevsKey(e)),this.state.transform.loadAbbreviation("default","nickname",n);var r=this.state.transform.abbrevs.default.nickname[n];r&&(t="!here>>>"!==r&&{family:r,given:""})}}return t},t.exports=h,h.NameOutput.prototype.joinPersons=function(t,e,n,r){return r||(r="name"),void 0===n?1===this.etal_spec[e].freeters?this._joinEtAl(t,r):2===this.etal_spec[e].freeters?this._joinEllipsis(t,r):this.state.tmp.sort_key_flag?this._join(t," "):this._joinAnd(t,r):1===this.etal_spec[e].persons[n]?this._joinEtAl(t,r):2===this.etal_spec[e].persons[n]?this._joinEllipsis(t,r):this.state.tmp.sort_key_flag?this._join(t," "):this._joinAnd(t,r)},h.NameOutput.prototype.joinInstitutionSets=function(t,e){return 1===this.etal_spec[e].institutions?this._joinEtAl(t,"institution"):2===this.etal_spec[e].institutions?this._joinEllipsis(t,"institution"):this._joinAnd(t,"institution")},h.NameOutput.prototype.joinPersonsAndInstitutions=function(t){return this._join(t,this.state.tmp.name_delimiter)},h.NameOutput.prototype.joinFreetersAndInstitutionSets=function(t){return this._join(t,"[never here]",this.with.single,this.with.multiple)},h.NameOutput.prototype._joinEtAl=function(t,e){var n=this._join(t,this.state.tmp.name_delimiter);return this.state.output.openLevel(this._getToken(e)),this.state.output.current.value().strings.delimiter="",this.state.output.append(n,"literal",!0),t.length>1?this.state.output.append(this["et-al"].multiple,"literal",!0):1===t.length&&this.state.output.append(this["et-al"].single,"literal",!0),this.state.output.closeLevel(),this.state.output.pop()},h.NameOutput.prototype._joinEllipsis=function(t,e){return this._join(t,this.state.tmp.name_delimiter,this.name.ellipsis.single,this.name.ellipsis.multiple,e)},h.NameOutput.prototype._joinAnd=function(t,e){return this._join(t,this.state.inheritOpt(this[e],"delimiter",e+"-delimiter",", "),this[e].and.single,this[e].and.multiple,e)},h.NameOutput.prototype._join=function(t,e,n,r,i){var o,a;if(!t)return!1;for(o=t.length-1;o>-1;o+=-1)t[o]&&0!==t[o].length&&t[o].blobs.length||(t=t.slice(0,o).concat(t.slice(o+1)));if(!t.length)return!1;if(n&&2===t.length)n&&(n=new h.Blob(n.blobs,n)),t=[t[0],n,t[1]];else{var s;for(s=r?2:1,o=0,a=t.length-s;o<a;o+=1)t[o].strings.suffix+=e;if(t.length>1){var u=t.pop();r?(r=new h.Blob(r.blobs,r),t.push(r)):(n&&(n=new h.Blob(n.blobs,n)),t.push(n)),t.push(u)}}for(this.state.output.openLevel(),n&&r&&(this.state.output.current.value().strings.delimiter=""),o=0,a=t.length;o<a;o+=1)this.state.output.append(t[o],!1,!0);return this.state.output.closeLevel(),this.state.output.pop()},h.NameOutput.prototype._getToken=function(t){var e=this[t];return"institution"===t?new h.Token:e},t.exports=h,h.NameOutput.prototype.setCommonTerm=function(){var t=this.variables.slice();if(t.sort(),this.common_term=t.join(""),!this.common_term)return!1;var e=!1;if(this.label&&this.label[this.variables[0]]&&(this.label[this.variables[0]].before?e=this.state.getTerm(this.common_term,this.label[this.variables[0]].before.strings.form,0):this.label[this.variables[0]].after&&(e=this.state.getTerm(this.common_term,this.label[this.variables[0]].after.strings.form,0))),!this.state.locale[this.state.opt.lang].terms[this.common_term]||!e||this.variables.length<2)this.common_term=!1;else for(var n=0,r=this.variables.length-1;n<r;n+=1){var i=this.variables[n],o=this.variables[n+1];if(this.freeters[i].length||this.freeters[o].length){if(this.etal_spec[i].freeters!==this.etal_spec[o].freeters||!this._compareNamesets(this.freeters[i],this.freeters[o]))return void(this.common_term=!1);1}if(this.persons[i].length!==this.persons[o].length)return void(this.common_term=!1);for(var a=0,s=this.persons[i].length;a<s;a+=1)if(this.etal_spec[i].persons[a]!==this.etal_spec[o].persons[a]||!this._compareNamesets(this.persons[i][a],this.persons[o][a]))return void(this.common_term=!1)}},h.NameOutput.prototype._compareNamesets=function(t,e){if(t.length!==e.length)return!1;for(var n=0,r=e.length;n<r;n+=1){e[n];for(var i=0,o=h.NAME_PARTS.length;i<o;i+=1){var a=h.NAME_PARTS[i];if(!t[n]||t[n][a]!=e[n][a])return!1}}return!0},t.exports=h,h.NameOutput.prototype.constrainNames=function(){var t;this.names_count=0;for(var e=0,n=this.variables.length;e<n;e+=1){var r=this.variables[e];t=this.nameset_base+e,this.freeters[r].length&&(this.state.tmp.names_max.push(this.freeters[r].length,"literal"),this._imposeNameConstraints(this.freeters,this.freeters_count,r,t),this.names_count+=this.freeters[r].length),this.institutions[r].length&&(this.state.tmp.names_max.push(this.institutions[r].length,"literal"),this._imposeNameConstraints(this.institutions,this.institutions_count,r,t),this.persons[r]=this.persons[r].slice(0,this.institutions[r].length),this.names_count+=this.institutions[r].length);for(var i=0,o=this.persons[r].length;i<o;i+=1)this.persons[r][i].length&&(this.state.tmp.names_max.push(this.persons[r][i].length,"literal"),this._imposeNameConstraints(this.persons[r],this.persons_count[r],i,t),this.names_count+=this.persons[r][i].length)}},h.NameOutput.prototype._imposeNameConstraints=function(t,e,n,r){var i=t[n],o=this.state.tmp["et-al-min"];this.state.tmp.suppress_decorations?this.state.tmp.disambig_request&&this.state.tmp.disambig_request.names[r]?o=this.state.tmp.disambig_request.names[r]:e[n]>=this.etal_min&&(o=this.etal_use_first):(this.state.tmp.disambig_request&&this.state.tmp.disambig_request.names[r]>this.etal_use_first?o=e[n]<this.etal_min?e[n]:this.state.tmp.disambig_request.names[r]:e[n]>=this.etal_min&&(o=this.etal_use_first),this.etal_use_last&&o>this.etal_min-2&&(o=this.etal_min-2));var a=this.etal_min>=this.etal_use_first,s=e[n]>o;o>e[n]&&(o=i.length),a&&s&&(this.etal_use_last?t[n]=i.slice(0,o).concat(i.slice(-1)):t[n]=i.slice(0,o)),this.state.tmp.disambig_settings.names[r]=t[n].length,this.state.disambiguate.padBase(this.state.tmp.disambig_settings)},t.exports=h,h.NameOutput.prototype.disambigNames=function(){for(var t,e=0,n=this.variables.length;e<n;e+=1){var r=this.variables[e];if(t=this.nameset_base+e,this.freeters[r].length&&this._runDisambigNames(this.freeters[r],t),this.institutions[r].length){void 0===this.state.tmp.disambig_settings.givens[t]&&(this.state.tmp.disambig_settings.givens[t]=[]);for(var i=0,o=this.institutions[r].length;i<o;i+=1)void 0===this.state.tmp.disambig_settings.givens[t][i]&&this.state.tmp.disambig_settings.givens[t].push(2)}for(i=0,o=this.persons[r].length;i<o;i+=1)this.persons[r][i].length&&this._runDisambigNames(this.persons[r][i],t)}},h.NameOutput.prototype._runDisambigNames=function(t,e){var n,r,i,o,a,s;for(o=0,a=t.length;o<a;o+=1)if(t[o].given||t[o].family){if(r=this.state.inheritOpt(this.name,"initialize-with"),this.state.registry.namereg.addname(""+this.Item.id,t[o],o),void 0===this.state.tmp.disambig_settings.givens[e])for(var u=0,l=e+1;u<l;u+=1)this.state.tmp.disambig_settings.givens[u]||(this.state.tmp.disambig_settings.givens[u]=[]);if(void 0===this.state.tmp.disambig_settings.givens[e][o]&&(n=this.state.inheritOpt(this.name,"form","name-form"),i=this.state.registry.namereg.evalname(""+this.Item.id,t[o],o,0,n,r),this.state.tmp.disambig_settings.givens[e].push(i)),n=this.state.inheritOpt(this.name,"form","name-form"),s=this.state.registry.namereg.evalname(""+this.Item.id,t[o],o,0,n,r),this.state.tmp.disambig_request){var c=this.state.tmp.disambig_settings.givens[e][o];1!==c||"by-cite"!==this.state.citation.opt["givenname-disambiguation-rule"]||void 0!==this.state.inheritOpt(this.name,"initialize-with")&&void 0!==t[o].given||(c=2),i=c,this.state.opt["disambiguate-add-givenname"]&&t[o].given&&(i=this.state.registry.namereg.evalname(""+this.Item.id,t[o],o,i,this.state.inheritOpt(this.name,"form","name-form"),this.state.inheritOpt(this.name,"initialize-with")))}else i=s;!this.state.tmp.just_looking&&this.item&&this.item.position===h.POSITION_FIRST&&s>i&&(i=s),this.state.tmp.sort_key_flag||(this.state.tmp.disambig_settings.givens[e][o]=i,"string"!=typeof r||void 0!==this.name.strings.initialize&&!0!==this.name.strings.initialize||(this.state.tmp.disambig_settings.use_initials=!0))}},t.exports=h,h.NameOutput.prototype.getEtAlConfig=function(){var t=this.item;this["et-al"]={},this.state.output.append(this.etal_term,this.etal_style,!0),this["et-al"].single=this.state.output.pop(),this["et-al"].single.strings.suffix=this.etal_suffix,this["et-al"].single.strings.prefix=this.etal_prefix_single,this.state.output.append(this.etal_term,this.etal_style,!0),this["et-al"].multiple=this.state.output.pop(),this["et-al"].multiple.strings.suffix=this.etal_suffix,this["et-al"].multiple.strings.prefix=this.etal_prefix_multiple,void 0===t&&(t={}),t.position?(this.state.inheritOpt(this.name,"et-al-subsequent-min")?this.etal_min=this.state.inheritOpt(this.name,"et-al-subsequent-min"):this.etal_min=this.state.inheritOpt(this.name,"et-al-min"),this.state.inheritOpt(this.name,"et-al-subsequent-use-first")?this.etal_use_first=this.state.inheritOpt(this.name,"et-al-subsequent-use-first"):this.etal_use_first=this.state.inheritOpt(this.name,"et-al-use-first")):(this.state.tmp["et-al-min"]?this.etal_min=this.state.tmp["et-al-min"]:this.etal_min=this.state.inheritOpt(this.name,"et-al-min"),this.state.tmp["et-al-use-first"]?this.etal_use_first=this.state.tmp["et-al-use-first"]:this.etal_use_first=this.state.inheritOpt(this.name,"et-al-use-first"),"boolean"==typeof this.state.tmp["et-al-use-last"]?this.etal_use_last=this.state.tmp["et-al-use-last"]:this.etal_use_last=this.state.inheritOpt(this.name,"et-al-use-last")),this.state.tmp["et-al-min"]||(this.state.tmp["et-al-min"]=this.etal_min)},t.exports=h,h.NameOutput.prototype.setEtAlParameters=function(){var t,e,n,r;for(t=0,e=this.variables.length;t<e;t+=1){var i=this.variables[t];for(void 0===this.etal_spec[i]&&(this.etal_spec[i]={freeters:0,institutions:0,persons:[]}),this.etal_spec[this.nameset_base+t]=this.etal_spec[i],this.freeters[i].length&&this._setEtAlParameter("freeters",i),n=0,r=this.persons[i].length;n<r;n+=1)void 0===this.etal_spec[i][n]&&(this.etal_spec[i].persons[n]=0),this._setEtAlParameter("persons",i,n);this.institutions[i].length&&this._setEtAlParameter("institutions",i)}},h.NameOutput.prototype._setEtAlParameter=function(t,e,n){var r,i;"persons"===t?(r=this.persons[e][n],i=this.persons_count[e][n]):(r=this[t][e],i=this[t+"_count"][e]),r.length<i&&!this.state.tmp.sort_key_flag?this.etal_use_last?"persons"===t?this.etal_spec[e].persons[n]=2:this.etal_spec[e][t]=2:"persons"===t?this.etal_spec[e].persons[n]=1:this.etal_spec[e][t]=1:"persons"===t?this.etal_spec[e].persons[n]=0:this.etal_spec[e][t]=0},t.exports=h,h.NameOutput.prototype.renderAllNames=function(){for(var t,e=0,n=this.variables.length;e<n;e+=1){var r=this.variables[e];(this.freeters[r].length||this.institutions[r].length)&&(this.state.tmp.group_context.tip.condition||(this.state.tmp.just_did_number=!1)),t=this.nameset_base+e,this.freeters[r].length&&(this.freeters[r]=this._renderNames(r,this.freeters[r],t));for(var i=0,o=this.institutions[r].length;i<o;i+=1)this.persons[r][i]=this._renderNames(r,this.persons[r][i],t,i)}this.renderInstitutionNames()},h.NameOutput.prototype.renderInstitutionNames=function(){for(var t=0,e=this.variables.length;t<e;t+=1)for(var n=this.variables[t],r=0,i=this.institutions[n].length;r<i;r+=1){var o,a=this.institutions[n][r],s={primary:"locale-orig",secondary:!1,tertiary:!1};if(o=this.state.tmp.extension?["sort"]:a.isInstitution||a.literal?this.state.opt["cite-lang-prefs"].institutions:this.state.opt["cite-lang-prefs"].persons)for(var u=["primary","secondary","tertiary"],l=0,c=u.length;l<c&&!(o.length-1<l);l+=1)o[l]&&(s[u[l]]="locale-"+o[l]);else s.primary="locale-translat";"bibliography"===this.state.tmp.area||"citation"===this.state.tmp.area&&"note"===this.state.opt.xclass&&this.item&&!this.item.position||(s.secondary=!1,s.tertiary=!1),this.setRenderedName(a);var h=this._renderInstitutionName(n,a,s,r);this.institutions[n][r]=h}},h.NameOutput.prototype._renderInstitutionName=function(t,e,n,r){var i,o,a,s,u,l=this.getName(e,n.primary,!0),c=l.name,h=l.usedOrig;if(c&&(c=this.fixupInstitution(c,t,r)),p=!1,n.secondary){var p=(l=this.getName(e,n.secondary,!1,h)).name;h=l.usedOrig,p&&(p=this.fixupInstitution(p,t,r))}i=!1,n.tertiary&&(i=(l=this.getName(e,n.tertiary,!1,h)).name)&&(i=this.fixupInstitution(i,t,r));var f={l:{pri:!1,sec:!1,ter:!1},s:{pri:!1,sec:!1,ter:!1}};switch(c&&(f.l.pri=c.long,f.s.pri=c.short.length?c.short:c.long),p&&(f.l.sec=p.long,f.s.sec=p.short.length?p.short:p.long),i&&(f.l.ter=i.long,f.s.ter=i.short.length?i.short:i.long),this.institution.strings["institution-parts"]){case"short":c.short.length?(a=this._getShortStyle(),s=[this._composeOneInstitutionPart([f.s.pri,f.s.sec,f.s.ter],n,a,t)]):(o=this._getLongStyle(c,t,r),s=[this._composeOneInstitutionPart([f.l.pri,f.l.sec,f.l.ter],n,o,t)]);break;case"short-long":o=this._getLongStyle(c,t,r),a=this._getShortStyle(),s=[u=this._renderOneInstitutionPart(c.short,a),this._composeOneInstitutionPart([f.l.pri,f.l.sec,f.l.ter],n,o,t)];break;case"long-short":o=this._getLongStyle(c,t,r),a=this._getShortStyle(),u=this._renderOneInstitutionPart(c.short,a),s=[this._composeOneInstitutionPart([f.l.pri,f.l.sec,f.l.ter],n,o,t),u];break;default:o=this._getLongStyle(c,t,r),s=[this._composeOneInstitutionPart([f.l.pri,f.l.sec,f.l.ter],n,o,t)]}var d=this._join(s," ");return this.state.tmp.name_node.children.push(d),d},h.NameOutput.prototype._composeOneInstitutionPart=function(t,e,n,r){var i,o,a,s,u=!1,l=!1,c=!1;if(t[0]){if(i=h.Util.cloneToken(n),this.state.opt.citeAffixes[e.primary]&&"<i>"===this.state.opt.citeAffixes.institutions[e.primary].prefix){for(var p=!1,f=0,d=i.decorations.length;f<d;f+=1)"@font-style"===n.decorations[f][0]&&"italic"===i.decorations[f][1]&&(p=!0);p||i.decorations.push(["@font-style","italic"])}u=this._renderOneInstitutionPart(t[0],i)}if(t[1]&&(l=this._renderOneInstitutionPart(t[1],n)),t[2]&&(c=this._renderOneInstitutionPart(t[2],n)),l||c){this.state.output.openLevel("empty"),this.state.output.append(u),o=h.Util.cloneToken(n),e.secondary&&(o.strings.prefix=this.state.opt.citeAffixes.institutions[e.secondary].prefix,o.strings.suffix=this.state.opt.citeAffixes.institutions[e.secondary].suffix,o.strings.prefix||(o.strings.prefix=" "));var m=new h.Token;m.decorations.push(["@font-style","normal"]),m.decorations.push(["@font-weight","normal"]),this.state.output.openLevel(m),this.state.output.append(l,o),this.state.output.closeLevel(),a=h.Util.cloneToken(n),e.tertiary&&(a.strings.prefix=this.state.opt.citeAffixes.institutions[e.tertiary].prefix,a.strings.suffix=this.state.opt.citeAffixes.institutions[e.tertiary].suffix,a.strings.prefix||(a.strings.prefix=" "));var g=new h.Token;g.decorations.push(["@font-style","normal"]),g.decorations.push(["@font-weight","normal"]),this.state.output.openLevel(g),this.state.output.append(c,a),this.state.output.closeLevel(),this.state.output.closeLevel(),s=this.state.output.pop()}else s=u;return s},h.NameOutput.prototype._renderOneInstitutionPart=function(t,e){for(var n=0,r=t.length;n<r;n+=1)if(t[n]){var i=t[n];if(this.state.tmp.strip_periods)i=i.replace(/\./g,"");else for(var o=0,a=e.decorations.length;o<a;o+=1)if("@strip-periods"===e.decorations[o][0]&&"true"===e.decorations[o][1]){i=i.replace(/\./g,"");break}this.state.tmp.group_context.tip.variable_success=!0,this.state.tmp.can_substitute.replace(!1,h.LITERAL),"!here>>>"===i?t[n]=!1:(this.state.output.append(i,e,!0),t[n]=this.state.output.pop())}return void 0===this.institution.strings["part-separator"]&&(this.institution.strings["part-separator"]=this.state.tmp.name_delimiter),this._join(t,this.institution.strings["part-separator"])},h.NameOutput.prototype._renderNames=function(t,e,n,r){var i=!1;if(e.length){for(var o=[],a=0,s=e.length;a<s;a+=1){var u,l=e[a],c={primary:"locale-orig",secondary:!1,tertiary:!1};if(u=this.state.tmp.extension?["sort"]:l.isInstitution||l.literal?this.state.opt["cite-lang-prefs"].institutions:this.state.opt["cite-lang-prefs"].persons)for(var p=["primary","secondary","tertiary"],f=0,d=p.length;f<d&&!(u.length-1<f);f+=1)c[p[f]]="locale-"+u[f];else c.primary="locale-translat";if((this.state.tmp.sort_key_flag||"bibliography"!==this.state.tmp.area&&("citation"!==this.state.tmp.area||"note"!==this.state.opt.xclass||!this.item||this.item.position))&&(c.secondary=!1,c.tertiary=!1),this.setRenderedName(l),l.literal||l.isInstitution)o.push(this._renderInstitutionName(t,l,c,r));else{var m=this._renderPersonalName(t,l,c,n,a,r),g=h.Util.cloneToken(this.name);this.state.output.append(m,g,!0),o.push(this.state.output.pop())}}i=this.joinPersons(o,n,r)}return i},h.NameOutput.prototype._renderPersonalName=function(t,e,n,r,i,o){var a=this.getName(e,n.primary,!0),s=this._renderOnePersonalName(a.name,r,i,o),u=!1;n.secondary&&(a=this.getName(e,n.secondary,!1,a.usedOrig)).name&&(u=this._renderOnePersonalName(a.name,r,i,o));var l,c=!1;if(n.tertiary&&(a=this.getName(e,n.tertiary,!1,a.usedOrig)).name&&(c=this._renderOnePersonalName(a.name,r,i,o)),u||c){this.state.output.openLevel("empty"),this.state.output.append(s);var p=new h.Token;n.secondary&&(p.strings.prefix=this.state.opt.citeAffixes.persons[n.secondary].prefix,p.strings.suffix=this.state.opt.citeAffixes.persons[n.secondary].suffix,p.strings.prefix||(p.strings.prefix=" ")),this.state.output.append(u,p);var f=new h.Token;n.tertiary&&(f.strings.prefix=this.state.opt.citeAffixes.persons[n.tertiary].prefix,f.strings.suffix=this.state.opt.citeAffixes.persons[n.tertiary].suffix,f.strings.prefix||(f.strings.prefix=" ")),this.state.output.append(c,f),this.state.output.closeLevel(),l=this.state.output.pop()}else l=s;return l},h.NameOutput.prototype._isRomanesque=function(t){var e=2;if(t.family.replace(/\"/g,"").match(h.ROMANESQUE_REGEXP)||(e=0),!e&&t.given&&t.given.match(h.STARTSWITH_ROMANESQUE_REGEXP)&&(e=1),2==e){if(t.multi&&t.multi.main)var n=t.multi.main.slice(0,2);else this.Item.language&&(n=this.Item.language.slice(0,2));["ja","zh"].indexOf(n)>-1&&(e=1)}return e},h.NameOutput.prototype._renderOnePersonalName=function(t,e,n,r){var i=t,o=this._droppingParticle(i,e,r),a=this._familyName(i),s=this._nonDroppingParticle(i),u=this._givenName(i,e,n),l=this._nameSuffix(i);this._isShort(e,n)&&!i["full-form-always"]&&(o=!1,u=!1,l=!1);var c,p=this.state.inheritOpt(this.name,"sort-separator");p||(p=""),c=i["comma-suffix"]?", ":" ";var f=this._isRomanesque(i);var d,m,g,v,y=function t(e){return!!e&&("string"==typeof e.blobs?["’","'","-"," "].indexOf(e.blobs.slice(-1))>-1:t(e.blobs[e.blobs.length-1]))}(s);if(0===f)d=this._join([s,a,u],"");else if(1===f||i["static-ordering"])d=this._join([s,a,u]," ");else if(i["reverse-ordering"])d=this._join([u,s,a]," ");else if(this.state.tmp.sort_key_flag)"never"===this.state.opt["demote-non-dropping-particle"]?(g=this._join([s,a,o]," "),m=this._join([g,u],this.state.opt.sort_sep),d=this._join([m,l]," ")):(v=this._join([u,o,s]," "),m=this._join([a,v],this.state.opt.sort_sep),d=this._join([m,l]," "));else if("all"===this.state.inheritOpt(this.name,"name-as-sort-order")||"first"===this.state.inheritOpt(this.name,"name-as-sort-order")&&0===n&&(0===r||void 0===r))["Lord","Lady"].indexOf(i.given)>-1&&(p=", "),["always","display-and-sort"].indexOf(this.state.opt["demote-non-dropping-particle"])>-1?(v=this._join([u,o],i["comma-dropping-particle"]+" "),(v=this._join([v,s]," "))&&this.given&&(v.strings.prefix=this.given.strings.prefix,v.strings.suffix=this.given.strings.suffix),a&&this.family&&(a.strings.prefix=this.family.strings.prefix,a.strings.suffix=this.family.strings.suffix),m=this._join([a,v],p),d=this._join([m,l],p)):((g=y?this._join([s,a],""):this._join([s,a]," "))&&this.family&&(g.strings.prefix=this.family.strings.prefix,g.strings.suffix=this.family.strings.suffix),(v=this._join([u,o],i["comma-dropping-particle"]+" "))&&this.given&&(v.strings.prefix=this.given.strings.prefix,v.strings.suffix=this.given.strings.suffix),m=this._join([g,v],p),d=this._join([m,l],p));else{i["dropping-particle"]&&i.family&&!i["non-dropping-particle"]&&["'","ʼ","’","-"].indexOf(i["dropping-particle"].slice(-1))>-1&&(a=this._join([o,a],""),o=!1),this.state.tmp.term_predecessor;var b=" ";this.state.inheritOpt(this.name,"initialize-with")&&this.state.inheritOpt(this.name,"initialize-with").match(/[\u00a0\ufeff]/)&&["fr","ru","cs"].indexOf(this.state.opt["default-locale"][0].slice(0,2))>-1&&(b=" "),y?(v=this._join([s,a],""),v=this._join([o,v],b)):v=this._join([o,s,a],b),(v=this._join([v,l],c))&&this.family&&(v.strings.prefix=this.family.strings.prefix,v.strings.suffix=this.family.strings.suffix),u&&this.given&&(u.strings.prefix=this.given.strings.prefix,u.strings.suffix=this.given.strings.suffix),v.strings.prefix&&(i["comma-dropping-particle"]=""),d=this._join([u,v],i["comma-dropping-particle"]+b)}return this.state.tmp.group_context.tip.variable_success=!0,this.state.tmp.can_substitute.replace(!1,h.LITERAL),this.state.tmp.term_predecessor=!0,this.state.tmp.name_node.children.push(d),d},h.NameOutput.prototype._isShort=function(t,e){return 0===this.state.tmp.disambig_settings.givens[t][e]},h.NameOutput.prototype._normalizeNameInput=function(t){var e={literal:t.literal,family:t.family,isInstitution:t.isInstitution,given:t.given,suffix:t.suffix,"comma-suffix":t["comma-suffix"],"non-dropping-particle":t["non-dropping-particle"],"dropping-particle":t["dropping-particle"],"static-ordering":t["static-ordering"],"static-particles":t["static-particles"],"reverse-ordering":t["reverse-ordering"],"full-form-always":t["full-form-always"],"parse-names":t["parse-names"],"comma-dropping-particle":"",block_initialize:t.block_initialize,multi:t.multi};return this._parseName(e),e},h.NameOutput.prototype._stripPeriods=function(t,e){var n=this[t+"_decor"];if(e)if(this.state.tmp.strip_periods)e=e.replace(/\./g,"");else if(n)for(var r=0,i=n.decorations.length;r<i;r+=1)if("@strip-periods"===n.decorations[r][0]&&"true"===n.decorations[r][1]){e=e.replace(/\./g,"");break}return e},h.NameOutput.prototype._nonDroppingParticle=function(t){var e=t["non-dropping-particle"];e&&this.state.tmp.sort_key_flag&&(e=e.replace(/[\'\u2019]/,""));var n=this._stripPeriods("family",e);return!!this.state.output.append(n,this.family_decor,!0)&&this.state.output.pop()},h.NameOutput.prototype._droppingParticle=function(t,e,n){var r=t["dropping-particle"];r&&this.state.tmp.sort_key_flag&&(r=r.replace(/[\'\u2019]/,""));var i=this._stripPeriods("given",r);if(t["dropping-particle"]&&t["dropping-particle"].match(/^et.?al[^a-z]$/))this.state.inheritOpt(this.name,"et-al-use-last")?void 0===n?this.etal_spec[e].freeters=2:this.etal_spec[e].persons=2:void 0===n?this.etal_spec[e].freeters=1:this.etal_spec[e].persons=1,t["comma-dropping-particle"]="";else if(this.state.output.append(i,this.given_decor,!0))return this.state.output.pop();return!1},h.NameOutput.prototype._familyName=function(t){var e=this._stripPeriods("family",t.family);return!!this.state.output.append(e,this.family_decor,!0)&&this.state.output.pop()},h.NameOutput.prototype._givenName=function(t,e,n){if(!1===this.state.inheritOpt(this.name,"initialize"))t.family&&t.given&&!1===this.state.inheritOpt(this.name,"initialize")&&(t.given=h.Util.Names.initializeWith(this.state,t.given,this.state.inheritOpt(this.name,"initialize-with"),!0)),t.given=h.Util.Names.unInitialize(this.state,t.given);else if(t.family&&1===this.state.tmp.disambig_settings.givens[e][n]&&!t.block_initialize){var r=this.state.inheritOpt(this.name,"initialize-with");t.given=h.Util.Names.initializeWith(this.state,t.given,r)}else t.given=h.Util.Names.unInitialize(this.state,t.given);var i=this._stripPeriods("given",t.given);return!!this.state.output.append(i,this.given_decor,!0)&&this.state.output.pop()},h.NameOutput.prototype._nameSuffix=function(t){var e,n=t.suffix;"string"==typeof this.state.inheritOpt(this.name,"initialize-with")&&(n=h.Util.Names.initializeWith(this.state,t.suffix,this.state.inheritOpt(this.name,"initialize-with"),!0));var r="";return(n=this._stripPeriods("family",n))&&"."===n.slice(-1)&&(n=n.slice(0,-1),r="."),!!this.state.output.append(n,"empty",!0)&&((e=this.state.output.pop()).strings.suffix=r+e.strings.suffix,e)},h.NameOutput.prototype._getLongStyle=function(t,e,n){var r;return(r=t.short.length&&this.institutionpart["long-with-short"]?this.institutionpart["long-with-short"]:this.institutionpart.long)||(r=new h.Token),r},h.NameOutput.prototype._getShortStyle=function(){return this.institutionpart.short?this.institutionpart.short:new h.Token},h.NameOutput.prototype._parseName=function(t){var e;if(!t["parse-names"]&&void 0!==t["parse-names"])return t;t.family&&!t.given&&t.isInstitution&&(t.literal=t.family,t.family=void 0,t.isInstitution=void 0),t.family&&'"'===t.family.slice(0,1)&&'"'===t.family.slice(-1)||!t["parse-names"]&&void 0!==t["parse-names"]?(t.family=t.family.slice(1,-1),e=!0,t["parse-names"]=0):e=!1,this.state.opt.development_extensions.parse_names&&!t["non-dropping-particle"]&&t.family&&!e&&t.given&&(t["static-particles"]||h.parseParticles(t,!0))},h.NameOutput.prototype.getName=function(t,e,n,r){if(r&&"locale-orig"===e)return{name:!1,usedOrig:r};t.family||(t.family=""),t.given||(t.given="");var i={};i["static-ordering"]=this.getStaticOrder(t);var o=!0;if("locale-orig"!==e&&(o=!1,t.multi))for(var a=this.state.opt[e],s=0,u=a.length;s<u;s+=1)if(c=a[s],t.multi._key[c]){o=!0;var l=t.isInstitution;(t=t.multi._key[c]).isInstitution=l,(i=this.getNameParams(c)).transliterated=!0;break}if(!o){var c=!1;t.multi&&t.multi.main?c=t.multi.main:this.Item.language&&(c=this.Item.language),c&&(i=this.getNameParams(c))}return n||o?(t.family||(t.family=""),t.given||(t.given=""),!(t={family:t.family,given:t.given,"non-dropping-particle":t["non-dropping-particle"],"dropping-particle":t["dropping-particle"],suffix:t.suffix,"static-ordering":i["static-ordering"],"static-particles":t["static-particles"],"reverse-ordering":i["reverse-ordering"],"full-form-always":i["full-form-always"],"parse-names":t["parse-names"],"comma-suffix":t["comma-suffix"],"comma-dropping-particle":t["comma-dropping-particle"],transliterated:i.transliterated,block_initialize:i["block-initialize"],literal:t.literal,isInstitution:t.isInstitution,multi:t.multi}).literal&&!t.given&&t.family&&t.isInstitution&&(t.literal=t.family),t.literal&&(delete t.family,delete t.given),{name:t=this._normalizeNameInput(t),usedOrig:r||!o}):{name:!1,usedOrig:r}},h.NameOutput.prototype.getNameParams=function(t){var e={},n=h.localeResolve(this.Item.language,this.state.opt["default-locale"][0]),r=this.state.locale[n.best]?n.best:this.state.opt["default-locale"][0],i=this.state.locale[r].opts["name-as-sort-order"],o=this.state.locale[r].opts["name-as-reverse-order"],a=this.state.locale[r].opts["name-never-short"],s=t.split("-")[0];return i&&i[s]&&(e["static-ordering"]=!0,e["reverse-ordering"]=!1),o&&o[s]&&(e["reverse-ordering"]=!0,e["static-ordering"]=!1),a&&a[s]&&(e["full-form-always"]=!0),e["static-ordering"]&&(e["block-initialize"]=!0),e},h.NameOutput.prototype.setRenderedName=function(t){if("bibliography"===this.state.tmp.area){for(var e="",n=0,r=h.NAME_PARTS.length;n<r;n+=1)t[h.NAME_PARTS[n]]&&(e+=t[h.NAME_PARTS[n]]);this.state.tmp.rendered_name.push(e)}},h.NameOutput.prototype.fixupInstitution=function(t,e,n){this.state.sys.getHumanForm&&"legal_case"===this.Item.type&&"authority"===e&&(t.literal=this.state.sys.getHumanForm(this.Item.jurisdiction,t.literal,!0)),t=this._splitInstitution(t,e,n),this.institution.strings["reverse-order"]&&t.long.reverse();var r=t.long,i=t.long.slice(),o=!1;if(this.state.sys.getAbbreviation)for(var a=this.Item.jurisdiction,s=0,u=r.length;s<u;s+=1){var l=r[s];this.state.sys.normalizeAbbrevsKey&&(l=this.state.sys.normalizeAbbrevsKey(r[s])),a=this.state.transform.loadAbbreviation(a,"institution-part",l),this.state.transform.abbrevs[a]["institution-part"][l]&&(i[s]=this.state.transform.abbrevs[a]["institution-part"][l],o=!0)}return t.short=o?i:[],t},h.NameOutput.prototype.getStaticOrder=function(t,e){var n=!1;return!e&&t["static-ordering"]?n=!0:0===this._isRomanesque(t)?n=!0:(!t.multi||!t.multi.main)&&this.Item.language&&["vi","hu"].indexOf(this.Item.language)>-1?n=!0:t.multi&&t.multi.main&&["vi","hu"].indexOf(t.multi.main.slice(0,2))>-1?n=!0:this.state.opt["auto-vietnamese-names"]&&h.VIETNAMESE_NAMES.exec(t.family+" "+t.given)&&h.VIETNAMESE_SPECIALS.exec(t.family+t.given)&&(n=!0),n},h.NameOutput.prototype._splitInstitution=function(t,e,n){var r={};!t.literal&&t.family&&(t.literal=t.family,delete t.family);var i=t.literal.replace(/\s*\|\s*/g,"|");if(i=i.split("|"),"short"===this.institution.strings.form&&this.state.sys.getAbbreviation)for(var o=this.Item.jurisdiction,a=i.length;a>0;a+=-1){var s=i.slice(0,a).join("|"),u=s;if(this.state.sys.normalizeAbbrevsKey&&(u=this.state.sys.normalizeAbbrevsKey(s)),o=this.state.transform.loadAbbreviation(o,"institution-entire",u),this.state.transform.abbrevs[o]["institution-entire"][u]){var l=this.state.transform.abbrevs[o]["institution-entire"][u],c=(l=this.state.transform.quashCheck(l)).split(/>>[0-9]{4}>>/),h=l.match(/>>([0-9]{4})>>/);if(l=c.pop(),c.length>0&&this.Item["original-date"]&&this.Item["original-date"].year)for(var p=h.length-1;p>0&&!(parseInt(this.Item["original-date"].year,10)>=parseInt(h[p],10));p+=-1)l=c.pop();i=[l=l.replace(/\s*\|\s*/g,"|")];break}}return i.reverse(),r.long=this._trimInstitution(i,e,n),r},h.NameOutput.prototype._trimInstitution=function(t,e,n){var r=!1,i=!1,o=t.slice(),a=!1;return this.institution&&(void 0!==this.institution.strings["use-first"]&&(r=this.institution.strings["use-first"]),void 0!==this.institution.strings["stop-last"]?a=this.institution.strings["stop-last"]:"authority"===e&&this.state.tmp.authority_stop_last&&(a=this.state.tmp.authority_stop_last),a&&(o=o.slice(0,a),t=t.slice(0,a)),void 0!==this.institution.strings["use-last"]&&(i=this.institution.strings["use-last"]),"authority"===e&&(a&&(this.state.tmp.authority_stop_last=a),i&&(this.state.tmp.authority_stop_last+=-1*i))),!1===r&&(0===this.persons[e].length&&(r=this.institution.strings["substitute-use-first"]),r||(r=0)),!1===i&&(i=r?0:t.length),r>t.length-i&&(r=t.length-i),t=t.slice(0,r),o=o.slice(r),i&&(i>o.length&&(i=o.length),i&&(t=t.concat(o.slice(o.length-i)))),t},t.exports=h,h.PublisherOutput=function(t,e){this.state=t,this.group_tok=e,this.varlist=[]},h.PublisherOutput.prototype.render=function(){this.clearVars(),this.composeAndBlob(),this.composeElements(),this.composePublishers(),this.joinPublishers()},h.PublisherOutput.prototype.composeAndBlob=function(){this.and_blob={};var t=!1;"text"===this.group_tok.strings.and?t=this.state.getTerm("and"):"symbol"===this.group_tok.strings.and&&(t="&");var e=new h.Token;e.strings.suffix=" ",e.strings.prefix=" ",this.state.output.append(t,e,!0);var n=this.state.output.pop();e.strings.prefix=this.group_tok.strings["subgroup-delimiter"],this.state.output.append(t,e,!0);var r=this.state.output.pop();this.and_blob.single=!1,this.and_blob.multiple=!1,t&&("always"===this.group_tok.strings["subgroup-delimiter-precedes-last"]?this.and_blob.single=r:"never"===this.group_tok.strings["subgroup-delimiter-precedes-last"]?(this.and_blob.single=n,this.and_blob.multiple=n):(this.and_blob.single=n,this.and_blob.multiple=r))},h.PublisherOutput.prototype.composeElements=function(){for(var t=0;t<2;t+=1)for(var e=["publisher","publisher-place"][t],n=0,r=this["publisher-list"].length;n<r;n+=1){var i=this[e+"-list"][n],o=this[e+"-token"];this.state.output.append(i,o,!0),this[e+"-list"][n]=this.state.output.pop()}},h.PublisherOutput.prototype.composePublishers=function(){for(var t,e=0,n=this["publisher-list"].length;e<n;e+=1){t=[this[this.varlist[0]+"-list"][e],this[this.varlist[1]+"-list"][e]],this["publisher-list"][e]=this._join(t,this.group_tok.strings.delimiter)}},h.PublisherOutput.prototype.joinPublishers=function(){var t=this["publisher-list"],e=(this.name_delimiter,this._join(t,this.group_tok.strings["subgroup-delimiter"],this.and_blob.single,this.and_blob.multiple,this.group_tok));this.state.output.append(e,"literal")},h.PublisherOutput.prototype._join=h.NameOutput.prototype._join,h.PublisherOutput.prototype._getToken=h.NameOutput.prototype._getToken,h.PublisherOutput.prototype.clearVars=function(){this.state.tmp["publisher-list"]=!1,this.state.tmp["publisher-place-list"]=!1,this.state.tmp["publisher-group-token"]=!1,this.state.tmp["publisher-token"]=!1,this.state.tmp["publisher-place-token"]=!1},t.exports=h,h.evaluateLabel=function(t,e,n,r){var i;"locator"===t.strings.term?(r&&r.label&&(i="sub verbo"===r.label?"sub-verbo":r.label),i||(i="page")):i=t.strings.term;var o=t.strings.plural;if("number"!=typeof o){var a="locator"===t.strings.term?r:n;e.processNumber(!1,a,t.strings.term,n.type),o=e.tmp.shadow_numbers[t.strings.term].plural,e.tmp.shadow_numbers[t.strings.term].labelForm||e.tmp.shadow_numbers[t.strings.term].labelDecorations||(e.tmp.shadow_numbers[t.strings.term].labelForm=t.strings.form,e.tmp.shadow_numbers[t.strings.term].labelDecorations=t.decorations.slice()),["locator","number","page"].indexOf(t.strings.term)>-1&&e.tmp.shadow_numbers[t.strings.term].label&&(i=e.tmp.shadow_numbers[t.strings.term].label),t.decorations&&(e.opt.development_extensions.csl_reverse_lookup_support||e.sys.csl_reverse_lookup_support)&&(t.decorations.reverse(),t.decorations.push(["@showid","true",t.cslid]),t.decorations.reverse())}return h.castLabel(e,t,i,o,h.TOLERANT)},h.castLabel=function(t,e,n,r,i){var o=e.strings.form;t.tmp.group_context.tip.label_form&&"static"!==o&&(o=t.tmp.group_context.tip.label_form);var a=t.getTerm(n,o,r,!1,i,e.default_locale);if(t.tmp.strip_periods)a=a.replace(/\./g,"");else for(var s=0,u=e.decorations.length;s<u;s+=1)if("@strip-periods"===e.decorations[s][0]&&"true"===e.decorations[s][1]){a=a.replace(/\./g,"");break}return a},t.exports=h,h.Node.name={build:function(t,e){var n;if([h.SINGLETON,h.START].indexOf(this.tokentype)>-1){if(void 0===t.tmp.root){var r=void 0;t.tmp.root="citation"}else r=t.tmp.root;t.inheritOpt(this,"et-al-subsequent-min")&&t.inheritOpt(this,"et-al-subsequent-min")!==t.inheritOpt(this,"et-al-min")&&(t.opt.update_mode=h.POSITION),t.inheritOpt(this,"et-al-subsequent-use-first")&&t.inheritOpt(this,"et-al-subsequent-use-first")!==t.inheritOpt(this,"et-al-use-first")&&(t.opt.update_mode=h.POSITION),t.tmp.root=r,n=function(t,e){t.tmp.etal_term="et-al",t.tmp.name_delimiter=t.inheritOpt(this,"delimiter","name-delimiter",", "),t.tmp["delimiter-precedes-et-al"]=t.inheritOpt(this,"delimiter-precedes-et-al"),"text"===t.inheritOpt(this,"and")?this.and_term=t.getTerm("and","long",0):"symbol"===t.inheritOpt(this,"and")&&(t.opt.development_extensions.expect_and_symbol_form?this.and_term=t.getTerm("and","symbol",0):this.and_term="&"),t.tmp.and_term=this.and_term,h.STARTSWITH_ROMANESQUE_REGEXP.test(this.and_term)?(this.and_prefix_single=" ",this.and_prefix_multiple=", ","string"==typeof t.tmp.name_delimiter&&(this.and_prefix_multiple=t.tmp.name_delimiter),this.and_suffix=" "):(this.and_prefix_single="",this.and_prefix_multiple="",this.and_suffix=""),"always"===t.inheritOpt(this,"delimiter-precedes-last")?this.and_prefix_single=t.tmp.name_delimiter:"never"===t.inheritOpt(this,"delimiter-precedes-last")?this.and_prefix_multiple&&(this.and_prefix_multiple=" "):"after-inverted-name"===t.inheritOpt(this,"delimiter-precedes-last")&&(this.and_prefix_single&&(this.and_prefix_single=t.tmp.name_delimiter),this.and_prefix_multiple&&(this.and_prefix_multiple=" ")),this.and={},t.inheritOpt(this,"and")?(t.output.append(this.and_term,"empty",!0),this.and.single=t.output.pop(),this.and.single.strings.prefix=this.and_prefix_single,this.and.single.strings.suffix=this.and_suffix,t.output.append(this.and_term,"empty",!0),this.and.multiple=t.output.pop(),this.and.multiple.strings.prefix=this.and_prefix_multiple,this.and.multiple.strings.suffix=this.and_suffix):t.tmp.name_delimiter&&(this.and.single=new h.Blob(t.tmp.name_delimiter),this.and.single.strings.prefix="",this.and.single.strings.suffix="",this.and.multiple=new h.Blob(t.tmp.name_delimiter),this.and.multiple.strings.prefix="",this.and.multiple.strings.suffix=""),this.ellipsis={},t.inheritOpt(this,"et-al-use-last")&&(this.ellipsis_term="…",this.ellipsis_prefix_single=" ",this.ellipsis_prefix_multiple=t.inheritOpt(this,"delimiter","name-delimiter",", "),this.ellipsis_suffix=" ",this.ellipsis.single=new h.Blob(this.ellipsis_term),this.ellipsis.single.strings.prefix=this.ellipsis_prefix_single,this.ellipsis.single.strings.suffix=this.ellipsis_suffix,this.ellipsis.multiple=new h.Blob(this.ellipsis_term),this.ellipsis.multiple.strings.prefix=this.ellipsis_prefix_multiple,this.ellipsis.multiple.strings.suffix=this.ellipsis_suffix),void 0===t.tmp["et-al-min"]&&(t.tmp["et-al-min"]=t.inheritOpt(this,"et-al-min")),void 0===t.tmp["et-al-use-first"]&&(t.tmp["et-al-use-first"]=t.inheritOpt(this,"et-al-use-first")),void 0===t.tmp["et-al-use-last"]&&(t.tmp["et-al-use-last"]=t.inheritOpt(this,"et-al-use-last")),t.nameOutput.name=this},t.build.name_flag=!0,this.execs.push(n)}e.push(this)}},t.exports=h,h.Node["name-part"]={build:function(t,e){t.build[this.strings.name]=this}},t.exports=h,h.Node.names={build:function(t,e){var n;if(this.tokentype!==h.START&&this.tokentype!==h.SINGLETON||(h.Util.substituteStart.call(this,t,e),t.build.substitute_level.push(1)),this.tokentype===h.SINGLETON&&(t.build.names_variables.push(this.variables),n=function(t,e,n){var r=t.nameOutput.labelVariable;t.nameOutput.reinit(this,r)},this.execs.push(n)),this.tokentype===h.START&&(t.build.names_flag=!0,t.build.names_level+=1,1===t.build.names_level&&(t.build.names_variables=[],t.build.name_label={}),t.build.names_variables.push(this.variables),n=function(t,e,n){t.tmp.can_substitute.push(!0),t.parallel.StartVariable("names",this.variables[0]),t.nameOutput.init(this)},this.execs.push(n)),this.tokentype===h.END){for(var r=0;r<3;r+=1){var i=["family","given","et-al"][r];this[i]=t.build[i],1===t.build.names_level&&(t.build[i]=void 0)}this.label=t.build.name_label,1===t.build.names_level&&(t.build.name_label={}),t.build.names_level+=-1,t.build.names_variables.pop(),n=function(t,e,n){t.tmp.etal_node?this.etal_style=t.tmp.etal_node:this.etal_style="empty",this.etal_term=t.getTerm(t.tmp.etal_term,"long",0),h.STARTSWITH_ROMANESQUE_REGEXP.test(this.etal_term)?(this.etal_prefix_single=" ",this.etal_prefix_multiple=t.tmp.name_delimiter,"always"===t.tmp["delimiter-precedes-et-al"]?this.etal_prefix_single=t.tmp.name_delimiter:"never"===t.tmp["delimiter-precedes-et-al"]?this.etal_prefix_multiple=" ":"after-inverted-name"===t.tmp["delimiter-precedes-et-al"]&&(this.etal_prefix_single=t.tmp.name_delimiter,this.etal_prefix_multiple=" "),this.etal_suffix=""):(this.etal_prefix_single="",this.etal_prefix_multiple="",this.etal_suffix="");for(var r=0;r<3;r+=1){var i=["family","given"][r];t.nameOutput[i]=this[i]}t.nameOutput.with=this.with;var o="",a="";h.STARTSWITH_ROMANESQUE_REGEXP.test("with")&&(o=" ",a=" ");var s={};s.single=new h.Blob("with"),s.single.strings.suffix=a,s.multiple=new h.Blob("with"),s.multiple.strings.suffix=a,"always"===t.inheritOpt(t.nameOutput.name,"delimiter-precedes-last")?(s.single.strings.prefix=t.inheritOpt(this,"delimiter","names-delimiter"),s.multiple.strings.prefix=t.inheritOpt(this,"delimiter","names-delimiter")):"contextual"===t.inheritOpt(t.nameOutput.name,"delimiter-precedes-last")?(s.single.strings.prefix=o,s.multiple.strings.prefix=t.inheritOpt(this,"delimiter","names-delimiter")):"after-inverted-name"===t.inheritOpt(t.nameOutput.name,"delimiter-precedes-last")?(s.single.strings.prefix=t.inheritOpt(this,"delimiter","names-delimiter"),s.multiple.strings.prefix=o):(s.single.strings.prefix=o,s.multiple.strings.prefix=o),t.nameOutput.with=s,t.nameOutput.label=this.label,t.nameOutput.etal_style=this.etal_style,t.nameOutput.etal_term=this.etal_term,t.nameOutput.etal_prefix_single=this.etal_prefix_single,t.nameOutput.etal_prefix_multiple=this.etal_prefix_multiple,t.nameOutput.etal_suffix=this.etal_suffix,t.nameOutput.outputNames(),t.tmp["et-al-use-first"]=void 0,t.tmp["et-al-min"]=void 0,t.tmp["et-al-use-last"]=void 0},this.execs.push(n),n=function(t,e){t.tmp.can_substitute.pop()||t.tmp.can_substitute.replace(!1,h.LITERAL),t.parallel.CloseVariable("names"),1===t.tmp.can_substitute.mystack.length&&(t.tmp.can_block_substitute=!1)},this.execs.push(n),t.build.name_flag=!1}e.push(this),this.tokentype!==h.END&&this.tokentype!==h.SINGLETON||(t.build.substitute_level.pop(),h.Util.substituteEnd.call(this,t,e))}},t.exports=h,h.Node.number={build:function(t,e){var n;h.Util.substituteStart.call(this,t,e),"roman"===this.strings.form?this.formatter=t.fun.romanizer:"ordinal"===this.strings.form?this.formatter=t.fun.ordinalizer:"long-ordinal"===this.strings.form&&(this.formatter=t.fun.long_ordinalizer),void 0===this.successor_prefix&&(this.successor_prefix=t[t.build.area].opt.layout_delimiter),void 0===this.splice_prefix&&(this.splice_prefix=t[t.build.area].opt.layout_delimiter),n=function(t,e,n){if(0!==this.variables.length){if(void 0===n)n={};var r;if("locator"!==(r=this.variables[0])||!t.tmp.just_looking){t.parallel.StartVariable(this.variables[0]),"locator"===this.variables[0]?t.parallel.AppendToVariable(e.section):t.parallel.AppendToVariable(e[this.variables[0]]);new RegExp("(?:&|, | and |"+t.getTerm("page-range-delimiter")+")");"collection-number"===r&&"legal_case"===e.type&&(t.tmp.renders_collection_number=!0);e[this.variables[0]];this.strings.label_form_override&&this.strings.label_form_override;if(t.tmp.group_context.tip.force_suppress)return!1;"locator"===r?t.processNumber(this,n,r,e.type):(!t.tmp.group_context.tip.condition&&e[r]&&(t.tmp.just_did_number=!0),t.processNumber(this,e,r,e.type)),h.Util.outputNumericField(t,r,e.id),t.parallel.CloseVariable("number"),["locator","locator-extra"].indexOf(this.variables_real[0])>-1&&!t.tmp.just_looking&&(t.tmp.done_vars.push(this.variables_real[0]),t.tmp.group_context.tip.done_vars.push(this.variables_real[0]))}}},this.execs.push(n),e.push(this),h.Util.substituteEnd.call(this,t,e)}},t.exports=h,h.Node.sort={build:function(t,e){if(e=t[t.build.root+"_sort"].tokens,this.tokentype===h.START){"citation"===t.build.area&&(t.parallel.use_parallels=!1,t.opt.sort_citations=!0),t.build.area=t.build.root+"_sort",t.build.extension="_sort";var n=function(t,e){if(t.opt.has_layout_locale){for(var n,r=h.localeResolve(e.language,t.opt["default-locale"][0]),i=t[t.tmp.area.slice(0,-5)].opt.sort_locales,o=0,a=i.length;o<a&&((n=i[o][r.bare])||(n=i[o][r.best]),!n);o+=1);n||(n=t.opt["default-locale"][0]),t.tmp.lang_sort_hold=t.opt.lang,t.opt.lang=n}};this.execs.push(n)}if(this.tokentype===h.END){t.build.area=t.build.root,t.build.extension="";n=function(t,e){t.opt.has_layout_locale&&(t.opt.lang=t.tmp.lang_sort_hold,delete t.tmp.lang_sort_hold)};this.execs.push(n)}e.push(this)}},t.exports=h,h.Node.substitute={build:function(t,e){var n;this.tokentype===h.START&&(n=function(t,e){t.tmp.can_block_substitute=!0,t.tmp.value.length&&t.tmp.can_substitute.replace(!1,h.LITERAL)},this.execs.push(n)),e.push(this)}},t.exports=h,h.Node.text={build:function(t,e){var n,r,i,o,a,s,u,l,c,p,f,d;if(this.postponed_macro){var m=h.Util.cloneToken(this);m.name="group",m.tokentype=h.START,h.Node.group.build.call(m,t,e),h.expandMacro.call(t,this,e);var g=h.Util.cloneToken(this);g.name="group",g.tokentype=h.END,"juris-locator-label"===this.postponed_macro&&(g.isJurisLocatorLabel=!0),h.Node.group.build.call(g,t,e)}else{if(h.Util.substituteStart.call(this,t,e),this.variables_real||(this.variables_real=[]),this.variables||(this.variables=[]),r="long",i=0,this.strings.form&&(r=this.strings.form),this.strings.plural&&(i=this.strings.plural),"citation-number"===this.variables_real[0]||"year-suffix"===this.variables_real[0]||"citation-label"===this.variables_real[0])"citation-number"===this.variables_real[0]?("citation"===t.build.root&&(t.opt.update_mode=h.NUMERIC),"bibliography"===t.build.root&&(t.opt.bib_mode=h.NUMERIC),"bibliography_sort"===t.build.area&&(t.opt.citation_number_sort_used=!0),"citation-number"===t[t.tmp.area].opt.collapse&&(this.range_prefix=t.getTerm("citation-range-delimiter")),this.successor_prefix=t[t.build.area].opt.layout_delimiter,this.splice_prefix=t[t.build.area].opt.layout_delimiter,n=function(t,e,n){if(o=""+e.id,!t.tmp.just_looking){if(n&&n["author-only"]){t.tmp.element_trace.replace("do-not-suppress-me");var r=t.getTerm("reference","long","singular");void 0===r&&(r="reference"),d=h.Output.Formatters["capitalize-first"](t,r),t.output.append(d+" "),t.tmp.last_element_trace=!0}n&&n["suppress-author"]&&(t.tmp.last_element_trace&&t.tmp.element_trace.replace("suppress-me"),t.tmp.last_element_trace=!1),a=t.registry.registry[o].seq,t.opt.citation_number_slug?t.output.append(t.opt.citation_number_slug,this):(s=new h.NumericBlob(!1,a,this,e.id),t.tmp.in_cite_predecessor&&(t.tmp.just_looking,s.suppress_splice_prefix=!0),t.output.append(s,"literal"))}},this.execs.push(n)):"year-suffix"===this.variables_real[0]?(t.opt.has_year_suffix=!0,"year-suffix-ranged"===t[t.tmp.area].opt.collapse&&(this.range_prefix=t.getTerm("citation-range-delimiter")),this.successor_prefix=t[t.build.area].opt.layout_delimiter,t[t.tmp.area].opt["year-suffix-delimiter"]&&(this.successor_prefix=t[t.build.area].opt["year-suffix-delimiter"]),n=function(t,e){if(t.registry.registry[e.id]&&!1!==t.registry.registry[e.id].disambig.year_suffix&&!t.tmp.just_looking){a=parseInt(t.registry.registry[e.id].disambig.year_suffix,10),t[t.tmp.area].opt.cite_group_delimiter&&(this.successor_prefix=t[t.tmp.area].opt.cite_group_delimiter),s=new h.NumericBlob(!1,a,this,e.id),u=new h.Util.Suffixator(h.SUFFIX_CHARS),s.setFormatter(u),t.output.append(s,"literal"),l=!1;for(var n=0,r=t.tmp.group_context.mystack.length;n<r;n++){var i=t.tmp.group_context.mystack[n];if(!i.variable_success&&(i.variable_attempt||!i.variable_attempt&&!i.term_intended)){l=!0;break}}c=t[t.tmp.area].opt["year-suffix-delimiter"],l&&c&&!t.tmp.sort_key_flag&&(t.tmp.splice_delimiter=t[t.tmp.area].opt["year-suffix-delimiter"])}},this.execs.push(n)):"citation-label"===this.variables_real[0]&&(t.opt.has_year_suffix=!0,n=function(t,e){(p=e["citation-label"])||(p=t.getCitationLabel(e)),t.tmp.just_looking||(f="",t.registry.registry[e.id]&&!1!==t.registry.registry[e.id].disambig.year_suffix&&(a=parseInt(t.registry.registry[e.id].disambig.year_suffix,10),f=t.fun.suffixator.format(a)),p+=f),t.output.append(p,this)},this.execs.push(n));else if(this.strings.term)n=function(t,e,n){var o,a=t.opt.gender[e.type],s=this.strings.term;if(""!==(s=t.getTerm(s,r,i,a,h.TOLERANT,this.default_locale))&&(t.tmp.group_context.tip.term_intended=!0),h.UPDATE_GROUP_CONTEXT_CONDITION(t,s),o=t.tmp.term_predecessor||"in-text"===t.opt.class&&"citation"===t.tmp.area?s:h.Output.Formatters["capitalize-first"](t,s),t.tmp.strip_periods)o=o.replace(/\./g,"");else for(var u=0,l=this.decorations.length;u<l;u+=1)if("@strip-periods"===this.decorations[u][0]&&"true"===this.decorations[u][1]){o=o.replace(/\./g,"");break}t.output.append(o,this)},this.execs.push(n),t.build.term=!1,t.build.form=!1,t.build.plural=!1;else if(this.variables_real.length){if(n=function(t,e,n){"locator"!==this.variables_real[0]&&(t.tmp.have_collapsed=!1);var i=this.variables[0];"title"!==i||"short"!==r&&!e["title-short"]||(i="title-short"),t.parallel.StartVariable(i),t.parallel.AppendToVariable(e[i],i),!t.tmp.group_context.tip.condition&&e[this.variables[0]]&&(t.tmp.just_did_number=!1)},this.execs.push(n),h.MULTI_FIELDS.indexOf(this.variables_real[0])>-1||["language-name","language-name-original"].indexOf(this.variables_real[0])>-1){var v=this.variables[0],y=!1,b=!1,_=!1;"short"===r?"container-title"===this.variables_real[0]?b="journalAbbreviation":"title"===this.variables_real[0]&&(b="title-short"):v=!1,t.build.extension?_=!0:(_=!0,y=!0),n=t.transform.getOutputFunction(this.variables,v,y,b,_)}else n=h.CITE_FIELDS.indexOf(this.variables_real[0])>-1?function(t,e,n){n&&n[this.variables[0]]&&(t.processNumber(this,n,this.variables[0],e.type),h.Util.outputNumericField(t,this.variables[0],e.id),t.output.append(void 0,this,!1,!1,!0),["locator","locator-extra"].indexOf(this.variables_real[0])>-1&&!t.tmp.just_looking&&t.tmp.done_vars.push(this.variables_real[0]))}:["page","page-first","chapter-number","collection-number","edition","issue","number","number-of-pages","number-of-volumes","volume"].indexOf(this.variables_real[0])>-1?function(t,e){t.processNumber(this,e,this.variables[0],e.type),h.Util.outputNumericField(t,this.variables[0],e.id)}:["URL","DOI"].indexOf(this.variables_real[0])>-1?function(t,e){var n;if(this.variables[0]&&(n=t.getVariable(e,this.variables[0],r)))if(t.opt.development_extensions.wrap_url_and_doi)if(this.decorations.length&&this.decorations[0][0]==="@"+this.variables[0])t.output.append(n,this,!1,!1,!0);else if("DOI"===this.variables_real[0]&&"https://doi.org/"===this.strings.prefix){var i=h.Util.cloneToken(this),o=new h.Blob(null,null,"url-wrapper");if(o.decorations.push(["@DOI","true"]),(n=n.replace(/^https?:\/\/doi\.org\//,"")).match(/^https?:\/\//))var a="";else a="https://doi.org/";var s=new h.Blob(a),u=new h.Blob(n);i.strings.prefix="",o.push(s),o.push(u),t.output.append(o,i,!1,!1,!0)}else this.decorations=[["@"+this.variables[0],"true"]].concat(this.decorations),t.output.append(n,this,!1,!1,!0);else{if(this.decorations.length)for(var l=this.decorations.length-1;l>-1;l--)this.decorations[l][0]==="@"+this.variables[0]&&(this.decorations=this.decorations.slice(0,l).concat(this.decorations.slice(l+1)));t.output.append(n,this,!1,!1,!0)}}:"section"===this.variables_real[0]?function(t,e){var n;(n=t.getVariable(e,this.variables[0],r))&&t.output.append(n,this)}:"hereinafter"===this.variables_real[0]?function(t,e){var n=t.transform.abbrevs.default.hereinafter[e.id];n&&(t.output.append(n,this),t.tmp.group_context.tip.variable_success=!0)}:function(t,e){var n;this.variables[0]&&(n=t.getVariable(e,this.variables[0],r))&&(n=(n=""+n).split("\\").join(""),t.output.append(n,this))};this.execs.push(n),n=function(t,e){t.parallel.CloseVariable("text")},this.execs.push(n)}else this.strings.value&&(n=function(t,e){t.tmp.group_context.tip.term_intended=!0,h.UPDATE_GROUP_CONTEXT_CONDITION(t,this.strings.value,!0),t.output.append(this.strings.value,this)},this.execs.push(n));e.push(this),h.Util.substituteEnd.call(this,t,e)}}},t.exports=h,h.Attributes={},h.Attributes["@genre"]=function(t,e){e=e.replace("-"," ");this.tests.push(function(t,n){return e===t.genre})},h.Attributes["@disambiguate"]=function(t,e){if("true"===e){t.opt.has_disambiguate=!0;var n=function(e,n){return t.tmp.disambiguate_maxMax+=1,!!(t.tmp.disambig_settings.disambiguate&&t.tmp.disambiguate_count<t.tmp.disambig_settings.disambiguate)&&(t.tmp.disambiguate_count+=1,!0)};this.tests.push(n)}else if("check-ambiguity-and-backreference"===e){n=function(e,n){return!!(t.registry.registry[e.id].disambig.disambiguate&&t.registry.registry[e.id]["citation-count"]>1)};this.tests.push(n)}},h.Attributes["@is-numeric"]=function(t,e,n){for(var r=e.split(/\s+/),i=function(e){return function(n,r){var i=n;if(["locator","locator-extra"].indexOf(e)>-1&&(i=r),void 0===i)return!1;if(h.NUMERIC_VARIABLES.indexOf(e)>-1){if(t.tmp.shadow_numbers[e]||t.processNumber(!1,i,e,n.type),i[e]&&t.tmp.shadow_numbers[e].numeric)return!0}else if(["title","locator-extra","version"].indexOf(e)>-1&&i[e]&&i[e].slice(-1)===""+parseInt(i[e].slice(-1),10))return!0;return!1}},o=0;o<r.length;o+=1)this.tests.push(i(r[o]))},h.Attributes["@is-uncertain-date"]=function(t,e){for(var n=e.split(/\s+/),r=function(t){return function(e,n){return!(!e[t]||!e[t].circa)}},i=0,o=n.length;i<o;i+=1)this.tests.push(r(n[i]))},h.Attributes["@locator"]=function(t,e){for(var n=e.replace("sub verbo","sub-verbo"),r=function(e){return function(n,r){var i;return t.processNumber(!1,r,"locator"),i=t.tmp.shadow_numbers.locator.label,e===i}},i=0,o=(n=n.split(/\s+/)).length;i<o;i+=1)this.tests.push(r(n[i]))},h.Attributes["@position"]=function(t,e){t.opt.update_mode=h.POSITION,t.parallel.use_parallels=null;for(var n=e.split(/\s+/),r=function(e){return function(n,r){if("bibliography"===t.tmp.area)return!1;if(r&&void 0===r.position&&(r.position=0),r&&"number"==typeof r.position){if(0===r.position&&0===e)return!0;if(e>0&&r.position>=e)return!0}else if(0===e)return!0;return!1}},i=0,o=n.length;i<o;i+=1){var a;"first"===(a=n[i])?a=h.POSITION_FIRST:"subsequent"===a?a=h.POSITION_SUBSEQUENT:"ibid"===a?a=h.POSITION_IBID:"ibid-with-locator"===a&&(a=h.POSITION_IBID_WITH_LOCATOR),"near-note"===a?this.tests.push(function(t,e){return!!(e&&e.position>=h.POSITION_SUBSEQUENT&&e["near-note"])}):"far-note"===a?this.tests.push(function(t,e){return!(!e||e.position!=h.POSITION_SUBSEQUENT||e["near-note"])}):this.tests.push(r(a))}},h.Attributes["@type"]=function(t,e){for(var n=e.split(/\s+/),r=function(t){return function(e,n){return!!(e.type===t)}},i=[],o=0,a=n.length;o<a;o+=1)i.push(r(n[o]));this.tests.push(t.fun.match.any(this,t,i))},h.Attributes["@variable"]=function(t,e){var n;if(this.variables=e.split(/\s+/),this.variables_real=this.variables.slice(),"label"===this.name&&this.variables[0])this.strings.term=this.variables[0];else if(["names","date","text","number"].indexOf(this.name)>-1)n=function(t,e,n){for(var r=this.variables.length-1;r>-1;r+=-1)this.variables.pop();r=0;for(var i=this.variables_real.length;r<i;r++)-1!==t.tmp.done_vars.indexOf(this.variables_real[r])||n&&"legal_case"===e.type&&n["suppress-author"]&&"title"===this.variables_real[r]||this.variables.push(this.variables_real[r]),t.tmp.can_block_substitute&&t.tmp.done_vars.push(this.variables_real[r])},this.execs.push(n),n=function(t,e,n){for(var r=!1,i=0,o=this.variables.length;i<o;i++){var a=this.variables[i];if(["authority","committee"].indexOf(a)>-1&&"string"==typeof e[a]&&"names"===this.name){var s=!0,u=e[a].split(/\s*;\s*/),l={};if(e.multi&&e.multi._keys[a])for(var c in e.multi._keys[a])if(l[c]=e.multi._keys[a][c].split(/\s*;\s*/),l[c].length!==u.length){s=!1;break}s||(u=[e[a]],l=e.multi._keys[a]);for(var p=0,f=u.length;p<f;p++){var d={literal:u[p],multi:{_key:{}}};for(var c in l){var m={literal:l[c][p]};d.multi._key[c]=m}u[p]=d}e[a]=u}if("short"!==this.strings.form||e[a]||("title"===a?a="title-short":"container-title"===a&&(a="journalAbbreviation")),"year-suffix"===a){r=!0;break}if(h.DATE_VARIABLES.indexOf(a)>-1){if(t.opt.development_extensions.locator_date_and_revision&&"locator-date"===a){r=!0;break}if(e[a]){for(var g in e[a])if((-1!==this.dateparts.indexOf(g)||"literal"===g)&&e[a][g]){r=!0;break}if(r)break}}else{if("locator"===a){n&&n.locator&&(r=!0);break}if("locator-extra"===a){n&&n["locator-extra"]&&(r=!0);break}if(["citation-number","citation-label"].indexOf(a)>-1){r=!0;break}if("first-reference-note-number"===a){n&&n["first-reference-note-number"]&&(r=!0);break}if("hereinafter"===a){t.transform.abbrevs.default.hereinafter[e.id]&&t.sys.getAbbreviation&&e.id&&(r=!0);break}if("object"==typeof e[a]){e[a].length;break}if("string"==typeof e[a]&&e[a]){r=!0;break}if("number"==typeof e[a]){r=!0;break}}if(r)break}if(r){for(i=0,o=this.variables_real.length;i<o;i++){"citation-number"===(a=this.variables_real[i])&&"bibliography"===t.tmp.area||(t.tmp.cite_renders_content=!0),t.tmp.group_context.tip.variable_success=!0,t.tmp.can_substitute.value()&&"bibliography"===t.tmp.area&&"string"==typeof e[a]&&(t.tmp.name_node.top=t.output.current.value(),t.tmp.rendered_name.push(e[a]))}t.tmp.can_substitute.replace(!1,h.LITERAL)}else t.tmp.group_context.tip.variable_attempt=!0},this.execs.push(n);else if(["if","else-if","condition"].indexOf(this.name)>-1)for(var r=function(e){return function(n,r){var i=n;if(r&&["locator","locator-extra","first-reference-note-number","locator-date"].indexOf(e)>-1&&(i=r),"hereinafter"===e&&t.sys.getAbbreviation&&i.id){if(t.transform.abbrevs.default.hereinafter[i.id])return!0}else if(i[e]){if("number"==typeof i[e]||"string"==typeof i[e])return!0;if("object"==typeof i[e])for(var o in i[e])if(i[e][o])return!0}return!1}},i=0,o=this.variables.length;i<o;i+=1)this.tests.push(r(this.variables[i]))},h.Attributes["@page"]=function(t,e){for(var n=e.replace("sub verbo","sub-verbo"),r=function(e){return function(n,r){var i;return t.processNumber(!1,n,"page",n.type),i=t.tmp.shadow_numbers.page.label?"sub verbo"===t.tmp.shadow_numbers.page.label?"sub-verbo":t.tmp.shadow_numbers.page.label:"page",e===i}},i=0,o=(n=n.split(/\s+/)).length;i<o;i+=1)this.tests.push(r(n[i]))},h.Attributes["@number"]=function(t,e){for(var n=e.replace("sub verbo","sub-verbo"),r=function(e){return function(n,r){var i;return t.processNumber(!1,n,"number",n.type),i=t.tmp.shadow_numbers.number.label?"sub verbo"===t.tmp.shadow_numbers.number.label?"sub-verbo":t.tmp.shadow_numbers.number.label:"number",e===i}},i=0,o=(n=n.split(/\s+/)).length;i<o;i+=1)this.tests.push(r(n[i]))},h.Attributes["@jurisdiction"]=function(t,e){for(var n=e.split(/\s+/),r=0,i=n.length;r<i;r+=1)n[r]=n[r].split(":");var o=function(t){return function(e,n){if(!e.jurisdiction)return!1;for(var r=e.jurisdiction.split(":"),i=0,o=r.length;i<o;i+=1)r[i]=r[i].split(":");for(i=t.length;i>0;i+=-1){if(t.slice(0,i).join(":")!==r.slice(0,i).join(":"))return!1}return!0}};for(r=0,i=n.length;r<i;r+=1){var a=n[r].slice();this.tests.push(o(a))}},h.Attributes["@context"]=function(t,e){this.tests.push(function(n,r){return t.tmp.area.slice(0,e.length)===e})},h.Attributes["@has-year-only"]=function(t,e){for(var n=e.split(/\s+/),r=function(t){return function(e,n){var r=e[t];return!(!r||r.month||r.season)}},i=0,o=n.length;i<o;i+=1)this.tests.push(r(n[i]))},h.Attributes["@has-to-month-or-season"]=function(t,e){for(var n=e.split(/\s+/),r=function(t){return function(e,n){var r=e[t];return!(!r||!r.month&&!r.season||r.day)}},i=0,o=n.length;i<o;i+=1)this.tests.push(r(n[i]))},h.Attributes["@has-day"]=function(t,e){for(var n=e.split(/\s+/),r=function(t){return function(e,n){var r=e[t];return!(!r||!r.day)}},i=0,o=n.length;i<o;i+=1)this.tests.push(r(n[i]))},h.Attributes["@subjurisdictions"]=function(t,e){var n=parseInt(e,10);this.tests.push(function(t,e){var r=0;return t.jurisdiction&&(r=t.jurisdiction.split(":").length),r&&(r+=-1),r>=n})},h.Attributes["@is-plural"]=function(t,e){this.tests.push(function(n,r){var i=n[e];if(i&&i.length){for(var o=0,a=0,s=!1,u=0,l=i.length;u<l;u+=1)t.opt.development_extensions.spoof_institutional_affiliations&&(i[u].literal||i[u].isInstitution&&i[u].family&&!i[u].given)?(a+=1,s=!1):(o+=1,s=!0);if(o>1)return!0;if(a>1)return!0;if(a&&s)return!0}return!1})},h.Attributes["@locale"]=function(t,e){var n,r,i,o,a,s,u=t.opt["default-locale"][0];if("layout"===this.name){if(this.locale_raw=e,this.tokentype===h.START){var l=e.split(/\s+/),c={},p=h.localeResolve(l[0],u);p.generic?c[p.generic]=p.best:c[p.best]=p.best;for(var f=1,d=l.length;f<d;f+=1){var m=h.localeResolve(l[f],u);m.generic?c[m.generic]=p.best:c[m.best]=p.best}t[t.build.area].opt.sort_locales.push(c)}t.opt.has_layout_locale=!0}else{i=e.split(/\s+/);var g=[];for(f=0,d=i.length;f<d;f+=1)r=i[f],n=h.localeResolve(r,u),2===i[f].length&&g.push(n.bare),t.localeConfigure(n,!0),i[f]=n;var v=i.slice();this.tests.push((o=v,a=u,s=g,function(t,e){var n,r,i;for([],n=!1,i=t.language?t.language:a,r=h.localeResolve(i,a),f=0,d=o.length;f<d;f+=1)if(r.best===o[f].best){n=!0;break}return!n&&s.indexOf(r.bare)>-1&&(n=!0),n}))}},h.Attributes["@authority-residue"]=function(t,e){var n;this.tests.push((n="true"===e,function(e,r){return e.authority&&e.authority[0]&&e.authority[0].family&&e.authority[0].family.split("|").length+t.tmp.authority_stop_last>0?n:!n}))},h.Attributes["@locale-internal"]=function(t,e){var n,r,i,o,a;for(i=e.split(/\s+/),this.locale_bares=[],o=0,a=i.length;o<a;o+=1)r=i[o],n=h.localeResolve(r,t.opt["default-locale"][0]),2===i[o].length&&this.locale_bares.push(n.bare),t.localeConfigure(n),i[o]=n;this.locale_default=t.opt["default-locale"][0],this.locale=i[0].best,this.locale_list=i.slice();var s;this.tests.push((s=this,function(e,n){var i;[],i=!1;var u=!1;if(e.language&&(r=e.language,(u=h.localeResolve(r,t.opt["default-locale"][0])).best===t.opt["default-locale"][0]&&(u=!1)),u){for(o=0,a=s.locale_list.length;o<a;o+=1)if(u.best===s.locale_list[o].best){t.opt.lang=s.locale,t.tmp.last_cite_locale=s.locale,t.output.openLevel("empty"),t.output.current.value().new_locale=s.locale,i=!0;break}!i&&s.locale_bares.indexOf(u.bare)>-1&&(t.opt.lang=s.locale,t.tmp.last_cite_locale=s.locale,t.output.openLevel("empty"),t.output.current.value().new_locale=s.locale,i=!0)}return i}))},h.Attributes["@is-parallel"]=function(t,e){for(var n=e.split(" "),r=0,i=n.length;r<i;r+=1)"true"===n[r]?n[r]=!0:"false"===n[r]&&(n[r]=!1);this.strings.set_parallel_condition=n},h.Attributes["@jurisdiction-depth"]=function(t,e){this.strings.jurisdiction_depth=parseInt(e,10)},h.Attributes["@require"]=function(t,e){this.strings.require=e},h.Attributes["@reject"]=function(t,e){this.strings.reject=e},h.Attributes["@gender"]=function(t,e){this.gender=e},h.Attributes["@cslid"]=function(t,e){this.cslid=parseInt(e,10)},h.Attributes["@label-form"]=function(t,e){this.strings.label_form_override=e},h.Attributes["@part-separator"]=function(t,e){this.strings["part-separator"]=e},h.Attributes["@leading-noise-words"]=function(t,e){this["leading-noise-words"]=e},h.Attributes["@name-never-short"]=function(t,e){this["name-never-short"]=e},h.Attributes["@class"]=function(t,e){t.opt.class=e},h.Attributes["@version"]=function(t,e){t.opt.version=e},h.Attributes["@value"]=function(t,e){this.strings.value=e},h.Attributes["@name"]=function(t,e){this.strings.name=e},h.Attributes["@form"]=function(t,e){this.strings.form=e},h.Attributes["@date-parts"]=function(t,e){this.strings["date-parts"]=e},h.Attributes["@range-delimiter"]=function(t,e){this.strings["range-delimiter"]=e},h.Attributes["@macro"]=function(t,e){this.postponed_macro=e},h.Attributes["@term"]=function(t,e){this.strings.term="sub verbo"===e?"sub-verbo":e},h.Attributes["@xmlns"]=function(t,e){},h.Attributes["@lang"]=function(t,e){e&&(t.build.lang=e)},h.Attributes["@lingo"]=function(t,e){},h.Attributes["@macro-has-date"]=function(t,e){this["macro-has-date"]=!0},h.Attributes["@suffix"]=function(t,e){this.strings.suffix=e},h.Attributes["@prefix"]=function(t,e){this.strings.prefix=e},h.Attributes["@delimiter"]=function(t,e){this.strings.delimiter=e},h.Attributes["@match"]=function(t,e){this.match=e},h.Attributes["@names-min"]=function(t,e){var n=parseInt(e,10);t[t.build.area].opt.max_number_of_names<n&&(t[t.build.area].opt.max_number_of_names=n),this.strings["et-al-min"]=n},h.Attributes["@names-use-first"]=function(t,e){this.strings["et-al-use-first"]=parseInt(e,10)},h.Attributes["@names-use-last"]=function(t,e){this.strings["et-al-use-last"]="true"===e},h.Attributes["@sort"]=function(t,e){"descending"===e&&(this.strings.sort_direction=h.DESCENDING)},h.Attributes["@plural"]=function(t,e){"always"===e||"true"===e?this.strings.plural=1:"never"===e||"false"===e?this.strings.plural=0:"contextual"===e&&(this.strings.plural=!1)},h.Attributes["@has-publisher-and-publisher-place"]=function(t,e){this.strings["has-publisher-and-publisher-place"]=!0},h.Attributes["@publisher-delimiter-precedes-last"]=function(t,e){this.strings["publisher-delimiter-precedes-last"]=e},h.Attributes["@publisher-delimiter"]=function(t,e){this.strings["publisher-delimiter"]=e},h.Attributes["@publisher-and"]=function(t,e){this.strings["publisher-and"]=e},h.Attributes["@newdate"]=function(t,e){},h.Attributes["@givenname-disambiguation-rule"]=function(t,e){h.GIVENNAME_DISAMBIGUATION_RULES.indexOf(e)>-1&&(t.citation.opt["givenname-disambiguation-rule"]=e)},h.Attributes["@collapse"]=function(t,e){e&&(t[this.name].opt.collapse=e)},h.Attributes["@cite-group-delimiter"]=function(t,e){e&&(t[t.tmp.area].opt.cite_group_delimiter=e)},h.Attributes["@names-delimiter"]=function(t,e){t.setOpt(this,"names-delimiter",e)},h.Attributes["@name-form"]=function(t,e){t.setOpt(this,"name-form",e)},h.Attributes["@subgroup-delimiter"]=function(t,e){this.strings["subgroup-delimiter"]=e},h.Attributes["@subgroup-delimiter-precedes-last"]=function(t,e){this.strings["subgroup-delimiter-precedes-last"]=e},h.Attributes["@name-delimiter"]=function(t,e){t.setOpt(this,"name-delimiter",e)},h.Attributes["@et-al-min"]=function(t,e){var n=parseInt(e,10);t[t.build.area].opt.max_number_of_names<n&&(t[t.build.area].opt.max_number_of_names=n),t.setOpt(this,"et-al-min",n)},h.Attributes["@et-al-use-first"]=function(t,e){t.setOpt(this,"et-al-use-first",parseInt(e,10))},h.Attributes["@et-al-use-last"]=function(t,e){"true"===e?t.setOpt(this,"et-al-use-last",!0):t.setOpt(this,"et-al-use-last",!1)},h.Attributes["@et-al-subsequent-min"]=function(t,e){var n=parseInt(e,10);t[t.build.area].opt.max_number_of_names<n&&(t[t.build.area].opt.max_number_of_names=n),t.setOpt(this,"et-al-subsequent-min",n)},h.Attributes["@et-al-subsequent-use-first"]=function(t,e){t.setOpt(this,"et-al-subsequent-use-first",parseInt(e,10))},h.Attributes["@suppress-min"]=function(t,e){this.strings["suppress-min"]=parseInt(e,10)},h.Attributes["@suppress-max"]=function(t,e){this.strings["suppress-max"]=parseInt(e,10)},h.Attributes["@and"]=function(t,e){t.setOpt(this,"and",e)},h.Attributes["@delimiter-precedes-last"]=function(t,e){t.setOpt(this,"delimiter-precedes-last",e)},h.Attributes["@delimiter-precedes-et-al"]=function(t,e){t.setOpt(this,"delimiter-precedes-et-al",e)},h.Attributes["@initialize-with"]=function(t,e){t.setOpt(this,"initialize-with",e)},h.Attributes["@initialize"]=function(t,e){"false"===e&&t.setOpt(this,"initialize",!1)},h.Attributes["@name-as-reverse-order"]=function(t,e){this["name-as-reverse-order"]=e},h.Attributes["@name-as-sort-order"]=function(t,e){"style-options"===this.name?this["name-as-sort-order"]=e:t.setOpt(this,"name-as-sort-order",e)},h.Attributes["@sort-separator"]=function(t,e){t.setOpt(this,"sort-separator",e)},h.Attributes["@year-suffix-delimiter"]=function(t,e){t[this.name].opt["year-suffix-delimiter"]=e},h.Attributes["@after-collapse-delimiter"]=function(t,e){t[this.name].opt["after-collapse-delimiter"]=e},h.Attributes["@subsequent-author-substitute"]=function(t,e){t[this.name].opt["subsequent-author-substitute"]=e},h.Attributes["@subsequent-author-substitute-rule"]=function(t,e){t[this.name].opt["subsequent-author-substitute-rule"]=e},h.Attributes["@disambiguate-add-names"]=function(t,e){"true"===e&&(t.opt["disambiguate-add-names"]=!0)},h.Attributes["@disambiguate-add-givenname"]=function(t,e){"true"===e&&(t.opt["disambiguate-add-givenname"]=!0)},h.Attributes["@disambiguate-add-year-suffix"]=function(t,e){"true"===e&&"numeric"!==t.opt.xclass&&(t.opt["disambiguate-add-year-suffix"]=!0)},h.Attributes["@second-field-align"]=function(t,e){"flush"!==e&&"margin"!==e||(t[this.name].opt["second-field-align"]=e)},h.Attributes["@hanging-indent"]=function(t,e){"true"===e&&(t[this.name].opt.hangingindent=2)},h.Attributes["@line-spacing"]=function(t,e){e&&e.match(/^[.0-9]+$/)&&(t[this.name].opt["line-spacing"]=parseFloat(e,10))},h.Attributes["@entry-spacing"]=function(t,e){e&&e.match(/^[.0-9]+$/)&&(t[this.name].opt["entry-spacing"]=parseFloat(e,10))},h.Attributes["@near-note-distance"]=function(t,e){t[this.name].opt["near-note-distance"]=parseInt(e,10)},h.Attributes["@text-case"]=function(t,e){this.execs.push(function(t,n){"normal"===e?this.text_case_normal=!0:(this.strings["text-case"]=e,"title"===e&&(t.opt["default-locale"][0].slice(0,2),n.jurisdiction&&(this.strings["text-case"]="passthrough")))})},h.Attributes["@page-range-format"]=function(t,e){t.opt["page-range-format"]=e},h.Attributes["@year-range-format"]=function(t,e){t.opt["year-range-format"]=e},h.Attributes["@default-locale"]=function(t,e){if("style"===this.name){var n,r,i,o,a;if(a=e.match(/-x-(sort|translit|translat)-/g))for(i=0,r=a.length;i<r;i+=1)a[i]=a[i].replace(/^-x-/,"").replace(/-$/,"");for(o=[(n=e.split(/-x-(?:sort|translit|translat)-/))[0]],i=1,r=n.length;i<r;i+=1)o.push(a[i-1]),o.push(n[i]);for(r=(n=o.slice()).length,i=1;i<r;i+=2)t.opt["locale-"+n[i]].push(n[i+1].replace(/^\s*/g,"").replace(/\s*$/g,""));n.length?t.opt["default-locale"]=n.slice(0,1):t.opt["default-locale"]=["en"]}else"true"===e&&(this.default_locale=!0)},h.Attributes["@default-locale-sort"]=function(t,e){t.opt["default-locale-sort"]=e},h.Attributes["@demote-non-dropping-particle"]=function(t,e){t.opt["demote-non-dropping-particle"]=e},h.Attributes["@initialize-with-hyphen"]=function(t,e){"false"===e&&(t.opt["initialize-with-hyphen"]=!1)},h.Attributes["@institution-parts"]=function(t,e){this.strings["institution-parts"]=e},h.Attributes["@if-short"]=function(t,e){"true"===e&&(this.strings["if-short"]=!0)},h.Attributes["@substitute-use-first"]=function(t,e){this.strings["substitute-use-first"]=parseInt(e,10)},h.Attributes["@use-first"]=function(t,e){this.strings["use-first"]=parseInt(e,10)},h.Attributes["@stop-last"]=function(t,e){this.strings["stop-last"]=-1*parseInt(e,10)},h.Attributes["@use-last"]=function(t,e){this.strings["use-last"]=parseInt(e,10)},h.Attributes["@reverse-order"]=function(t,e){"true"===e&&(this.strings["reverse-order"]=!0)},h.Attributes["@display"]=function(t,e){2===t.bibliography.tokens.length&&(t.opt.using_display=!0),this.strings.cls=e},t.exports=h,h.Stack=function(t,e){this.mystack=[],(e||t)&&this.mystack.push(t),this.tip=this.mystack[0]},h.Stack.prototype.push=function(t,e){e||t?this.mystack.push(t):this.mystack.push(""),this.tip=this.mystack[this.mystack.length-1]},h.Stack.prototype.clear=function(){this.mystack=[],this.tip={}},h.Stack.prototype.replace=function(t,e){if(0===this.mystack.length)throw"Internal CSL processor error: attempt to replace nonexistent stack item with "+t;this.mystack[this.mystack.length-1]=e||t?t:"",this.tip=this.mystack[this.mystack.length-1]},h.Stack.prototype.pop=function(){var t=this.mystack.pop();return this.mystack.length?this.tip=this.mystack[this.mystack.length-1]:this.tip={},t},h.Stack.prototype.value=function(){return this.mystack.slice(-1)[0]},h.Stack.prototype.length=function(){return this.mystack.length},t.exports=h,h.Parallel=function(t){this.state=t,this.sets=new h.Stack([]),this.try_cite=!0,this.use_parallels=!1,this.midVars=["section","volume","container-title","collection-number","issue","page-first","page","number"],this.ignoreVarsLawGeneral=["first-reference-note-number","locator","label","page-first","page","genre"],this.ignoreVarsLawProceduralHistory=["issued","first-reference-note-number","locator","label","page-first","page","genre","jurisdiction"],this.ignoreVarsOrders=["first-reference-note-number"],this.ignoreVarsOther=["first-reference-note-number","locator","label","section","page-first","page"]},h.Parallel.prototype.isMid=function(t){return this.midVars.indexOf(t)>-1},h.Parallel.prototype.StartCitation=function(t,e){this.parallel_conditional_blobs_list=[],this.use_parallels&&(this.sortedItems=t,this.sortedItemsPos=-1,this.sets.clear(),this.sets.push([]),this.in_series=!0,this.delim_counter=0,this.delim_pointers=[],this.out=e||this.state.output.queue,this.master_was_neutral_cite=!0)},h.Parallel.prototype.StartCite=function(t,e,n){var r,i,o,a,s,u;if(this.use_parallels){this.sets.value().length&&this.sets.value()[0].itemId==t.id&&this.ComposeSet(),this.sortedItemsPos+=1,e&&(r=e.position),this.try_cite=!0;for(var l=!1,c=0,p=h.PARALLEL_MATCH_VARS.length;c<p;c+=1)if(t[h.PARALLEL_MATCH_VARS[c]]){l=!0;break}var f=!0,d=this.sets.value().slice(-1)[0];if(d&&d.Item){var m=d.Item.jurisdiction?d.Item.jurisdiction.split(":")[0]:"",g=t.jurisdiction?t.jurisdiction.split(":")[0]:"";d.Item.title!==t.title?f=!1:m!==g?f=!1:d.Item.type!==t.type?f=!1:["article-journal","article-magazine"].indexOf(t.type)>-1&&(this.state.opt.development_extensions.handle_parallel_articles&&d.Item["container-title"]===t["container-title"]||(f=!1))}if(f&&l&&-1!==h.PARALLEL_TYPES.indexOf(t.type)||(this.try_cite=!0,this.in_series&&(this.in_series=!1)),this.cite={},this.cite.front=[],this.cite.mid=[],this.cite.back=[],this.cite.front_collapse={},this.cite.back_forceme=[],this.cite.position=r,this.cite.Item=t,this.cite.itemId=""+t.id,this.cite.prevItemID=""+n,this.target="front",["treaty"].indexOf(t.type)>-1)this.ignoreVars=this.ignoreVarsOrders;else if(["article-journal","article-magazine"].indexOf(t.type)>-1)this.ignoreVars=this.ignoreVarsOther;else if(e&&e.prefix){this.ignoreVars=this.ignoreVarsLawProceduralHistory,this.cite.useProceduralHistory=!0;var v=this.sets.value()[this.sets.value().length-1];if(v&&v.back)for(c=v.back.length-1;c>-1;c+=-1)v.back[c]&&v[v.back[c]]&&delete v[v.back[c]]}else this.ignoreVars=this.ignoreVarsLawGeneral;if(this.sortedItems&&this.sortedItemsPos>0&&this.sortedItemsPos<this.sortedItems.length){if(o=this.sortedItems[this.sortedItemsPos][1],a=""+this.sortedItems[this.sortedItemsPos-1][1].id,s=!1,this.state.registry.registry[a].parallel==o.id){for(i=this.sortedItemsPos-1;i>-1;i+=-1)if(this.sortedItems[i][1].id==t.id){s=this.sortedItems[i][1].locator;break}u=this.sortedItems[this.sortedItemsPos][1].locator,o.position=!s&&u?h.POSITION_IBID_WITH_LOCATOR:u===s?h.POSITION_IBID:h.POSITION_IBID_WITH_LOCATOR}}else{if(!this.state.registry.registry[t.id])return this.try_cite=!1,void(this.force_collapse=!1);this.state.registry.registry[t.id].parallel=!1}this.force_collapse=!1,this.state.registry.registry[t.id].parallel&&(this.force_collapse=!0)}},h.Parallel.prototype.StartVariable=function(t,e){if(this.use_parallels&&(this.try_cite||this.force_collapse)){if(this.variable="names"===t?t+":"+this.target:t,this.ignoreVars.indexOf(t)>-1)return;"container-title"===t&&0===this.sets.value().length&&(this.master_was_neutral_cite=!1),this.data={},this.data.value="",this.data.blobs=[];var n=this.isMid(t);if("authority"===e&&"names:front"===this.variable&&this.sets.value().length){var r=this.sets.value()[this.sets.value().length-1].Item,i=!1;this.cite.Item.authority&&this.cite.Item.authority.length&&(i=this.cite.Item.authority[0].literal);var o=!1;r.authority&&r.authority.length&&(o=r.authority[0].literal),i!==o&&(this.try_cite=!0,this.in_series=!1)}else"front"===this.target&&n?this.target="mid":"mid"===this.target&&!n&&this.cite.Item.title&&"names"!==t?this.target="back":"back"===this.target&&n&&(this.try_cite=!0,this.in_series=!1);"number"===t?this.cite.front.push(this.variable):h.PARALLEL_COLLAPSING_MID_VARSET.indexOf(t)>-1?["article-journal","article-magazine"].indexOf(this.cite.Item.type)>-1?this.cite.mid.push(this.variable):this.cite.front.push(this.variable):this.cite[this.target].push(this.variable)}},h.Parallel.prototype.AppendBlobPointer=function(t){if(this.use_parallels){if(this.ignoreVars.indexOf(this.variable)>-1)return;if(this.use_parallels&&(this.force_collapse||this.try_cite)){if(["article-journal","article-magazine"].indexOf(this.cite.Item.type)>-1){if(["volume","page","page-first","issue"].indexOf(this.variable)>-1)return;if("container-title"===this.variable&&this.cite.mid.length>1)return}this.variable&&(this.try_cite||this.force_collapse)&&t&&t.blobs&&(this.cite.useProceduralHistory&&"back"===this.target||this.data.blobs.push([t,t.blobs.length]))}}},h.Parallel.prototype.AppendToVariable=function(t,e){if(this.use_parallels){if(this.ignoreVars.indexOf(this.variable)>-1)return;if(this.try_cite||this.force_collapse)this.target,this.data.value+="::"+t}},h.Parallel.prototype.CloseVariable=function(){if(this.use_parallels){if(this.ignoreVars.indexOf(this.variable)>-1)return;if((this.try_cite||this.force_collapse)&&(this.cite[this.variable]=this.data,this.sets.value().length>0)){var t=this.sets.value()[this.sets.value().length-1];"front"===this.target&&"issued"===this.variable&&this.data.value&&this.master_was_neutral_cite&&(this.target="mid"),"front"===this.target?!t[this.variable]&&!this.data.value||t[this.variable]&&this.data.value===t[this.variable].value||"issued"!==this.variable&&(this.in_series=!1):"mid"===this.target?h.PARALLEL_COLLAPSING_MID_VARSET.indexOf(this.variable)>-1&&(t[this.variable]&&t[this.variable].value===this.data.value?this.cite.front_collapse[this.variable]=!0:this.cite.front_collapse[this.variable]=!1):"back"===this.target&&t[this.variable]&&this.data.value!==t[this.variable].value&&-1===this.sets.value().slice(-1)[0].back_forceme.indexOf(this.variable)&&(this.in_series=!1)}this.variable=!1}},h.Parallel.prototype.CloseCite=function(){var t,e,n,r,i,o;if(this.use_parallels&&(this.force_collapse||this.try_cite)){if(n=!1,this.cite.front_collapse["container-title"]||(n=!0),!1===this.cite.front_collapse.volume&&(n=!0),!1===this.cite.front_collapse["collection-number"]&&(n=!0),!1===this.cite.front_collapse.section&&(n=!0),n){this.cite.use_journal_info=!0,(o=this.cite.front.indexOf("section"))>-1&&(this.cite.front=this.cite.front.slice(0,o).concat(this.cite.front.slice(o+1))),(r=this.cite.front.indexOf("volume"))>-1&&(this.cite.front=this.cite.front.slice(0,r).concat(this.cite.front.slice(r+1))),(i=this.cite.front.indexOf("container-title"))>-1&&(this.cite.front=this.cite.front.slice(0,i).concat(this.cite.front.slice(i+1)));var a=this.cite.front.indexOf("collection-number");a>-1&&(this.cite.front=this.cite.front.slice(0,a).concat(this.cite.front.slice(a+1)))}if(this.in_series||this.force_collapse||this.ComposeSet(!0),0===this.sets.value().length){var s=!1;for(t=0,e=this.cite.back.length;t<e;t+=1)if("issued"===this.cite.back[t]&&this.cite.issued&&this.cite.issued.value){s=!0;break}s||this.cite.back_forceme.push("issued")}else{var u=this.cite.front.indexOf("issued");if((-1===u||this.master_was_neutral_cite)&&(this.cite.back_forceme=this.sets.value().slice(-1)[0].back_forceme),u>-1)this.sets.value()[this.sets.value().length-1].issued||(this.cite.front=this.cite.front.slice(0,u).concat(this.cite.front.slice(u+1)));this.master_was_neutral_cite&&this.cite.mid.indexOf("names:mid")>-1&&this.cite.front.push("names:mid")}this.sets.value().push(this.cite)}},h.Parallel.prototype.ComposeSet=function(t){var e,n,r;if(this.use_parallels&&(this.force_collapse||this.try_cite)){var i=this.sets.value().length;if(1===this.sets.value().length)this.in_series||(this.sets.value().pop(),this.delim_counter+=1);else{for(r=this.sets.value().length,n=0;n<r;n+=1)e=this.sets.value()[n],0===n?this.delim_counter+=1:(!e.Item.title&&e.use_journal_info?this.delim_pointers.push(!1):this.delim_pointers.push(this.delim_counter),this.delim_counter+=1),h.POSITION_FIRST===e.position&&(0===n?(this.state.registry.registry[e.itemId].master=!0,this.state.registry.registry[e.itemId].siblings=[],this.state.registry.registry[e.itemId].parallel=!1):e.prevItemID&&(this.state.registry.registry[e.prevItemID].parallel?this.state.registry.registry[e.itemId].parallel=this.state.registry.registry[e.prevItemID].parallel:this.state.registry.registry[e.itemId].parallel=e.prevItemID,this.state.registry.registry[e.itemId].siblings=this.state.registry.registry[e.prevItemID].siblings,this.state.registry.registry[e.itemId].siblings||(this.state.registry.registry[e.itemId].siblings=[],h.debug("WARNING: adding missing siblings array to registry object")),this.state.registry.registry[e.itemId].siblings.push(e.itemId)));this.sets.push([])}i<2?this.purgeGroupsIfParallel(!1):this.purgeGroupsIfParallel(!0),this.in_series=!0}},h.Parallel.prototype.PruneOutputQueue=function(){var t,e,n,r,i,o;if(this.use_parallels)for(t=this.sets.mystack.length,e=0;e<t;e+=1)if((n=this.sets.mystack[e]).length>1)for(i=n.length,r=0;r<i;r+=1)o=n[r],0===r?this.purgeVariableBlobs(o,o.back):r===n.length-1?this.purgeVariableBlobs(o,o.front.concat(o.back_forceme)):this.purgeVariableBlobs(o,o.front.concat(o.back))},h.Parallel.prototype.purgeVariableBlobs=function(t,e){var n,r,i,o,a,s;if(this.use_parallels){for(void 0===(s=this.state.output.current.value()).length&&(s=s.blobs),r=0,n=this.delim_pointers.length;r<n;r+=1)!1!==(a=this.delim_pointers[r])&&(s[a].parallel_delimiter=", ");for(r=n=e.length-1;r>-1;r+=-1)if(t[i=e[r]])for(a=t[i].blobs.length-1;a>-1;a+=-1)(o=t[i].blobs[a])[0].blobs=o[0].blobs.slice(0,o[1]).concat(o[0].blobs.slice(o[1]+1)),this.state.tmp.has_purged_parallel=!0,o[0]&&o[0].strings&&"string"==typeof o[0].strings.oops&&o[0].parent&&o[0].parent&&(o[0].parent.parent.strings.delimiter=o[0].strings.oops)}},h.Parallel.prototype.purgeGroupsIfParallel=function(t){for(var e=this.parallel_conditional_blobs_list.length-1;e>-1;e+=-1){for(var n=this.parallel_conditional_blobs_list[e],r=!0,i=0,o=n.conditions.length;i<o;i+=1)if(!n.conditions[i]!=!!t&&("master"!==n.conditions[i]||this.state.registry.registry[n.id].master)&&("servant"!==n.conditions[i]||this.state.registry.registry[n.id].parallel)){r=!1;break}if(r){for(var a=[];n.blobs.length>n.pos;)a.push(n.blobs.pop());for(a.length&&a.pop();a.length;)n.blobs.push(a.pop())}this.parallel_conditional_blobs_list.pop()}},t.exports=h,h.Util={},h.Util.Match=function(){this.any=function(t,e,n){return function(t,e){for(var r=0,i=n.length;r<i;r+=1){if(n[r](t,e))return!0}return!1}},this.none=function(t,e,n){return function(t,e){for(var r=0,i=n.length;r<i;r+=1){if(n[r](t,e))return!1}return!0}},this.all=function(t,e,n){return function(t,e){for(var r=0,i=n.length;r<i;r+=1){if(!n[r](t,e))return!1}return!0}},this[void 0]=this.all,this.nand=function(t,e,n){return function(t,e){for(var r=0,i=n.length;r<i;r+=1){if(!n[r](t,e))return!0}return!1}}},t.exports=h,h.Transform=function(t){function e(t,e,n,r,i,o){var a;if(!(i=h.FIELD_CATEGORY_REMAP[i]))return r;var s=i;if(a="",t.sys.getAbbreviation){var u=r;t.sys.normalizeAbbrevsKey&&(u=t.sys.normalizeAbbrevsKey(r));var l=t.transform.loadAbbreviation(e.jurisdiction,i,u,e.type,!0);t.transform.abbrevs[l][i]&&u&&t.sys.getAbbreviation&&t.transform.abbrevs[l][i][u]&&(a=t.transform.abbrevs[l][i][u].replace("{stet}",r))}return a||t.opt.development_extensions.require_explicit_legal_case_title_short&&"legal_case"===e.type||!n||!e[n]||!o||(a=e[n]),a||(a=r),a&&a.match(/^\!(?:[^>]+,)*here(?:,[^>]+)*>>>/)&&(a="jurisdiction"===s&&["treaty","patent"].indexOf(e.type)>-1&&a.replace(/^\![^>]*>>>\s*/,"")),a}function n(e,n){var r,i=t.opt["default-locale"][0].slice(0,2);if(r=t.opt.development_extensions.strict_text_case_locales?new RegExp("^([a-zA-Z]{2})(?:$|-.*| .*)"):new RegExp("^([a-zA-Z]{2})(?:$|-.*|.*)"),e.language){var o=(""+e.language).match(r);i=o?o[1]:"tlh"}return e.multi&&e.multi&&e.multi.main&&e.multi.main[n]&&(i=e.multi.main[n]),t.opt.development_extensions.strict_text_case_locales&&!t.opt.development_extensions.normalize_lang_keys_to_lowercase||(i=i.toLowerCase()),i}function r(e,r,i,o,a){var s,u,l,c=a,p=!1;if(!e[r])return{name:"",usedOrig:a,token:h.Util.cloneToken(this)};m={name:"",usedOrig:a,locale:n(e,r)},l=t.opt[i];var f=!1,d=!1;if("locale-orig"===i)m=a?{name:"",usedOrig:a}:{name:e[r],usedOrig:!1,locale:n(e,r)},f=!0,p=!0;else if(o&&(void 0===l||0===l.length)){var m={name:e[r],usedOrig:!0,locale:n(e,r)};f=!0,p=!0}if(!f){for(var g=0,v=l.length;g<v;g+=1){if(u=(s=l[g]).split(/[\-_]/)[0],s&&e.multi&&e.multi._keys[r]&&e.multi._keys[r][s]){m.name=e.multi._keys[r][s],m.locale=s,"jurisdiction"===r&&(d=m.name);break}if(u&&e.multi&&e.multi._keys[r]&&e.multi._keys[r][u]){m.name=e.multi._keys[r][u],m.locale=u,"jurisdiction"===r&&(d=m.name);break}}!m.name&&o&&(m={name:e[r],usedOrig:!0,locale:n(e,r)},p=!0)}if(m.token=h.Util.cloneToken(this),t.sys.getHumanForm&&m.name&&"jurisdiction"===r)m.name=h.getJurisdictionNameAndSuppress(t,e[r],d,this.strings.jurisdiction_depth);else if(["title","container-title"].indexOf(r)>-1&&!(c||m.token.strings["text-case"]&&"sentence"!==m.token.strings["text-case"]&&"normal"!==m.token.strings["text-case"])){var y=!p&&m.locale,b=r.slice(0,-5),_="sentence"===m.token.strings["text-case"];m.name=h.titlecaseSentenceOrNormal(t,e,b,y,_),delete m.token.strings["text-case"]}return m}function i(e){var n=e.match(/^!([-,_a-z]+)>>>/);if(n){var r=n[1].split(",");e=e.slice(n[0].length);for(var i=0,o=r.length;i<o;i+=1)-1===t.tmp.done_vars.indexOf(r[i])&&t.tmp.done_vars.push(r[i])}return e}this.abbrevs={},this.abbrevs.default=new t.sys.AbbreviationSegments,this.getTextSubField=r,this.loadAbbreviation=function(e,n,r,i){return e||(e="default"),r?(t.sys.getAbbreviation&&((e=t.sys.getAbbreviation(t.opt.styleID,t.transform.abbrevs,e,n,r,i,!0))||(e="default")),e):(t.transform.abbrevs[e]||(t.transform.abbrevs[e]=new t.sys.AbbreviationSegments),t.transform.abbrevs[e][n]||(t.transform.abbrevs[e][n]={}),e)},this.getOutputFunction=function(n,o,a,s,u){var l,c=h.LangPrefsMap[n[0]];return l=!!c&&t.opt["cite-lang-prefs"][c],function(a,u,p,f){var d,m,g,v,y,b;if(!n[0]||!u[n[0]]&&!u[s])return null;var _={primary:!1,secondary:!1,tertiary:!1};if("_sort"===a.tmp.area.slice(-5))_.primary="locale-sort";else if(l)for(var x=["primary","secondary","tertiary"],w=0,E=x.length;w<E&&!(l.length-1<w);w+=1)l[w]&&(_[x[w]]="locale-"+l[w]);else _.primary="locale-orig";if("title-short"!==n[0]&&("bibliography"===a.tmp.area||"citation"===a.tmp.area&&"note"===a.opt.xclass&&p&&!p.position)||(_.secondary=!1,_.tertiary=!1),a.tmp["publisher-list"])return"publisher"===n[0]?a.tmp["publisher-token"]=this:"publisher-place"===n[0]&&(a.tmp["publisher-place-token"]=this),null;var S=r.call(this,u,n[0],_.primary,!0);d=S.name,m=S.locale;var T,O=S.token,A=S.usedOrig;if(function(n,r,i,o){var a=n.variables[0];if(t.publisherOutput&&i){if(-1===["publisher","publisher-place"].indexOf(a))return!1;t.publisherOutput[a+"-token"]=n,t.publisherOutput.varlist.push(a);var s=i.split(/;\s*/);s.length===t.publisherOutput[a+"-list"].length&&(t.publisherOutput[a+"-list"]=s);for(var u=0,l=s.length;u<l;u+=1)s[u]=e(t,r,!1,s[u],o,!0);return t.tmp[a+"-token"]=n,!0}return!1}(this,u,d,o))return null;if(g=!1,y=!1,_.secondary){g=(S=r.call(this,u,n[0],_.secondary,!1,S.usedOrig)).name,v=S.locale;var M=S.token}if(_.tertiary){y=(S=r.call(this,u,n[0],_.tertiary,!1,S.usedOrig)).name,b=S.locale;var C=S.token}if(o&&((d=e(a,u,s,d,o,!0))&&(d=i(d)),g=e(a,u,!1,g,o,!0),y=e(a,u,!1,y,o,!0)),"locale-translit"===_.primary&&(T=a.opt.citeAffixes[c][_.primary].prefix),"<i>"===T&&"title"===n[0]&&!A){var k=!1;for(w=0,E=O.decorations.length;w<E;w+=1)"@font-style"===O.decorations[w][0]&&"italic"===O.decorations[w][1]&&(k=!0);k||O.decorations.push(["@font-style","italic"])}if("en"!==m&&"title"===O.strings["text-case"]&&(O.strings["text-case"]="passthrough"),"title"===n[0]&&(d=h.demoteNoiseWords(a,d,this["leading-noise-words"])),g||y){if(a.output.openLevel("empty"),O.strings.suffix=O.strings.suffix.replace(/[ .,]+$/,""),a.output.append(d,O),g){for(M.strings.prefix=a.opt.citeAffixes[c][_.secondary].prefix,M.strings.suffix=a.opt.citeAffixes[c][_.secondary].suffix,M.strings.prefix||(M.strings.prefix=" "),w=M.decorations.length-1;w>-1;w+=-1)["@quotes/true","@font-style/italic","@font-style/oblique","@font-weight/bold"].indexOf(M.decorations[w].join("/"))>-1&&(M.decorations=M.decorations.slice(0,w).concat(M.decorations.slice(w+1)));"en"!==v&&"title"===M.strings["text-case"]&&(M.strings["text-case"]="passthrough");var P=new h.Token;P.decorations.push(["@font-style","normal"]),P.decorations.push(["@font-weight","normal"]),a.output.openLevel(P),a.output.append(g,M),a.output.closeLevel();var R=a.output.current.value(),L=a.output.current.value().blobs.length-1;a.parallel.use_parallels&&(a.parallel.cite.front.push(n[0]+":secondary"),a.parallel.cite[n[0]+":secondary"]={blobs:[[R,L]]})}if(y){for(C.strings.prefix=a.opt.citeAffixes[c][_.tertiary].prefix,C.strings.suffix=a.opt.citeAffixes[c][_.tertiary].suffix,C.strings.prefix||(C.strings.prefix=" "),w=C.decorations.length-1;w>-1;w+=-1)["@quotes/true","@font-style/italic","@font-style/oblique","@font-weight/bold"].indexOf(C.decorations[w].join("/"))>-1&&(C.decorations=C.decorations.slice(0,w).concat(C.decorations.slice(w+1)));"en"!==b&&"title"===C.strings["text-case"]&&(C.strings["text-case"]="passthrough");var I=new h.Token;I.decorations.push(["@font-style","normal"]),I.decorations.push(["@font-weight","normal"]),a.output.openLevel(I),a.output.append(y,C),a.output.closeLevel(),R=a.output.current.value(),L=a.output.current.value().blobs.length-1,a.parallel.use_parallels&&(a.parallel.cite.front.push(n[0]+":tertiary"),a.parallel.cite[n[0]+":tertiary"]={blobs:[[R,L]]})}a.output.closeLevel()}else a.output.append(d,O);return null}},this.quashCheck=i},t.exports=h,h.Token=function(t,e){this.name=t,this.strings={},this.strings.delimiter=void 0,this.strings.prefix="",this.strings.suffix="",this.decorations=[],this.variables=[],this.execs=[],this.tokentype=e,this.evaluator=!1,this.tests=[],this.rawtests=[],this.succeed=!1,this.fail=!1,this.next=!1},h.Util.cloneToken=function(t){var e,n,r;if("string"==typeof t)return t;e=new h.Token(t.name,t.tokentype);for(var i in t.strings)t.strings.hasOwnProperty(i)&&(e.strings[i]=t.strings[i]);if(t.decorations)for(e.decorations=[],n=0,r=t.decorations.length;n<r;n+=1)e.decorations.push(t.decorations[n].slice());return t.variables&&(e.variables=t.variables.slice()),t.execs&&(e.execs=t.execs.slice(),e.tests=t.tests.slice(),e.rawtests=t.tests.slice()),e},t.exports=h,h.AmbigConfig=function(){this.maxvals=[],this.minval=1,this.names=[],this.givens=[],this.year_suffix=!1,this.disambiguate=0},t.exports=h,h.Blob=function(t,e,n){var r,i;if(this.levelname=n,e){this.strings={prefix:"",suffix:""};for(var o in e.strings)e.strings.hasOwnProperty(o)&&(this.strings[o]=e.strings[o]);for(this.decorations=[],r=void 0===e.decorations?0:e.decorations.length,i=0;i<r;i+=1)this.decorations.push(e.decorations[i].slice())}else this.strings={},this.strings.prefix="",this.strings.suffix="",this.strings.delimiter="",this.decorations=[];this.blobs="string"==typeof t?t:t?[t]:[],this.alldecor=[this.decorations]},h.Blob.prototype.push=function(t){if("string"==typeof this.blobs)throw"Attempt to push blob onto string object";!1!==t&&(t.alldecor=t.alldecor.concat(this.alldecor),this.blobs.push(t))},t.exports=h,h.NumericBlob=function(t,e,n,r){this.id=r,this.alldecor=[],this.num=e,this.particle=t,this.blobs=e.toString(),this.status=h.START,this.strings={},n?(this.gender=n.gender,this.decorations=n.decorations,this.strings.prefix=n.strings.prefix,this.strings.suffix=n.strings.suffix,this.strings["text-case"]=n.strings["text-case"],this.successor_prefix=n.successor_prefix,this.range_prefix=n.range_prefix,this.splice_prefix=n.splice_prefix,this.formatter=n.formatter,this.formatter||(this.formatter=new h.Output.DefaultFormatter),this.formatter&&(this.type=this.formatter.format(1))):(this.decorations=[],this.strings.prefix="",this.strings.suffix="",this.successor_prefix="",this.range_prefix="",this.splice_prefix="",this.formatter=new h.Output.DefaultFormatter)},h.NumericBlob.prototype.setFormatter=function(t){this.formatter=t,this.type=this.formatter.format(1)},h.Output.DefaultFormatter=function(){},h.Output.DefaultFormatter.prototype.format=function(t){return t.toString()},h.NumericBlob.prototype.checkNext=function(t,e){e?(this.status=h.START,"object"==typeof t&&(t.num===this.num+1?t.status=h.SUCCESSOR:t.status=h.SEEN)):t&&t.num&&this.type===t.type&&t.num===this.num+1?this.status===h.START||this.status===h.SEEN?t.status=h.SUCCESSOR:this.status!==h.SUCCESSOR&&this.status!==h.SUCCESSOR_OF_SUCCESSOR||(this.range_prefix?(t.status=h.SUCCESSOR_OF_SUCCESSOR,this.status=h.SUPPRESS):t.status=h.SUCCESSOR):(this.status===h.SUCCESSOR_OF_SUCCESSOR&&(this.status=h.END),"object"==typeof t&&(t.status=h.SEEN))},h.NumericBlob.prototype.checkLast=function(t){return(this.status===h.SEEN||t.num!==this.num-1&&this.status===h.SUCCESSOR)&&(this.status=h.SUCCESSOR,!0)},t.exports=h,h.Util.fixDateNode=function(t,e,n){var r,i,o,a,s,u,l,c,h,p,f,d,m,g=this.cslXml.getAttributeValue(n,"lingo"),v=this.cslXml.getAttributeValue(n,"default-locale");if(this.build.date_key=!0,r=this.cslXml.getAttributeValue(n,"form"),g=v?this.opt["default-locale"][0]:this.cslXml.getAttributeValue(n,"lingo"),!this.getDate(r,v))return t;var y=this.cslXml.getAttributeValue(n,"date-parts");i=this.cslXml.getAttributeValue(n,"variable"),c=this.cslXml.getAttributeValue(n,"prefix"),h=this.cslXml.getAttributeValue(n,"suffix"),d=this.cslXml.getAttributeValue(n,"display"),m=this.cslXml.getAttributeValue(n,"cslid"),o=this.cslXml.nodeCopy(this.getDate(r,v)),this.cslXml.setAttribute(o,"lingo",this.opt.lang),this.cslXml.setAttribute(o,"form",r),this.cslXml.setAttribute(o,"date-parts",y),this.cslXml.setAttribute(o,"cslid",m),this.cslXml.setAttribute(o,"variable",i),this.cslXml.setAttribute(o,"default-locale",v),c&&this.cslXml.setAttribute(o,"prefix",c),h&&this.cslXml.setAttribute(o,"suffix",h),d&&this.cslXml.setAttribute(o,"display",d),p=this.cslXml.children(o);for(var b in p)a=p[b],"date-part"===this.cslXml.nodename(a)&&(s=this.cslXml.getAttributeValue(a,"name"),v&&this.cslXml.setAttributeOnNodeIdentifiedByNameAttribute(o,"date-part",s,"@default-locale","true"));p=this.cslXml.children(n);for(var b in p)if(a=p[b],"date-part"===this.cslXml.nodename(a)){s=this.cslXml.getAttributeValue(a,"name"),f=this.cslXml.attributes(a);for(u in f)"@name"!==u&&(g&&g!==this.opt.lang&&["@suffix","@prefix","@form"].indexOf(u)>-1||(l=f[u],this.cslXml.setAttributeOnNodeIdentifiedByNameAttribute(o,"date-part",s,u,l)))}if("year"===this.cslXml.getAttributeValue(n,"date-parts"))this.cslXml.deleteNodeByNameAttribute(o,"month"),this.cslXml.deleteNodeByNameAttribute(o,"day");else if("year-month"===this.cslXml.getAttributeValue(n,"date-parts"))this.cslXml.deleteNodeByNameAttribute(o,"day");else if("month-day"===this.cslXml.getAttributeValue(n,"date-parts")){for(var _=this.cslXml.children(o),x=1,w=this.cslXml.numberofnodes(_);x<w;x++)if("year"===this.cslXml.getAttributeValue(_[x],"name")){this.cslXml.setAttribute(_[x-1],"suffix","");break}this.cslXml.deleteNodeByNameAttribute(o,"year")}return this.cslXml.insertChildNodeAfter(t,n,e,o)},t.exports=h,h.dateMacroAsSortKey=function(t,e){h.dateAsSortKey.call(this,t,e,!0)},h.dateAsSortKey=function(t,e,n){var r,i,o,a,s,u,l,c=this.variables[0],p="empty";for(n&&t.tmp.extension&&(p="macro-with-date"),void 0===(r=e[c])&&((r={"date-parts":[[0]]}).year||(t.tmp.empty_date=!0)),void 0===this.dateparts&&(this.dateparts=["year","month","day"]),r.raw?r=t.fun.dateparser.parseDateToArray(r.raw):r["date-parts"]&&(r=t.dateParseArray(r)),void 0===r&&(r={}),u=0,l=h.DATE_PARTS_INTERNAL.length;u<l;u+=1)if(o=0,"_end"===(a=i=h.DATE_PARTS_INTERNAL[u]).slice(-4)&&(a=a.slice(0,-4)),r[i]&&this.dateparts.indexOf(a)>-1&&(o=r[i]),"year"===i.slice(0,4)){var f="Y";"-"===(s=h.Util.Dates[a].numeric(t,o))[0]&&(f="X",s=s.slice(1),s=9999-parseInt(s,10)),t.output.append(h.Util.Dates[i.slice(0,4)].numeric(t,f+s),p)}else(o=h.Util.Dates[a]["numeric-leading-zeros"](t,o))||(o="00"),t.output.append(o,p)},h.Engine.prototype.dateParseArray=function(t){var e,n,r,i;e={};for(n in t)if("date-parts"===n){(r=t["date-parts"]).length>1&&r[0].length!==r[1].length&&h.error("CSL data error: element mismatch in date range input."),i=["","_end"];for(var o=0,a=r.length;o<a;o+=1)for(var s=0,u=h.DATE_PARTS.length;s<u;s+=1)void 0===r[o][s]?e[h.DATE_PARTS[s]+i[o]]=r[o][s]:e[h.DATE_PARTS[s]+i[o]]=parseInt(r[o][s],10)}else t.hasOwnProperty(n)&&("literal"===n&&"object"==typeof t.literal&&"string"==typeof t.literal.part?(h.debug("Warning: fixing up weird literal date value"),e.literal=t.literal.part):e[n]=t[n]);return e},t.exports=h,h.Util.Names={},h.Util.Names.compareNamesets=h.NameOutput.prototype._compareNamesets,h.Util.Names.unInitialize=function(t,e){var n,r,i,o,a;if(!e)return"";for(i=e.split(/(?:\-|\s+)/),o=e.match(/(\-|\s+)/g),a="",n=0,r=i.length;n<r;n+=1)a+=i[n],n<r-1&&(a+=o[n]);return a},h.Util.Names.initializeWith=function(t,e,n,r){var i,o,a,s,u,l;if(!e)return"";if(n||(n=""),["Lord","Lady"].indexOf(e)>-1||!e.match(h.STARTSWITH_ROMANESQUE_REGEXP)&&!n.match("%s"))return e;var c=e;if(!1===t.opt["initialize-with-hyphen"]&&(c=c.replace(/\-/g," ")),u=(c=(c=c.replace(/\s*\-\s*/g,"-").replace(/\s+/g," ")).replace(/-([a-z])/g,"–$1")).match(/[\-\s]+/g),0===(l=c.split(/[\-\s]+/)).length)c=u;else for(c=[l[0]],i=1,o=l.length;i<o;i+=1)c.push(u[i-1]),c.push(l[i]);for(i=(l=c).length-1;i>-1;i+=-1)if(l[i]&&l[i].slice(0,-1).indexOf(".")>-1){var p=l.slice(i+1),f=l[i].slice(0,-1).split(".");for(l=l.slice(0,i),a=0,s=f.length;a<s;a+=1)l.push(f[a]+"."),a<f.length-1&&l.push(" ");l=l.concat(p)}return(r?h.Util.Names.doNormalize(t,l,n):h.Util.Names.doInitialize(t,l,n)).replace(/\u2013([a-z])/g,"-$1")},h.Util.Names.doNormalize=function(t,e,n,r){var i,o;n=n||"";var a=[];for(i=0,o=e.length;i<o;i+=1)e[i].length>1&&"."===e[i].slice(-1)?(e[i]=e[i].slice(0,-1),a.push(!0)):1===e[i].length&&e[i].toUpperCase()===e[i]?a.push(!0):a.push(!1);for(i=0,o=e.length;i<o;i+=2)if(a[i]){if(i<e.length-2)e[i+1]="",(n.match(/^[\u0009\u000a\u000b\u000c\u000d\u0020\u00a0]+$/)||(!n||n.slice(-1)&&!n.slice(-1).match(/[\u0009\u000a\u000b\u000c\u000d\u0020\u00a0]/))&&e[i].length&&e[i].match(h.ALL_ROMANESQUE_REGEXP)&&(e[i].length>1||e[i+2].length>1))&&(e[i+1]=" "),e[i+2].length>1?e[i]=e[i]+n.replace(/\ufeff$/,""):e[i]=e[i]+n;i===e.length-1&&(e[i]=e[i]+n)}return e.join("").replace(/[\u0009\u000a\u000b\u000c\u000d\u0020\ufeff\u00a0]+$/,"").replace(/\s*\-\s*/g,"-").replace(/[\u0009\u000a\u000b\u000c\u000d\u0020]+/g," ")},h.Util.Names.doInitialize=function(t,e,n,r){var i,o,a,s,u,l,c;for(i=0,o=e.length;i<o;i+=2)if(c=e[i])if(!(a=c.match(h.NAME_INITIAL_REGEXP))&&!c.match(h.STARTSWITH_ROMANESQUE_REGEXP)&&c.length>1&&n.match("%s")&&(a=c.match(/(.)(.*)/)),a&&a[1]===a[1].toUpperCase()){var p="";if(a[2]){var f="";for(s=0,u=(l=a[2].split("")).length;s<u;s+=1){var d=l[s];if(d!==d.toUpperCase())break;f+=d}f.length<a[2].length&&(p=f.toLocaleLowerCase())}e[i]=a[1].toLocaleUpperCase()+p,i<o-1?n.match("%s")?e[i]=n.replace("%s",e[i]):e[i+1].indexOf("-")>-1?e[i+1]=n+e[i+1]:e[i+1]=n:n.match("%s")?e[i]=n.replace("%s",e[i]):e.push(n)}else c.match(h.ROMANESQUE_REGEXP)&&(e[i]=" "+c);var m=e.join("");return m=m.replace(/[\u0009\u000a\u000b\u000c\u000d\u0020\ufeff\u00a0]+$/,"").replace(/\s*\-\s*/g,"-").replace(/[\u0009\u000a\u000b\u000c\u000d\u0020]+/g," ")},h.Util.Names.getRawName=function(t){var e=[];return t.given&&e.push(t.given),t.family&&e.push(t.family),e.join(" ")},t.exports=h,h.Util.Dates={},h.Util.Dates.year={},h.Util.Dates.year.long=function(t,e){return e||(e="boolean"==typeof e?"":0),e.toString()},h.Util.Dates.year.imperial=function(t,e,n,r){var i="";e||(e="boolean"==typeof e?"":0),n=n?"_end":"";var o=t.tmp.date_object["month"+n];for(o=o?""+o:"1";o.length<2;)o="0"+o;var a=t.tmp.date_object["day"+n];for(a=a?""+a:"1";a.length<2;)a="0"+a;var s,u,l=parseInt(e+o+a,10);if(l>=18680908&&l<19120730?(s="明治",u=1867):l>=19120730&&l<19261225?(s="大正",u=1911):l>=19261225&&l<19890108?(s="昭和",u=1925):l>=19890108&&(s="平成",u=1988),s&&u){var c=s;t.sys.normalizeAbbrevsKey&&(c=t.sys.normalizeAbbrevsKey(s)),t.transform.abbrevs.default.number[c]||t.transform.loadAbbreviation("default","number",c),t.transform.abbrevs.default.number[c]&&(s=t.transform.abbrevs.default.number[c]),i=s+(e-u)}return i},h.Util.Dates.year.short=function(t,e){if((e=e.toString())&&4===e.length)return e.substr(2)},h.Util.Dates.year.numeric=function(t,e){var n,r;for((r=(e=""+e).match(/([0-9]*)$/))?(n=e.slice(0,-1*r[1].length),e=r[1]):(n=e,e="");e.length<4;)e="0"+e;return n+e},h.Util.Dates.normalizeMonth=function(t,e){var n;if(t||(t=0),(t=""+t).match(/^[0-9]+$/)||(t=0),t=parseInt(t,10),e){var r={stub:"month-",num:t};r.num<1||r.num>20?r.num=0:r.num>16?(r.stub="season-",r.num=r.num-16):r.num>12&&(r.stub="season-",r.num=r.num-12),n=r}else(t<1||t>12)&&(t=0),n=t;return n},h.Util.Dates.month={},h.Util.Dates.month.numeric=function(t,e){return(e=h.Util.Dates.normalizeMonth(e))||(e=""),e},h.Util.Dates.month["numeric-leading-zeros"]=function(t,e){if(e=h.Util.Dates.normalizeMonth(e))for(e=""+e;e.length<2;)e="0"+e;else e="";return e},h.Util.Dates.month.long=function(t,e,n,r){var i=h.Util.Dates.normalizeMonth(e,!0);if(e=i.num){for(e=""+e;e.length<2;)e="0"+e;e=t.getTerm(i.stub+e,"long",0,0,!1,r)}else e="";return e},h.Util.Dates.month.short=function(t,e,n,r){var i=h.Util.Dates.normalizeMonth(e,!0);if(e=i.num){for(e=""+e;e.length<2;)e="0"+e;e=t.getTerm(i.stub+e,"short",0,0,!1,r)}else e="";return e},h.Util.Dates.day={},h.Util.Dates.day.numeric=function(t,e){return e.toString()},h.Util.Dates.day.long=h.Util.Dates.day.numeric,h.Util.Dates.day["numeric-leading-zeros"]=function(t,e){for(e||(e=0),e=e.toString();e.length<2;)e="0"+e;return e.toString()},h.Util.Dates.day.ordinal=function(t,e,n){return t.fun.ordinalizer.format(e,n)},t.exports=h,h.Util.Sort={},h.Util.Sort.strip_prepositions=function(t){var e;return"string"==typeof t&&(e=t.toLocaleLowerCase(),e=t.match(/^((a|an|the)\s+)/)),e&&(t=t.substr(e[1].length)),t},t.exports=h,h.Util.substituteStart=function(t,e){var n,r,i,o,a,s,u;o=function(t,e){for(var n=0,r=this.decorations.length;n<r;n+=1)if("@strip-periods"===this.decorations[n][0]&&"true"===this.decorations[n][1]){t.tmp.strip_periods+=1;break}},this.execs.push(o),this.decorations&&(t.opt.development_extensions.csl_reverse_lookup_support||t.sys.csl_reverse_lookup_support)&&(this.decorations.reverse(),this.decorations.push(["@showid","true",this.cslid]),this.decorations.reverse()),u=["number","date","names"],("text"===this.name&&!this.postponed_macro||u.indexOf(this.name)>-1)&&(n=function(t,e,n){"author"===t.tmp.element_trace.value()||"names"===this.name?n&&n["author-only"]?t.tmp.element_trace.push("do-not-suppress-me"):n&&n["suppress-author"]:n&&n["author-only"]?t.tmp.element_trace.push("suppress-me"):n&&n["suppress-author"]&&t.tmp.element_trace.push("do-not-suppress-me")},this.execs.push(n)),r=this.strings.cls,this.strings.cls=!1,0===t.build.render_nesting_level&&("bibliography"===t.build.area&&t.bibliography.opt["second-field-align"]?((i=new h.Token("group",h.START)).decorations=[["@display","left-margin"]],o=function(t,e){t.tmp.render_seen||(i.strings.first_blob=e.id,t.output.startTag("bib_first",i))},i.execs.push(o),e.push(i)):h.DISPLAY_CLASSES.indexOf(r)>-1&&((i=new h.Token("group",h.START)).decorations=[["@display",r]],o=function(t,e){i.strings.first_blob=e.id,t.output.startTag("bib_first",i)},i.execs.push(o),e.push(i)),t.build.cls=r),t.build.render_nesting_level+=1,1===t.build.substitute_level.value()&&(a=new h.Token("choose",h.START),h.Node.choose.build.call(a,t,e),o=function(e,n){return!!t.tmp.can_substitute.value()},(s=new h.Token("if",h.START)).tests.push(o),s.test=t.fun.match.any(this,t,s.tests),e.push(s)),t.sys.variableWrapper&&this.variables_real&&this.variables_real.length&&(o=function(t,e,n){if(!t.tmp.just_looking&&!t.tmp.suppress_decorations){var r=new h.Token("text",h.START);r.decorations=[["@showid","true"]],t.output.startTag("variable_entry",r);var i=null;n&&(i=n.position),i||(i=0);var o=0;n&&n.noteIndex&&(o=n.noteIndex);var a=0;n&&n["first-reference-note-number"]&&(a=n["first-reference-note-number"]);var s=0;n&&n["citation-number"]&&(s=n["citation-number"]);var u=0;n&&n.index&&(u=n.index);var l={itemData:e,variableNames:this.variables,context:t.tmp.area,xclass:t.opt.xclass,position:["first","subsequent","ibid","ibid-with-locator"][i],"note-number":o,"first-reference-note-number":a,"citation-number":s,index:u,mode:t.opt.mode};t.output.current.value().params=l}},this.execs.push(o))},h.Util.substituteEnd=function(t,e){var n,r,i,o,a,s;t.sys.variableWrapper&&(this.hasVariable||this.variables_real&&this.variables_real.length)&&(n=function(t,e){t.tmp.just_looking||t.tmp.suppress_decorations||t.output.endTag("variable_entry")},this.execs.push(n)),n=function(t,e){for(var n=0,r=this.decorations.length;n<r;n+=1)if("@strip-periods"===this.decorations[n][0]&&"true"===this.decorations[n][1]){t.tmp.strip_periods+=-1;break}},this.execs.push(n),t.build.render_nesting_level+=-1,0===t.build.render_nesting_level&&(t.build.cls?(n=function(t,e){t.output.endTag("bib_first")},this.execs.push(n),t.build.cls=!1):"bibliography"===t.build.area&&t.bibliography.opt["second-field-align"]&&(n=function(t,e){t.tmp.render_seen||t.output.endTag("bib_first")},(r=new h.Token("group",h.END)).execs.push(n),e.push(r),(i=new h.Token("group",h.START)).decorations=[["@display","right-inline"]],n=function(t,e){t.tmp.render_seen||(t.tmp.render_seen=!0,t.output.startTag("bib_other",i))},i.execs.push(n),e.push(i))),1===t.build.substitute_level.value()&&(o=new h.Token("if",h.END),e.push(o),a=new h.Token("choose",h.END),h.Node.choose.build.call(a,t,e)),("names"===this.name||"text"===this.name&&"title"!==this.variables_real)&&(new h.Token("text",h.SINGLETON),n=function(t,e){if("bibliography"===t.tmp.area&&"string"==typeof t.bibliography.opt["subsequent-author-substitute"]&&(!this.variables_real||e[this.variables_real])&&t.tmp.substituted_variable===this.variables_real){var n,r,i=t.bibliography.opt["subsequent-author-substitute-rule"];if(!t.tmp.suppress_decorations&&t.tmp.subsequent_author_substitute_ok&&t.tmp.rendered_name){if("partial-each"===i||"partial-first"===i){var o=!0,a=[];for(n=0,r=t.tmp.name_node.children.length;n<r;n+=1){var u=t.tmp.rendered_name[n];o&&t.tmp.last_rendered_name&&t.tmp.last_rendered_name.length>n-1&&u&&!u.localeCompare(t.tmp.last_rendered_name[n])?(s=new h.Blob(t[t.tmp.area].opt["subsequent-author-substitute"]),t.tmp.name_node.children[n].blobs=[s],"partial-first"===i&&(o=!1)):o=!1,a.push(u)}t.tmp.last_rendered_name=a}else if("complete-each"===i){if(a=t.tmp.rendered_name.join(",")){if(t.tmp.last_rendered_name&&!a.localeCompare(t.tmp.last_rendered_name))for(n=0,r=t.tmp.name_node.children.length;n<r;n+=1)s=new h.Blob(t[t.tmp.area].opt["subsequent-author-substitute"]),t.tmp.name_node.children[n].blobs=[s];t.tmp.last_rendered_name=a}}else{(a=t.tmp.rendered_name.join(","))&&(t.tmp.last_rendered_name&&!a.localeCompare(t.tmp.last_rendered_name)&&(s=new h.Blob(t[t.tmp.area].opt["subsequent-author-substitute"]),t.tmp.label_blob?t.tmp.name_node.top.blobs=[s,t.tmp.label_blob]:t.tmp.name_node.top.blobs.length?t.tmp.name_node.top.blobs[0].blobs=[s]:t.tmp.name_node.top.blobs=[s],t.tmp.substituted_variable=this.variables_real),t.tmp.last_rendered_name=a)}t.tmp.subsequent_author_substitute_ok=!1}}},this.execs.push(n)),("text"===this.name&&!this.postponed_macro||["number","date","names"].indexOf(this.name)>-1)&&(n=function(t,e){t.tmp.element_trace.pop()},this.execs.push(n))},t.exports=h,h.Util.padding=function(t){var e=t.match(/\s*(-{0,1}[0-9]+)/);if(e)for((t=parseInt(e[1],10))<0&&(t=1e20+t),t=""+t;t.length<20;)t="0"+t;return t},h.Util.LongOrdinalizer=function(){},h.Util.LongOrdinalizer.prototype.init=function(t){this.state=t},h.Util.LongOrdinalizer.prototype.format=function(t,e){t<10&&(t="0"+t);var n=h.Engine.getField(h.LOOSE,this.state.locale[this.state.opt.lang].terms,"long-ordinal-"+t,"long",0,e);return n||(n=this.state.fun.ordinalizer.format(t,e)),this.state.tmp.cite_renders_content=!0,n},h.Util.Ordinalizer=function(t){this.state=t,this.suffixes={}},h.Util.Ordinalizer.prototype.init=function(){if(!this.suffixes[this.state.opt.lang]){this.suffixes[this.state.opt.lang]={};for(var t=0;t<3;t+=1){var e=[void 0,"masculine","feminine"][t];this.suffixes[this.state.opt.lang][e]=[];for(var n=1;n<5;n+=1){var r=this.state.getTerm("ordinal-0"+n,"long",!1,e);if(void 0===r){delete this.suffixes[this.state.opt.lang][e];break}this.suffixes[this.state.opt.lang][e].push(r)}}}},h.Util.Ordinalizer.prototype.format=function(t,e){var n;n=""+(t=parseInt(t,10));var r="",i=[];if(e&&i.push(e),i.push("neuter"),this.state.locale[this.state.opt.lang].ord["1.0.1"]){var o;r=this.state.getTerm("ordinal",!1,0,e);for(var a=0,s=i.length;a<s;a+=1){o=i[a];var u=this.state.locale[this.state.opt.lang].ord["1.0.1"];if(u["whole-number"][n]&&u["whole-number"][n][o]?r=this.state.getTerm(this.state.locale[this.state.opt.lang].ord["1.0.1"]["whole-number"][n][o],!1,0,e):u["last-two-digits"][n.slice(n.length-2)]&&u["last-two-digits"][n.slice(n.length-2)][o]?r=this.state.getTerm(this.state.locale[this.state.opt.lang].ord["1.0.1"]["last-two-digits"][n.slice(n.length-2)][o],!1,0,e):u["last-digit"][n.slice(n.length-1)]&&u["last-digit"][n.slice(n.length-1)][o]&&(r=this.state.getTerm(this.state.locale[this.state.opt.lang].ord["1.0.1"]["last-digit"][n.slice(n.length-1)][o],!1,0,e)),r)break}}else e||(e=void 0),this.state.fun.ordinalizer.init(),r=t/10%10==1||t>10&&t<20?this.suffixes[this.state.opt.lang][e][3]:t%10==1&&t%100!=11?this.suffixes[this.state.opt.lang][e][0]:t%10==2&&t%100!=12?this.suffixes[this.state.opt.lang][e][1]:t%10==3&&t%100!=13?this.suffixes[this.state.opt.lang][e][2]:this.suffixes[this.state.opt.lang][e][3];return n=n+=r},h.Util.Romanizer=function(){},h.Util.Romanizer.prototype.format=function(t){var e,n,r,i,o;if(e="",t<6e3)for((i=t.toString().split("")).reverse(),n=0,r=0,o=i.length,n=0;n<o;n+=1)r=parseInt(i[n],10),e=h.ROMAN_NUMERALS[n][r]+e;return e},h.Util.Suffixator=function(t){t||(t=h.SUFFIX_CHARS),this.slist=t.split(",")},h.Util.Suffixator.prototype.format=function(t){var e;t+=1;var n="";do{e=t%26==0?26:t%26;n=this.slist[e-1]+n;t=(t-e)/26}while(0!==t);return n},h.Engine.prototype.processNumber=function(t,e,n,r){var i,o=this;function a(t,e,r,i){i=i||"";var o={};if(e||h.STATUTE_SUBDIV_STRINGS_REVERSE[n]||(e="var:"+n),e){var a=e.match(/(\s*)([^\s]*)(\s*)/);o.label=a[2],o.origLabel=t,o.labelSuffix=a[3]?a[3]:"",o.plural=0,o.labelVisibility=!1}return(a=r.match(/^([a-zA-Z0]*)([0-9]+(?:[a-zA-Z]*|[-,a-zA-Z]+))$/))?(o.particle=a[1],o.value=a[2]):(o.particle="",o.value=r),o.joiningSuffix=i.replace(/\s*-\s*/,"-"),o}function s(t,e,n){var r=t[n.pos],i=t[e].value,o="\\-"===r.joiningSuffix;i.particle&&i.particle!==r.particle&&(n.collapsible=!1);var a=i.match(/^[0-9]+([-,:a-zA-Z]*)$/),s=r.value.match(/^[0-9]+([-,:a-zA-Z]*)$/);i&&a&&s&&!o||(n.collapsible=!1,i&&s||(n.numeric=!1),o&&n.count--),(a&&a[1]||s&&s[1])&&(n.collapsible=!1);var u=n.collapsible;!u&&e>0&&i.match(/^[ivxlcmIVXLCM]+$/)&&t[e-1].value.match(/^[ivxlcmIVXLCM]+$/)&&(u=!0);for(var l=n.pos,c=t.length;l<c;l++)n.label===t[l].label&&n.count>1&&u&&(t[l].plural=1),t[l].numeric=n.numeric,t[l].collapsible=n.collapsible;n.label=t[e].label,n.count=1,n.pos=e,n.numeric=!0,n.collapsible=!0}function u(e){var n=h.Util.cloneToken(t),r=new h.Token;if(!o.tmp.just_looking){for(var i=n.decorations.length-1;i>-1;i--)"@quotes"===n.decorations[i][0]&&(r.decorations=r.decorations.concat(n.decorations.slice(i,i+1)),n.decorations=n.decorations.slice(0,i).concat(n.decorations.slice(i+1)));r.strings.prefix=n.strings.prefix,n.strings.prefix="",r.strings.suffix=n.strings.suffix,n.strings.suffix=""}var a=e.length?e[0].label:null;if(e.length){for(var s=0,u=e.length;s<u;s++){var c=e[s],p=h.Util.cloneToken(n);p.gender=t.gender,a===c.label&&(p.formatter=t.formatter),c.numeric&&(p.successor_prefix=c.successor_prefix),p.strings.suffix=p.strings.suffix+l(c.joiningSuffix),c.styling=p}o.tmp.just_looking||'"'===e[0].value.slice(0,1)&&'"'===e[e.length-1].value.slice(-1)&&(e[0].value=e[0].value.slice(1),e[e.length-1].value=e[e.length-1].value.slice(0,-1),r.decorations.push(["@quotes",!0]))}return r}function l(t){return t.replace("\\-","-")}function c(t,e,n,r){var i=p(t,e);return function(t,e){var n=!0;"locator"===t&&(n=!!o.getTerm(h.STATUTE_SUBDIV_STRINGS[e.label]));return n}(t,e)&&"-"===n&&r&&((i||["locator","issue","volume","edition","number"].indexOf(t)>-1)&&((n=o.getTerm("page-range-delimiter"))||(n="–")),"collection-number"===t&&((n=o.getTerm("year-range-delimiter"))||(n="–"))),n}function p(t,e){return"page"===t||"locator"===t&&["p."].indexOf(e.label)>-1}function f(t,e,r){if(!(e<1)&&2===r.count&&t[e-1].particle===t[e].particle)if("-"===t[e-1].joiningSuffix)if(!o.opt["page-range-format"]&&parseInt(t[e-1].value,10)>parseInt(t[e].value,10))t[e-1].joiningSuffix=c(n,t[e],t[e-1].joiningSuffix,!0);else{var i=t[e];if(p(n,i)){var a=t[e-1].particle+t[e-1].value+" - "+t[e].particle+t[e].value;a=o.fun.page_mangler(a)}else a=t[e-1].value+l(t[e-1].joiningSuffix)+t[e].value;var s=a.match(/^([a-zA-Z]?0*)([0-9]+)(\s*[^0-9]+\s*)([-,a-zA-Z]?0*)([0-9]+)$/);if(s){var u=s[3];u=c(n,i,u,t[e].numeric),t[e-1].particle=s[1],t[e-1].value=s[2],t[e-1].joiningSuffix=u,t[e].particle=s[4],t[e].value=s[5]}r.count=0}else r.count=1}function d(e){if(t&&-1!==["page","page-first","chapter-number","collection-number","edition","issue","number","number-of-pages","number-of-volumes","volume","locator"].indexOf(n)){for(var r={count:0,label:null,lastHadRangeDelimiter:!1},i=0,o=e.length;i<o;i++){var a=e[i];if(a.collapsible)r.label===a.label&&"-"===a.joiningSuffix?r.count=1:r.label===a.label&&"-"!==a.joiningSuffix?(r.count++,2===r.count&&f(e,i,r)):r.label!==a.label?(r.label=a.label,r.count=1):(r.count=1,r.label=a.label);else{r.count=0,r.label=null;var s=a.numeric;i<e.length-1&&!s&&a.value.match(/^[ivxlcmIVXLCM]+$/)&&e[i+1].value.match(/^[ivxlcmIVXLCM]+$/)&&(s=!0),a.joiningSuffix=c(n,a,a.joiningSuffix,s)}}2===r.count&&f(e,e.length-1,r)}}if(t&&this.tmp.shadow_numbers[n]&&this.tmp.shadow_numbers[n].values.length)return d(w=this.tmp.shadow_numbers[n].values),void(this.tmp.shadow_numbers[n].masterStyling=u(w));if(this.tmp.shadow_numbers[n]||(this.tmp.shadow_numbers[n]={values:[]}),e){var m,g,v,y,b=h.LangPrefsMap[n];if(b){var _=this.opt["cite-lang-prefs"][b][0];i=(i=this.transform.getTextSubField(e,n,"locale-"+_,!0)).name}else i=e[n];if(i&&this.sys.getAbbreviation){var x=this.transform.loadAbbreviation(e.jurisdiction,"number",i);this.transform.abbrevs[x].number&&(this.transform.abbrevs[x].number[i]?i=this.transform.abbrevs[x].number[i]:void 0!==this.transform.abbrevs[x].number[i]&&delete this.transform.abbrevs[x].number[i])}if(void 0!==i&&("string"==typeof i||"number"==typeof i)){"number"==typeof i&&(i=""+i);var w,E=h.STATUTE_SUBDIV_STRINGS_REVERSE[n];if(!this.tmp.shadow_numbers.values)!function(t){for(var e=0,n=t.length-1;e<n;e++)!t[e].joiningSuffix&&t[e+1].label&&(t[e].joiningSuffix=" ")}(w=function(t,r){r=r||"";var i=[];if(f=(t=function(t,r){var i=(t=t.trim()).match(/^([^ ]+)/);if(i&&!h.STATUTE_SUBDIV_STRINGS[i[1]]){var o=null;(o="locator"===n?e.label?h.STATUTE_SUBDIV_STRINGS_REVERSE[e.label]:"p.":h.STATUTE_SUBDIV_STRINGS_REVERSE[n])&&(t=o+" "+t)}return t}(t)).match(/(,\s+|\s*\\*[\-\u2013]+\s*|\s*&\s*)/g)){for(var s=0,u=(d=t.split(/(?:,\s+|\s*\\*[\-\u2013]+\s*|\s*&\s*)/)).length-1;s<u;s++)i.push(d[s]),i.push(f[s]);i.push(d[d.length-1]),i=function(t){for(var e=t.length-2;e>-1;e-=2)"-"===t[e]&&t[e-1].match(/^(?:(?:[a-z]|[a-z][a-z]|[a-z][a-z][a-z]|[a-z][a-z][a-z][a-z])\.  *)*[0-9]+[,a-zA-Z]+$/)&&t[e+1].match(/^[,a-zA-Z]+$/)&&(t[e-1]=t.slice(e-1,e+2).join(""),t=t.slice(0,e).concat(t.slice(e+2)));return t}(i)}else i=[t];var l=[],c=r,p="";for(s=0,u=i.length;s<u;s+=2){var f;if(f=i[s].match(/((?:^| )(?:[a-z]|[a-z][a-z]|[a-z][a-z][a-z]|[a-z][a-z][a-z][a-z])\. *)/g)){for(var d,m=(d=i[s].split(/(?:(?:^| )(?:[a-z]|[a-z][a-z]|[a-z][a-z][a-z]|[a-z][a-z][a-z][a-z])\. *)/)).length-1;m>0;m--)!d[m-1]||d[m].match(/^[0-9]+([-,:a-zA-Z]*)$/)&&d[m-1].match(/^[0-9]+([-,:a-zA-Z]*)$/)||(d[m-1]=d[m-1]+f[m-1]+d[m],d=d.slice(0,m).concat(d.slice(m+1)),f=f.slice(0,m-1).concat(f.slice(m)));if(f.length>0&&0===s){var g=f[0].trim();h.STATUTE_SUBDIV_STRINGS[g]&&o.getTerm(h.STATUTE_SUBDIV_STRINGS[g])&&(-1!==["locator","number"].indexOf(n)||h.STATUTE_SUBDIV_STRINGS[g]===n)||(f=f.slice(1),d[0]=d[0]+" "+g+" "+d[1],d=d.slice(0,1).concat(d.slice(2)))}m=0;for(var v=d.length;m<v;m++)(d[m]||m===d.length-1)&&(c=f[m-1]?f[m-1]:c,p=m>1?f[m-1]:"",t=d[m]?d[m].trim():"",m===d.length-1?l.push(a(p,c,t,i[s+1])):l.push(a(p,c,t)))}else l.push(a(p,c,i[s],i[s+1]))}return l}(i,E)),function(t){for(var r={label:null,count:1,numeric:!0,collapsible:!0,pos:0},i=(t.length&&t[0].label,0),a=t.length;i<a;i++)t[i].label&&(t[i].label===r.label?r.count++:(s(t,i,r),0===r.pos?("locator"!==n&&"number"!==n||o.getTerm(h.STATUTE_SUBDIV_STRINGS[r.label])||"var:"===r.label.slice(0,4)||(t[r.pos].labelVisibility=!0),-1===["locator","number"].indexOf(n)&&h.STATUTE_SUBDIV_STRINGS[r.label]!==n&&"var:"!==r.label.slice(0,4)&&(t[0].labelVisibility=!0)):t[i-1].label!==t[i].label&&"var:"!==r.label.slice(0,4)&&(t[r.pos].labelVisibility=!0)));for(s(t,t.length-1,r),t.length&&t[0].numeric&&"number-of-"===n.slice(0,10)&&parseInt(e[n],10)>1&&(t[0].plural=1),i=0,a=t.length;i<a;i++)if(!t[i].numeric){var u=t[i].origLabel?t[i].origLabel:"";t[i].value=(u+t[i].value).trim(),t[i].label!==t[0].label&&(t[i].label="")}}(w),this.tmp.shadow_numbers[n].values=w;t&&(d(w),this.tmp.shadow_numbers[n].masterStyling=u(w)),m=this.tmp.shadow_numbers,v=w,y=m[g=n],v.length&&(y.numeric=v[0].numeric,y.collapsible=v[0].collapsible,y.plural=v[0].plural,y.label=h.STATUTE_SUBDIV_STRINGS[v[0].label],"number"===g&&"issue"===y.label&&o.getTerm("number")&&(y.label="number"))}}},h.Util.outputNumericField=function(t,e,n){t.output.openLevel(t.tmp.shadow_numbers[e].masterStyling);var r,i=t.tmp.shadow_numbers[e].values,o=i.length?i[0].label:null,a=t.tmp.shadow_numbers[e].labelForm;r=a||"short";for(var s=t.tmp.shadow_numbers[e].labelDecorations,u=null,l=0,c=i.length;l<c;l++){var p,f=i[l],d="";if(f.label)(p="var:"===f.label.slice(0,4)?f.label.slice(4):h.STATUTE_SUBDIV_STRINGS[f.label])&&(d=f.label===o?t.getTerm(p,a,f.plural):t.getTerm(p,r,f.plural));var m=-1;d&&(m=d.indexOf("%s"));var g=h.Util.cloneToken(f.styling);if(g.formatter=f.styling.formatter,g.type=f.styling.type,g.num=f.styling.num,g.gender=f.styling.gender,m>0&&m<d.length-2)g.strings.prefix+=d.slice(0,m),g.strings.suffix=d.slice(m+2)+g.strings.suffix;else if(f.labelVisibility)if(d||(d=f.label,p=f.label),m>0){var v=new h.Token;v.decorations=s,t.output.append(d.slice(0,m),v)}else m!==d.length-2&&-1!==m||t.output.append(d+f.labelSuffix,"empty");if(f.collapsible){if(f.value.match(/^[0-9]+$/))var y=new h.NumericBlob(f.particle,parseInt(f.value,10),g,n);else y=new h.NumericBlob(f.particle,f.value,g,n);void 0===y.gender&&(y.gender=t.locale[t.opt.lang]["noun-genders"][e]),t.output.append(y,"literal")}else t.output.append(f.particle+f.value,g);if(0===m&&m<d.length-2&&(null===u&&(u=p),p!==u||l===i.length-1)){var b=new h.Token;b.decorations=s,t.output.append(d.slice(m+2),b)}}t.output.closeLevel()},t.exports=h,h.Util.PageRangeMangler={},h.Util.PageRangeMangler.getFunction=function(t,e){var n,r,i,o,a,s,u,l,c,h,p,f,d,m,g,v,y,b=t.getTerm(e+"-range-delimiter");n=/([a-zA-Z]*)([0-9]+)\s*(?:\u2013|-)\s*([a-zA-Z]*)([0-9]+)/,o=function(n){for(i=n.length,r=1;r<i;r+=2)"object"==typeof n[r]&&(n[r]=n[r].join(""));var o=n.join("");return o=o.replace(/([^\\])\-/g,"$1"+t.getTerm(e+"-range-delimiter"))},a=function(t){var e,n,o,a=new RegExp("([^\\\\])[-"+("-"===b?"":b)+"\\u2013]","g");t=t.replace(a,"$1 - ").replace(/\s+-\s+/g," - ");var s=new RegExp("([a-zA-Z]*[0-9]+\\s+\\-\\s+[a-zA-Z]*[0-9]+)","g"),u=new RegExp("[a-zA-Z]*[0-9]+\\s+\\-\\s+[a-zA-Z]*[0-9]+");if(e=t.match(s),0===(n=t.split(u)).length)o=e;else for(o=[n[0]],r=1,i=n.length;r<i;r+=1)o.push(e[r-1].replace(/\s*\-\s*/g,"-")),o.push(n[r]);return o},s=function(t){for(h=a(t=""+t),i=h.length,r=1;r<i;r+=2)(p=h[r].match(n))&&(p[3]&&p[1]!==p[3]||(p[4].length<p[2].length&&(p[4]=p[2].slice(0,p[2].length-p[4].length)+p[4]),parseInt(p[2],10)<parseInt(p[4],10)&&(p[3]=b+p[1],h[r]=p.slice(1)))),"string"==typeof h[r]&&(h[r]=h[r].replace(/\-/g,b));return h},u=function(t,e,n){i=t.length;for(var r=1,a=t.length;r<a;r+=2)t[r][3]=l(t[r][1],t[r][3],e,n),t[r][2].slice(1)===t[r][0]&&(t[r][2]=b);return o(t)},l=function(t,e,n,r){if(n||(n=0),f=(""+t).split(""),d=(""+e).split(""),(m=d.slice()).reverse(),f.length===d.length)for(var i=0,o=f.length;i<o;i+=1){if(!(f[i]===d[i]&&m.length>n)){if(n&&r&&3===m.length){var a=f.slice(0,i);a.reverse(),m=m.concat(a)}break}m.pop()}return m.reverse(),m.join("")},c=function(t){for(i=t.length,r=1;r<i;r+=2)"object"==typeof t[r]&&(p=t[r],g=parseInt(p[1],10),v=parseInt(p[3],10),g>100&&g%100&&parseInt(g/100,10)===parseInt(v/100,10)?p[3]=""+v%100:g>=1e4&&(p[3]=""+v%1e3)),p[2].slice(1)===p[0]&&(p[2]=b);return o(t)};var _=function(t,e,n,r){return e(s(t=""+t),n,r)};return t.opt[e+"-range-format"]?"expanded"===t.opt[e+"-range-format"]?y=function(t){return _(t,o)}:"minimal"===t.opt[e+"-range-format"]?y=function(t){return _(t,u)}:"minimal-two"===t.opt[e+"-range-format"]?y=function(t,e){return _(t,u,2,e)}:"chicago"===t.opt[e+"-range-format"]&&(y=function(t){return _(t,c)}):y=function(t){return _(t,o)},y},t.exports=h,h.Util.FlipFlopper=function(t){this.processTags=function(r){var i=!1;" "!==(g=r.blobs).slice(0,1)||g.match(/^\s+[\'\"]/)||(i=!0);var o=function(t){var e=[],r=(t=(t=t.replace(/(<span)\s+(style=\"font-variant:)\s*(small-caps);?\"[^>]*(>)/g,'$1 $2$3;"$4')).replace(/(<span)\s+(class=\"no(?:case|decor)\")[^>]*(>)/g,"$1 $2$3")).match(c.matchAll);if(!r)return{tags:[],strings:[t],forcedSpaces:[]};for(var i=t.split(c.splitAll),o=0,a=r.length-1;o<a;o++)n[r[o]]&&(""===i[o+1]&&['"',"'"].indexOf(r[o+1])>-1?(r[o+1]=" "+r[o+1],e.push(!0)):e.push(!1));return{tags:r,strings:i,forcedSpaces:e}}(g=" "+g);if(0===o.tags.length)return;for(var a=!1,u=0,d=o.tags.length;u<d;u++){var m=o.tags[u],g=o.strings[u+1];if(f(m,g))o.strings[u+1]=" '"===m?" ’"+o.strings[u+1]:"’"+o.strings[u+1],o.tags[u]="";else{for(var v;_=u,x=void 0,w=void 0,E=void 0,S=void 0,T=void 0,O=void 0,v=(b=m).match(c.open)?(S=b,T=_,!(O=e[e.length-1])||S.match(O.opener)?(e.push({type:l[S].type,opener:l[S].opener,closer:l[S].closer,pos:T}),!1):(e.pop(),e.push({type:l[S].type,opener:l[S].opener,closer:l[S].closer,pos:T}),{fixtag:O.pos})):(x=b,w=_,(E=e[e.length-1])&&x===E.closer?(e.pop(),"nocase"===E.type&&{nocase:{open:E.pos,close:w}}):E?{fixtag:E.pos}:{fixtag:w});){if(!(Object.keys(v).indexOf("fixtag")>-1)){if(v.nocase){o.tags[v.nocase.open]="",o.tags[v.nocase.close]="";break}break}if(m.match(c.close)&&"'"===m)o.strings[u+1]="’"+o.strings[u+1],o.tags[u]="";else{var y=o.tags[v.fixtag];o.forcedSpaces[v.fixtag-1]&&(y=y.slice(1)),o.strings[v.fixtag+1]=y+o.strings[v.fixtag+1],o.tags[v.fixtag]=""}if(!(e.length>0))break;e.pop()}v&&(v.fixtag||0===v.fixtag)&&(o.strings[u+1]=o.tags[u]+o.strings[u+1],o.tags[u]="")}}var b,_,x,w,E,S,T,O;for(var u=e.length-1;u>-1;u--){var A=e[u].pos,m=o.tags[A];o.strings[A+1]=" '"===m||"'"===m?" ’"+o.strings[A+1]:o.tags[A]+o.strings[A+1],o.tags[A]="",e.pop()}for(var u=o.tags.length-1;u>-1;u--)o.tags[u]||(o.tags=o.tags.slice(0,u).concat(o.tags.slice(u+1)),o.strings[u]=o.strings[u]+o.strings[u+1],o.strings=o.strings.slice(0,u+1).concat(o.strings.slice(u+2)));for(var u=0,d=o.tags.length;u<d;u++){var m=o.tags[u],M=o.forcedSpaces[u-1];[' "'," '",'("',"('"].indexOf(m)>-1&&(a||(s(m),a=!0),M||(o.strings[u]+=m.slice(0,1)))}!function(e,n,r){var i=!0,o=new p(e);e.blobs=[];var a=new function(e){this.stack=[e],this.latest=e,this.addStyling=function(e,n,r){if(i&&(" "===e.slice(0,1)&&(e=e.slice(1))," "===e.slice(0,1)&&(e=e.slice(1)),i=!1),this.latest=this.stack[this.stack.length-1],n){if("string"==typeof this.latest.blobs){var o=new h.Blob;o.blobs=this.latest.blobs,o.alldecor=this.latest.alldecor.slice(),this.latest.blobs=[o]}var a=new h.Token,s=new h.Blob(null,a);if(s.alldecor=this.latest.alldecor.slice(),"@class"===n[0]&&"nodecor"===n[1]){for(var u=[],l={},c=[t[t.tmp.area].opt.layout_decorations].concat(s.alldecor),p=c.length-1;p>-1;p--){var f=c[p];if(f)for(var d=f.length-1;d>-1;d--){var m=f[d];["@font-weight","@font-style","@font-variant"].indexOf(m[0])>-1&&!l[m[0]]&&("normal"!==n[1]&&(s.decorations.push([m[0],"normal"]),u.push([m[0],"normal"])),l[m[0]]=!0)}}s.alldecor.push(u)}else s.decorations.push(n),s.alldecor.push([n]);if(this.latest.blobs.push(s),this.stack.push(s),this.latest=s,e){var a=new h.Token,s=new h.Blob(null,a);s.blobs=e,s.alldecor=this.latest.alldecor.slice(),this.latest.blobs.push(s)}}else if(e){var o=new h.Blob;o.blobs=e,o.alldecor=this.latest.alldecor.slice(),this.latest.blobs.push(o)}},this.popStyling=function(){this.stack.pop()}}(e);if(n.strings.length){var s=n.strings[0];r&&(s=" "+s),a.addStyling(s)}for(var u=0,l=n.tags.length;u<l;u++){var f=n.tags[u],s=n.strings[u+1];f.match(c.open)?(o.set(f),a.addStyling(s,o.pair())):(o.pop(),a.popStyling(),a.addStyling(s))}}(r,o,i)};var e=[],n={'<span class="nocase">':{type:"nocase",opener:'<span class="nocase">',closer:"</span>",attr:null,outer:null,flipflop:null},'<span class="nodecor">':{type:"nodecor",opener:'<span class="nodecor">',closer:"</span>",attr:"@class",outer:"nodecor",flipflop:{nodecor:"nodecor"}},'<span style="font-variant:small-caps;">':{type:"tag",opener:'<span style="font-variant:small-caps;">',closer:"</span>",attr:"@font-variant",outer:"small-caps",flipflop:{"small-caps":"normal",normal:"small-caps"}},"<sc>":{type:"tag",opener:"<sc>",closer:"</sc>",attr:"@font-variant",outer:"small-caps",flipflop:{"small-caps":"normal",normal:"small-caps"}},"<i>":{type:"tag",opener:"<i>",closer:"</i>",attr:"@font-style",outer:"italic",flipflop:{italic:"normal",normal:"italic"}},"<b>":{type:"tag",opener:"<b>",closer:"</b>",attr:"@font-weight",outer:"bold",flipflop:{bold:"normal",normal:"bold"}},"<sup>":{type:"tag",opener:"<sup>",closer:"</sup>",attr:"@vertical-align",outer:"sup",flipflop:{sub:"sup",sup:"sup"}},"<sub>":{type:"tag",opener:"<sub>",closer:"</sub>",attr:"@vertical-align",outer:"sub",flipflop:{sup:"sub",sub:"sub"}},' "':{type:"quote",opener:' "',closer:'"',attr:"@quotes",outer:"true",flipflop:{true:"inner",inner:"true",false:"true"}}," '":{type:"quote",opener:" '",closer:"'",attr:"@quotes",outer:"inner",flipflop:{true:"inner",inner:"true",false:"true"}}};n['("']=n[' "'],n["('"]=n[" '"];var r=t.getTerm("open-quote"),i=t.getTerm("close-quote"),o=t.getTerm("open-inner-quote"),a=t.getTerm("close-inner-quote");r&&i&&-1===[' "'," '",'"',"'"].indexOf(r)&&(n[r]=JSON.parse(JSON.stringify(n[' "'])),n[r].opener=r,n[r].closer=i),o&&a&&-1===[' "'," '",'"',"'"].indexOf(o)&&(n[o]=JSON.parse(JSON.stringify(n[" '"])),n[o].opener=o,n[o].closer=a);(function(){for(var t={},e=Object.keys(n),r=0,i=e.length;r<i;r++){var o=e[r];"quote"===n[o].type&&(t[n[o].closer]=n[o])}})(),function(){for(var t={},e=Object.keys(n),r=0,i=e.length;r<i;r++){var o=e[r];if("nocase"!==n[o].type){var a=n[o].attr,s=n[o].outer,u=n[o].flipflop[n[o].outer];t[a+"/"+s]=n[o],t[a+"/"+u]=n[o]}}}();function s(t){n[t].outer="true",n[{" '":' "',' "':" '",'("':"('","('":'("'}[t]].outer="inner"}function u(t){for(var e=[],r=Object.keys(n),i=0,o=r.length;i<o;i++){var a=r[i];"quote"===n[t].type&&n[t]||e.push(a)}var s=n[t];return s.opener=new RegExp("^(?:"+e.map(function(t){return t.replace("(","\\(")}).join("|")+")"),s}var l=function(){for(var t={},e=Object.keys(n),r=0,i=e.length;r<i;r++){var o=e[r];t[o]=u(o)}return t}(),c=function(){var t=[],e=[],n={};for(var r in l)t.push(r),n[l[r].closer]=!0;for(var i=Object.keys(n),o=0,a=i.length;o<a;o++){var s=i[o];e.push(s)}var u=t.concat(e).map(function(t){return t.replace("(","\\(")}).join("|");return{matchAll:new RegExp("((?:"+u+"))","g"),splitAll:new RegExp("(?:"+u+")","g"),open:new RegExp("(^(?:"+t.map(function(t){return t.replace("(","\\(")}).join("|")+")$)"),close:new RegExp("(^(?:"+e.join("|")+")$)")}}();var p=function(e){this.set=function(i){for(var o=n[i].attr,a=null,s=r.length-1;s>-1;s--){var u=r[s];if(u[0]===o){a=u;break}}if(!a){var l=[t[t.tmp.area].opt.layout_decorations].concat(e.alldecor);t:for(var s=l.length-1;s>-1;s--){var c=l[s];if(c)for(var h=c.length-1;h>-1;h--){var u=c[h];if(u[0]===o){a=u;break t}}}}a=a?[o,n[i].flipflop[a[1]]]:[o,n[i].outer];r.push(a)},this.pair=function(){return r[r.length-1]},this.pop=function(){r.pop()};var r=[]};function f(t,e){if("'"===t){if(e&&e.match(/^[^\,\.\?\:\;\ ]/))return!0}else if(" '"===t&&e&&e.match(/^[\ ]/))return!0;return!1}},t.exports=h,h.Output.Formatters=new function(){this.passthrough=function(t,e){return e},this.lowercase=function(t,e){return i({quoteState:null,capitaliseWords:function(t){for(var e=t.split(" "),n=0,r=e.length;n<r;n++){var i=e[n];i&&(e[n]=i.toLowerCase())}return e.join(" ")},skipWordsRex:null,tagState:[],afterPunct:null,isFirst:null},e)},this.uppercase=function(t,e){return i({quoteState:null,capitaliseWords:function(t){for(var e=t.split(" "),n=0,r=e.length;n<r;n++){var i=e[n];i&&(e[n]=i.toUpperCase())}return e.join(" ")},skipWordsRex:null,tagState:[],afterPunct:null,isFirst:null},e)},this.sentence=function(t,e){var n={quoteState:[],capitaliseWords:function(t){for(var e=t.split(" "),i=0,o=e.length;i<o;i++){var a=e[i];a&&(n.isFirst?(e[i]=r(a),n.isFirst=!1):e[i]=a.toLowerCase())}return e.join(" ")},skipWordsRex:null,tagState:[],afterPunct:null,isFirst:!0};return i(n,e)},this.title=function(t,n){var o={quoteState:[],capitaliseWords:function(t,n,i){if(t.trim()){for(var a=t.split(/[ \u00A0]+/),s=e.split(t),a=s.strings,u=0,l=a.length;u<l;u++){var c=a[u];c&&(c.length>1&&!c.toLowerCase().match(o.skipWordsRex)?a[u]=r(a[u]):u===a.length-1&&"-"===i?a[u]=r(a[u]):o.isFirst?a[u]=r(a[u]):o.afterPunct&&(a[u]=r(a[u])),o.afterPunct=!1,o.isFirst=!1,o.lastWordPos={strings:n,words:u})}t=e.join(s)}return t},skipWordsRex:t.locale[t.opt.lang].opts["skip-words-regexp"],tagState:[],afterPunct:!1,isFirst:!0};return i(o,n)},this["capitalize-first"]=function(t,e){var n={quoteState:[],capitaliseWords:function(t){for(var e=t.split(" "),i=0,o=e.length;i<o;i++){var a=e[i];if(a&&n.isFirst){e[i]=r(a),n.isFirst=!1;break}}return e.join(" ")},skipWordsRex:null,tagState:[],afterPunct:null,isFirst:!0};return i(n,e)},this["capitalize-all"]=function(t,e){return i({quoteState:[],capitaliseWords:function(t){for(var e=t.split(" "),n=0,i=e.length;n<i;n++){var o=e[n];o&&(e[n]=r(o))}return e.join(" ")},skipWordsRex:null,tagState:[],afterPunct:null,isFirst:null},e)};var t=new h.Doppeler('(?:‘|’|“|”| "| \'|"|\'|[-–—/.,;?!:]|\\[|\\]|\\(|\\)|<span style="font-variant: small-caps;">|<span class="no(?:case|decor)">|</span>|</?(?:i|sc|b|sub|sup)>)',function(t){return t.replace(/(<span)\s+(class=\"no(?:case|decor)\")[^>]*(>)/g,"$1 $2$3").replace(/(<span)\s+(style=\"font-variant:)\s*(small-caps);?(\")[^>]*(>)/g,"$1 $2 $3;$4$5")}),e=new h.Doppeler("(?:[   -​ 　]+)"),n={'<span style="font-variant: small-caps;">':"</span>",'<span class="nocase">':"</span>",'<span class="nodecor">':"</span>"};function r(t,e){var n=t.match(/(^\s*)((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))(.*)/);return!n||n[2].match(/^[\u0370-\u03FF]$/)&&!n[3]?t:n[1]+n[2].toUpperCase()+n[3]}function i(i,o){if(!o)return"";i.doppel=t.split(o);var a={' "':{opener:" '",closer:'"'}," '":{opener:' "',closer:"'"},"‘":{opener:"‘",closer:"’"},"“":{opener:"“",closer:"”"}};function s(t,e){var n,r,o=t.match(/(^(?:\u2018|\u2019|\u201C|\u201D|\"|\')|(?: \"| \')$)/);if(o)return n=o[1],r=e,["“","‘",' "'," '"].indexOf(n)>-1?function(t,e){if(0===i.quoteState.length||t===i.quoteState[i.quoteState.length-1].opener)return i.quoteState.push({opener:a[t].opener,closer:a[t].closer,pos:e}),!1;var n=i.quoteState[i.quoteState.length-1].pos;return i.quoteState.pop(),i.quoteState.push({opener:a[t].opener,closer:a[t].closer,positions:e}),n}(n,r):function(t,e){if(!(i.quoteState.length>0&&t===i.quoteState[i.quoteState.length-1].closer))return e;i.quoteState.pop()}(n,r)}i.doppel.strings.length&&i.doppel.strings[0].trim()&&(i.doppel.strings[0]=i.capitaliseWords(i.doppel.strings[0],0,i.doppel.tags[0]));for(var u=0,l=i.doppel.tags.length;u<l;u++){var c=i.doppel.tags[u],h=i.doppel.strings[u+1];if(null!==i.tagState&&(n[c]?i.tagState.push(n[c]):i.tagState.length&&c===i.tagState[i.tagState.length-1]&&i.tagState.pop()),null!==i.afterPunct&&c.match(/[\!\?\:]$/)&&(i.afterPunct=!0),0===i.tagState.length?i.doppel.strings[u+1]=i.capitaliseWords(h,u+1,i.doppel,i.doppel.tags[u+1]):i.doppel.strings[u+1].trim()&&(i.lastWordPos=null),null!==i.quoteState)if((f=s(c,u))||0===f){var p=i.doppel.origStrings[f+1].slice(0,1);i.doppel.strings[f+1]=p+i.doppel.strings[f+1].slice(1),i.lastWordPos=null}i.isFirst&&h.trim()&&(i.isFirst=!1),i.afterPunct&&h.trim()&&(i.afterPunct=!1)}if(i.quoteState)for(u=0,l=i.quoteState.length;u<l;u++){var f;if(void 0!==(f=i.quoteState[u].pos)){p=i.doppel.origStrings[f+1].slice(0,1);i.doppel.strings[f+1]=p+i.doppel.strings[f+1].slice(1)}}if(i.lastWordPos){var d=e.split(i.doppel.strings[i.lastWordPos.strings]),m=r(d.strings[i.lastWordPos.words]);d.strings[i.lastWordPos.words]=m,i.doppel.strings[i.lastWordPos.strings]=e.join(d)}return t.join(i.doppel)}},t.exports=h,h.Output.Formats=function(){},h.Output.Formats.prototype.html={text_escape:function(t){return t||(t=""),t.replace(/&/g,"&#38;").replace(/</g,"&#60;").replace(/>/g,"&#62;").replace(/\s\s/g,"  ").replace(h.SUPERSCRIPTS_REGEXP,function(t){return"<sup>"+h.SUPERSCRIPTS[t]+"</sup>"})},bibstart:'<div class="csl-bib-body">\n',bibend:"</div>","@font-style/italic":"<i>%%STRING%%</i>","@font-style/oblique":"<em>%%STRING%%</em>","@font-style/normal":'<span style="font-style:normal;">%%STRING%%</span>',"@font-variant/small-caps":'<span style="font-variant:small-caps;">%%STRING%%</span>',"@passthrough/true":h.Output.Formatters.passthrough,"@font-variant/normal":'<span style="font-variant:normal;">%%STRING%%</span>',"@font-weight/bold":"<b>%%STRING%%</b>","@font-weight/normal":'<span style="font-weight:normal;">%%STRING%%</span>',"@font-weight/light":!1,"@text-decoration/none":'<span style="text-decoration:none;">%%STRING%%</span>',"@text-decoration/underline":'<span style="text-decoration:underline;">%%STRING%%</span>',"@vertical-align/sup":"<sup>%%STRING%%</sup>","@vertical-align/sub":"<sub>%%STRING%%</sub>","@vertical-align/baseline":'<span style="baseline">%%STRING%%</span>',"@strip-periods/true":h.Output.Formatters.passthrough,"@strip-periods/false":h.Output.Formatters.passthrough,"@quotes/true":function(t,e){return void 0===e?t.getTerm("open-quote"):t.getTerm("open-quote")+e+t.getTerm("close-quote")},"@quotes/inner":function(t,e){return void 0===e?"’":t.getTerm("open-inner-quote")+e+t.getTerm("close-inner-quote")},"@quotes/false":!1,"@cite/entry":function(t,e){return t.sys.wrapCitationEntry(e,this.item_id,this.locator_txt,this.suffix_txt)},"@bibliography/entry":function(t,e){var n="";return t.sys.embedBibliographyEntry&&(n=t.sys.embedBibliographyEntry(this.item_id)+"\n"),'  <div class="csl-entry">'+e+"</div>\n"+n},"@display/block":function(t,e){return'\n\n    <div class="csl-block">'+e+"</div>\n"},"@display/left-margin":function(t,e){return'\n    <div class="csl-left-margin">'+e+"</div>"},"@display/right-inline":function(t,e){return'<div class="csl-right-inline">'+e+"</div>\n  "},"@display/indent":function(t,e){return'<div class="csl-indent">'+e+"</div>\n  "},"@showid/true":function(t,e,n){if(t.tmp.just_looking||t.tmp.suppress_decorations)return e;if(n)return'<span class="'+t.opt.nodenames[n]+'" cslid="'+n+'">'+e+"</span>";if(this.params&&"string"==typeof e){var r="";if(e){var i=e.match(h.VARIABLE_WRAPPER_PREPUNCT_REX);r=i[1],e=i[2]}var o="";return e&&h.SWAPPING_PUNCTUATION.indexOf(e.slice(-1))>-1&&(o=e.slice(-1),e=e.slice(0,-1)),t.sys.variableWrapper(this.params,r,e,o)}return e},"@URL/true":function(t,e){return'<a href="'+e+'">'+e+"</a>"},"@DOI/true":function(t,e){var n=e;return e.match(/^https?:\/\//)||(n="https://doi.org/"+e),'<a href="'+n+'">'+e+"</a>"}},h.Output.Formats.prototype.text={text_escape:function(t){return t||(t=""),t},bibstart:"",bibend:"","@font-style/italic":!1,"@font-style/oblique":!1,"@font-style/normal":!1,"@font-variant/small-caps":!1,"@passthrough/true":h.Output.Formatters.passthrough,"@font-variant/normal":!1,"@font-weight/bold":!1,"@font-weight/normal":!1,"@font-weight/light":!1,"@text-decoration/none":!1,"@text-decoration/underline":!1,"@vertical-align/baseline":!1,"@vertical-align/sup":!1,"@vertical-align/sub":!1,"@strip-periods/true":h.Output.Formatters.passthrough,"@strip-periods/false":h.Output.Formatters.passthrough,"@quotes/true":function(t,e){return void 0===e?t.getTerm("open-quote"):t.getTerm("open-quote")+e+t.getTerm("close-quote")},"@quotes/inner":function(t,e){return void 0===e?"’":t.getTerm("open-inner-quote")+e+t.getTerm("close-inner-quote")},"@quotes/false":!1,"@cite/entry":function(t,e){return t.sys.wrapCitationEntry(e,this.item_id,this.locator_txt,this.suffix_txt)},"@bibliography/entry":function(t,e){return e+"\n"},"@display/block":function(t,e){return"\n"+e},"@display/left-margin":function(t,e){return e},"@display/right-inline":function(t,e){return e},"@display/indent":function(t,e){return"\n    "+e},"@showid/true":function(t,e,n){return e},"@URL/true":function(t,e){return e},"@DOI/true":function(t,e){return e}},h.Output.Formats.prototype.rtf={text_escape:function(t){return t||(t=""),t.replace(/([\\{}])/g,"\\$1").replace(h.SUPERSCRIPTS_REGEXP,function(t){return"\\super "+h.SUPERSCRIPTS[t]+"\\nosupersub{}"}).replace(/[\u007F-\uFFFF]/g,function(t){return"\\uc0\\u"+t.charCodeAt(0).toString()+"{}"}).split("\t").join("\\tab{}")},"@passthrough/true":h.Output.Formatters.passthrough,"@font-style/italic":"{\\i{}%%STRING%%}","@font-style/normal":"{\\i0{}%%STRING%%}","@font-style/oblique":"{\\i{}%%STRING%%}","@font-variant/small-caps":"{\\scaps %%STRING%%}","@font-variant/normal":"{\\scaps0{}%%STRING%%}","@font-weight/bold":"{\\b{}%%STRING%%}","@font-weight/normal":"{\\b0{}%%STRING%%}","@font-weight/light":!1,"@text-decoration/none":!1,"@text-decoration/underline":"{\\ul{}%%STRING%%}","@vertical-align/baseline":!1,"@vertical-align/sup":"\\super %%STRING%%\\nosupersub{}","@vertical-align/sub":"\\sub %%STRING%%\\nosupersub{}","@strip-periods/true":h.Output.Formatters.passthrough,"@strip-periods/false":h.Output.Formatters.passthrough,"@quotes/true":function(t,e){return void 0===e?h.Output.Formats.rtf.text_escape(t.getTerm("open-quote")):h.Output.Formats.rtf.text_escape(t.getTerm("open-quote"))+e+h.Output.Formats.rtf.text_escape(t.getTerm("close-quote"))},"@quotes/inner":function(t,e){return void 0===e?h.Output.Formats.rtf.text_escape("’"):h.Output.Formats.rtf.text_escape(t.getTerm("open-inner-quote"))+e+h.Output.Formats.rtf.text_escape(t.getTerm("close-inner-quote"))},"@quotes/false":!1,bibstart:"{\\rtf ",bibend:"}","@display/block":"\\line{}%%STRING%%\\line\r\n","@cite/entry":function(t,e){return t.sys.wrapCitationEntry(e,this.item_id,this.locator_txt,this.suffix_txt)},"@bibliography/entry":function(t,e){return e},"@display/left-margin":function(t,e){return e+"\\tab "},"@display/right-inline":function(t,e){return e+"\r\n"},"@display/indent":function(t,e){return"\n\\tab "+e+"\\line\r\n"},"@showid/true":function(t,e,n){if(t.tmp.just_looking||t.tmp.suppress_decorations)return e;var r="";if(e){var i=e.match(h.VARIABLE_WRAPPER_PREPUNCT_REX);r=i[1],e=i[2]}var o="";return e&&h.SWAPPING_PUNCTUATION.indexOf(e.slice(-1))>-1&&(o=e.slice(-1),e=e.slice(0,-1)),t.sys.variableWrapper(this.params,r,e,o)},"@URL/true":function(t,e){return e},"@DOI/true":function(t,e){return e}},h.Output.Formats=new h.Output.Formats,t.exports=h,h.Registry=function(t){this.debug=!1,this.state=t,this.registry={},this.reflist=[],this.refhash={},this.namereg=new h.Registry.NameReg(t),this.citationreg=new h.Registry.CitationReg(t),this.authorstrings={},this.mylist=[],this.myhash={},this.deletes=[],this.inserts=[],this.uncited={},this.refreshes={},this.akeys={},this.oldseq={},this.return_data={},this.ambigcites={},this.ambigresets={},this.sorter=new h.Registry.Comparifier(t,"bibliography_sort"),this.getSortedIds=function(){for(var t=[],e=0,n=this.reflist.length;e<n;e+=1)t.push(""+this.reflist[e].id);return t},this.getSortedRegistryItems=function(){for(var t=[],e=0,n=this.reflist.length;e<n;e+=1)t.push(this.reflist[e]);return t}},h.Registry.prototype.init=function(t,e){if(this.oldseq={},e){this.uncited={};for(var n=0,r=t.length;n<r;n+=1)this.myhash[t[n]]||this.mylist.push(""+t[n]),this.uncited[t[n]]=!0,this.myhash[t[n]]=!0}else{for(var i in this.uncited)t.push(i);var o={};for(n=t.length-1;n>-1;n+=-1)o[t[n]]?t=t.slice(0,n).concat(t.slice(n+1)):o[t[n]]=!0;this.mylist=[];for(n=0,r=t.length;n<r;n+=1)this.mylist.push(""+t[n]);this.myhash=o}this.refreshes={},this.touched={},this.ambigsTouched={},this.ambigresets={}},h.Registry.prototype.dopurge=function(t){for(var e=this.mylist.length-1;e>-1;e+=-1)this.citationreg.citationsByItemId&&(this.citationreg.citationsByItemId[this.mylist[e]]||t[this.mylist[e]]||(delete this.myhash[this.mylist[e]],this.mylist=this.mylist.slice(0,e).concat(this.mylist.slice(e+1))));this.dodeletes(this.myhash)},h.Registry.prototype.dodeletes=function(t){var e,n,r,i,o,a,s,u;"string"==typeof t&&((t={})[t]=!0);for(var l in this.registry)if(!t[l]){if(this.uncited[l])continue;e=this.namereg.delitems(l);for(a in e)this.refreshes[a]=!0;for(n=this.registry[l].ambig,(s=this.ambigcites[n].indexOf(l))>-1&&(o=this.ambigcites[n].slice(),this.ambigcites[n]=o.slice(0,s).concat(o.slice(s+1,o.length)),this.ambigresets[n]=this.ambigcites[n].length),i=this.ambigcites[n].length,r=0;r<i;r+=1)u=""+this.ambigcites[n][r],this.refreshes[u]=!0;if(this.registry[l].siblings)if(1==this.registry[l].siblings.length){var c=this.registry[l].siblings[0];this.registry[c].master=!0,this.registry[c].siblings.pop(),this.registry[c].parallel=!1}else if(this.registry[l].siblings.length>1){var h=[l];if(this.registry[l].master){var p=this.registry[l].siblings[0],f=this.registry[p];f.master=!0,f.parallel=!1,h.push(p);for(var d=0,m=this.registry[l].siblings.length;d<m;d+=1)this.registry[this.registry[l].siblings[d]].parallel=p}var g=[];for(d=this.registry[l].siblings.length-1;d>-1;d+=-1){var v=this.registry[l].siblings.pop();-1===h.indexOf(v)&&g.push(v)}for(d=g.length-1;d>-1;d+=-1)this.registry[l].siblings.push(g[d])}delete this.registry[l],delete this.refhash[l],this.return_data.bibchange=!0}},h.Registry.prototype.doinserts=function(t){var e,n,r,i,o;"string"==typeof t&&(t=[t]);for(var a=0,s=t.length;a<s;a+=1)e=t[a],this.registry[e]||(n=this.state.retrieveItem(e),r=h.getAmbiguousCite.call(this.state,n),this.ambigsTouched[r]=!0,n.legislation_id||(this.akeys[r]=!0),i={id:""+e,seq:0,offset:0,sortkeys:!1,ambig:!1,rendered:!1,disambig:!1,ref:n},this.registry[e]=i,this.citationreg.citationsByItemId&&this.citationreg.citationsByItemId[e]&&(this.registry[e]["first-reference-note-number"]=this.citationreg.citationsByItemId[e][0].properties.noteIndex),o=h.getAmbigConfig.call(this.state),this.registerAmbigToken(r,e,o),this.touched[e]=!0,this.return_data.bibchange=!0)},h.Registry.prototype.rebuildlist=function(){var t,e,n;for(this.reflist=[],this.state.opt.citation_number_sort_direction===h.DESCENDING&&this.state.opt.citation_number_sort_used,t=this.mylist.length,e=0;e<t;e+=1)n=this.mylist[e],this.reflist.push(this.registry[n]),this.oldseq[n]=this.registry[n].seq,this.registry[n].seq=e+1;this.state.opt.citation_number_sort_direction===h.DESCENDING&&this.state.opt.citation_number_sort_used},h.Registry.prototype.dorefreshes=function(){var t;for(var e in this.refreshes)if(t=this.registry[e]){t.sortkeys=void 0,i=this.state.retrieveItem(e),void 0===(o=t.ambig)&&(this.state.tmp.disambig_settings=!1,o=h.getAmbiguousCite.call(this.state,i),a=h.getAmbigConfig.call(this.state),this.registerAmbigToken(o,e,a));for(var n in this.ambigresets)if(1===this.ambigresets[n]){var r=this.ambigcites[o][0],i=this.state.retrieveItem(r);this.registry[r].disambig=new h.AmbigConfig,this.state.tmp.disambig_settings=!1;var o=h.getAmbiguousCite.call(this.state,i),a=h.getAmbigConfig.call(this.state);this.registerAmbigToken(o,r,a)}this.state.tmp.taintedItemIDs[e]=!0,this.ambigsTouched[o]=!0,i.legislation_id||(this.akeys[o]=!0),this.touched[e]=!0}},h.Registry.prototype.setdisambigs=function(){var t;this.leftovers=[];for(t in this.ambigsTouched)this.state.disambiguate.run(t);this.ambigsTouched={},this.akeys={}},h.Registry.prototype.renumber=function(){var t,e,n;for(this.state.opt.citation_number_sort_direction===h.DESCENDING&&this.state.opt.citation_number_sort_used,t=this.reflist.length,e=0;e<t;e+=1)(n=this.reflist[e]).seq=e+1,this.state.opt.update_mode===h.NUMERIC&&n.seq!=this.oldseq[n.id]&&(this.state.tmp.taintedItemIDs[n.id]=!0),this.state.opt.bib_mode===h.NUMERIC&&n.seq!=this.oldseq[n.id]&&(this.return_data.bibchange=!0);this.state.opt.citation_number_sort_direction===h.DESCENDING&&this.state.opt.citation_number_sort_used&&this.reflist.reverse()},h.Registry.prototype.setsortkeys=function(){for(var t=0,e=this.mylist.length;t<e;t+=1){var n=this.mylist[t];(this.touched[n]||this.state.tmp.taintedItemIDs[n]||!this.registry[n].sortkeys)&&(this.registry[n].sortkeys=h.getSortKeys.call(this.state,this.state.retrieveItem(n),"bibliography_sort"))}},h.Registry.prototype.sorttokens=function(){this.reflist.sort(this.sorter.compareKeys)},h.Registry.Comparifier=function(t,e){var n,r,i,o,a=h.getSortCompare(t.opt["default-locale-sort"]);n=t[e].opt.sort_directions,this.compareKeys=function(t,e){for(r=t.sortkeys?t.sortkeys.length:0,i=0;i<r;i+=1){var o=0;if(0<(o=t.sortkeys[i]===e.sortkeys[i]?0:void 0===t.sortkeys[i]?n[i][1]:void 0===e.sortkeys[i]?n[i][0]:a(t.sortkeys[i],e.sortkeys[i])))return n[i][1];if(0>o)return n[i][0]}return t.seq>e.seq?1:t.seq<e.seq?-1:0},o=this.compareKeys,this.compareCompositeKeys=function(t,e){return o(t[1],e[1])}},h.Registry.prototype.compareRegistryTokens=function(t,e){return t.seq>e.seq?1:t.seq<e.seq?-1:0},h.Registry.prototype.registerAmbigToken=function(t,e,n){if(this.registry[e]&&this.registry[e].disambig&&this.registry[e].disambig.names)for(var r=0,i=n.names.length;r<i;r+=1){if(n.names[r]!==this.registry[e].disambig.names[r])this.state.tmp.taintedItemIDs[e]=!0;else if(n.givens[r])for(var o=0,a=n.givens[r].length;o<a;o+=1){n.givens[r][o]!==this.registry[e].disambig.givens[r][o]&&(this.state.tmp.taintedItemIDs[e]=!0)}}this.ambigcites[t]||(this.ambigcites[t]=[]),-1===this.ambigcites[t].indexOf(""+e)&&this.ambigcites[t].push(""+e),this.registry[e].ambig=t;this.registry[e].disambig=h.cloneAmbigConfig(n)},h.getSortKeys=function(t,e){var n,r,i,o,a,s;for(n=this.tmp.area,r=this.tmp.root,i=this.tmp.extension,o=h.Util.Sort.strip_prepositions,this.tmp.area=e,this.tmp.root=e.indexOf("_")>-1?e.slice(0,-5):e,this.tmp.extension="_sort",this.tmp.disambig_override=!0,this.tmp.disambig_request=!1,this.parallel.use_parallels=(!0===this.parallel.use_parallels||null===this.parallel.use_parallels)&&null,this.tmp.suppress_decorations=!0,h.getCite.call(this,t),this.tmp.suppress_decorations=!1,this.parallel.use_parallels=null===this.parallel.use_parallels,this.tmp.disambig_override=!1,a=this[e].keys.length,s=0;s<a;s+=1)this[e].keys[s]=o(this[e].keys[s]);return this.tmp.area=n,this.tmp.root=r,this.tmp.extension=i,this[e].keys},t.exports=h,h.Registry.NameReg=function(t){var e,n,r,i,o,a,s,u,l,c,p,f;this.state=t,this.namereg={},this.nameind={},this.nameindpkeys={},this.itemkeyreg={},s=function(t){return t||(t=""),t.replace(/\./g," ").replace(/\s+/g," ").replace(/\s+$/,"")},u=function(t,i,o){e=s(o.family);var a=(r=s(o.given)).match(/[,\!]* ([^,]+)$/);a&&a[1]===a[1].toLowerCase()&&(r=r.replace(/[,\!]* [^,]+$/,"")),n=h.Util.Names.initializeWith(t,r,"%s"),"by-cite"===t.citation.opt["givenname-disambiguation-rule"]&&(e=""+i+e)},l=function(r,a,s,l,c,h){var p;if("bibliography"===t.tmp.area.slice(0,12)&&!c)return"string"==typeof h?1:2;a=t.nameOutput.getName(a,"locale-translit",!0).name,u(this.state,""+r,a),p=2,i=t.opt["disambiguate-add-givenname"];var f=o=t.citation.opt["givenname-disambiguation-rule"];return"by-cite"===o&&(o="all-names"),"short"===c?p=0:"string"==typeof h&&(p=1),void 0===this.namereg[e]||void 0===this.namereg[e].ikey[n]?p:"by-cite"===f&&p<=l?l:i?"string"==typeof o&&"primary-name"===o.slice(0,12)&&s>0?p:(o&&"all-names"!==o&&"primary-name"!==o?"all-names-with-initials"!==o&&"primary-name-with-initials"!==o||(p=this.namereg[e].count>1?1:0):(this.namereg[e].count>1&&(p=1),(this.namereg[e].ikey&&this.namereg[e].ikey[n].count>1||this.namereg[e].count>1&&"string"!=typeof h)&&(p=2)),t.registry.registry[r]?p:"short"==c?0:"string"==typeof h?1:void 0):p},c=function(i){var o,s,u,l,c;"string"!=typeof i&&"number"!=typeof i||(i=[""+i]);for(s=i.length,o=0;o<s;o+=1)if(l=""+i[o],this.nameind[l]){for(c in this.nameind[l])if(this.nameind[l].hasOwnProperty(c)){var h=c.split("::");if(e=h[0],n=h[1],r=h[2],void 0===this.namereg[e])continue;if(a=this.namereg[e].items,r&&this.namereg[e].ikey[n]&&this.namereg[e].ikey[n].skey[r]&&((u=(f=this.namereg[e].ikey[n].skey[r].items).indexOf(""+l))>-1&&(this.namereg[e].ikey[n].skey[r].items=f.slice(0,u).concat(f.slice([u+1]))),0===this.namereg[e].ikey[n].skey[r].items.length&&(delete this.namereg[e].ikey[n].skey[r],this.namereg[e].ikey[n].count+=-1,this.namereg[e].ikey[n].count<2)))for(var p=0,d=this.namereg[e].ikey[n].items.length;p<d;p+=1)t.tmp.taintedItemIDs[this.namereg[e].ikey[n].items[p]]=!0;if(n&&this.namereg[e].ikey[n]&&((u=this.namereg[e].ikey[n].items.indexOf(""+l))>-1&&(a=this.namereg[e].ikey[n].items.slice(),this.namereg[e].ikey[n].items=a.slice(0,u).concat(a.slice([u+1]))),0===this.namereg[e].ikey[n].items.length&&(delete this.namereg[e].ikey[n],this.namereg[e].count+=-1,this.namereg[e].count<2)))for(p=0,d=this.namereg[e].items.length;p<d;p+=1)t.tmp.taintedItemIDs[this.namereg[e].items[p]]=!0;e&&((u=this.namereg[e].items.indexOf(""+l))>-1&&(a=this.namereg[e].items.slice(),this.namereg[e].items=a.slice(0,u).concat(a.slice([u+1],a.length))),this.namereg[e].items.length<2&&delete this.namereg[e]),delete this.nameind[l][c]}delete this.nameind[l],delete this.nameindpkeys[l]}return{}},p=function(i,o,a){if(o=t.nameOutput.getName(o,"locale-translit",!0).name,!t.citation.opt["givenname-disambiguation-rule"]||"primary-"!==t.citation.opt["givenname-disambiguation-rule"].slice(0,8)||0===a){if(u(this.state,""+i,o),e&&(void 0===this.namereg[e]?(this.namereg[e]={},this.namereg[e].count=0,this.namereg[e].ikey={},this.namereg[e].items=[i]):-1===this.namereg[e].items.indexOf(i)&&this.namereg[e].items.push(i)),e&&n)if(void 0===this.namereg[e].ikey[n]){if(this.namereg[e].ikey[n]={},this.namereg[e].ikey[n].count=0,this.namereg[e].ikey[n].skey={},this.namereg[e].ikey[n].items=[i],this.namereg[e].count+=1,2===this.namereg[e].count)for(var s=0,l=this.namereg[e].items.length;s<l;s+=1)t.tmp.taintedItemIDs[this.namereg[e].items[s]]=!0}else-1===this.namereg[e].ikey[n].items.indexOf(i)&&this.namereg[e].ikey[n].items.push(i);if(e&&n&&r)if(void 0===this.namereg[e].ikey[n].skey[r]){if(this.namereg[e].ikey[n].skey[r]={},this.namereg[e].ikey[n].skey[r].items=[i],this.namereg[e].ikey[n].count+=1,2===this.namereg[e].ikey[n].count)for(s=0,l=this.namereg[e].ikey[n].items.length;s<l;s+=1)t.tmp.taintedItemIDs[this.namereg[e].ikey[n].items[s]]=!0}else-1===this.namereg[e].ikey[n].skey[r].items.indexOf(i)&&this.namereg[e].ikey[n].skey[r].items.push(i);void 0===this.nameind[i]&&(this.nameind[i]={},this.nameindpkeys[i]={}),e&&(this.nameind[i][e+"::"+n+"::"+r]=!0,this.nameindpkeys[i][e]=this.namereg[e])}},this.addname=p,this.delitems=c,this.evalname=l},t.exports=h,h.Registry.CitationReg=function(t){this.citationById={},this.citationByIndex=[]},t.exports=h,h.Disambiguation=function(t){this.state=t,this.sys=this.state.sys,this.registry=t.registry.registry,this.ambigcites=t.registry.ambigcites,this.configModes(),this.debug=!1},h.Disambiguation.prototype.run=function(t){this.modes.length&&(this.akey=t,this.initVars(t)&&this.runDisambig())},h.Disambiguation.prototype.runDisambig=function(){var t;for(this.initGivens=!0;this.lists.length;){for(this.gnameset=0,this.gname=0,this.clashes=[1,0];this.lists[0][1].length;){this.listpos=0,this.base||(this.base=this.lists[0][0]);t=this.incrementDisambig(),this.scanItems(this.lists[0]),this.evalScan(t)}this.lists=this.lists.slice(1)}},h.Disambiguation.prototype.scanItems=function(t){var e;this.Item=t[1][0],this.ItemCite=h.getAmbiguousCite.call(this.state,this.Item,this.base,!0),this.scanlist=t[1],this.partners=[],this.partners.push(this.Item),this.nonpartners=[];for(var n=0,r=1,i=t[1].length;r<i;r+=1){e=t[1][r];var o=h.getAmbiguousCite.call(this.state,e,this.base,!0);this.ItemCite===o?(n+=1,this.partners.push(e)):this.nonpartners.push(e)}this.clashes[0]=this.clashes[1],this.clashes[1]=n},h.Disambiguation.prototype.evalScan=function(t){this[this.modes[this.modeindex]](t),t&&(this.modeindex<this.modes.length-1?this.modeindex+=1:this.lists[this.listpos+1]=[this.base,[]])},h.Disambiguation.prototype.disNames=function(t){if(0===this.clashes[1]&&1===this.nonpartners.length)this.captureStepToBase(),this.state.registry.registerAmbigToken(this.akey,""+this.nonpartners[0].id,this.betterbase),this.state.registry.registerAmbigToken(this.akey,""+this.partners[0].id,this.betterbase),this.lists[this.listpos]=[this.betterbase,[]];else if(0===this.clashes[1])this.captureStepToBase(),this.state.registry.registerAmbigToken(this.akey,""+this.partners[0].id,this.betterbase),this.lists[this.listpos]=[this.betterbase,this.nonpartners],this.nonpartners.length&&(this.initGivens=!0);else if(1===this.nonpartners.length)this.captureStepToBase(),this.state.registry.registerAmbigToken(this.akey,""+this.nonpartners[0].id,this.betterbase),this.lists[this.listpos]=[this.betterbase,this.partners];else if(this.clashes[1]<this.clashes[0])this.captureStepToBase(),this.lists[this.listpos]=[this.betterbase,this.partners],this.lists.push([this.betterbase,this.nonpartners]);else if(t&&(this.lists[this.listpos]=[this.betterbase,this.nonpartners],this.lists.push([this.betterbase,this.partners]),this.modeindex===this.modes.length-1)){for(var e=0,n=this.partners.length;e<n;e+=1)this.state.registry.registerAmbigToken(this.akey,""+this.partners[e].id,this.betterbase);this.lists[this.listpos]=[this.betterbase,[]]}},h.Disambiguation.prototype.disExtraText=function(){var t=!1;if(0===this.clashes[1]&&this.nonpartners.length<2&&(t=!0),t||this.base.disambiguate&&this.state.tmp.disambiguate_count===this.state.tmp.disambiguate_maxMax){if(t||this.state.tmp.disambiguate_count===this.state.tmp.disambiguate_maxMax)if(t||this.modeindex===this.modes.length-1){var e=this.lists[this.listpos][0];for(n=0,r=this.lists[this.listpos][1].length;n<r;n+=1)this.state.tmp.taintedItemIDs[this.lists[this.listpos][1][n].id]=!0,this.state.registry.registerAmbigToken(this.akey,""+this.lists[this.listpos][1][n].id,e);this.lists[this.listpos]=[this.betterbase,[]]}else{this.modeindex=this.modes.length-1,(e=this.lists[this.listpos][0]).disambiguate=!0;for(n=0,r=this.lists[this.listpos][1].length;n<r;n+=1)this.state.tmp.taintedItemIDs[this.lists[this.listpos][1][n].id]=!0,this.state.registry.registerAmbigToken(this.akey,""+this.lists[this.listpos][1][n].id,e)}}else if(this.modeindex=0,this.base.disambiguate=this.state.tmp.disambiguate_count,this.betterbase.disambiguate=this.state.tmp.disambiguate_count,this.base.disambiguate)this.disNames();else{this.initGivens=!0,this.base.disambiguate=1;for(var n=0,r=this.lists[this.listpos][1].length;n<r;n+=1)this.state.tmp.taintedItemIDs[this.lists[this.listpos][1][n].id]=!0}},h.Disambiguation.prototype.disYears=function(){var t;t=[];var e=this.lists[this.listpos][0];if(this.clashes[1])for(var n=0,r=this.state.registry.mylist.length;n<r;n+=1)for(var i=this.state.registry.mylist[n],o=0,a=this.lists[this.listpos][1].length;o<a;o+=1){var s;if((s=this.lists[this.listpos][1][o]).id==i){t.push(this.registry[s.id]);break}}t.sort(this.state.registry.sorter.compareKeys);for(var u=0,l=t.length;u<l;u+=1){e.year_suffix=""+u;var c=this.state.registry.registry[t[u].id].disambig;this.state.registry.registerAmbigToken(this.akey,""+t[u].id,e),h.ambigConfigDiff(c,e)&&(this.state.tmp.taintedItemIDs[t[u].id]=!0)}this.lists[this.listpos]=[this.betterbase,[]]},h.Disambiguation.prototype.incrementDisambig=function(){if(this.initGivens)return this.initGivens=!1,!1;var t=!1,e=!0;if("disNames"===this.modes[this.modeindex]){e=!1,"number"!=typeof this.givensMax&&(e=!0);var n=!1;if("number"!=typeof this.namesMax&&(n=!0),"number"==typeof this.givensMax&&(this.base.givens.length&&this.base.givens[this.gnameset][this.gname]<this.givensMax?this.base.givens[this.gnameset][this.gname]+=1:e=!0),"number"==typeof this.namesMax&&e&&(this.state.opt["disambiguate-add-names"]?(n=!1,this.gname<this.namesMax?(this.base.names[this.gnameset]+=1,this.gname+=1):n=!0):n=!0),"number"==typeof this.namesetsMax&&n)if(this.gnameset<this.namesetsMax)this.gnameset+=1,this.base.names[this.gnameset]=1,this.gname=0;else;"number"==typeof this.namesetsMax&&-1!==this.namesetsMax&&this.gnameset!==this.namesetsMax||this.state.opt["disambiguate-add-names"]&&"number"==typeof this.namesMax&&this.gname!==this.namesMax||"number"==typeof this.givensMax&&void 0!==this.base.givens[this.gnameset]&&void 0!==this.base.givens[this.gnameset][this.gname]&&this.base.givens[this.gnameset][this.gname]!==this.givensMax||(t=!0)}else"disExtraText"===this.modes[this.modeindex]&&(this.base.disambiguate+=1,this.betterbase.disambiguate+=1);return t},h.Disambiguation.prototype.initVars=function(t){var e,n,r;if(this.lists=[],this.base=!1,this.betterbase=!1,this.akey=t,this.maxNamesByItemId={},n=[],!(e=this.ambigcites[t])||!e.length)return!1;var i=this.state.retrieveItem(""+e[0]);if(this.getCiteData(i),this.base=h.getAmbigConfig.call(this.state),e&&e.length>1){n.push([this.maxNamesByItemId[i.id],i]);for(var o=1,a=e.length;o<a;o+=1)i=this.state.retrieveItem(""+e[o]),this.getCiteData(i,this.base),n.push([this.maxNamesByItemId[i.id],i]);n.sort(function(t,e){return t[0]>e[0]?1:t[0]<e[0]?-1:t[1].id>e[1].id?1:t[1].id<e[1].id?-1:0}),r=[];for(var o=0,a=n.length;o<a;o+=1)r.push(n[o][1]);this.lists.push([this.base,r]),this.Item=this.lists[0][1][0]}else this.Item=this.state.retrieveItem(""+e[0]);return this.modeindex=0,this.state.citation.opt["disambiguate-add-names"],this.namesMax=this.maxNamesByItemId[this.Item.id][0],this.padBase(this.base),this.padBase(this.betterbase),this.base.year_suffix=!1,this.base.disambiguate=!1,this.betterbase.year_suffix=!1,this.betterbase.disambiguate=!1,"by-cite"===this.state.citation.opt["givenname-disambiguation-rule"]&&this.state.opt["disambiguate-add-givenname"]&&(this.givensMax=2),!0},h.Disambiguation.prototype.padBase=function(t){for(var e=0,n=t.names.length;e<n;e+=1){t.givens[e]||(t.givens[e]=[]);for(var r=0,i=t.names[e];r<i;r+=1)t.givens[e][r]||(t.givens[e][r]=0)}},h.Disambiguation.prototype.configModes=function(){var t,e;this.modes=[],t=this.state.opt["disambiguate-add-givenname"],e=this.state.citation.opt["givenname-disambiguation-rule"],(this.state.opt["disambiguate-add-names"]||t&&"by-cite"===e)&&this.modes.push("disNames"),this.state.opt.has_disambiguate&&this.modes.push("disExtraText"),this.state.opt["disambiguate-add-year-suffix"]&&this.modes.push("disYears")},h.Disambiguation.prototype.getCiteData=function(t,e){if(!this.maxNamesByItemId[t.id]){h.getAmbiguousCite.call(this.state,t,e),e=h.getAmbigConfig.call(this.state),this.maxNamesByItemId[t.id]=h.getMaxVals.call(this.state),this.state.registry.registry[t.id].disambig.givens=this.state.tmp.disambig_settings.givens.slice();for(var n=0,r=this.state.registry.registry[t.id].disambig.givens.length;n<r;n+=1)this.state.registry.registry[t.id].disambig.givens[n]=this.state.tmp.disambig_settings.givens[n].slice();this.namesetsMax=this.state.registry.registry[t.id].disambig.names.length-1,this.base||(this.base=e,this.betterbase=h.cloneAmbigConfig(e)),e.names.length<this.base.names.length&&(this.base=e);for(n=0,r=e.names.length;n<r;n+=1)e.names[n]>this.base.names[n]&&(this.base.givens[n]=e.givens[n].slice(),this.base.names[n]=e.names[n],this.betterbase.names=this.base.names.slice(),this.betterbase.givens=this.base.givens.slice(),this.padBase(this.base),this.padBase(this.betterbase));this.betterbase.givens=this.base.givens.slice();for(var i=0,o=this.base.givens.length;i<o;i+=1)this.betterbase.givens[i]=this.base.givens[i].slice()}},h.Disambiguation.prototype.captureStepToBase=function(){"by-cite"===this.state.citation.opt["givenname-disambiguation-rule"]&&this.base.givens&&this.base.givens.length&&void 0!==this.base.givens[this.gnameset][this.gname]&&(this.betterbase.givens[this.gnameset][this.gname]=this.base.givens[this.gnameset][this.gname]),this.betterbase.names[this.gnameset]=this.base.names[this.gnameset]},t.exports=h,h.Engine.prototype.getJurisdictionList=function(t){for(var e=[],n=t.split(":"),r=n.length;r>0;r--)e.push(n.slice(0,r).join(":"));return-1===e.indexOf("us")&&e.push("us"),e},h.Engine.prototype.retrieveAllStyleModules=function(t){for(var e={},n=this.locale[this.opt.lang].opts["jurisdiction-preference"],r=(n=[""].concat(n=n||[])).length-1;r>-1;r--)for(var i=n[r],o=0,a=t.length;o<a;o++){var s=t[o];if(!this.opt.jurisdictions_seen[s]){var u=this.sys.retrieveStyleModule(s,i);(!u&&!i||u)&&(this.opt.jurisdictions_seen[s]=!0),u&&(e[s]=u)}}return e},t.exports=h,h.ParticleList=[["'s",r=[[null,[0,1]]]],["'s-",r],["'t",r],["a",r],["aan 't",i=[[null,[0,2]]]],["aan de",i],["aan den",i],["aan der",i],["aan het",i],["aan t",i],["aan",r],["ad-",a=[[null,[0,1]],[[0,1],null]]],["adh-",a],["af",a],["al",a],["al-",a],["am de",i],["am",r],["an-",a],["ar-",a],["as-",a],["ash-",a],["at-",a],["ath-",a],["auf dem",l=[[[0,2],null],[null,[0,2]]]],["auf den",l],["auf der",l],["auf ter",i],["auf",u=[[[0,1],null],[null,[0,1]]]],["aus 'm",l],["aus dem",l],["aus den",l],["aus der",l],["aus m",l],["aus",u],["aus'm",l],["az-",a],["aš-",a],["aḍ-",a],["aḏ-",a],["aṣ-",a],["aṭ-",a],["aṯ-",a],["aẓ-",a],["ben",r],["bij 't",i],["bij de",i],["bij den",i],["bij het",i],["bij t",i],["bij",r],["bin",r],["boven d",i],["boven d'",i],["d",r],["d'",a],["da",a],["dal",r],["dal'",r],["dall'",r],["dalla",r],["das",a],["de die le",o=[[null,[0,3]]]],["de die",i],["de l",i],["de l'",i],["de la",c=[[null,[0,2]],[[0,1],[1,2]]]],["de las",c],["de le",i],["de li",s=[[null,[0,2]],[[0,2],null]]],["de van der",o],["de",a],["de'",a],["deca",r],["degli",a],["dei",a],["del",a],["dela",n=[[[0,1],null]]],["dell'",a],["della",a],["delle",a],["dello",a],["den",a],["der",a],["des",a],["di",a],["die le",i],["do",r],["don",r],["dos",a],["du",a],["ed-",a],["edh-",a],["el",a],["el-",a],["en-",a],["er-",a],["es-",a],["esh-",a],["et-",a],["eth-",a],["ez-",a],["eš-",a],["eḍ-",a],["eḏ-",a],["eṣ-",a],["eṭ-",a],["eṯ-",a],["eẓ-",a],["het",r],["i",r],["il",n],["im",r],["in 't",i],["in de",i],["in den",i],["in der",s],["in het",i],["in t",i],["in",r],["l",r],["l'",r],["la",r],["las",r],["le",r],["les",a],["lo",a],["los",r],["lou",r],["of",r],["onder 't",i],["onder de",i],["onder den",i],["onder het",i],["onder t",i],["onder",r],["op 't",i],["op de",s],["op den",i],["op der",i],["op gen",i],["op het",i],["op t",i],["op ten",i],["op",r],["over 't",i],["over de",i],["over den",i],["over het",i],["over t",i],["over",r],["s",r],["s'",r],["sen",n],["t",r],["te",r],["ten",r],["ter",r],["tho",r],["thoe",r],["thor",r],["to",r],["toe",r],["tot",r],["uijt 't",i],["uijt de",i],["uijt den",i],["uijt te de",o],["uijt ten",i],["uijt",r],["uit 't",i],["uit de",i],["uit den",i],["uit het",i],["uit t",i],["uit te de",o],["uit ten",i],["uit",r],["unter",r],["v",r],["v.",r],["v.d.",r],["van 't",i],["van de l",o],["van de l'",o],["van de",i],["van de",i],["van den",i],["van der",i],["van gen",i],["van het",i],["van la",i],["van t",i],["van ter",i],["van van de",o],["van",a],["vander",r],["vd",r],["ver",r],["vom und zum",[[[0,3],null]]],["vom",a],["von 't",i],["von dem",l],["von den",l],["von der",l],["von t",i],["von und zu",[[[0,3],null],[null,[0,3]]]],["von zu",l],["von",u],["voor 't",i],["voor de",i],["voor den",i],["voor in 't",o],["voor in t",o],["voor",r],["vor der",l],["vor",u],["z",n],["ze",n],["zu",u],["zum",a],["zur",a]],h.parseParticles=function(){function t(t,e,n){var r=t;t=n?t.toLowerCase():t;var i,o=[];e?(t=t.split("").reverse().join(""),i=h.PARTICLE_GIVEN_REGEXP):i=h.PARTICLE_FAMILY_REGEXP;for(var a=t.match(i);a;){var s,u=e?a[1].split("").reverse().join(""):a[1],l=!!(s=!!(s=!!a&&u)&&u.replace(/^[-\'\u02bb\u2019\s]*(.).*$/,"$1"))&&s.toUpperCase()!==s;if(!l)break;e?(o.push(r.slice(-1*u.length)),r=r.slice(0,-1*u.length)):(o.push(r.slice(0,u.length)),r=r.slice(u.length)),a=(t=a[2]).match(i)}if(e){t=t.split("").reverse().join(""),o.reverse();for(var c=1,p=o.length;c<p;c++)" "==o[c].slice(0,1)&&(o[c-1]+=" ");for(c=0,p=o.length;c<p;c++)" "==o[c].slice(0,1)&&(o[c]=o[c].slice(1));t=r.slice(0,t.length)}else t=r.slice(-1*t.length);return[l,t,o]}return function(e){(s=t(e.family))[0];var n=s[1],r=s[2];e.family=n;var i,o,a=(i=r.join(""),o=i.slice(-1),i=i.trim()," "===o&&["'","’"].indexOf(i.slice(-1))>-1&&(i+=" "),i);a&&(e["non-dropping-particle"]=a),function(t){if(!t.suffix&&t.given){var e=t.given.match(/(\s*,!*\s*)/);if(e){var n=t.given.indexOf(e[1]),r=t.given.slice(n+e[1].length),i=t.given.slice(n,n+e[1].length).replace(/\s*/g,"");"et al"!==r.replace(/\./g,"")||t["dropping-particle"]?(2===i.length&&(t["comma-suffix"]=!0),t.suffix=r):(t["dropping-particle"]=r,t["comma-dropping-particle"]=","),t.given=t.given.slice(0,n)}}}(e);(s=t(e.given,!0))[0];var s,u=s[1],l=s[2];e.given=u;var c=l.join("").trim();c&&(e["dropping-particle"]=c)}}(),t.exports=h}).call(e,n(166)(t))},function(t,e,n){var r=n(32);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){var r=n(32),i=n(7)("toStringTag"),o="Arguments"==r(function(){return arguments}());t.exports=function(t){var e,n,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),i))?n:o?r(e):"Object"==(a=r(e))&&"function"==typeof e.callee?"Arguments":a}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=n(216),a=(r=o)&&r.__esModule?r:{default:r};e.default=function t(e){switch(void 0===e?"undefined":i(e)){case"string":return 0===e.length?"string/empty":/^\s+$/.test(e)?"string/whitespace":a.default.doi[0].test(e)?"api/doi":a.default.doi[1].test(e)?"string/doi":a.default.doi[2].test(e)?"list/doi":a.default.wikidata[0].test(e)?"string/wikidata":a.default.wikidata[1].test(e)?"list/wikidata":a.default.wikidata[2].test(e)?"api/wikidata":a.default.wikidata[3].test(e)?"url/wikidata":a.default.bibtex.test(e)?"string/bibtex":a.default.bibtxt.test(e)?"string/bibtxt":/^\s*(\{|\[)/.test(e)?"string/json":a.default.url.test(e)?"url/else":(console.warn("[set]","This format is not supported or recognized"),"invalid");case"object":return null===e?"empty":"undefined"!=typeof jQuery&&e instanceof jQuery?"jquery/else":"undefined"!=typeof HTMLElement&&e instanceof HTMLElement?"html/else":Array.isArray(e)?0===e.length?"array/csl":e.every(function(e){return"string/wikidata"===t(e)})?"array/wikidata":e.every(function(e){return"string/doi"===t(e)})?"array/doi":e.every(function(e){return"object/csl"===t(e)})?"array/csl":"array/else":e.hasOwnProperty("entities")?"object/wikidata":["fulltext_html","fulltext_xml","fulltext_pdf"].some(function(t){return e[t]&&Array.isArray(e[t].value)})?"object/contentmine":["type","label","properties"].every(function(t){return e.hasOwnProperty(t)})?"object/bibtex":"object/csl";case"undefined":return"empty";default:return console.warn("[set]","This format is not supported or recognized"),"invalid"}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t){return JSON.parse(JSON.stringify(t))}},function(t,e,n){const r=t.exports={};r.searchEntities=n(921),r.getEntities=n(354),r.getManyEntities=n(923),r.getWikidataIdsFromSitelinks=n(924),r.sparqlQuery=n(355),r.getReverseClaims=n(925),r.getRevisions=n(927),r.parse=n(928);const i=n(357),o=n(361);r.simplify=n(358),r.simplify.entity=n(356),r.simplify.claim=i.simplifyClaim,r.simplify.propertyClaims=i.simplifyPropertyClaims,r.simplify.claims=i.simplifyClaims,r.simplify.sitelinks=n(359),r.simplify.sparqlResults=o,r.simplifySparqlResults=n(361),Object.assign(r,i),r.getWikidataIdsFromWikipediaTitles=r.getWikidataIdsFromSitelinks;const a=n(140),s=n(360);Object.assign(r,a,s)},,,,,,,,,,,,,,function(t,e,n){"use strict";t.exports=function(t){for(var e=arguments.length-1,n="Minified React error #"+t+"; visit http://facebook.github.io/react/docs/error-decoder.html?invariant="+t,r=0;r<e;r++)n+="&args[]="+encodeURIComponent(arguments[r+1]);n+=" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.";var i=new Error(n);throw i.name="Invariant Violation",i.framesToPop=1,i}},function(t,e,n){"use strict";var r=n(58);t.exports=r},function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t&&!0===t["@@functional/placeholder"]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n,r,i,o=arguments.length<=2||void 0===arguments[2]?function(t,e){return t+e}:arguments[2];return n={},r=t,i=["-webkit-","-moz-",""].map(function(t){return o(t,e)}),r in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,n},t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.utils=e.controls=e.withMediaProps=e.Player=e.Media=void 0;var r=l(n(623)),i=l(n(627)),o=l(n(45)),a=u(n(636)),s=u(n(645));function u(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function l(t){return t&&t.__esModule?t:{default:t}}e.Media=r.default,e.Player=i.default,e.withMediaProps=o.default,e.controls=a,e.utils=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(2),o=(r=i)&&r.__esModule?r:{default:r};e.default={src:o.default.string,onPlaying:o.default.func,onProgress:o.default.func,onDuration:o.default.func,onTimeUpdate:o.default.func,onVolumeChange:o.default.func},t.exports=e.default},function(t,e,n){var r;!function(){"use strict";var n={}.hasOwnProperty;function i(){for(var t=[],e=0;e<arguments.length;e++){var r=arguments[e];if(r){var o=typeof r;if("string"===o||"number"===o)t.push(r);else if(Array.isArray(r))t.push(i.apply(null,r));else if("object"===o)for(var a in r)n.call(r,a)&&r[a]&&t.push(a)}}return t.join(" ")}void 0!==t&&t.exports?t.exports=i:void 0===(r=function(){return i}.apply(e,[]))||(t.exports=r)}()},function(t,e,n){var r=n(4),i="__core-js_shared__",o=r[i]||(r[i]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,e,n){var r=n(27),i=n(13),o=n(66);t.exports=function(t){return function(e,n,a){var s,u=r(e),l=i(u.length),c=o(a,l);if(t&&n!=n){for(;l>c;)if((s=u[c++])!=s)return!0}else for(;l>c;c++)if((t||c in u)&&u[c]===n)return t||c||0;return!t&&-1}}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var r=n(32);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,e,n){var r=n(6),i=n(32),o=n(7)("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==i(t))}},function(t,e,n){var r=n(7)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!i)return!1;var n=!1;try{var o=[7],a=o[r]();a.next=function(){return{done:n=!0}},o[r]=function(){return a},t(o)}catch(t){}return n}},function(t,e,n){"use strict";var r=n(3);t.exports=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){"use strict";var r=n(23),i=n(24),o=n(5),a=n(40),s=n(7);t.exports=function(t,e,n){var u=s(t),l=n(a,u,""[t]),c=l[0],h=l[1];o(function(){var e={};return e[u]=function(){return 7},7!=""[t](e)})&&(i(String.prototype,t,c),r(RegExp.prototype,u,2==e?function(t,e){return h.call(t,this,e)}:function(t){return h.call(t,this)}))}},function(t,e,n){var r=n(3),i=n(17),o=n(7)("species");t.exports=function(t,e){var n,a=r(t).constructor;return void 0===a||void 0==(n=r(a)[o])?e:i(n)}},function(t,e,n){"use strict";var r=n(4),i=n(0),o=n(24),a=n(72),s=n(51),u=n(71),l=n(70),c=n(6),h=n(5),p=n(127),f=n(82),d=n(194);t.exports=function(t,e,n,m,g,v){var y=r[t],b=y,_=g?"set":"add",x=b&&b.prototype,w={},E=function(t){var e=x[t];o(x,t,"delete"==t?function(t){return!(v&&!c(t))&&e.call(this,0===t?0:t)}:"has"==t?function(t){return!(v&&!c(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return v&&!c(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,n){return e.call(this,0===t?0:t,n),this})};if("function"==typeof b&&(v||x.forEach&&!h(function(){(new b).entries().next()}))){var S=new b,T=S[_](v?{}:-0,1)!=S,O=h(function(){S.has(1)}),A=p(function(t){new b(t)}),M=!v&&h(function(){for(var t=new b,e=5;e--;)t[_](e,e);return!t.has(-0)});A||((b=e(function(e,n){l(e,b,t);var r=d(new y,e,b);return void 0!=n&&u(n,g,r[_],r),r})).prototype=x,x.constructor=b),(O||M)&&(E("delete"),E("has"),g&&E("get")),(M||T)&&E(_),v&&x.clear&&delete x.clear}else b=m.getConstructor(e,t,g,_),a(b.prototype,n),s.NEED=!0;return f(b,t),w[t]=b,i(i.G+i.W+i.F*(b!=y),w),v||m.setStrong(b,t,g),b}},function(t,e,n){for(var r,i=n(4),o=n(23),a=n(63),s=a("typed_array"),u=a("view"),l=!(!i.ArrayBuffer||!i.DataView),c=l,h=0,p="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");h<9;)(r=i[p[h++]])?(o(r.prototype,s,!0),o(r.prototype,u,!0)):c=!1;t.exports={ABV:l,CONSTR:c,TYPED:s,VIEW:u}},function(t,e,n){"use strict";t.exports=n(64)||!n(5)(function(){var t=Math.random();__defineSetter__.call(null,t,function(){}),delete n(4)[t]})},function(t,e,n){"use strict";var r=n(0);t.exports=function(t){r(r.S,t,{of:function(){for(var t=arguments.length,e=Array(t);t--;)e[t]=arguments[t];return new this(e)}})}},function(t,e,n){"use strict";var r=n(0),i=n(17),o=n(31),a=n(71);t.exports=function(t){r(r.S,t,{from:function(t){var e,n,r,s,u=arguments[1];return i(this),(e=void 0!==u)&&i(u),void 0==t?new this:(n=[],e?(r=0,s=o(u,arguments[2],2),a(t,!1,function(t){n.push(s(t,r++))})):a(t,!1,n.push,n),new this(n))}})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(n(338)),i=s(n(213)),o=s(n(214)),a=s(n(339));function s(t){return t&&t.__esModule?t:{default:t}}e.default=function(t){var e={label:(0,i.default)(t),type:(0,r.default)(t.type)},n={};return t.author&&(n.author=t.author.map(function(t){return(0,o.default)(t,!0)}).join(" and ")),t.event&&(n.organization=t.event),t.accessed&&(n.note="[Online; accesed "+(0,a.default)(t.accessed)+"]"),t.DOI&&(n.doi=t.DOI),t.editor&&(n.editor=t.editor.map(function(t){return(0,o.default)(t,!0)}).join(" and ")),t.ISBN&&(n.isbn=t.ISBN),t.ISSN&&(n.issn=t.ISSN),t["container-title"]&&(n.journal=t["container-title"]),(t.issue||0===t.issue)&&(n.issue=t.issue.toString()),t.page&&(n.pages=t.page.replace("-","--")),t["publisher-place"]&&(n.address=t["publisher-place"]),(t.edition||0===t.edition)&&(n.edition=t.edition.toString()),t.publisher&&(n.publisher=t.publisher),t.title&&(n.title=t.title),t.url&&(n.url=t.url),(t.volume||0===t.volume)&&(n.volume=t.volume.toString()),t.issued&&3===t.issued["date-parts"][0].length&&(n.year=t.issued["date-parts"][0][0].toString()),e.properties=n,e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.htmlDict={wr_start:'<div class="csl-bib-body">',wr_end:"</div>",en_start:'<div class="csl-entry">',en_end:"</div>",ul_start:'<ul style="list-style-type:none">',ul_end:"</ul>",li_start:"<li>",li_end:"</li>"},e.textDict={wr_start:"",wr_end:"\n",en_start:"",en_end:"\n",ul_start:"\n",ul_end:"",li_start:"\t",li_end:"\n"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=m(n(216)),i=m(n(217)),o=m(n(218)),a=m(n(353)),s=m(n(362)),u=m(n(364)),l=m(n(365)),c=m(n(367)),h=m(n(368)),p=n(370),f=m(n(371)),d=m(n(374));function m(t){return t&&t.__esModule?t:{default:t}}e.default=function(t,e){var n;switch(e){case"string/wikidata":return(0,a.default)(t.match(r.default.wikidata[0])[1]);case"list/wikidata":return(0,a.default)(t.match(r.default.wikidata[1])[1]);case"api/wikidata":return(0,i.default)(t);case"url/wikidata":return(0,a.default)(t.match(r.default.wikidata[3])[1]);case"array/wikidata":return(0,a.default)(t.join(","));case"api/doi":return(0,l.default)(t);case"string/doi":case"list/doi":return(0,u.default)(t);case"array/doi":return(0,u.default)(t.join("\n"));case"url/else":return(0,i.default)(t);case"jquery/else":return t.val()||t.text()||t.html();case"html/else":return t.value||t.textContent;case"string/json":return(0,d.default)(t);case"string/bibtex":return(0,h.default)(t);case"string/bibtxt":return(0,p.text)(t);case"object/bibtex":return(0,f.default)(t);case"object/wikidata":return(0,s.default)(t);case"object/contentmine":return(0,c.default)(t);case"array/else":return(n=[]).concat.apply(n,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(t.map(function(t){return(0,o.default)(t)})));case"object/csl":return[t];case"array/csl":return t;case"string/empty":case"string/whitespace":case"empty":case"invalid":default:return[]}}},function(t,e,n){const r="undefined"!=typeof location&&"undefined"!=typeof document,i=n(r?922:251);t.exports=function(t){return r&&(t.origin="*"),"https://www.wikidata.org/w/api.php?"+i.stringify(t)}},function(t,e,n){const r=n(926),i={};i.isNumericId=(t=>/^[0-9]+$/.test(t)),i.isEntityId=(t=>/^(Q|P)[0-9]+$/.test(t)),i.isItemId=(t=>/^Q[0-9]+$/.test(t)),i.isPropertyId=(t=>/^P[0-9]+$/.test(t)),i.getNumericId=function(t){if(!i.isEntityId(t))throw new Error(`invalid wikidata id: ${t}`);return t.replace(/Q|P/,"")},i.wikidataTimeToDateObject=r;const o=t=>e=>{try{return t(e)}catch(t){return e}};i.wikidataTimeToEpochTime=o(t=>r(t).getTime()),i.wikidataTimeToISOString=o(t=>r(t).toISOString()),t.exports=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t){var e=new Date(t);return e.getFullYear()?{"date-parts":[[e.getFullYear(),e.getMonth()+1,e.getDate()]]}:{raw:t}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(n(100)),i=s(n(220)),o=s(n(99)),a=n(352);function s(t){return t&&t.__esModule?t:{default:t}}var u,l,c=(u=regeneratorRuntime.mark(function t(e){var n,s,u,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=l.maxChainLength,h=void 0===c?10:c,p=l.generateGraph,f=void 0===p||p,d=l.forceType;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=d||(0,o.default)(e),s=n.match(/^(array|object)\//)?(0,r.default)(e):e,u=[{type:n,data:e}];case 3:if("array/csl"===n){t.next=14;break}if(!(h--<=0)){t.next=7;break}return console.error("[set]","Max. number of parsing iterations reached"),t.abrupt("return",[]);case 7:return t.next=9,(0,i.default)(s,n);case 9:s=t.sent,n=(0,o.default)(s),u.push({type:n}),t.next=3;break;case 14:return t.abrupt("return",s.map(f?function(t){return(0,a.applyGraph)(t,u)}:a.removeGraph));case 15:case"end":return t.stop()}},t,void 0)}),l=function(){var t=u.apply(this,arguments);return new Promise(function(e,n){return function r(i,o){try{var a=t[i](o),s=a.value}catch(t){return void n(t)}if(!a.done)return Promise.resolve(s).then(function(t){r("next",t)},function(t){r("throw",t)});e(s)}("next")})},function(t){return l.apply(this,arguments)});e.default=c},,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.makeBibliography=e.ReferencesManager=e.Bibliography=void 0;var r=a(n(474)),i=a(n(541)),o=a(n(542));function a(t){return t&&t.__esModule?t:{default:t}}e.Bibliography=r.default,e.ReferencesManager=i.default,e.makeBibliography=o.default},function(t,e,n){var r=n(262),i=n(494);t.exports=function(t,e,n){return function(){if(0===arguments.length)return n();var o=Array.prototype.slice.call(arguments,0),a=o.pop();if(!r(a)){for(var s=0;s<t.length;){if("function"==typeof a[t[s]])return a[t[s]].apply(a,o);s+=1}if(i(a))return e.apply(null,o)(a)}return n.apply(this,arguments)}}},function(t,e){t.exports={init:function(){return this.xf["@@transducer/init"]()},result:function(t){return this.xf["@@transducer/result"](t)}}},function(t,e,n){var r=n(502),i=n(504),o=n(505);function a(t,e,n){for(var r=n.next();!r.done;){if((e=t["@@transducer/step"](e,r.value))&&e["@@transducer/reduced"]){e=e["@@transducer/value"];break}r=n.next()}return t["@@transducer/result"](e)}function s(t,e,n,r){return t["@@transducer/result"](n[r](o(t["@@transducer/step"],t),e))}var u="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator";t.exports=function(t,e,n){if("function"==typeof t&&(t=i(t)),r(n))return function(t,e,n){for(var r=0,i=n.length;r<i;){if((e=t["@@transducer/step"](e,n[r]))&&e["@@transducer/reduced"]){e=e["@@transducer/value"];break}r+=1}return t["@@transducer/result"](e)}(t,e,n);if("function"==typeof n["fantasy-land/reduce"])return s(t,e,n,"fantasy-land/reduce");if(null!=n[u])return a(t,e,n[u]());if("function"==typeof n.next)return a(t,e,n);if("function"==typeof n.reduce)return s(t,e,n,"reduce");throw new TypeError("reduce: list must be array or iterable")}},function(t,e){t.exports=function(t,e){switch(t){case 0:return function(){return e.apply(this,arguments)};case 1:return function(t){return e.apply(this,arguments)};case 2:return function(t,n){return e.apply(this,arguments)};case 3:return function(t,n,r){return e.apply(this,arguments)};case 4:return function(t,n,r,i){return e.apply(this,arguments)};case 5:return function(t,n,r,i,o){return e.apply(this,arguments)};case 6:return function(t,n,r,i,o,a){return e.apply(this,arguments)};case 7:return function(t,n,r,i,o,a,s){return e.apply(this,arguments)};case 8:return function(t,n,r,i,o,a,s,u){return e.apply(this,arguments)};case 9:return function(t,n,r,i,o,a,s,u,l){return e.apply(this,arguments)};case 10:return function(t,n,r,i,o,a,s,u,l,c){return e.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}}},function(t,e){t.exports=function(t,e){return Object.prototype.hasOwnProperty.call(e,t)}},function(t,e){t.exports=function(t){return null==t?"":""+t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(1),a=d(o),s=d(n(2)),u=d(n(544)),l=d(n(558)),c=d(n(272)),h=d(n(559)),p=d(n(700)),f=d(n(701));function d(t){return t&&t.__esModule?t:{default:t}}function m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var g=c.default.draftEntitiesNames,v=g.LINK,y=g.BLOCK_ASSET,b=g.INLINE_ASSET,_=g.NOTE_POINTER,x=function(t){return t.map(function(t,e){return[t,a.default.createElement("br",{key:e})]})},w={inline:{BOLD:function(t,e){var n=e.key;return a.default.createElement("strong",{key:n},t)},ITALIC:function(t,e){var n=e.key;return a.default.createElement("em",{key:n},t)},UNDERLINE:function(t,e){var n=e.key;return a.default.createElement("u",{key:n},t)},CODE:function(t,e){var n=e.key;return a.default.createElement("span",{key:n},t)}},blocks:{unstyled:function(t,e){var n=e.keys;return t.map(function(t,e){return a.default.createElement("p",{id:n[e],key:e},t)})},blockquote:function(t,e){var n=e.keys;return a.default.createElement("blockquote",{id:n[0]},x(t))},"header-one":function(t,e){var n=e.keys;return t.map(function(t,e){return a.default.createElement("h1",{id:n[e],key:e},t)})},"header-two":function(t,e){var n=e.keys;return t.map(function(t,e){return a.default.createElement("h2",{id:n[e],key:e},t)})},"header-three":function(t,e){var n=e.keys;return t.map(function(t,e){return a.default.createElement("h3",{id:n[e],key:e},t)})},"header-four":function(t,e){var n=e.keys;return t.map(function(t,e){return a.default.createElement("h4",{id:n[e],key:e},t)})},"header-five":function(t,e){var n=e.keys;return t.map(function(t,e){return a.default.createElement("h5",{id:n[e],key:e},t)})},"header-six":function(t,e){var n=e.keys;return t.map(function(t,e){return a.default.createElement("h6",{id:n[e],key:e},t)})},"code-block":function(t,e){var n=e.keys;return a.default.createElement("pre",{key:n[0]},x(t))},"unordered-list-item":function(t,e){var n=e.depth,r=e.keys;return a.default.createElement("ul",{key:r[r.length-1],className:"ul-level-"+n},t.map(function(t,e){return a.default.createElement("li",{key:e},t)}))},"ordered-list-item":function(t,e){var n=e.depth,r=e.keys;return a.default.createElement("ol",{key:r.join("|"),className:"ol-level-"+n},t.map(function(t,e){return a.default.createElement("li",{key:r[e]},t)}))}},entities:(r={},m(r,v,function(t,e,n){var r=n.key;return a.default.createElement(l.default,{key:r,to:e.url},t)}),m(r,y,function(t,e,n){var r=n.key;return a.default.createElement(h.default,{key:r,data:e})}),m(r,b,function(t,e,n){var r=n.key;return a.default.createElement(p.default,{data:e,key:r})}),m(r,_,function(t,e,n){var r=n.key;return a.default.createElement(f.default,{key:r,children:t,noteId:e.noteId})}),r)},E=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.getChildContext=function(){return{contextualizations:n.props.contextualizations,contextualizers:n.props.contextualizers,resources:n.props.resources,assetsData:n.props.assets,notes:n.props.notes,NoteContentPointer:n.props.NoteContentPointer,Link:n.props.Link}},n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Component),i(e,[{key:"shouldComponentUpdate",value:function(){return!0}},{key:"renderWarning",value:function(){return a.default.createElement("div",null,a.default.createElement("p",null,"Nothing to render."))}},{key:"render",value:function(){var t=this.props.raw;if(!t)return this.renderWarning();var e=(0,u.default)(t,w);return e?a.default.createElement("div",null,e):this.renderWarning()}}]),e}();E.childContextTypes={contextualizations:s.default.object,contextualizers:s.default.object,resources:s.default.object,assetsData:s.default.object,notes:s.default.object,NoteContentPointer:s.default.func,Link:s.default.func},E.propTypes={raw:s.default.object},e.default=E},function(t,e,n){"use strict";var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var a=n(1),s=n(570),u={width:"100%",height:"100%",padding:0,border:0};function l(t){return t.clientWidth}function c(t){return t.clientHeight}t.exports=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.getHeight,n=void 0===e?c:e,h=t.getWidth,p=void 0===h?l:h,f=t.containerStyle,d=void 0===f?u:f,m=t.className,g=void 0===m?null:m,v=t.elementResize,y=void 0!==v&&v;return function(t){return function(e){function u(){var t,e,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var i=arguments.length,a=Array(i),s=0;s<i;s++)a[s]=arguments[s];return e=r=o(this,(t=u.__proto__||Object.getPrototypeOf(u)).call.apply(t,[this].concat(a))),r.state={},r.updateDimensions=function(){var t=r.refs.container,e=p(t),i=n(t);e===r.state.containerWidth&&i===r.state.containerHeight||r.setState({containerWidth:e,containerHeight:i})},r.onResize=function(){r.rqf||(r.rqf=r.getWindow().requestAnimationFrame(function(){r.rqf=null,r.updateDimensions()}))},o(r,e)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(u,a.Component),i(u,[{key:"getWindow",value:function(){return this.refs.container?this.refs.container.ownerDocument.defaultView||window:window}},{key:"componentDidMount",value:function(){if(!this.refs.container)throw new Error("Cannot find container div");this.updateDimensions(),y?s(this.refs.container,this.updateDimensions):this.getWindow().addEventListener("resize",this.onResize,!1)}},{key:"componentWillUnmount",value:function(){this.getWindow().removeEventListener("resize",this.onResize)}},{key:"getWrappedInstance",value:function(){this.refs.wrappedInstance}},{key:"render",value:function(){var e=this.state,n=e.containerWidth,i=e.containerHeight;return n||i||console.warn("Wrapper div has no height or width, try overriding style with `containerStyle` option"),a.createElement("div",{className:g,style:d,ref:"container"},(n||i)&&a.createElement(t,r({},this.state,this.props,{updateDimensions:this.updateDimensions,ref:"wrappedInstance"})))}}]),u}()}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},o=function(t){return Object.keys(t).map(function(e){return[e,t[e]]})};e.objectToPairs=o;e.mapObj=function(t,e){return n=o(t).map(e),i={},n.forEach(function(t){var e=r(t,2),n=e[0],o=e[1];i[n]=o}),i;var n,i};e.flatten=function(t){return t.reduce(function(t,e){return t.concat(e)},[])};var a=/([A-Z])/g,s=/^ms-/;e.kebabifyStyleName=function(t){return(e=t,e.replace(a,"-$1").toLowerCase()).replace(s,"-ms-");var e};e.recursiveMerge=function t(e,n){if("object"!=typeof e)return n;var r=i({},e);return Object.keys(n).forEach(function(i){r.hasOwnProperty(i)?r[i]=t(e[i],n[i]):r[i]=n[i]}),r};var u={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridColumn:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};var l=["Webkit","ms","Moz","O"];Object.keys(u).forEach(function(t){l.forEach(function(e){var n,r;u[(n=e,r=t,n+r.charAt(0).toUpperCase()+r.substring(1))]=u[t]})});e.stringifyValue=function(t,e){return"number"==typeof e?u[t]?""+e:e+"px":e};e.hashObject=function(t){return function(t){for(var e=t.length,n=e,r=0,i=void 0;e>=4;)i=1540483477*(65535&(i=255&t.charCodeAt(r)|(255&t.charCodeAt(++r))<<8|(255&t.charCodeAt(++r))<<16|(255&t.charCodeAt(++r))<<24))+((1540483477*(i>>>16)&65535)<<16),n=1540483477*(65535&n)+((1540483477*(n>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),e-=4,++r;switch(e){case 3:n^=(255&t.charCodeAt(r+2))<<16;case 2:n^=(255&t.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&t.charCodeAt(r)))+((1540483477*(n>>>16)&65535)<<16)}return n=1540483477*(65535&(n^=n>>>13))+((1540483477*(n>>>16)&65535)<<16),((n^=n>>>15)>>>0).toString(36)}(JSON.stringify(t))};var c=/^([^:]+:.*?)( !important)?;$/;e.importantify=function(t){return t.replace(c,function(t,e,n){return e+" !important;"})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return Array.isArray(t)&&(t=t.join(",")),null!==t.match(/-webkit-|-moz-|-ms-/)},t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(2),o=(r=i)&&r.__esModule?r:{default:r};e.default={media:o.default.object,_mediaSetters:o.default.object,_mediaGetters:o.default.object},t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=Math.floor(t/3600),n=Math.floor((t-3600*e)/60),r=Math.floor(t%60);r<10&&(r="0"+r);return e>0?e+":"+n+":"+r:n+":"+r},t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=a(n(1)),o=a(n(121));function a(t){return t&&t.__esModule?t:{default:t}}function s(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}function u(t){return Array.isArray(t)}function l(t){return function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(u(e))for(var r=0;r<e.length;r+=1)t(e[r],n);else n.push(e);return n}(t).join(".").replace(/\[/g,".").replace(/\]/g,"").split(".")}e.default={get:function(t,e,n){if(!e)return t;var r=l(e),i=void 0;try{i=r.reduce(function(t,e){return t[e]},t)}catch(t){}return void 0!==i?i:n},set:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1],n=arguments[2],r=l(e),i=void 0,o=t;for(;(i=r.shift())&&r.length;)o[i]||(o[i]={}),o=o[i];return o[i]=n,t},takeRight:function(t,e){var n=e>t.length?0:t.length-e;return t.slice(n)},last:function(t){return t[t.length-1]},orderBy:function(t,e,n,r){return t.sort(function(t,i){for(var o=0;o<e.length;o+=1){var a=e[o],s=!1===n[o]||"desc"===n[o],u=a(t,i);if(u)return s?-u:u}return n[0]?t[r]-i[r]:i[r]-t[r]})},range:function(t){for(var e=[],n=0;n<t;n+=1)e.push(t);return e},remove:function(t,e){return t.filter(function(n,r){var i=e(n);return!!i&&(t.splice(r,1),!0)})},clone:function(t){try{return JSON.parse(JSON.stringify(t,function(t,e){return"function"==typeof e?e.toString():e}))}catch(e){return t}},getFirstDefined:function(){for(var t=0;t<arguments.length;t+=1)if(void 0!==(arguments.length<=t?void 0:arguments[t]))return arguments.length<=t?void 0:arguments[t]},sum:function(t){return t.reduce(function(t,e){return t+e},0)},makeTemplateComponent:function(t,e){if(!e)throw new Error("No displayName found for template component:",t);var n=function(e){var n=e.children,a=e.className,u=s(e,["children","className"]);return i.default.createElement("div",r({className:(0,o.default)(t,a)},u),n)};return n.displayName=e,n},groupBy:function(t,e){return t.reduce(function(t,n,r){var i="function"==typeof e?e(n,r):n[e];return t[i]=u(t[i])?t[i]:[],t[i].push(n),t},{})},isArray:u,splitProps:function(t){var e=t.className,n=t.style,r=s(t,["className","style"]);return{className:e,style:n,rest:r||{}}},compactObject:function(t){var e={};t&&Object.keys(t).map(function(n){return Object.prototype.hasOwnProperty.call(t,n)&&void 0!==t[n]&&void 0!==t[n]&&(e[n]=t[n]),!0});return e},isSortingDesc:function(t){return!("desc"!==t.sort&&!0!==t.desc&&!1!==t.asc)},normalizeComponent:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;return"function"==typeof t?Object.getPrototypeOf(t).isReactComponent?i.default.createElement(t,e):t(e):n},asPx:function(t){return t=Number(t),Number.isNaN(t)?null:t+"px"}}},function(t,e,n){t.exports=n(663)},function(t,e,n){"use strict";(function(e){var r=n(26),i=n(666),o={"Content-Type":"application/x-www-form-urlencoded"};function a(t,e){!r.isUndefined(t)&&r.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var s,u={adapter:("undefined"!=typeof XMLHttpRequest?s=n(296):void 0!==e&&(s=n(296)),s),transformRequest:[function(t,e){return i(e,"Content-Type"),r.isFormData(t)||r.isArrayBuffer(t)||r.isBuffer(t)||r.isStream(t)||r.isFile(t)||r.isBlob(t)?t:r.isArrayBufferView(t)?t.buffer:r.isURLSearchParams(t)?(a(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):r.isObject(t)?(a(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(t){return t>=200&&t<300}};u.headers={common:{Accept:"application/json, text/plain, */*"}},r.forEach(["delete","get","head"],function(t){u.headers[t]={}}),r.forEach(["post","put","patch"],function(t){u.headers[t]=r.merge(o)}),t.exports=u}).call(e,n(164))},function(t,e,n){"use strict";function r(){}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"WebGLRenderTargetCube",function(){return Qe}),n.d(e,"WebGLRenderTarget",function(){return Ke}),n.d(e,"WebGLRenderer",function(){return Wo}),n.d(e,"ShaderLib",function(){return $n}),n.d(e,"UniformsLib",function(){return qn}),n.d(e,"UniformsUtils",function(){return Xn}),n.d(e,"ShaderChunk",function(){return Yn}),n.d(e,"FogExp2",function(){return qo}),n.d(e,"Fog",function(){return Xo}),n.d(e,"Scene",function(){return Yo}),n.d(e,"LensFlare",function(){return $o}),n.d(e,"Sprite",function(){return Jo}),n.d(e,"LOD",function(){return Ko}),n.d(e,"SkinnedMesh",function(){return ea}),n.d(e,"Skeleton",function(){return Qo}),n.d(e,"Bone",function(){return ta}),n.d(e,"Mesh",function(){return lo}),n.d(e,"LineSegments",function(){return ia}),n.d(e,"LineLoop",function(){return oa}),n.d(e,"Line",function(){return ra}),n.d(e,"Points",function(){return sa}),n.d(e,"Group",function(){return ua}),n.d(e,"VideoTexture",function(){return la}),n.d(e,"DataTexture",function(){return tn}),n.d(e,"CompressedTexture",function(){return ca}),n.d(e,"CubeTexture",function(){return en}),n.d(e,"CanvasTexture",function(){return Kn}),n.d(e,"DepthTexture",function(){return ha}),n.d(e,"Texture",function(){return Ze}),n.d(e,"CompressedTextureLoader",function(){return Ds}),n.d(e,"DataTextureLoader",function(){return Ns}),n.d(e,"CubeTextureLoader",function(){return Us}),n.d(e,"TextureLoader",function(){return Fs}),n.d(e,"ObjectLoader",function(){return Vu}),n.d(e,"MaterialLoader",function(){return Lu}),n.d(e,"BufferGeometryLoader",function(){return Iu}),n.d(e,"DefaultLoadingManager",function(){return Rs}),n.d(e,"LoadingManager",function(){return Ps}),n.d(e,"JSONLoader",function(){return Hu}),n.d(e,"ImageLoader",function(){return js}),n.d(e,"ImageBitmapLoader",function(){return $u}),n.d(e,"FontLoader",function(){return Ku}),n.d(e,"FileLoader",function(){return Is}),n.d(e,"Loader",function(){return Bu}),n.d(e,"LoaderUtils",function(){return Gu}),n.d(e,"Cache",function(){return ks}),n.d(e,"AudioLoader",function(){return Fl}),n.d(e,"SpotLightShadow",function(){return pu}),n.d(e,"SpotLight",function(){return fu}),n.d(e,"PointLight",function(){return du}),n.d(e,"RectAreaLight",function(){return yu}),n.d(e,"HemisphereLight",function(){return cu}),n.d(e,"DirectionalLightShadow",function(){return mu}),n.d(e,"DirectionalLight",function(){return gu}),n.d(e,"AmbientLight",function(){return vu}),n.d(e,"LightShadow",function(){return hu}),n.d(e,"Light",function(){return lu}),n.d(e,"StereoCamera",function(){return Bl}),n.d(e,"PerspectiveCamera",function(){return zo}),n.d(e,"OrthographicCamera",function(){return Jr}),n.d(e,"CubeCamera",function(){return zl}),n.d(e,"ArrayCamera",function(){return Go}),n.d(e,"Camera",function(){return Zr}),n.d(e,"AudioListener",function(){return Gl}),n.d(e,"PositionalAudio",function(){return Vl}),n.d(e,"AudioContext",function(){return Ul}),n.d(e,"AudioAnalyser",function(){return Wl}),n.d(e,"Audio",function(){return Hl}),n.d(e,"VectorKeyframeTrack",function(){return Pu}),n.d(e,"StringKeyframeTrack",function(){return bu}),n.d(e,"QuaternionKeyframeTrack",function(){return Eu}),n.d(e,"NumberKeyframeTrack",function(){return Tu}),n.d(e,"ColorKeyframeTrack",function(){return Su}),n.d(e,"BooleanKeyframeTrack",function(){return _u}),n.d(e,"PropertyMixer",function(){return ql}),n.d(e,"PropertyBinding",function(){return Yl}),n.d(e,"KeyframeTrack",function(){return ku}),n.d(e,"AnimationUtils",function(){return Cu}),n.d(e,"AnimationObjectGroup",function(){return $l}),n.d(e,"AnimationMixer",function(){return Jl}),n.d(e,"AnimationClip",function(){return Ru}),n.d(e,"Uniform",function(){return Kl}),n.d(e,"InstancedBufferGeometry",function(){return Ql}),n.d(e,"BufferGeometry",function(){return Qi}),n.d(e,"Geometry",function(){return ai}),n.d(e,"InterleavedBufferAttribute",function(){return tc}),n.d(e,"InstancedInterleavedBuffer",function(){return nc}),n.d(e,"InterleavedBuffer",function(){return ec}),n.d(e,"InstancedBufferAttribute",function(){return rc}),n.d(e,"Face3",function(){return Kr}),n.d(e,"Object3D",function(){return $r}),n.d(e,"Raycaster",function(){return ic}),n.d(e,"Layers",function(){return Mr}),n.d(e,"EventDispatcher",function(){return r}),n.d(e,"Clock",function(){return sc}),n.d(e,"QuaternionLinearInterpolant",function(){return wu}),n.d(e,"LinearInterpolant",function(){return Au}),n.d(e,"DiscreteInterpolant",function(){return Mu}),n.d(e,"CubicInterpolant",function(){return Ou}),n.d(e,"Interpolant",function(){return xu}),n.d(e,"Triangle",function(){return uo}),n.d(e,"Math",function(){return ze}),n.d(e,"Spherical",function(){return uc}),n.d(e,"Cylindrical",function(){return lc}),n.d(e,"Plane",function(){return Er}),n.d(e,"Frustum",function(){return Sr}),n.d(e,"Sphere",function(){return wr}),n.d(e,"Ray",function(){return ao}),n.d(e,"Matrix4",function(){return He}),n.d(e,"Matrix3",function(){return qe}),n.d(e,"Box3",function(){return xr}),n.d(e,"Box2",function(){return Zn}),n.d(e,"Line3",function(){return so}),n.d(e,"Euler",function(){return Ar}),n.d(e,"Vector4",function(){return Je}),n.d(e,"Vector3",function(){return We}),n.d(e,"Vector2",function(){return Ge}),n.d(e,"Quaternion",function(){return Ve}),n.d(e,"Color",function(){return Hn}),n.d(e,"ImmediateRenderObject",function(){return cc}),n.d(e,"VertexNormalsHelper",function(){return hc}),n.d(e,"SpotLightHelper",function(){return pc}),n.d(e,"SkeletonHelper",function(){return fc}),n.d(e,"PointLightHelper",function(){return dc}),n.d(e,"RectAreaLightHelper",function(){return mc}),n.d(e,"HemisphereLightHelper",function(){return gc}),n.d(e,"GridHelper",function(){return vc}),n.d(e,"PolarGridHelper",function(){return yc}),n.d(e,"FaceNormalsHelper",function(){return bc}),n.d(e,"DirectionalLightHelper",function(){return _c}),n.d(e,"CameraHelper",function(){return xc}),n.d(e,"BoxHelper",function(){return wc}),n.d(e,"Box3Helper",function(){return Ec}),n.d(e,"PlaneHelper",function(){return Sc}),n.d(e,"ArrowHelper",function(){return Tc}),n.d(e,"AxesHelper",function(){return Oc}),n.d(e,"Shape",function(){return uu}),n.d(e,"Path",function(){return su}),n.d(e,"ShapePath",function(){return Zu}),n.d(e,"Font",function(){return Ju}),n.d(e,"CurvePath",function(){return au}),n.d(e,"Curve",function(){return Bs}),n.d(e,"ShapeUtils",function(){return Ka}),n.d(e,"SceneUtils",function(){return Ac}),n.d(e,"WebGLUtils",function(){return Vo}),n.d(e,"WireframeGeometry",function(){return pa}),n.d(e,"ParametricGeometry",function(){return fa}),n.d(e,"ParametricBufferGeometry",function(){return da}),n.d(e,"TetrahedronGeometry",function(){return va}),n.d(e,"TetrahedronBufferGeometry",function(){return ya}),n.d(e,"OctahedronGeometry",function(){return ba}),n.d(e,"OctahedronBufferGeometry",function(){return _a}),n.d(e,"IcosahedronGeometry",function(){return xa}),n.d(e,"IcosahedronBufferGeometry",function(){return wa}),n.d(e,"DodecahedronGeometry",function(){return Ea}),n.d(e,"DodecahedronBufferGeometry",function(){return Sa}),n.d(e,"PolyhedronGeometry",function(){return ma}),n.d(e,"PolyhedronBufferGeometry",function(){return ga}),n.d(e,"TubeGeometry",function(){return Ta}),n.d(e,"TubeBufferGeometry",function(){return Oa}),n.d(e,"TorusKnotGeometry",function(){return Aa}),n.d(e,"TorusKnotBufferGeometry",function(){return Ma}),n.d(e,"TorusGeometry",function(){return Ca}),n.d(e,"TorusBufferGeometry",function(){return ka}),n.d(e,"TextGeometry",function(){return es}),n.d(e,"TextBufferGeometry",function(){return ns}),n.d(e,"SphereGeometry",function(){return rs}),n.d(e,"SphereBufferGeometry",function(){return is}),n.d(e,"RingGeometry",function(){return os}),n.d(e,"RingBufferGeometry",function(){return as}),n.d(e,"PlaneGeometry",function(){return no}),n.d(e,"PlaneBufferGeometry",function(){return ro}),n.d(e,"LatheGeometry",function(){return ss}),n.d(e,"LatheBufferGeometry",function(){return us}),n.d(e,"ShapeGeometry",function(){return ls}),n.d(e,"ShapeBufferGeometry",function(){return cs}),n.d(e,"ExtrudeGeometry",function(){return Qa}),n.d(e,"ExtrudeBufferGeometry",function(){return ts}),n.d(e,"EdgesGeometry",function(){return ps}),n.d(e,"ConeGeometry",function(){return ms}),n.d(e,"ConeBufferGeometry",function(){return gs}),n.d(e,"CylinderGeometry",function(){return fs}),n.d(e,"CylinderBufferGeometry",function(){return ds}),n.d(e,"CircleGeometry",function(){return vs}),n.d(e,"CircleBufferGeometry",function(){return ys}),n.d(e,"BoxGeometry",function(){return to}),n.d(e,"BoxBufferGeometry",function(){return eo}),n.d(e,"ShadowMaterial",function(){return _s}),n.d(e,"SpriteMaterial",function(){return Zo}),n.d(e,"RawShaderMaterial",function(){return xs}),n.d(e,"ShaderMaterial",function(){return oo}),n.d(e,"PointsMaterial",function(){return aa}),n.d(e,"MeshPhysicalMaterial",function(){return Es}),n.d(e,"MeshStandardMaterial",function(){return ws}),n.d(e,"MeshPhongMaterial",function(){return Ss}),n.d(e,"MeshToonMaterial",function(){return Ts}),n.d(e,"MeshNormalMaterial",function(){return Os}),n.d(e,"MeshLambertMaterial",function(){return As}),n.d(e,"MeshDepthMaterial",function(){return br}),n.d(e,"MeshDistanceMaterial",function(){return _r}),n.d(e,"MeshBasicMaterial",function(){return io}),n.d(e,"LineDashedMaterial",function(){return Ms}),n.d(e,"LineBasicMaterial",function(){return na}),n.d(e,"Material",function(){return yr}),n.d(e,"Float64BufferAttribute",function(){return gi}),n.d(e,"Float32BufferAttribute",function(){return mi}),n.d(e,"Uint32BufferAttribute",function(){return di}),n.d(e,"Int32BufferAttribute",function(){return fi}),n.d(e,"Uint16BufferAttribute",function(){return pi}),n.d(e,"Int16BufferAttribute",function(){return hi}),n.d(e,"Uint8ClampedBufferAttribute",function(){return ci}),n.d(e,"Uint8BufferAttribute",function(){return li}),n.d(e,"Int8BufferAttribute",function(){return ui}),n.d(e,"BufferAttribute",function(){return si}),n.d(e,"ArcCurve",function(){return Gs}),n.d(e,"CatmullRomCurve3",function(){return Ys}),n.d(e,"CubicBezierCurve",function(){return Ks}),n.d(e,"CubicBezierCurve3",function(){return Qs}),n.d(e,"EllipseCurve",function(){return zs}),n.d(e,"LineCurve",function(){return tu}),n.d(e,"LineCurve3",function(){return eu}),n.d(e,"QuadraticBezierCurve",function(){return nu}),n.d(e,"QuadraticBezierCurve3",function(){return ru}),n.d(e,"SplineCurve",function(){return iu}),n.d(e,"REVISION",function(){return S}),n.d(e,"MOUSE",function(){return T}),n.d(e,"CullFaceNone",function(){return O}),n.d(e,"CullFaceBack",function(){return A}),n.d(e,"CullFaceFront",function(){return M}),n.d(e,"CullFaceFrontBack",function(){return C}),n.d(e,"FrontFaceDirectionCW",function(){return k}),n.d(e,"FrontFaceDirectionCCW",function(){return P}),n.d(e,"BasicShadowMap",function(){return R}),n.d(e,"PCFShadowMap",function(){return L}),n.d(e,"PCFSoftShadowMap",function(){return I}),n.d(e,"FrontSide",function(){return D}),n.d(e,"BackSide",function(){return N}),n.d(e,"DoubleSide",function(){return j}),n.d(e,"FlatShading",function(){return U}),n.d(e,"SmoothShading",function(){return F}),n.d(e,"NoColors",function(){return B}),n.d(e,"FaceColors",function(){return z}),n.d(e,"VertexColors",function(){return G}),n.d(e,"NoBlending",function(){return H}),n.d(e,"NormalBlending",function(){return V}),n.d(e,"AdditiveBlending",function(){return W}),n.d(e,"SubtractiveBlending",function(){return q}),n.d(e,"MultiplyBlending",function(){return X}),n.d(e,"CustomBlending",function(){return Y}),n.d(e,"AddEquation",function(){return $}),n.d(e,"SubtractEquation",function(){return Z}),n.d(e,"ReverseSubtractEquation",function(){return J}),n.d(e,"MinEquation",function(){return K}),n.d(e,"MaxEquation",function(){return Q}),n.d(e,"ZeroFactor",function(){return tt}),n.d(e,"OneFactor",function(){return et}),n.d(e,"SrcColorFactor",function(){return nt}),n.d(e,"OneMinusSrcColorFactor",function(){return rt}),n.d(e,"SrcAlphaFactor",function(){return it}),n.d(e,"OneMinusSrcAlphaFactor",function(){return ot}),n.d(e,"DstAlphaFactor",function(){return at}),n.d(e,"OneMinusDstAlphaFactor",function(){return st}),n.d(e,"DstColorFactor",function(){return ut}),n.d(e,"OneMinusDstColorFactor",function(){return lt}),n.d(e,"SrcAlphaSaturateFactor",function(){return ct}),n.d(e,"NeverDepth",function(){return ht}),n.d(e,"AlwaysDepth",function(){return pt}),n.d(e,"LessDepth",function(){return ft}),n.d(e,"LessEqualDepth",function(){return dt}),n.d(e,"EqualDepth",function(){return mt}),n.d(e,"GreaterEqualDepth",function(){return gt}),n.d(e,"GreaterDepth",function(){return vt}),n.d(e,"NotEqualDepth",function(){return yt}),n.d(e,"MultiplyOperation",function(){return bt}),n.d(e,"MixOperation",function(){return _t}),n.d(e,"AddOperation",function(){return xt}),n.d(e,"NoToneMapping",function(){return wt}),n.d(e,"LinearToneMapping",function(){return Et}),n.d(e,"ReinhardToneMapping",function(){return St}),n.d(e,"Uncharted2ToneMapping",function(){return Tt}),n.d(e,"CineonToneMapping",function(){return Ot}),n.d(e,"UVMapping",function(){return At}),n.d(e,"CubeReflectionMapping",function(){return Mt}),n.d(e,"CubeRefractionMapping",function(){return Ct}),n.d(e,"EquirectangularReflectionMapping",function(){return kt}),n.d(e,"EquirectangularRefractionMapping",function(){return Pt}),n.d(e,"SphericalReflectionMapping",function(){return Rt}),n.d(e,"CubeUVReflectionMapping",function(){return Lt}),n.d(e,"CubeUVRefractionMapping",function(){return It}),n.d(e,"RepeatWrapping",function(){return Dt}),n.d(e,"ClampToEdgeWrapping",function(){return Nt}),n.d(e,"MirroredRepeatWrapping",function(){return jt}),n.d(e,"NearestFilter",function(){return Ut}),n.d(e,"NearestMipMapNearestFilter",function(){return Ft}),n.d(e,"NearestMipMapLinearFilter",function(){return Bt}),n.d(e,"LinearFilter",function(){return zt}),n.d(e,"LinearMipMapNearestFilter",function(){return Gt}),n.d(e,"LinearMipMapLinearFilter",function(){return Ht}),n.d(e,"UnsignedByteType",function(){return Vt}),n.d(e,"ByteType",function(){return Wt}),n.d(e,"ShortType",function(){return qt}),n.d(e,"UnsignedShortType",function(){return Xt}),n.d(e,"IntType",function(){return Yt}),n.d(e,"UnsignedIntType",function(){return $t}),n.d(e,"FloatType",function(){return Zt}),n.d(e,"HalfFloatType",function(){return Jt}),n.d(e,"UnsignedShort4444Type",function(){return Kt}),n.d(e,"UnsignedShort5551Type",function(){return Qt}),n.d(e,"UnsignedShort565Type",function(){return te}),n.d(e,"UnsignedInt248Type",function(){return ee}),n.d(e,"AlphaFormat",function(){return ne}),n.d(e,"RGBFormat",function(){return re}),n.d(e,"RGBAFormat",function(){return ie}),n.d(e,"LuminanceFormat",function(){return oe}),n.d(e,"LuminanceAlphaFormat",function(){return ae}),n.d(e,"RGBEFormat",function(){return se}),n.d(e,"DepthFormat",function(){return ue}),n.d(e,"DepthStencilFormat",function(){return le}),n.d(e,"RGB_S3TC_DXT1_Format",function(){return ce}),n.d(e,"RGBA_S3TC_DXT1_Format",function(){return he}),n.d(e,"RGBA_S3TC_DXT3_Format",function(){return pe}),n.d(e,"RGBA_S3TC_DXT5_Format",function(){return fe}),n.d(e,"RGB_PVRTC_4BPPV1_Format",function(){return de}),n.d(e,"RGB_PVRTC_2BPPV1_Format",function(){return me}),n.d(e,"RGBA_PVRTC_4BPPV1_Format",function(){return ge}),n.d(e,"RGBA_PVRTC_2BPPV1_Format",function(){return ve}),n.d(e,"RGB_ETC1_Format",function(){return ye}),n.d(e,"LoopOnce",function(){return be}),n.d(e,"LoopRepeat",function(){return _e}),n.d(e,"LoopPingPong",function(){return xe}),n.d(e,"InterpolateDiscrete",function(){return we}),n.d(e,"InterpolateLinear",function(){return Ee}),n.d(e,"InterpolateSmooth",function(){return Se}),n.d(e,"ZeroCurvatureEnding",function(){return Te}),n.d(e,"ZeroSlopeEnding",function(){return Oe}),n.d(e,"WrapAroundEnding",function(){return Ae}),n.d(e,"TrianglesDrawMode",function(){return Me}),n.d(e,"TriangleStripDrawMode",function(){return Ce}),n.d(e,"TriangleFanDrawMode",function(){return ke}),n.d(e,"LinearEncoding",function(){return Pe}),n.d(e,"sRGBEncoding",function(){return Re}),n.d(e,"GammaEncoding",function(){return Le}),n.d(e,"RGBEEncoding",function(){return Ie}),n.d(e,"LogLuvEncoding",function(){return De}),n.d(e,"RGBM7Encoding",function(){return Ne}),n.d(e,"RGBM16Encoding",function(){return je}),n.d(e,"RGBDEncoding",function(){return Ue}),n.d(e,"BasicDepthPacking",function(){return Fe}),n.d(e,"RGBADepthPacking",function(){return Be}),n.d(e,"CubeGeometry",function(){return to}),n.d(e,"Face4",function(){return Mc}),n.d(e,"LineStrip",function(){return kc}),n.d(e,"LinePieces",function(){return Pc}),n.d(e,"MeshFaceMaterial",function(){return Rc}),n.d(e,"MultiMaterial",function(){return Lc}),n.d(e,"PointCloud",function(){return Ic}),n.d(e,"Particle",function(){return Dc}),n.d(e,"ParticleSystem",function(){return Nc}),n.d(e,"PointCloudMaterial",function(){return jc}),n.d(e,"ParticleBasicMaterial",function(){return Uc}),n.d(e,"ParticleSystemMaterial",function(){return Fc}),n.d(e,"Vertex",function(){return Bc}),n.d(e,"DynamicBufferAttribute",function(){return zc}),n.d(e,"Int8Attribute",function(){return Gc}),n.d(e,"Uint8Attribute",function(){return Hc}),n.d(e,"Uint8ClampedAttribute",function(){return Vc}),n.d(e,"Int16Attribute",function(){return Wc}),n.d(e,"Uint16Attribute",function(){return qc}),n.d(e,"Int32Attribute",function(){return Xc}),n.d(e,"Uint32Attribute",function(){return Yc}),n.d(e,"Float32Attribute",function(){return $c}),n.d(e,"Float64Attribute",function(){return Zc}),n.d(e,"ClosedSplineCurve3",function(){return Jc}),n.d(e,"SplineCurve3",function(){return Kc}),n.d(e,"Spline",function(){return Qc}),n.d(e,"AxisHelper",function(){return th}),n.d(e,"BoundingBoxHelper",function(){return eh}),n.d(e,"EdgesHelper",function(){return nh}),n.d(e,"WireframeHelper",function(){return rh}),n.d(e,"XHRLoader",function(){return ih}),n.d(e,"BinaryTextureLoader",function(){return oh}),n.d(e,"GeometryUtils",function(){return ah}),n.d(e,"ImageUtils",function(){return sh}),n.d(e,"Projector",function(){return uh}),n.d(e,"CanvasRenderer",function(){return lh}),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(void 0!==r&&null!==r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}),Object.assign(r.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var n=this._listeners[t];if(void 0!==n){var r=n.indexOf(e);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var n=e.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,t)}}}});var i,o,a,s,u,l,c,h,p,f,d,m,g,v,y,b,_,x,w,E,S="89",T={LEFT:0,MIDDLE:1,RIGHT:2},O=0,A=1,M=2,C=3,k=0,P=1,R=0,L=1,I=2,D=0,N=1,j=2,U=1,F=2,B=0,z=1,G=2,H=0,V=1,W=2,q=3,X=4,Y=5,$=100,Z=101,J=102,K=103,Q=104,tt=200,et=201,nt=202,rt=203,it=204,ot=205,at=206,st=207,ut=208,lt=209,ct=210,ht=0,pt=1,ft=2,dt=3,mt=4,gt=5,vt=6,yt=7,bt=0,_t=1,xt=2,wt=0,Et=1,St=2,Tt=3,Ot=4,At=300,Mt=301,Ct=302,kt=303,Pt=304,Rt=305,Lt=306,It=307,Dt=1e3,Nt=1001,jt=1002,Ut=1003,Ft=1004,Bt=1005,zt=1006,Gt=1007,Ht=1008,Vt=1009,Wt=1010,qt=1011,Xt=1012,Yt=1013,$t=1014,Zt=1015,Jt=1016,Kt=1017,Qt=1018,te=1019,ee=1020,ne=1021,re=1022,ie=1023,oe=1024,ae=1025,se=ie,ue=1026,le=1027,ce=2001,he=2002,pe=2003,fe=2004,de=2100,me=2101,ge=2102,ve=2103,ye=2151,be=2200,_e=2201,xe=2202,we=2300,Ee=2301,Se=2302,Te=2400,Oe=2401,Ae=2402,Me=0,Ce=1,ke=2,Pe=3e3,Re=3001,Le=3007,Ie=3002,De=3003,Ne=3004,je=3005,Ue=3006,Fe=3200,Be=3201,ze={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var t=[],e=0;e<256;e++)t[e]=(e<16?"0":"")+e.toString(16).toUpperCase();return function(){var e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return t[255&e]+t[e>>8&255]+t[e>>16&255]+t[e>>24&255]+"-"+t[255&n]+t[n>>8&255]+"-"+t[n>>16&15|64]+t[n>>24&255]+"-"+t[63&r|128]+t[r>>8&255]+"-"+t[r>>16&255]+t[r>>24&255]+t[255&i]+t[i>>8&255]+t[i>>16&255]+t[i>>24&255]}}(),clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*ze.DEG2RAD},radToDeg:function(t){return t*ze.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}};function Ge(t,e){this.x=t||0,this.y=e||0}function He(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function Ve(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==r?r:1}function We(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}function qe(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.defineProperties(Ge.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(Ge.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:(i=new Ge,o=new Ge,function(t,e){return i.set(t,t),o.set(e,e),this.clamp(i,o)}),clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=this.x-t.x,o=this.y-t.y;return this.x=i*n-o*r+t.x,this.y=i*r+o*n+t.y,this}}),Object.assign(He.prototype,{isMatrix4:!0,set:function(t,e,n,r,i,o,a,s,u,l,c,h,p,f,d,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=r,g[1]=i,g[5]=o,g[9]=a,g[13]=s,g[2]=u,g[6]=l,g[10]=c,g[14]=h,g[3]=p,g[7]=f,g[11]=d,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new He).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this},copyPosition:function(t){var e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:(p=new We,function(t){var e=this.elements,n=t.elements,r=1/p.setFromMatrixColumn(t,0).length(),i=1/p.setFromMatrixColumn(t,1).length(),o=1/p.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[4]=n[4]*i,e[5]=n[5]*i,e[6]=n[6]*i,e[8]=n[8]*o,e[9]=n[9]*o,e[10]=n[10]*o,this}),makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,n=t.x,r=t.y,i=t.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(r),u=Math.sin(r),l=Math.cos(i),c=Math.sin(i);if("XYZ"===t.order){var h=o*l,p=o*c,f=a*l,d=a*c;e[0]=s*l,e[4]=-s*c,e[8]=u,e[1]=p+f*u,e[5]=h-d*u,e[9]=-a*s,e[2]=d-h*u,e[6]=f+p*u,e[10]=o*s}else if("YXZ"===t.order){var m=s*l,g=s*c,v=u*l,y=u*c;e[0]=m+y*a,e[4]=v*a-g,e[8]=o*u,e[1]=o*c,e[5]=o*l,e[9]=-a,e[2]=g*a-v,e[6]=y+m*a,e[10]=o*s}else if("ZXY"===t.order){m=s*l,g=s*c,v=u*l,y=u*c;e[0]=m-y*a,e[4]=-o*c,e[8]=v+g*a,e[1]=g+v*a,e[5]=o*l,e[9]=y-m*a,e[2]=-o*u,e[6]=a,e[10]=o*s}else if("ZYX"===t.order){h=o*l,p=o*c,f=a*l,d=a*c;e[0]=s*l,e[4]=f*u-p,e[8]=h*u+d,e[1]=s*c,e[5]=d*u+h,e[9]=p*u-f,e[2]=-u,e[6]=a*s,e[10]=o*s}else if("YZX"===t.order){var b=o*s,_=o*u,x=a*s,w=a*u;e[0]=s*l,e[4]=w-b*c,e[8]=x*c+_,e[1]=c,e[5]=o*l,e[9]=-a*l,e[2]=-u*l,e[6]=_*c+x,e[10]=b-w*c}else if("XZY"===t.order){b=o*s,_=o*u,x=a*s,w=a*u;e[0]=s*l,e[4]=-c,e[8]=u*l,e[1]=b*c+w,e[5]=o*l,e[9]=_*c-x,e[2]=x*c-_,e[6]=a*l,e[10]=w*c+b}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){var e=this.elements,n=t._x,r=t._y,i=t._z,o=t._w,a=n+n,s=r+r,u=i+i,l=n*a,c=n*s,h=n*u,p=r*s,f=r*u,d=i*u,m=o*a,g=o*s,v=o*u;return e[0]=1-(p+d),e[4]=c-v,e[8]=h+g,e[1]=c+v,e[5]=1-(l+d),e[9]=f-m,e[2]=h-g,e[6]=f+m,e[10]=1-(l+p),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:(l=new We,c=new We,h=new We,function(t,e,n){var r=this.elements;return h.subVectors(t,e),0===h.lengthSq()&&(h.z=1),h.normalize(),l.crossVectors(n,h),0===l.lengthSq()&&(1===Math.abs(n.z)?h.x+=1e-4:h.z+=1e-4,h.normalize(),l.crossVectors(n,h)),l.normalize(),c.crossVectors(h,l),r[0]=l.x,r[4]=c.x,r[8]=h.x,r[1]=l.y,r[5]=c.y,r[9]=h.y,r[2]=l.z,r[6]=c.z,r[10]=h.z,this}),multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,o=n[0],a=n[4],s=n[8],u=n[12],l=n[1],c=n[5],h=n[9],p=n[13],f=n[2],d=n[6],m=n[10],g=n[14],v=n[3],y=n[7],b=n[11],_=n[15],x=r[0],w=r[4],E=r[8],S=r[12],T=r[1],O=r[5],A=r[9],M=r[13],C=r[2],k=r[6],P=r[10],R=r[14],L=r[3],I=r[7],D=r[11],N=r[15];return i[0]=o*x+a*T+s*C+u*L,i[4]=o*w+a*O+s*k+u*I,i[8]=o*E+a*A+s*P+u*D,i[12]=o*S+a*M+s*R+u*N,i[1]=l*x+c*T+h*C+p*L,i[5]=l*w+c*O+h*k+p*I,i[9]=l*E+c*A+h*P+p*D,i[13]=l*S+c*M+h*R+p*N,i[2]=f*x+d*T+m*C+g*L,i[6]=f*w+d*O+m*k+g*I,i[10]=f*E+d*A+m*P+g*D,i[14]=f*S+d*M+m*R+g*N,i[3]=v*x+y*T+b*C+_*L,i[7]=v*w+y*O+b*k+_*I,i[11]=v*E+y*A+b*P+_*D,i[15]=v*S+y*M+b*R+_*N,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToBufferAttribute:(u=new We,function(t){for(var e=0,n=t.count;e<n;e++)u.x=t.getX(e),u.y=t.getY(e),u.z=t.getZ(e),u.applyMatrix4(this),t.setXYZ(e,u.x,u.y,u.z);return t}),determinant:function(){var t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],o=t[1],a=t[5],s=t[9],u=t[13],l=t[2],c=t[6],h=t[10],p=t[14];return t[3]*(+i*s*c-r*u*c-i*a*h+n*u*h+r*a*p-n*s*p)+t[7]*(+e*s*p-e*u*h+i*o*h-r*o*p+r*u*l-i*s*l)+t[11]*(+e*u*c-e*a*p-i*o*c+n*o*p+i*a*l-n*u*l)+t[15]*(-r*a*l-e*s*c+e*a*h+r*o*c-n*o*h+n*s*l)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var n=this.elements,r=t.elements,i=r[0],o=r[1],a=r[2],s=r[3],u=r[4],l=r[5],c=r[6],h=r[7],p=r[8],f=r[9],d=r[10],m=r[11],g=r[12],v=r[13],y=r[14],b=r[15],_=f*y*h-v*d*h+v*c*m-l*y*m-f*c*b+l*d*b,x=g*d*h-p*y*h-g*c*m+u*y*m+p*c*b-u*d*b,w=p*v*h-g*f*h+g*l*m-u*v*m-p*l*b+u*f*b,E=g*f*c-p*v*c-g*l*d+u*v*d+p*l*y-u*f*y,S=i*_+o*x+a*w+s*E;if(0===S){var T="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===e)throw new Error(T);return console.warn(T),this.identity()}var O=1/S;return n[0]=_*O,n[1]=(v*d*s-f*y*s-v*a*m+o*y*m+f*a*b-o*d*b)*O,n[2]=(l*y*s-v*c*s+v*a*h-o*y*h-l*a*b+o*c*b)*O,n[3]=(f*c*s-l*d*s-f*a*h+o*d*h+l*a*m-o*c*m)*O,n[4]=x*O,n[5]=(p*y*s-g*d*s+g*a*m-i*y*m-p*a*b+i*d*b)*O,n[6]=(g*c*s-u*y*s-g*a*h+i*y*h+u*a*b-i*c*b)*O,n[7]=(u*d*s-p*c*s+p*a*h-i*d*h-u*a*m+i*c*m)*O,n[8]=w*O,n[9]=(g*f*s-p*v*s-g*o*m+i*v*m+p*o*b-i*f*b)*O,n[10]=(u*v*s-g*l*s+g*o*h-i*v*h-u*o*b+i*l*b)*O,n[11]=(p*l*s-u*f*s-p*o*h+i*f*h+u*o*m-i*l*m)*O,n[12]=E*O,n[13]=(p*v*a-g*f*a+g*o*d-i*v*d-p*o*y+i*f*y)*O,n[14]=(g*l*a-u*v*a-g*o*c+i*v*c+u*o*y-i*l*y)*O,n[15]=(u*f*a-p*l*a+p*o*c-i*f*c-u*o*d+i*l*d)*O,this},scale:function(t){var e=this.elements,n=t.x,r=t.y,i=t.z;return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=1-n,o=t.x,a=t.y,s=t.z,u=i*o,l=i*a;return this.set(u*o+n,u*a-r*s,u*s+r*a,0,u*a+r*s,l*a+n,l*s-r*o,0,u*s-r*a,l*s+r*o,i*s*s+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){return this.makeRotationFromQuaternion(e),this.scale(n),this.setPosition(t),this},decompose:(a=new We,s=new He,function(t,e,n){var r=this.elements,i=a.set(r[0],r[1],r[2]).length(),o=a.set(r[4],r[5],r[6]).length(),u=a.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),t.x=r[12],t.y=r[13],t.z=r[14],s.copy(this);var l=1/i,c=1/o,h=1/u;return s.elements[0]*=l,s.elements[1]*=l,s.elements[2]*=l,s.elements[4]*=c,s.elements[5]*=c,s.elements[6]*=c,s.elements[8]*=h,s.elements[9]*=h,s.elements[10]*=h,e.setFromRotationMatrix(s),n.x=i,n.y=o,n.z=u,this}),makePerspective:function(t,e,n,r,i,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*i/(e-t),u=2*i/(n-r),l=(e+t)/(e-t),c=(n+r)/(n-r),h=-(o+i)/(o-i),p=-2*o*i/(o-i);return a[0]=s,a[4]=0,a[8]=l,a[12]=0,a[1]=0,a[5]=u,a[9]=c,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=p,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(t,e,n,r,i,o){var a=this.elements,s=1/(e-t),u=1/(n-r),l=1/(o-i),c=(e+t)*s,h=(n+r)*u,p=(o+i)*l;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-c,a[1]=0,a[5]=2*u,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*l,a[14]=-p,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<16;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}),Object.assign(Ve,{slerp:function(t,e,n,r){return n.copy(t).slerp(e,r)},slerpFlat:function(t,e,n,r,i,o,a){var s=n[r+0],u=n[r+1],l=n[r+2],c=n[r+3],h=i[o+0],p=i[o+1],f=i[o+2],d=i[o+3];if(c!==d||s!==h||u!==p||l!==f){var m=1-a,g=s*h+u*p+l*f+c*d,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){var b=Math.sqrt(y),_=Math.atan2(b,g*v);m=Math.sin(m*_)/b,a=Math.sin(a*_)/b}var x=a*v;if(s=s*m+h*x,u=u*m+p*x,l=l*m+f*x,c=c*m+d*x,m===1-a){var w=1/Math.sqrt(s*s+u*u+l*l+c*c);s*=w,u*=w,l*=w,c*=w}}t[e]=s,t[e+1]=u,t[e+2]=l,t[e+3]=c}}),Object.defineProperties(Ve.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this.onChangeCallback()}}}),Object.assign(Ve.prototype,{set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t._x,r=t._y,i=t._z,o=t.order,a=Math.cos,s=Math.sin,u=a(n/2),l=a(r/2),c=a(i/2),h=s(n/2),p=s(r/2),f=s(i/2);return"XYZ"===o?(this._x=h*l*c+u*p*f,this._y=u*p*c-h*l*f,this._z=u*l*f+h*p*c,this._w=u*l*c-h*p*f):"YXZ"===o?(this._x=h*l*c+u*p*f,this._y=u*p*c-h*l*f,this._z=u*l*f-h*p*c,this._w=u*l*c+h*p*f):"ZXY"===o?(this._x=h*l*c-u*p*f,this._y=u*p*c+h*l*f,this._z=u*l*f+h*p*c,this._w=u*l*c-h*p*f):"ZYX"===o?(this._x=h*l*c-u*p*f,this._y=u*p*c+h*l*f,this._z=u*l*f-h*p*c,this._w=u*l*c+h*p*f):"YZX"===o?(this._x=h*l*c+u*p*f,this._y=u*p*c+h*l*f,this._z=u*l*f-h*p*c,this._w=u*l*c-h*p*f):"XZY"===o&&(this._x=h*l*c-u*p*f,this._y=u*p*c-h*l*f,this._z=u*l*f+h*p*c,this._w=u*l*c+h*p*f),!1!==e&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e,n=t.elements,r=n[0],i=n[4],o=n[8],a=n[1],s=n[5],u=n[9],l=n[2],c=n[6],h=n[10],p=r+s+h;return p>0?(e=.5/Math.sqrt(p+1),this._w=.25/e,this._x=(c-u)*e,this._y=(o-l)*e,this._z=(a-i)*e):r>s&&r>h?(e=2*Math.sqrt(1+r-s-h),this._w=(c-u)/e,this._x=.25*e,this._y=(i+a)/e,this._z=(o+l)/e):s>h?(e=2*Math.sqrt(1+s-r-h),this._w=(o-l)/e,this._x=(i+a)/e,this._y=.25*e,this._z=(u+c)/e):(e=2*Math.sqrt(1+h-r-s),this._w=(a-i)/e,this._x=(o+l)/e,this._y=(u+c)/e,this._z=.25*e),this.onChangeCallback(),this},setFromUnitVectors:(d=new We,function(t,e){return void 0===d&&(d=new We),(f=t.dot(e)+1)<1e-6?(f=0,Math.abs(t.x)>Math.abs(t.z)?d.set(-t.y,t.x,0):d.set(0,-t.z,t.y)):d.crossVectors(t,e),this._x=d.x,this._y=d.y,this._z=d.z,this._w=f,this.normalize()}),inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t._x,r=t._y,i=t._z,o=t._w,a=e._x,s=e._y,u=e._z,l=e._w;return this._x=n*l+o*a+r*u-i*s,this._y=r*l+o*s+i*a-n*u,this._z=i*l+o*u+n*s-r*a,this._w=o*l-n*a-r*s-i*u,this.onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,r=this._y,i=this._z,o=this._w,a=o*t._w+n*t._x+r*t._y+i*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;var s=Math.sqrt(1-a*a);if(Math.abs(s)<.001)return this._w=.5*(o+this._w),this._x=.5*(n+this._x),this._y=.5*(r+this._y),this._z=.5*(i+this._z),this;var u=Math.atan2(s,a),l=Math.sin((1-e)*u)/s,c=Math.sin(e*u)/s;return this._w=o*l+this._w*c,this._x=n*l+this._x*c,this._y=r*l+this._y*c,this._z=i*l+this._z*c,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),Object.assign(We.prototype,{isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:(w=new Ve,function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(w.setFromEuler(t))}),applyAxisAngle:(x=new Ve,function(t,e){return this.applyQuaternion(x.setFromAxisAngle(t,e))}),applyMatrix3:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6]*r,this.y=i[1]*e+i[4]*n+i[7]*r,this.z=i[2]*e+i[5]*n+i[8]*r,this},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements,o=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*o,this},applyQuaternion:function(t){var e=this.x,n=this.y,r=this.z,i=t.x,o=t.y,a=t.z,s=t.w,u=s*e+o*r-a*n,l=s*n+a*e-i*r,c=s*r+i*n-o*e,h=-i*e-o*n-a*r;return this.x=u*s+h*-i+l*-a-c*-o,this.y=l*s+h*-o+c*-i-u*-a,this.z=c*s+h*-a+u*-o-l*-i,this},project:(_=new He,function(t){return _.multiplyMatrices(t.projectionMatrix,_.getInverse(t.matrixWorld)),this.applyMatrix4(_)}),unproject:(b=new He,function(t){return b.multiplyMatrices(t.matrixWorld,b.getInverse(t.projectionMatrix)),this.applyMatrix4(b)}),transformDirection:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[4]*n+i[8]*r,this.y=i[1]*e+i[5]*n+i[9]*r,this.z=i[2]*e+i[6]*n+i[10]*r,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:(v=new We,y=new We,function(t,e){return v.set(t,t,t),y.set(e,e,e),this.clamp(v,y)}),clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var n=t.x,r=t.y,i=t.z,o=e.x,a=e.y,s=e.z;return this.x=r*s-i*a,this.y=i*o-n*s,this.z=n*a-r*o,this},projectOnVector:function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},projectOnPlane:(g=new We,function(t){return g.copy(this).projectOnVector(t),this.sub(g)}),reflect:(m=new We,function(t){return this.sub(m.copy(t).multiplyScalar(2*this.dot(t)))}),angleTo:function(t){var e=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq());return Math.acos(ze.clamp(e,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){var e=Math.sin(t.phi)*t.radius;return this.x=e*Math.sin(t.theta),this.y=Math.cos(t.phi)*t.radius,this.z=e*Math.cos(t.theta),this},setFromCylindrical:function(t){return this.x=t.radius*Math.sin(t.theta),this.y=t.y,this.z=t.radius*Math.cos(t.theta),this},setFromMatrixPosition:function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}}),Object.assign(qe.prototype,{isMatrix3:!0,set:function(t,e,n,r,i,o,a,s,u){var l=this.elements;return l[0]=t,l[1]=r,l[2]=a,l[3]=e,l[4]=i,l[5]=s,l[6]=n,l[7]=o,l[8]=u,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},applyToBufferAttribute:(E=new We,function(t){for(var e=0,n=t.count;e<n;e++)E.x=t.getX(e),E.y=t.getY(e),E.z=t.getZ(e),E.applyMatrix3(this),t.setXYZ(e,E.x,E.y,E.z);return t}),multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,o=n[0],a=n[3],s=n[6],u=n[1],l=n[4],c=n[7],h=n[2],p=n[5],f=n[8],d=r[0],m=r[3],g=r[6],v=r[1],y=r[4],b=r[7],_=r[2],x=r[5],w=r[8];return i[0]=o*d+a*v+s*_,i[3]=o*m+a*y+s*x,i[6]=o*g+a*b+s*w,i[1]=u*d+l*v+c*_,i[4]=u*m+l*y+c*x,i[7]=u*g+l*b+c*w,i[2]=h*d+p*v+f*_,i[5]=h*m+p*y+f*x,i[8]=h*g+p*b+f*w,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],l=t[8];return e*o*l-e*a*u-n*i*l+n*a*s+r*i*u-r*o*s},getInverse:function(t,e){t&&t.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var n=t.elements,r=this.elements,i=n[0],o=n[1],a=n[2],s=n[3],u=n[4],l=n[5],c=n[6],h=n[7],p=n[8],f=p*u-l*h,d=l*c-p*s,m=h*s-u*c,g=i*f+o*d+a*m;if(0===g){var v="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===e)throw new Error(v);return console.warn(v),this.identity()}var y=1/g;return r[0]=f*y,r[1]=(a*h-p*o)*y,r[2]=(l*o-a*u)*y,r[3]=d*y,r[4]=(p*i-a*c)*y,r[5]=(a*s-l*i)*y,r[6]=m*y,r[7]=(o*c-h*i)*y,r[8]=(u*i-o*s)*y,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,n,r,i,o,a){var s=Math.cos(i),u=Math.sin(i);this.set(n*s,n*u,-n*(s*o+u*a)+o+t,-r*u,r*s,-r*(-u*o+s*a)+a+e,0,0,1)},scale:function(t,e){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this},rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=this.elements,i=r[0],o=r[3],a=r[6],s=r[1],u=r[4],l=r[7];return r[0]=e*i+n*s,r[3]=e*o+n*u,r[6]=e*a+n*l,r[1]=-n*i+e*s,r[4]=-n*o+e*u,r[7]=-n*a+e*l,this},translate:function(t,e){var n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<9;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}});var Xe,Ye,$e=0;function Ze(t,e,n,r,i,o,a,s,u,l){Object.defineProperty(this,"id",{value:$e++}),this.uuid=ze.generateUUID(),this.name="",this.image=void 0!==t?t:Ze.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:Ze.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:Nt,this.wrapT=void 0!==r?r:Nt,this.magFilter=void 0!==i?i:zt,this.minFilter=void 0!==o?o:Ht,this.anisotropy=void 0!==u?u:1,this.format=void 0!==a?a:ie,this.type=void 0!==s?s:Vt,this.offset=new Ge(0,0),this.repeat=new Ge(1,1),this.center=new Ge(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new qe,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==l?l:Pe,this.version=0,this.onUpdate=null}function Je(t,e,n,r){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==r?r:1}function Ke(t,e,n){this.uuid=ze.generateUUID(),this.width=t,this.height=e,this.scissor=new Je(0,0,t,e),this.scissorTest=!1,this.viewport=new Je(0,0,t,e),void 0===(n=n||{}).minFilter&&(n.minFilter=zt),this.texture=new Ze(void 0,void 0,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function Qe(t,e,n){Ke.call(this,t,e,n),this.activeCubeFace=0,this.activeMipMapLevel=0}function tn(t,e,n,r,i,o,a,s,u,l,c,h){Ze.call(this,null,o,a,s,u,l,r,i,c,h),this.image={data:t,width:e,height:n},this.magFilter=void 0!==u?u:Ut,this.minFilter=void 0!==l?l:Ut,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function en(t,e,n,r,i,o,a,s,u,l){t=void 0!==t?t:[],e=void 0!==e?e:Mt,Ze.call(this,t,e,n,r,i,o,a,s,u,l),this.flipY=!1}Ze.DEFAULT_IMAGE=void 0,Ze.DEFAULT_MAPPING=At,Ze.prototype=Object.assign(Object.create(r.prototype),{constructor:Ze,isTexture:!0,clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var r=this.image;void 0===r.uuid&&(r.uuid=ze.generateUUID()),e||void 0!==t.images[r.uuid]||(t.images[r.uuid]={uuid:r.uuid,url:function(t){var e;if(t instanceof HTMLCanvasElement)e=t;else{(e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=t.width,e.height=t.height;var n=e.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height)}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}(r)}),n.image=r.uuid}return e||(t.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping===At){if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Dt:t.x=t.x-Math.floor(t.x);break;case Nt:t.x=t.x<0?0:1;break;case jt:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Dt:t.y=t.y-Math.floor(t.y);break;case Nt:t.y=t.y<0?0:1;break;case jt:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}this.flipY&&(t.y=1-t.y)}}}),Object.defineProperty(Ze.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Je.prototype,{isVector4:!0,set:function(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=this.w,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*e+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*e+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*e+o[7]*n+o[11]*r+o[15]*i,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,n,r,i,o=t.elements,a=o[0],s=o[4],u=o[8],l=o[1],c=o[5],h=o[9],p=o[2],f=o[6],d=o[10];if(Math.abs(s-l)<.01&&Math.abs(u-p)<.01&&Math.abs(h-f)<.01){if(Math.abs(s+l)<.1&&Math.abs(u+p)<.1&&Math.abs(h+f)<.1&&Math.abs(a+c+d-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;var m=(a+1)/2,g=(c+1)/2,v=(d+1)/2,y=(s+l)/4,b=(u+p)/4,_=(h+f)/4;return m>g&&m>v?m<.01?(n=0,r=.707106781,i=.707106781):(r=y/(n=Math.sqrt(m)),i=b/n):g>v?g<.01?(n=.707106781,r=0,i=.707106781):(n=y/(r=Math.sqrt(g)),i=_/r):v<.01?(n=.707106781,r=.707106781,i=0):(n=b/(i=Math.sqrt(v)),r=_/i),this.set(n,r,i,e),this}var x=Math.sqrt((f-h)*(f-h)+(u-p)*(u-p)+(l-s)*(l-s));return Math.abs(x)<.001&&(x=1),this.x=(f-h)/x,this.y=(u-p)/x,this.z=(l-s)/x,this.w=Math.acos((a+c+d-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(t,e){return void 0===Xe&&(Xe=new Je,Ye=new Je),Xe.set(t,t,t,t),Ye.set(e,e,e,e),this.clamp(Xe,Ye)},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}}),Ke.prototype=Object.assign(Object.create(r.prototype),{constructor:Ke,isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Qe.prototype=Object.create(Ke.prototype),Qe.prototype.constructor=Qe,Qe.prototype.isWebGLRenderTargetCube=!0,tn.prototype=Object.create(Ze.prototype),tn.prototype.constructor=tn,tn.prototype.isDataTexture=!0,en.prototype=Object.create(Ze.prototype),en.prototype.constructor=en,en.prototype.isCubeTexture=!0,Object.defineProperty(en.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}});var nn=new Ze,rn=new en;function on(){this.seq=[],this.map={}}var an=[],sn=[],un=new Float32Array(16),ln=new Float32Array(9);function cn(t,e,n){var r=t[0];if(r<=0||r>0)return t;var i=e*n,o=an[i];if(void 0===o&&(o=new Float32Array(i),an[i]=o),0!==e){r.toArray(o,0);for(var a=1,s=0;a!==e;++a)s+=n,t[a].toArray(o,s)}return o}function hn(t,e){var n=sn[e];void 0===n&&(n=new Int32Array(e),sn[e]=n);for(var r=0;r!==e;++r)n[r]=t.allocTextureUnit();return n}function pn(t,e){t.uniform1f(this.addr,e)}function fn(t,e){t.uniform1i(this.addr,e)}function dn(t,e){void 0===e.x?t.uniform2fv(this.addr,e):t.uniform2f(this.addr,e.x,e.y)}function mn(t,e){void 0!==e.x?t.uniform3f(this.addr,e.x,e.y,e.z):void 0!==e.r?t.uniform3f(this.addr,e.r,e.g,e.b):t.uniform3fv(this.addr,e)}function gn(t,e){void 0===e.x?t.uniform4fv(this.addr,e):t.uniform4f(this.addr,e.x,e.y,e.z,e.w)}function vn(t,e){t.uniformMatrix2fv(this.addr,!1,e.elements||e)}function yn(t,e){void 0===e.elements?t.uniformMatrix3fv(this.addr,!1,e):(ln.set(e.elements),t.uniformMatrix3fv(this.addr,!1,ln))}function bn(t,e){void 0===e.elements?t.uniformMatrix4fv(this.addr,!1,e):(un.set(e.elements),t.uniformMatrix4fv(this.addr,!1,un))}function _n(t,e,n){var r=n.allocTextureUnit();t.uniform1i(this.addr,r),n.setTexture2D(e||nn,r)}function xn(t,e,n){var r=n.allocTextureUnit();t.uniform1i(this.addr,r),n.setTextureCube(e||rn,r)}function wn(t,e){t.uniform2iv(this.addr,e)}function En(t,e){t.uniform3iv(this.addr,e)}function Sn(t,e){t.uniform4iv(this.addr,e)}function Tn(t,e){t.uniform1fv(this.addr,e)}function On(t,e){t.uniform1iv(this.addr,e)}function An(t,e){t.uniform2fv(this.addr,cn(e,this.size,2))}function Mn(t,e){t.uniform3fv(this.addr,cn(e,this.size,3))}function Cn(t,e){t.uniform4fv(this.addr,cn(e,this.size,4))}function kn(t,e){t.uniformMatrix2fv(this.addr,!1,cn(e,this.size,4))}function Pn(t,e){t.uniformMatrix3fv(this.addr,!1,cn(e,this.size,9))}function Rn(t,e){t.uniformMatrix4fv(this.addr,!1,cn(e,this.size,16))}function Ln(t,e,n){var r=e.length,i=hn(n,r);t.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.setTexture2D(e[o]||nn,i[o])}function In(t,e,n){var r=e.length,i=hn(n,r);t.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.setTextureCube(e[o]||rn,i[o])}function Dn(t,e,n){this.id=t,this.addr=n,this.setValue=function(t){switch(t){case 5126:return pn;case 35664:return dn;case 35665:return mn;case 35666:return gn;case 35674:return vn;case 35675:return yn;case 35676:return bn;case 35678:case 36198:return _n;case 35680:return xn;case 5124:case 35670:return fn;case 35667:case 35671:return wn;case 35668:case 35672:return En;case 35669:case 35673:return Sn}}(e.type)}function Nn(t,e,n){this.id=t,this.addr=n,this.size=e.size,this.setValue=function(t){switch(t){case 5126:return Tn;case 35664:return An;case 35665:return Mn;case 35666:return Cn;case 35674:return kn;case 35675:return Pn;case 35676:return Rn;case 35678:return Ln;case 35680:return In;case 5124:case 35670:return On;case 35667:case 35671:return wn;case 35668:case 35672:return En;case 35669:case 35673:return Sn}}(e.type)}function jn(t){this.id=t,on.call(this)}jn.prototype.setValue=function(t,e){for(var n=this.seq,r=0,i=n.length;r!==i;++r){var o=n[r];o.setValue(t,e[o.id])}};var Un=/([\w\d_]+)(\])?(\[|\.)?/g;function Fn(t,e){t.seq.push(e),t.map[e.id]=e}function Bn(t,e,n){var r=t.name,i=r.length;for(Un.lastIndex=0;;){var o=Un.exec(r),a=Un.lastIndex,s=o[1],u="]"===o[2],l=o[3];if(u&&(s|=0),void 0===l||"["===l&&a+2===i){Fn(n,void 0===l?new Dn(s,t,e):new Nn(s,t,e));break}var c=n.map[s];void 0===c&&Fn(n,c=new jn(s)),n=c}}function zn(t,e,n){on.call(this),this.renderer=n;for(var r=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),i=0;i<r;++i){var o=t.getActiveUniform(e,i),a=o.name;Bn(o,t.getUniformLocation(e,a),this)}}zn.prototype.setValue=function(t,e,n){var r=this.map[e];void 0!==r&&r.setValue(t,n,this.renderer)},zn.prototype.setOptional=function(t,e,n){var r=e[n];void 0!==r&&this.setValue(t,n,r)},zn.upload=function(t,e,n,r){for(var i=0,o=e.length;i!==o;++i){var a=e[i],s=n[a.id];!1!==s.needsUpdate&&a.setValue(t,s.value,r)}},zn.seqWithValue=function(t,e){for(var n=[],r=0,i=t.length;r!==i;++r){var o=t[r];o.id in e&&n.push(o)}return n};var Gn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Hn(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}Object.assign(Hn.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,n){return this.r=t,this.g=e,this.b=n,this},setHSL:function(){function t(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}return function(e,n,r){if(e=ze.euclideanModulo(e,1),n=ze.clamp(n,0,1),r=ze.clamp(r,0,1),0===n)this.r=this.g=this.b=r;else{var i=r<=.5?r*(1+n):r+n-r*n,o=2*r-i;this.r=t(o,i,e+1/3),this.g=t(o,i,e),this.b=t(o,i,e-1/3)}return this}}(),setStyle:function(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var r,i=n[1],o=n[2];switch(i){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,e(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,e(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){var a=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,u=parseInt(r[3],10)/100;return e(r[5]),this.setHSL(a,s,u)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(t)){var l,c=(l=n[1]).length;if(3===c)return this.r=parseInt(l.charAt(0)+l.charAt(0),16)/255,this.g=parseInt(l.charAt(1)+l.charAt(1),16)/255,this.b=parseInt(l.charAt(2)+l.charAt(2),16)/255,this;if(6===c)return this.r=parseInt(l.charAt(0)+l.charAt(1),16)/255,this.g=parseInt(l.charAt(2)+l.charAt(3),16)/255,this.b=parseInt(l.charAt(4)+l.charAt(5),16)/255,this}t&&t.length>0&&(void 0!==(l=Gn[t])?this.setHex(l):console.warn("THREE.Color: Unknown color "+t));return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var n=e>0?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},convertGammaToLinear:function(){var t=this.r,e=this.g,n=this.b;return this.r=t*t,this.g=e*e,this.b=n*n,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){var e,n,r=t||{h:0,s:0,l:0},i=this.r,o=this.g,a=this.b,s=Math.max(i,o,a),u=Math.min(i,o,a),l=(u+s)/2;if(u===s)e=0,n=0;else{var c=s-u;switch(n=l<=.5?c/(s+u):c/(2-s-u),s){case i:e=(o-a)/c+(o<a?6:0);break;case o:e=(a-i)/c+2;break;case a:e=(i-o)/c+4}e/=6}return r.h=e,r.s=n,r.l=l,r},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,n){var r=this.getHSL();return r.h+=t,r.s+=e,r.l+=n,this.setHSL(r.h,r.s,r.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}});var Vn,Wn,qn={common:{diffuse:{value:new Hn(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new qe},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Ge(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Hn(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new Hn(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new qe}}},Xn={merge:function(t){for(var e={},n=0;n<t.length;n++){var r=this.clone(t[n]);for(var i in r)e[i]=r[i]}return e},clone:function(t){var e={};for(var n in t){e[n]={};for(var r in t[n]){var i=t[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?e[n][r]=i.clone():Array.isArray(i)?e[n][r]=i.slice():e[n][r]=i}}return e}},Yn={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat theta = acos( dot( N, V ) );\n\tvec2 uv = vec2(\n\t\tsqrt( saturate( roughness ) ),\n\t\tsaturate( theta / ( 0.5 * PI ) ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.86267 + (0.49788 + 0.01436 * y ) * y;\n\tfloat b = 3.45068 + (4.18814 + y) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = (x > 0.0) ? v : 0.5 * inversesqrt( 1.0 - x * x ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tvec3 result = vec3( LTC_ClippedSphereFormFactor( vectorFormFactor ) );\n\treturn result;\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; ++ i ) {\n\t\tvec4 plane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t\t\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; ++ i ) {\n\t\t\tvec4 plane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t\n\t#endif\n#endif\n",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",fog_vertex:"\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",lights_pars:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltcMat;\tuniform sampler2D ltcMag;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tfloat norm = texture2D( ltcMag, uv ).a;\n\t\tvec4 t = texture2D( ltcMat, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3(   1,   0, t.y ),\n\t\t\tvec3(   0, t.z,   0 ),\n\t\t\tvec3( t.w,   0, t.x )\n\t\t);\n\t\treflectedLight.directSpecular += lightColor * material.specularColor * norm * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",lights_template:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\t#ifndef STANDARD\n\t\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n\t#else\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",normal_fragment:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n"},$n={basic:{uniforms:Xn.merge([qn.common,qn.specularmap,qn.envmap,qn.aomap,qn.lightmap,qn.fog]),vertexShader:Yn.meshbasic_vert,fragmentShader:Yn.meshbasic_frag},lambert:{uniforms:Xn.merge([qn.common,qn.specularmap,qn.envmap,qn.aomap,qn.lightmap,qn.emissivemap,qn.fog,qn.lights,{emissive:{value:new Hn(0)}}]),vertexShader:Yn.meshlambert_vert,fragmentShader:Yn.meshlambert_frag},phong:{uniforms:Xn.merge([qn.common,qn.specularmap,qn.envmap,qn.aomap,qn.lightmap,qn.emissivemap,qn.bumpmap,qn.normalmap,qn.displacementmap,qn.gradientmap,qn.fog,qn.lights,{emissive:{value:new Hn(0)},specular:{value:new Hn(1118481)},shininess:{value:30}}]),vertexShader:Yn.meshphong_vert,fragmentShader:Yn.meshphong_frag},standard:{uniforms:Xn.merge([qn.common,qn.envmap,qn.aomap,qn.lightmap,qn.emissivemap,qn.bumpmap,qn.normalmap,qn.displacementmap,qn.roughnessmap,qn.metalnessmap,qn.fog,qn.lights,{emissive:{value:new Hn(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:Yn.meshphysical_vert,fragmentShader:Yn.meshphysical_frag},points:{uniforms:Xn.merge([qn.points,qn.fog]),vertexShader:Yn.points_vert,fragmentShader:Yn.points_frag},dashed:{uniforms:Xn.merge([qn.common,qn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Yn.linedashed_vert,fragmentShader:Yn.linedashed_frag},depth:{uniforms:Xn.merge([qn.common,qn.displacementmap]),vertexShader:Yn.depth_vert,fragmentShader:Yn.depth_frag},normal:{uniforms:Xn.merge([qn.common,qn.bumpmap,qn.normalmap,qn.displacementmap,{opacity:{value:1}}]),vertexShader:Yn.normal_vert,fragmentShader:Yn.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Yn.cube_vert,fragmentShader:Yn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Yn.equirect_vert,fragmentShader:Yn.equirect_frag},distanceRGBA:{uniforms:Xn.merge([qn.common,qn.displacementmap,{referencePosition:{value:new We},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Yn.distanceRGBA_vert,fragmentShader:Yn.distanceRGBA_frag},shadow:{uniforms:Xn.merge([qn.lights,qn.fog,{color:{value:new Hn(0)},opacity:{value:1}}]),vertexShader:Yn.shadow_vert,fragmentShader:Yn.shadow_frag}};function Zn(t,e){this.min=void 0!==t?t:new Ge(1/0,1/0),this.max=void 0!==e?e:new Ge(-1/0,-1/0)}function Jn(t,e,n,r,i){var o,a,s,u,l,c,h,p;function f(){var t,r,f,d,m,g=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),v=new Uint16Array([0,1,2,0,2,3]);o=e.createBuffer(),a=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,g,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,a),e.bufferData(e.ELEMENT_ARRAY_BUFFER,v,e.STATIC_DRAW),h=e.createTexture(),p=e.createTexture(),n.bindTexture(e.TEXTURE_2D,h),e.texImage2D(e.TEXTURE_2D,0,e.RGB,16,16,0,e.RGB,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),n.bindTexture(e.TEXTURE_2D,p),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,16,16,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),s={vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","\tvUV = uv;","\tvec2 pos = position;","\tif ( renderType == 2 ) {","\t\tvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","\t\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","\t\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","\t\tvVisibility =        visibility.r / 9.0;","\t\tvVisibility *= 1.0 - visibility.g / 9.0;","\t\tvVisibility *=       visibility.b / 9.0;","\t\tvVisibility *= 1.0 - visibility.a / 9.0;","\t\tpos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","\t\tpos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","\t}","\tgl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","\tif ( renderType == 0 ) {","\t\tgl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","\t} else if ( renderType == 1 ) {","\t\tgl_FragColor = texture2D( map, vUV );","\t} else {","\t\tvec4 texture = texture2D( map, vUV );","\t\ttexture.a *= opacity * vVisibility;","\t\tgl_FragColor = texture;","\t\tgl_FragColor.rgb *= color;","\t}","}"].join("\n")},t=s,r=e.createProgram(),f=e.createShader(e.FRAGMENT_SHADER),d=e.createShader(e.VERTEX_SHADER),m="precision "+i.precision+" float;\n",e.shaderSource(f,m+t.fragmentShader),e.shaderSource(d,m+t.vertexShader),e.compileShader(f),e.compileShader(d),e.attachShader(r,f),e.attachShader(r,d),e.linkProgram(r),u=r,l={vertex:e.getAttribLocation(u,"position"),uv:e.getAttribLocation(u,"uv")},c={renderType:e.getUniformLocation(u,"renderType"),map:e.getUniformLocation(u,"map"),occlusionMap:e.getUniformLocation(u,"occlusionMap"),opacity:e.getUniformLocation(u,"opacity"),color:e.getUniformLocation(u,"color"),scale:e.getUniformLocation(u,"scale"),rotation:e.getUniformLocation(u,"rotation"),screenPosition:e.getUniformLocation(u,"screenPosition")}}this.render=function(t,i,s,d){if(0!==t.length){var m=new We,g=d.w/d.z,v=.5*d.z,y=.5*d.w,b=16/d.w,_=new Ge(b*g,b),x=new We(1,1,0),w=new Ge(1,1),E=new Zn;E.min.set(d.x,d.y),E.max.set(d.x+(d.z-16),d.y+(d.w-16)),void 0===u&&f(),n.useProgram(u),n.initAttributes(),n.enableAttribute(l.vertex),n.enableAttribute(l.uv),n.disableUnusedAttributes(),e.uniform1i(c.occlusionMap,0),e.uniform1i(c.map,1),e.bindBuffer(e.ARRAY_BUFFER,o),e.vertexAttribPointer(l.vertex,2,e.FLOAT,!1,16,0),e.vertexAttribPointer(l.uv,2,e.FLOAT,!1,16,8),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,a),n.disable(e.CULL_FACE),n.buffers.depth.setMask(!1);for(var S=0,T=t.length;S<T;S++){b=16/d.w,_.set(b*g,b);var O=t[S];if(m.set(O.matrixWorld.elements[12],O.matrixWorld.elements[13],O.matrixWorld.elements[14]),m.applyMatrix4(s.matrixWorldInverse),m.applyMatrix4(s.projectionMatrix),x.copy(m),w.x=d.x+x.x*v+v-8,w.y=d.y+x.y*y+y-8,!0===E.containsPoint(w)){n.activeTexture(e.TEXTURE0),n.bindTexture(e.TEXTURE_2D,null),n.activeTexture(e.TEXTURE1),n.bindTexture(e.TEXTURE_2D,h),e.copyTexImage2D(e.TEXTURE_2D,0,e.RGB,w.x,w.y,16,16,0),e.uniform1i(c.renderType,0),e.uniform2f(c.scale,_.x,_.y),e.uniform3f(c.screenPosition,x.x,x.y,x.z),n.disable(e.BLEND),n.enable(e.DEPTH_TEST),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),n.activeTexture(e.TEXTURE0),n.bindTexture(e.TEXTURE_2D,p),e.copyTexImage2D(e.TEXTURE_2D,0,e.RGBA,w.x,w.y,16,16,0),e.uniform1i(c.renderType,1),n.disable(e.DEPTH_TEST),n.activeTexture(e.TEXTURE1),n.bindTexture(e.TEXTURE_2D,h),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),O.positionScreen.copy(x),O.customUpdateCallback?O.customUpdateCallback(O):O.updateLensFlares(),e.uniform1i(c.renderType,2),n.enable(e.BLEND);for(var A=0,M=O.lensFlares.length;A<M;A++){var C=O.lensFlares[A];C.opacity>.001&&C.scale>.001&&(x.x=C.x,x.y=C.y,x.z=C.z,b=C.size*C.scale/d.w,_.x=b*g,_.y=b,e.uniform3f(c.screenPosition,x.x,x.y,x.z),e.uniform2f(c.scale,_.x,_.y),e.uniform1f(c.rotation,C.rotation),e.uniform1f(c.opacity,C.opacity),e.uniform3f(c.color,C.color.r,C.color.g,C.color.b),n.setBlending(C.blending,C.blendEquation,C.blendSrc,C.blendDst),r.setTexture2D(C.texture,1),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}}}n.enable(e.CULL_FACE),n.enable(e.DEPTH_TEST),n.buffers.depth.setMask(!0),n.reset()}}}function Kn(t,e,n,r,i,o,a,s,u){Ze.call(this,t,e,n,r,i,o,a,s,u),this.needsUpdate=!0}function Qn(t,e,n,r,i){var o,a,s,u,l,c,h=new We,p=new Ve,f=new We;function d(){var t,n,r,h=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),p=new Uint16Array([0,1,2,0,2,3]);o=e.createBuffer(),a=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,h,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,a),e.bufferData(e.ELEMENT_ARRAY_BUFFER,p,e.STATIC_DRAW),t=e.createProgram(),n=e.createShader(e.VERTEX_SHADER),r=e.createShader(e.FRAGMENT_SHADER),e.shaderSource(n,["precision "+i.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvUV = uvOffset + uv * uvScale;","\tvec2 alignedPosition = position * scale;","\tvec2 rotatedPosition;","\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","\tvec4 mvPosition;","\tmvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","\tmvPosition.xy += rotatedPosition;","\tgl_Position = projectionMatrix * mvPosition;","\tfogDepth = - mvPosition.z;","}"].join("\n")),e.shaderSource(r,["precision "+i.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvec4 texture = texture2D( map, vUV );","\tgl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","\tif ( gl_FragColor.a < alphaTest ) discard;","\tif ( fogType > 0 ) {","\t\tfloat fogFactor = 0.0;","\t\tif ( fogType == 1 ) {","\t\t\tfogFactor = smoothstep( fogNear, fogFar, fogDepth );","\t\t} else {","\t\t\tconst float LOG2 = 1.442695;","\t\t\tfogFactor = exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 );","\t\t\tfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","\t\t}","\t\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );","\t}","}"].join("\n")),e.compileShader(n),e.compileShader(r),e.attachShader(t,n),e.attachShader(t,r),e.linkProgram(t),s=t,u={position:e.getAttribLocation(s,"position"),uv:e.getAttribLocation(s,"uv")},l={uvOffset:e.getUniformLocation(s,"uvOffset"),uvScale:e.getUniformLocation(s,"uvScale"),rotation:e.getUniformLocation(s,"rotation"),scale:e.getUniformLocation(s,"scale"),color:e.getUniformLocation(s,"color"),map:e.getUniformLocation(s,"map"),opacity:e.getUniformLocation(s,"opacity"),modelViewMatrix:e.getUniformLocation(s,"modelViewMatrix"),projectionMatrix:e.getUniformLocation(s,"projectionMatrix"),fogType:e.getUniformLocation(s,"fogType"),fogDensity:e.getUniformLocation(s,"fogDensity"),fogNear:e.getUniformLocation(s,"fogNear"),fogFar:e.getUniformLocation(s,"fogFar"),fogColor:e.getUniformLocation(s,"fogColor"),fogDepth:e.getUniformLocation(s,"fogDepth"),alphaTest:e.getUniformLocation(s,"alphaTest")};var f=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");f.width=8,f.height=8;var d=f.getContext("2d");d.fillStyle="white",d.fillRect(0,0,8,8),c=new Kn(f)}function m(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:e.id-t.id}this.render=function(i,g,v){if(0!==i.length){void 0===s&&d(),n.useProgram(s),n.initAttributes(),n.enableAttribute(u.position),n.enableAttribute(u.uv),n.disableUnusedAttributes(),n.disable(e.CULL_FACE),n.enable(e.BLEND),e.bindBuffer(e.ARRAY_BUFFER,o),e.vertexAttribPointer(u.position,2,e.FLOAT,!1,16,0),e.vertexAttribPointer(u.uv,2,e.FLOAT,!1,16,8),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,a),e.uniformMatrix4fv(l.projectionMatrix,!1,v.projectionMatrix.elements),n.activeTexture(e.TEXTURE0),e.uniform1i(l.map,0);var y=0,b=0,_=g.fog;_?(e.uniform3f(l.fogColor,_.color.r,_.color.g,_.color.b),_.isFog?(e.uniform1f(l.fogNear,_.near),e.uniform1f(l.fogFar,_.far),e.uniform1i(l.fogType,1),y=1,b=1):_.isFogExp2&&(e.uniform1f(l.fogDensity,_.density),e.uniform1i(l.fogType,2),y=2,b=2)):(e.uniform1i(l.fogType,0),y=0,b=0);for(var x=0,w=i.length;x<w;x++){(S=i[x]).modelViewMatrix.multiplyMatrices(v.matrixWorldInverse,S.matrixWorld),S.z=-S.modelViewMatrix.elements[14]}i.sort(m);var E=[];for(x=0,w=i.length;x<w;x++){var S,T=(S=i[x]).material;if(!1!==T.visible){S.onBeforeRender(t,g,v,void 0,T,void 0),e.uniform1f(l.alphaTest,T.alphaTest),e.uniformMatrix4fv(l.modelViewMatrix,!1,S.modelViewMatrix.elements),S.matrixWorld.decompose(h,p,f),E[0]=f.x,E[1]=f.y;var O=0;g.fog&&T.fog&&(O=b),y!==O&&(e.uniform1i(l.fogType,O),y=O),null!==T.map?(e.uniform2f(l.uvOffset,T.map.offset.x,T.map.offset.y),e.uniform2f(l.uvScale,T.map.repeat.x,T.map.repeat.y)):(e.uniform2f(l.uvOffset,0,0),e.uniform2f(l.uvScale,1,1)),e.uniform1f(l.opacity,T.opacity),e.uniform3f(l.color,T.color.r,T.color.g,T.color.b),e.uniform1f(l.rotation,T.rotation),e.uniform2fv(l.scale,E),n.setBlending(T.blending,T.blendEquation,T.blendSrc,T.blendDst,T.blendEquationAlpha,T.blendSrcAlpha,T.blendDstAlpha,T.premultipliedAlpha),n.buffers.depth.setTest(T.depthTest),n.buffers.depth.setMask(T.depthWrite),n.buffers.color.setMask(T.colorWrite),r.setTexture2D(T.map||c,0),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),S.onAfterRender(t,g,v,void 0,T,void 0)}}n.enable(e.CULL_FACE),n.reset()}}}$n.physical={uniforms:Xn.merge([$n.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:Yn.meshphysical_vert,fragmentShader:Yn.meshphysical_frag},Object.assign(Zn.prototype,{set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:(Wn=new Ge,function(t,e){var n=Wn.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){var e=t||new Ge;return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){var e=t||new Ge;return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return(e||new Ge).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return(e||new Ge).copy(t).clamp(this.min,this.max)},distanceToPoint:(Vn=new Ge,function(t){return Vn.copy(t).clamp(this.min,this.max).sub(t).length()}),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),Kn.prototype=Object.create(Ze.prototype),Kn.prototype.constructor=Kn;var tr,er,nr,rr,ir,or,ar,sr,ur,lr,cr,hr,pr,fr,dr,mr,gr,vr=0;function yr(){Object.defineProperty(this,"id",{value:vr++}),this.uuid=ze.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=V,this.side=D,this.flatShading=!1,this.vertexColors=B,this.opacity=1,this.transparent=!1,this.blendSrc=it,this.blendDst=ot,this.blendEquation=$,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=dt,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.userData={},this.needsUpdate=!0}function br(t){yr.call(this),this.type="MeshDepthMaterial",this.depthPacking=Fe,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(t)}function _r(t){yr.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new We,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(t)}function xr(t,e){this.min=void 0!==t?t:new We(1/0,1/0,1/0),this.max=void 0!==e?e:new We(-1/0,-1/0,-1/0)}function wr(t,e){this.center=void 0!==t?t:new We,this.radius=void 0!==e?e:0}function Er(t,e){this.normal=void 0!==t?t:new We(1,0,0),this.constant=void 0!==e?e:0}function Sr(t,e,n,r,i,o){this.planes=[void 0!==t?t:new Er,void 0!==e?e:new Er,void 0!==n?n:new Er,void 0!==r?r:new Er,void 0!==i?i:new Er,void 0!==o?o:new Er]}function Tr(t,e,n){for(var r=new Sr,i=new He,o=new Ge,a=new Ge(n,n),s=new We,u=new We,l=1,c=2,h=1+(l|c),p=new Array(h),f=new Array(h),d={},m=[new We(1,0,0),new We(-1,0,0),new We(0,0,1),new We(0,0,-1),new We(0,1,0),new We(0,-1,0)],g=[new We(0,1,0),new We(0,1,0),new We(0,1,0),new We(0,1,0),new We(0,0,1),new We(0,0,-1)],v=[new Je,new Je,new Je,new Je,new Je,new Je],y=0;y!==h;++y){var b=0!=(y&l),_=0!=(y&c),x=new br({depthPacking:Be,morphTargets:b,skinning:_});p[y]=x;var w=new _r({morphTargets:b,skinning:_});f[y]=w}var E=this;function S(e,n,r,i,o,a){var s=e.geometry,u=null,h=p,m=e.customDepthMaterial;if(r&&(h=f,m=e.customDistanceMaterial),m)u=m;else{var g=!1;n.morphTargets&&(s&&s.isBufferGeometry?g=s.morphAttributes&&s.morphAttributes.position&&s.morphAttributes.position.length>0:s&&s.isGeometry&&(g=s.morphTargets&&s.morphTargets.length>0)),e.isSkinnedMesh&&!1===n.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e);var v=e.isSkinnedMesh&&n.skinning,y=0;g&&(y|=l),v&&(y|=c),u=h[y]}if(t.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length){var b=u.uuid,_=n.uuid,x=d[b];void 0===x&&(x={},d[b]=x);var w=x[_];void 0===w&&(w=u.clone(),x[_]=w),u=w}u.visible=n.visible,u.wireframe=n.wireframe;var S=n.side;return E.renderSingleSided&&S==j&&(S=D),E.renderReverseSided&&(S===D?S=N:S===N&&(S=D)),u.side=S,u.clipShadows=n.clipShadows,u.clippingPlanes=n.clippingPlanes,u.clipIntersection=n.clipIntersection,u.wireframeLinewidth=n.wireframeLinewidth,u.linewidth=n.linewidth,r&&u.isMeshDistanceMaterial&&(u.referencePosition.copy(i),u.nearDistance=o,u.farDistance=a),u}function T(n,i,o,a){if(!1!==n.visible){if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&n.castShadow&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);var s=e.update(n),l=n.material;if(Array.isArray(l))for(var c=s.groups,h=0,p=c.length;h<p;h++){var f=c[h],d=l[f.materialIndex];if(d&&d.visible){var m=S(n,d,a,u,o.near,o.far);t.renderBufferDirect(o,null,s,m,n,f)}}else if(l.visible){m=S(n,l,a,u,o.near,o.far);t.renderBufferDirect(o,null,s,m,n,null)}}for(var g=n.children,v=0,y=g.length;v<y;v++)T(g[v],i,o,a)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=L,this.renderReverseSided=!0,this.renderSingleSided=!0,this.render=function(e,n,l){if(!1!==E.enabled&&(!1!==E.autoUpdate||!1!==E.needsUpdate)&&0!==e.length){var c,h=t.context,p=t.state;p.disable(h.BLEND),p.buffers.color.setClear(1,1,1,1),p.buffers.depth.setTest(!0),p.setScissorTest(!1);for(var f=0,d=e.length;f<d;f++){var y=e[f],b=y.shadow,_=y&&y.isPointLight;if(void 0!==b){var x=b.camera;if(o.copy(b.mapSize),o.min(a),_){var w=o.x,S=o.y;v[0].set(2*w,S,w,S),v[1].set(0,S,w,S),v[2].set(3*w,S,w,S),v[3].set(w,S,w,S),v[4].set(3*w,0,w,S),v[5].set(w,0,w,S),o.x*=4,o.y*=2}if(null===b.map){var O={minFilter:Ut,magFilter:Ut,format:ie};b.map=new Ke(o.x,o.y,O),b.map.texture.name=y.name+".shadowMap",x.updateProjectionMatrix()}b.isSpotLightShadow&&b.update(y);var A=b.map,M=b.matrix;u.setFromMatrixPosition(y.matrixWorld),x.position.copy(u),_?(c=6,M.makeTranslation(-u.x,-u.y,-u.z)):(c=1,s.setFromMatrixPosition(y.target.matrixWorld),x.lookAt(s),x.updateMatrixWorld(),M.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),M.multiply(x.projectionMatrix),M.multiply(x.matrixWorldInverse)),t.setRenderTarget(A),t.clear();for(var C=0;C<c;C++){if(_){s.copy(x.position),s.add(m[C]),x.up.copy(g[C]),x.lookAt(s),x.updateMatrixWorld();var k=v[C];p.viewport(k)}i.multiplyMatrices(x.projectionMatrix,x.matrixWorldInverse),r.setFromMatrix(i),T(n,l,x,_)}}else console.warn("THREE.WebGLShadowMap:",y,"has no shadow.")}E.needsUpdate=!1}}}function Or(t){var e={};return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),e[t.uuid]},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);var r=e[n.uuid];r&&(t.deleteBuffer(r.buffer),delete e[n.uuid])},update:function(n,r){n.isInterleavedBufferAttribute&&(n=n.data);var i,o,a,s,u,l=e[n.uuid];void 0===l?e[n.uuid]=function(e,n){var r=e.array,i=e.dynamic?t.DYNAMIC_DRAW:t.STATIC_DRAW,o=t.createBuffer();t.bindBuffer(n,o),t.bufferData(n,r,i),e.onUploadCallback();var a=t.FLOAT;return r instanceof Float32Array?a=t.FLOAT:r instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):r instanceof Uint16Array?a=t.UNSIGNED_SHORT:r instanceof Int16Array?a=t.SHORT:r instanceof Uint32Array?a=t.UNSIGNED_INT:r instanceof Int32Array?a=t.INT:r instanceof Int8Array?a=t.BYTE:r instanceof Uint8Array&&(a=t.UNSIGNED_BYTE),{buffer:o,type:a,bytesPerElement:r.BYTES_PER_ELEMENT,version:e.version}}(n,r):l.version<n.version&&(i=l.buffer,a=r,s=(o=n).array,u=o.updateRange,t.bindBuffer(a,i),!1===o.dynamic?t.bufferData(a,s,t.STATIC_DRAW):-1===u.count?t.bufferSubData(a,0,s):0===u.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(t.bufferSubData(a,u.offset*s.BYTES_PER_ELEMENT,s.subarray(u.offset,u.offset+u.count)),u.count=-1),l.version=n.version)}}}function Ar(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._order=r||Ar.DefaultOrder}function Mr(){this.mask=1}yr.prototype=Object.assign(Object.create(r.prototype),{constructor:yr,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var e in t){var n=t[e];if(void 0!==n)if("shading"!==e){var r=this[e];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]="overdraw"===e?Number(n):n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===U;else console.warn("THREE.Material: '"+e+"' parameter is undefined.")}},toJSON:function(t){var e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearCoat&&(n.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(n.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,n.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==V&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),this.side!==D&&(n.side=this.side),this.vertexColors!==B&&(n.vertexColors=this.vertexColors),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,0!==this.rotation&&(n.rotation=this.rotation),1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e){var i=r(t.textures),o=r(t.images);i.length>0&&(n.textures=i),o.length>0&&(n.images=o)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.lights=t.lights,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.overdraw=t.overdraw,this.visible=t.visible,this.userData=JSON.parse(JSON.stringify(t.userData)),this.clipShadows=t.clipShadows,this.clipIntersection=t.clipIntersection;var e=t.clippingPlanes,n=null;if(null!==e){var r=e.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=e[i].clone()}return this.clippingPlanes=n,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),br.prototype=Object.create(yr.prototype),br.prototype.constructor=br,br.prototype.isMeshDepthMaterial=!0,br.prototype.copy=function(t){return yr.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},_r.prototype=Object.create(yr.prototype),_r.prototype.constructor=_r,_r.prototype.isMeshDistanceMaterial=!0,_r.prototype.copy=function(t){return yr.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this},Object.assign(xr.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,u=t.length;s<u;s+=3){var l=t[s],c=t[s+1],h=t[s+2];l<e&&(e=l),c<n&&(n=c),h<r&&(r=h),l>i&&(i=l),c>o&&(o=c),h>a&&(a=h)}return this.min.set(e,n,r),this.max.set(i,o,a),this},setFromBufferAttribute:function(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,u=t.count;s<u;s++){var l=t.getX(s),c=t.getY(s),h=t.getZ(s);l<e&&(e=l),c<n&&(n=c),h<r&&(r=h),l>i&&(i=l),c>o&&(o=c),h>a&&(a=h)}return this.min.set(e,n,r),this.max.set(i,o,a),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:(ir=new We,function(t,e){var n=ir.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}),setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){var e=t||new We;return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){var e=t||new We;return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(){var t,e,n,r=new We;function i(i){var o=i.geometry;if(void 0!==o)if(o.isGeometry){var a=o.vertices;for(e=0,n=a.length;e<n;e++)r.copy(a[e]),r.applyMatrix4(i.matrixWorld),t.expandByPoint(r)}else if(o.isBufferGeometry){var s=o.attributes.position;if(void 0!==s)for(e=0,n=s.count;e<n;e++)r.fromBufferAttribute(s,e).applyMatrix4(i.matrixWorld),t.expandByPoint(r)}}return function(e){return t=this,e.updateMatrixWorld(!0),e.traverse(i),this}}(),containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return(e||new We).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:(rr=new We,function(t){return this.clampPoint(t.center,rr),rr.distanceToSquared(t.center)<=t.radius*t.radius}),intersectsPlane:function(t){var e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=t.constant&&n>=t.constant},clampPoint:function(t,e){return(e||new We).copy(t).clamp(this.min,this.max)},distanceToPoint:(nr=new We,function(t){return nr.copy(t).clamp(this.min,this.max).sub(t).length()}),getBoundingSphere:(er=new We,function(t){var e=t||new wr;return this.getCenter(e.center),e.radius=.5*this.getSize(er).length(),e}),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:(tr=[new We,new We,new We,new We,new We,new We,new We,new We],function(t){return this.isEmpty()?this:(tr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),tr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),tr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),tr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),tr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),tr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),tr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),tr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(tr),this)}),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),Object.assign(wr.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:(or=new xr,function(t,e){var n=this.center;void 0!==e?n.copy(e):or.setFromPoints(t).getCenter(n);for(var r=0,i=0,o=t.length;i<o;i++)r=Math.max(r,n.distanceToSquared(t[i]));return this.radius=Math.sqrt(r),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,e){var n=this.center.distanceToSquared(t),r=e||new We;return r.copy(t),n>this.radius*this.radius&&(r.sub(this.center).normalize(),r.multiplyScalar(this.radius).add(this.center)),r},getBoundingBox:function(t){var e=t||new xr;return e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}}),Object.assign(Er.prototype,{set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:(lr=new We,cr=new We,function(t,e,n){var r=lr.subVectors(n,e).cross(cr.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return(e||new We).copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:(ur=new We,function(t,e){var n=e||new We,r=t.delta(ur),i=this.normal.dot(r);if(0===i)return 0===this.distanceToPoint(t.start)?n.copy(t.start):void 0;var o=-(t.start.dot(this.normal)+this.constant)/i;return o<0||o>1?void 0:n.copy(r).multiplyScalar(o).add(t.start)}),intersectsLine:function(t){var e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return(t||new We).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:(ar=new We,sr=new qe,function(t,e){var n=e||sr.getNormalMatrix(t),r=this.coplanarPoint(ar).applyMatrix4(t),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}),translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}}),Object.assign(Sr.prototype,{set:function(t,e,n,r,i,o){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(r),a[4].copy(i),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,n=0;n<6;n++)e[n].copy(t.planes[n]);return this},setFromMatrix:function(t){var e=this.planes,n=t.elements,r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],l=n[6],c=n[7],h=n[8],p=n[9],f=n[10],d=n[11],m=n[12],g=n[13],v=n[14],y=n[15];return e[0].setComponents(a-r,c-s,d-h,y-m).normalize(),e[1].setComponents(a+r,c+s,d+h,y+m).normalize(),e[2].setComponents(a+i,c+u,d+p,y+g).normalize(),e[3].setComponents(a-i,c-u,d-p,y-g).normalize(),e[4].setComponents(a-o,c-l,d-f,y-v).normalize(),e[5].setComponents(a+o,c+l,d+f,y+v).normalize(),this},intersectsObject:(dr=new wr,function(t){var e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),dr.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(dr)}),intersectsSprite:(fr=new wr,function(t){return fr.center.set(0,0,0),fr.radius=.7071067811865476,fr.applyMatrix4(t.matrixWorld),this.intersectsSphere(fr)}),intersectsSphere:function(t){for(var e=this.planes,n=t.center,r=-t.radius,i=0;i<6;i++){if(e[i].distanceToPoint(n)<r)return!1}return!0},intersectsBox:(hr=new We,pr=new We,function(t){for(var e=this.planes,n=0;n<6;n++){var r=e[n];hr.x=r.normal.x>0?t.min.x:t.max.x,pr.x=r.normal.x>0?t.max.x:t.min.x,hr.y=r.normal.y>0?t.min.y:t.max.y,pr.y=r.normal.y>0?t.max.y:t.min.y,hr.z=r.normal.z>0?t.min.z:t.max.z,pr.z=r.normal.z>0?t.max.z:t.min.z;var i=r.distanceToPoint(hr),o=r.distanceToPoint(pr);if(i<0&&o<0)return!1}return!0}),containsPoint:function(t){for(var e=this.planes,n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}}),Ar.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Ar.DefaultOrder="XYZ",Object.defineProperties(Ar.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this.onChangeCallback()}}}),Object.assign(Ar.prototype,{isEuler:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._order=r||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,e,n){var r=ze.clamp,i=t.elements,o=i[0],a=i[4],s=i[8],u=i[1],l=i[5],c=i[9],h=i[2],p=i[6],f=i[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(r(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-c,f),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(p,l),this._z=0)):"YXZ"===e?(this._x=Math.asin(-r(c,-1,1)),Math.abs(c)<.99999?(this._y=Math.atan2(s,f),this._z=Math.atan2(u,l)):(this._y=Math.atan2(-h,o),this._z=0)):"ZXY"===e?(this._x=Math.asin(r(p,-1,1)),Math.abs(p)<.99999?(this._y=Math.atan2(-h,f),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(u,o))):"ZYX"===e?(this._y=Math.asin(-r(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(p,f),this._z=Math.atan2(u,o)):(this._x=0,this._z=Math.atan2(-a,l))):"YZX"===e?(this._z=Math.asin(r(u,-1,1)),Math.abs(u)<.99999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(s,f))):"XZY"===e?(this._z=Math.asin(-r(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(p,l),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-c,f),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==n&&this.onChangeCallback(),this},setFromQuaternion:(gr=new He,function(t,e,n){return gr.makeRotationFromQuaternion(t),this.setFromRotationMatrix(gr,e,n)}),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:(mr=new Ve,function(t){return mr.setFromEuler(this),this.setFromQuaternion(mr,t)}),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new We(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),Object.assign(Mr.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},test:function(t){return 0!=(this.mask&t.mask)}});var Cr,kr,Pr,Rr,Lr,Ir,Dr,Nr,jr,Ur,Fr,Br,zr,Gr,Hr,Vr,Wr,qr,Xr,Yr=0;function $r(){Object.defineProperty(this,"id",{value:Yr++}),this.uuid=ze.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=$r.DefaultUp.clone();var t=new We,e=new Ar,n=new Ve,r=new We(1,1,1);e.onChange(function(){n.setFromEuler(e,!1)}),n.onChange(function(){e.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:t},rotation:{enumerable:!0,value:e},quaternion:{enumerable:!0,value:n},scale:{enumerable:!0,value:r},modelViewMatrix:{value:new He},normalMatrix:{value:new qe}}),this.matrix=new He,this.matrixWorld=new He,this.matrixAutoUpdate=$r.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Mr,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function Zr(){$r.call(this),this.type="Camera",this.matrixWorldInverse=new He,this.projectionMatrix=new He}function Jr(t,e,n,r,i,o){Zr.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=r,this.near=void 0!==i?i:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function Kr(t,e,n,r,i,o){this.a=t,this.b=e,this.c=n,this.normal=r&&r.isVector3?r:new We,this.vertexNormals=Array.isArray(r)?r:[],this.color=i&&i.isColor?i:new Hn,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==o?o:0}$r.DefaultUp=new We(0,1,0),$r.DefaultMatrixAutoUpdate=!0,$r.prototype=Object.assign(Object.create(r.prototype),{constructor:$r,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:(qr=new Ve,function(t,e){return qr.setFromAxisAngle(t,e),this.quaternion.multiply(qr),this}),rotateOnWorldAxis:(Wr=new Ve,function(t,e){return Wr.setFromAxisAngle(t,e),this.quaternion.premultiply(Wr),this}),rotateX:(Vr=new We(1,0,0),function(t){return this.rotateOnAxis(Vr,t)}),rotateY:(Hr=new We(0,1,0),function(t){return this.rotateOnAxis(Hr,t)}),rotateZ:(Gr=new We(0,0,1),function(t){return this.rotateOnAxis(Gr,t)}),translateOnAxis:(zr=new We,function(t,e){return zr.copy(t).applyQuaternion(this.quaternion),this.position.add(zr.multiplyScalar(e)),this}),translateX:(Br=new We(1,0,0),function(t){return this.translateOnAxis(Br,t)}),translateY:(Fr=new We(0,1,0),function(t){return this.translateOnAxis(Fr,t)}),translateZ:(Ur=new We(0,0,1),function(t){return this.translateOnAxis(Ur,t)}),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:(jr=new He,function(t){return t.applyMatrix4(jr.getInverse(this.matrixWorld))}),lookAt:(Dr=new He,Nr=new We,function(t,e,n){t.isVector3?Nr.copy(t):Nr.set(t,e,n),this.isCamera?Dr.lookAt(this.position,Nr,this.up):Dr.lookAt(Nr,this.position,this.up),this.quaternion.setFromRotationMatrix(Dr)}),add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}var n=this.children.indexOf(t);return-1!==n&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(n,1)),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(t,e);if(void 0!==i)return i}},getWorldPosition:function(t){var e=t||new We;return this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:(Lr=new We,Ir=new We,function(t){var e=t||new Ve;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(Lr,e,Ir),e}),getWorldRotation:(Rr=new Ve,function(t){var e=t||new Ar;return this.getWorldQuaternion(Rr),e.setFromQuaternion(Rr,this.rotation.order,!1)}),getWorldScale:(kr=new We,Pr=new Ve,function(t){var e=t||new We;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(kr,Pr,e),e}),getWorldDirection:(Cr=new Ve,function(t){var e=t||new We;return this.getWorldQuaternion(Cr),e.set(0,0,1).applyQuaternion(Cr)}),raycast:function(){},traverse:function(t){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].updateMatrixWorld(t)},toJSON:function(t){var e=void 0===t||"string"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.matrix=this.matrix.toArray(),void 0!==this.geometry){r.geometry=i(t.geometries,this.geometry);var o=this.geometry.parameters;if(void 0!==o&&void 0!==o.shapes){var a=o.shapes;if(Array.isArray(a))for(var s=0,u=a.length;s<u;s++){var l=a[s];i(t.shapes,l)}else i(t.shapes,a)}}if(void 0!==this.material)if(Array.isArray(this.material)){var c=[];for(s=0,u=this.material.length;s<u;s++)c.push(i(t.materials,this.material[s]));r.material=c}else r.material=i(t.materials,this.material);if(this.children.length>0){r.children=[];for(s=0;s<this.children.length;s++)r.children.push(this.children[s].toJSON(t).object)}if(e){var h=m(t.geometries),p=m(t.materials),f=m(t.textures),d=m(t.images);a=m(t.shapes);h.length>0&&(n.geometries=h),p.length>0&&(n.materials=p),f.length>0&&(n.textures=f),d.length>0&&(n.images=d),a.length>0&&(n.shapes=a)}return n.object=r,n;function m(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var n=0;n<t.children.length;n++){var r=t.children[n];this.add(r.clone())}return this}}),Zr.prototype=Object.assign(Object.create($r.prototype),{constructor:Zr,isCamera:!0,copy:function(t,e){return $r.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this},getWorldDirection:(Xr=new Ve,function(t){var e=t||new We;return this.getWorldQuaternion(Xr),e.set(0,0,-1).applyQuaternion(Xr)}),updateMatrixWorld:function(t){$r.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),Jr.prototype=Object.assign(Object.create(Zr.prototype),{constructor:Jr,isOrthographicCamera:!0,copy:function(t,e){return Zr.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-t,o=n+t,a=r+e,s=r-e;if(null!==this.view&&this.view.enabled){var u=this.zoom/(this.view.width/this.view.fullWidth),l=this.zoom/(this.view.height/this.view.fullHeight),c=(this.right-this.left)/this.view.width,h=(this.top-this.bottom)/this.view.height;o=(i+=c*(this.view.offsetX/u))+c*(this.view.width/u),s=(a-=h*(this.view.offsetY/l))-h*(this.view.height/l)}this.projectionMatrix.makeOrthographic(i,o,a,s,this.near,this.far)},toJSON:function(t){var e=$r.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}),Object.assign(Kr.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}});var Qr,ti,ei,ni,ri,ii,oi=0;function ai(){Object.defineProperty(this,"id",{value:oi+=2}),this.uuid=ze.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function si(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.uuid=ze.generateUUID(),this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function ui(t,e,n){si.call(this,new Int8Array(t),e,n)}function li(t,e,n){si.call(this,new Uint8Array(t),e,n)}function ci(t,e,n){si.call(this,new Uint8ClampedArray(t),e,n)}function hi(t,e,n){si.call(this,new Int16Array(t),e,n)}function pi(t,e,n){si.call(this,new Uint16Array(t),e,n)}function fi(t,e,n){si.call(this,new Int32Array(t),e,n)}function di(t,e,n){si.call(this,new Uint32Array(t),e,n)}function mi(t,e,n){si.call(this,new Float32Array(t),e,n)}function gi(t,e,n){si.call(this,new Float64Array(t),e,n)}function vi(){this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function yi(t){if(0===t.length)return-1/0;for(var e=t[0],n=1,r=t.length;n<r;++n)t[n]>e&&(e=t[n]);return e}ai.prototype=Object.assign(Object.create(r.prototype),{constructor:ai,isGeometry:!0,applyMatrix:function(t){for(var e=(new qe).getNormalMatrix(t),n=0,r=this.vertices.length;n<r;n++){this.vertices[n].applyMatrix4(t)}for(n=0,r=this.faces.length;n<r;n++){var i=this.faces[n];i.normal.applyMatrix3(e).normalize();for(var o=0,a=i.vertexNormals.length;o<a;o++)i.vertexNormals[o].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:(ii=new He,function(t){return ii.makeRotationX(t),this.applyMatrix(ii),this}),rotateY:(ri=new He,function(t){return ri.makeRotationY(t),this.applyMatrix(ri),this}),rotateZ:(ni=new He,function(t){return ni.makeRotationZ(t),this.applyMatrix(ni),this}),translate:(ei=new He,function(t,e,n){return ei.makeTranslation(t,e,n),this.applyMatrix(ei),this}),scale:(ti=new He,function(t,e,n){return ti.makeScale(t,e,n),this.applyMatrix(ti),this}),lookAt:(Qr=new $r,function(t){Qr.lookAt(t),Qr.updateMatrix(),this.applyMatrix(Qr.matrix)}),fromBufferGeometry:function(t){var e=this,n=null!==t.index?t.index.array:void 0,r=t.attributes,i=r.position.array,o=void 0!==r.normal?r.normal.array:void 0,a=void 0!==r.color?r.color.array:void 0,s=void 0!==r.uv?r.uv.array:void 0,u=void 0!==r.uv2?r.uv2.array:void 0;void 0!==u&&(this.faceVertexUvs[1]=[]);for(var l=[],c=[],h=[],p=0,f=0;p<i.length;p+=3,f+=2)e.vertices.push(new We(i[p],i[p+1],i[p+2])),void 0!==o&&l.push(new We(o[p],o[p+1],o[p+2])),void 0!==a&&e.colors.push(new Hn(a[p],a[p+1],a[p+2])),void 0!==s&&c.push(new Ge(s[f],s[f+1])),void 0!==u&&h.push(new Ge(u[f],u[f+1]));function d(t,n,r,i){var p=new Kr(t,n,r,void 0!==o?[l[t].clone(),l[n].clone(),l[r].clone()]:[],void 0!==a?[e.colors[t].clone(),e.colors[n].clone(),e.colors[r].clone()]:[],i);e.faces.push(p),void 0!==s&&e.faceVertexUvs[0].push([c[t].clone(),c[n].clone(),c[r].clone()]),void 0!==u&&e.faceVertexUvs[1].push([h[t].clone(),h[n].clone(),h[r].clone()])}var m=t.groups;if(m.length>0)for(p=0;p<m.length;p++)for(var g=m[p],v=g.start,y=(f=v,v+g.count);f<y;f+=3)void 0!==n?d(n[f],n[f+1],n[f+2],g.materialIndex):d(f,f+1,f+2,g.materialIndex);else if(void 0!==n)for(p=0;p<n.length;p+=3)d(n[p],n[p+1],n[p+2]);else for(p=0;p<i.length/3;p+=3)d(p,p+1,p+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var t=this.boundingBox.getCenter().negate();return this.translate(t.x,t.y,t.z),t},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,n=0===e?1:1/e,r=new He;return r.set(n,0,0,-n*t.x,0,n,0,-n*t.y,0,0,n,-n*t.z,0,0,0,1),this.applyMatrix(r),this},computeFaceNormals:function(){for(var t=new We,e=new We,n=0,r=this.faces.length;n<r;n++){var i=this.faces[n],o=this.vertices[i.a],a=this.vertices[i.b],s=this.vertices[i.c];t.subVectors(s,a),e.subVectors(o,a),t.cross(e),t.normalize(),i.normal.copy(t)}},computeVertexNormals:function(t){var e,n,r,i,o,a;for(void 0===t&&(t=!0),a=new Array(this.vertices.length),e=0,n=this.vertices.length;e<n;e++)a[e]=new We;if(t){var s,u,l,c=new We,h=new We;for(r=0,i=this.faces.length;r<i;r++)o=this.faces[r],s=this.vertices[o.a],u=this.vertices[o.b],l=this.vertices[o.c],c.subVectors(l,u),h.subVectors(s,u),c.cross(h),a[o.a].add(c),a[o.b].add(c),a[o.c].add(c)}else for(this.computeFaceNormals(),r=0,i=this.faces.length;r<i;r++)a[(o=this.faces[r]).a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(e=0,n=this.vertices.length;e<n;e++)a[e].normalize();for(r=0,i=this.faces.length;r<i;r++){var p=(o=this.faces[r]).vertexNormals;3===p.length?(p[0].copy(a[o.a]),p[1].copy(a[o.b]),p[2].copy(a[o.c])):(p[0]=a[o.a].clone(),p[1]=a[o.b].clone(),p[2]=a[o.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t,e,n;for(this.computeFaceNormals(),t=0,e=this.faces.length;t<e;t++){var r=(n=this.faces[t]).vertexNormals;3===r.length?(r[0].copy(n.normal),r[1].copy(n.normal),r[2].copy(n.normal)):(r[0]=n.normal.clone(),r[1]=n.normal.clone(),r[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,n,r,i;for(n=0,r=this.faces.length;n<r;n++)for((i=this.faces[n]).__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),t=0,e=i.vertexNormals.length;t<e;t++)i.__originalVertexNormals[t]?i.__originalVertexNormals[t].copy(i.vertexNormals[t]):i.__originalVertexNormals[t]=i.vertexNormals[t].clone();var o=new ai;for(o.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var a=this.morphNormals[t].faceNormals,s=this.morphNormals[t].vertexNormals;for(n=0,r=this.faces.length;n<r;n++)u=new We,l={a:new We,b:new We,c:new We},a.push(u),s.push(l)}var u,l,c=this.morphNormals[t];for(o.vertices=this.morphTargets[t].vertices,o.computeFaceNormals(),o.computeVertexNormals(),n=0,r=this.faces.length;n<r;n++)i=this.faces[n],u=c.faceNormals[n],l=c.vertexNormals[n],u.copy(i.normal),l.a.copy(i.vertexNormals[0]),l.b.copy(i.vertexNormals[1]),l.c.copy(i.vertexNormals[2])}for(n=0,r=this.faces.length;n<r;n++)(i=this.faces[n]).normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeLineDistances:function(){for(var t=0,e=this.vertices,n=0,r=e.length;n<r;n++)n>0&&(t+=e[n].distanceTo(e[n-1])),this.lineDistances[n]=t},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new xr),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new wr),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,n){if(t&&t.isGeometry){var r,i=this.vertices.length,o=this.vertices,a=t.vertices,s=this.faces,u=t.faces,l=this.faceVertexUvs[0],c=t.faceVertexUvs[0],h=this.colors,p=t.colors;void 0===n&&(n=0),void 0!==e&&(r=(new qe).getNormalMatrix(e));for(var f=0,d=a.length;f<d;f++){var m=a[f].clone();void 0!==e&&m.applyMatrix4(e),o.push(m)}for(f=0,d=p.length;f<d;f++)h.push(p[f].clone());for(f=0,d=u.length;f<d;f++){var g,v,y,b=u[f],_=b.vertexNormals,x=b.vertexColors;(g=new Kr(b.a+i,b.b+i,b.c+i)).normal.copy(b.normal),void 0!==r&&g.normal.applyMatrix3(r).normalize();for(var w=0,E=_.length;w<E;w++)v=_[w].clone(),void 0!==r&&v.applyMatrix3(r).normalize(),g.vertexNormals.push(v);g.color.copy(b.color);for(w=0,E=x.length;w<E;w++)y=x[w],g.vertexColors.push(y.clone());g.materialIndex=b.materialIndex+n,s.push(g)}for(f=0,d=c.length;f<d;f++){var S=c[f],T=[];if(void 0!==S){for(w=0,E=S.length;w<E;w++)T.push(S[w].clone());l.push(T)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t)},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){var t,e,n,r,i,o,a,s,u={},l=[],c=[],h=Math.pow(10,4);for(n=0,r=this.vertices.length;n<r;n++)t=this.vertices[n],void 0===u[e=Math.round(t.x*h)+"_"+Math.round(t.y*h)+"_"+Math.round(t.z*h)]?(u[e]=n,l.push(this.vertices[n]),c[n]=l.length-1):c[n]=c[u[e]];var p=[];for(n=0,r=this.faces.length;n<r;n++){(i=this.faces[n]).a=c[i.a],i.b=c[i.b],i.c=c[i.c],o=[i.a,i.b,i.c];for(var f=0;f<3;f++)if(o[f]===o[(f+1)%3]){p.push(n);break}}for(n=p.length-1;n>=0;n--){var d=p[n];for(this.faces.splice(d,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(d,1)}var m=this.vertices.length-l.length;return this.vertices=l,m},setFromPoints:function(t){this.vertices=[];for(var e=0,n=t.length;e<n;e++){var r=t[e];this.vertices.push(new We(r.x,r.y,r.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,n=0;n<e;n++)t[n]._id=n;t.sort(function(t,e){return t.materialIndex-e.materialIndex});var r,i,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];o&&o.length===e&&(r=[]),a&&a.length===e&&(i=[]);for(n=0;n<e;n++){var s=t[n]._id;r&&r.push(o[s]),i&&i.push(a[s])}r&&(this.faceVertexUvs[0]=r),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){var t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}for(var r=[],i=0;i<this.vertices.length;i++){var o=this.vertices[i];r.push(o.x,o.y,o.z)}var a=[],s=[],u={},l=[],c={},h=[],p={};for(i=0;i<this.faces.length;i++){var f=this.faces[i],d=void 0!==this.faceVertexUvs[0][i],m=f.normal.length()>0,g=f.vertexNormals.length>0,v=1!==f.color.r||1!==f.color.g||1!==f.color.b,y=f.vertexColors.length>0,b=0;if(b=E(b=E(b=E(b=E(b=E(b=E(b=E(b=E(b,0,0),1,!0),2,!1),3,d),4,m),5,g),6,v),7,y),a.push(b),a.push(f.a,f.b,f.c),a.push(f.materialIndex),d){var _=this.faceVertexUvs[0][i];a.push(O(_[0]),O(_[1]),O(_[2]))}if(m&&a.push(S(f.normal)),g){var x=f.vertexNormals;a.push(S(x[0]),S(x[1]),S(x[2]))}if(v&&a.push(T(f.color)),y){var w=f.vertexColors;a.push(T(w[0]),T(w[1]),T(w[2]))}}function E(t,e,n){return n?t|1<<e:t&~(1<<e)}function S(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==u[e]?u[e]:(u[e]=s.length/3,s.push(t.x,t.y,t.z),u[e])}function T(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==c[e]?c[e]:(c[e]=l.length,l.push(t.getHex()),c[e])}function O(t){var e=t.x.toString()+t.y.toString();return void 0!==p[e]?p[e]:(p[e]=h.length/2,h.push(t.x,t.y),p[e])}return t.data={},t.data.vertices=r,t.data.normals=s,l.length>0&&(t.data.colors=l),h.length>0&&(t.data.uvs=[h]),t.data.faces=a,t},clone:function(){return(new ai).copy(this)},copy:function(t){var e,n,r,i,o,a;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var s=t.vertices;for(e=0,n=s.length;e<n;e++)this.vertices.push(s[e].clone());var u=t.colors;for(e=0,n=u.length;e<n;e++)this.colors.push(u[e].clone());var l=t.faces;for(e=0,n=l.length;e<n;e++)this.faces.push(l[e].clone());for(e=0,n=t.faceVertexUvs.length;e<n;e++){var c=t.faceVertexUvs[e];for(void 0===this.faceVertexUvs[e]&&(this.faceVertexUvs[e]=[]),r=0,i=c.length;r<i;r++){var h=c[r],p=[];for(o=0,a=h.length;o<a;o++){var f=h[o];p.push(f.clone())}this.faceVertexUvs[e].push(p)}}var d=t.morphTargets;for(e=0,n=d.length;e<n;e++){var m={};if(m.name=d[e].name,void 0!==d[e].vertices)for(m.vertices=[],r=0,i=d[e].vertices.length;r<i;r++)m.vertices.push(d[e].vertices[r].clone());if(void 0!==d[e].normals)for(m.normals=[],r=0,i=d[e].normals.length;r<i;r++)m.normals.push(d[e].normals[r].clone());this.morphTargets.push(m)}var g=t.morphNormals;for(e=0,n=g.length;e<n;e++){var v={};if(void 0!==g[e].vertexNormals)for(v.vertexNormals=[],r=0,i=g[e].vertexNormals.length;r<i;r++){var y=g[e].vertexNormals[r],b={};b.a=y.a.clone(),b.b=y.b.clone(),b.c=y.c.clone(),v.vertexNormals.push(b)}if(void 0!==g[e].faceNormals)for(v.faceNormals=[],r=0,i=g[e].faceNormals.length;r<i;r++)v.faceNormals.push(g[e].faceNormals[r].clone());this.morphNormals.push(v)}var _=t.skinWeights;for(e=0,n=_.length;e<n;e++)this.skinWeights.push(_[e].clone());var x=t.skinIndices;for(e=0,n=x.length;e<n;e++)this.skinIndices.push(x[e].clone());var w=t.lineDistances;for(e=0,n=w.length;e<n;e++)this.lineDistances.push(w[e]);var E=t.boundingBox;null!==E&&(this.boundingBox=E.clone());var S=t.boundingSphere;return null!==S&&(this.boundingSphere=S.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(si.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(si.prototype,{isBufferAttribute:!0,setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==t?t.length/this.itemSize:0,this.array=t},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.dynamic=t.dynamic,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[t+r]=e.array[n+r];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),o=new Hn),e[n++]=o.r,e[n++]=o.g,e[n++]=o.b}return this},copyIndicesArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];e[n++]=o.a,e[n++]=o.b,e[n++]=o.c}return this},copyVector2sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new Ge),e[n++]=o.x,e[n++]=o.y}return this},copyVector3sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new We),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z}return this},copyVector4sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),o=new Je),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z,e[n++]=o.w}return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=i,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),ui.prototype=Object.create(si.prototype),ui.prototype.constructor=ui,li.prototype=Object.create(si.prototype),li.prototype.constructor=li,ci.prototype=Object.create(si.prototype),ci.prototype.constructor=ci,hi.prototype=Object.create(si.prototype),hi.prototype.constructor=hi,pi.prototype=Object.create(si.prototype),pi.prototype.constructor=pi,fi.prototype=Object.create(si.prototype),fi.prototype.constructor=fi,di.prototype=Object.create(si.prototype),di.prototype.constructor=di,mi.prototype=Object.create(si.prototype),mi.prototype.constructor=mi,gi.prototype=Object.create(si.prototype),gi.prototype.constructor=gi,Object.assign(vi.prototype,{computeGroups:function(t){for(var e,n=[],r=void 0,i=t.faces,o=0;o<i.length;o++){var a=i[o];a.materialIndex!==r&&(r=a.materialIndex,void 0!==e&&(e.count=3*o-e.start,n.push(e)),e={start:3*o,materialIndex:r})}void 0!==e&&(e.count=3*o-e.start,n.push(e)),this.groups=n},fromGeometry:function(t){var e,n=t.faces,r=t.vertices,i=t.faceVertexUvs,o=i[0]&&i[0].length>0,a=i[1]&&i[1].length>0,s=t.morphTargets,u=s.length;if(u>0){e=[];for(var l=0;l<u;l++)e[l]=[];this.morphTargets.position=e}var c,h=t.morphNormals,p=h.length;if(p>0){c=[];for(l=0;l<p;l++)c[l]=[];this.morphTargets.normal=c}var f=t.skinIndices,d=t.skinWeights,m=f.length===r.length,g=d.length===r.length;for(l=0;l<n.length;l++){var v=n[l];this.vertices.push(r[v.a],r[v.b],r[v.c]);var y=v.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var b=v.normal;this.normals.push(b,b,b)}var _,x=v.vertexColors;if(3===x.length)this.colors.push(x[0],x[1],x[2]);else{var w=v.color;this.colors.push(w,w,w)}if(!0===o)void 0!==(_=i[0][l])?this.uvs.push(_[0],_[1],_[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",l),this.uvs.push(new Ge,new Ge,new Ge));if(!0===a)void 0!==(_=i[1][l])?this.uvs2.push(_[0],_[1],_[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",l),this.uvs2.push(new Ge,new Ge,new Ge));for(var E=0;E<u;E++){var S=s[E].vertices;e[E].push(S[v.a],S[v.b],S[v.c])}for(E=0;E<p;E++){var T=h[E].vertexNormals[l];c[E].push(T.a,T.b,T.c)}m&&this.skinIndices.push(f[v.a],f[v.b],f[v.c]),g&&this.skinWeights.push(d[v.a],d[v.b],d[v.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this}});var bi,_i,xi,wi,Ei,Si,Ti,Oi,Ai,Mi,Ci,ki,Pi,Ri,Li,Ii,Di,Ni,ji,Ui,Fi,Bi,zi,Gi,Hi,Vi,Wi,qi,Xi,Yi,$i,Zi,Ji,Ki=1;function Qi(){Object.defineProperty(this,"id",{value:Ki+=2}),this.uuid=ze.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}}function to(t,e,n,r,i,o){ai.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:o},this.fromBufferGeometry(new eo(t,e,n,r,i,o)),this.mergeVertices()}function eo(t,e,n,r,i,o){Qi.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:o};var a=this;t=t||1,e=e||1,n=n||1,r=Math.floor(r)||1,i=Math.floor(i)||1;var s=[],u=[],l=[],c=[],h=0,p=0;function f(t,e,n,r,i,o,f,d,m,g,v){var y,b,_=o/m,x=f/g,w=o/2,E=f/2,S=d/2,T=m+1,O=g+1,A=0,M=0,C=new We;for(b=0;b<O;b++){var k=b*x-E;for(y=0;y<T;y++){var P=y*_-w;C[t]=P*r,C[e]=k*i,C[n]=S,u.push(C.x,C.y,C.z),C[t]=0,C[e]=0,C[n]=d>0?1:-1,l.push(C.x,C.y,C.z),c.push(y/m),c.push(1-b/g),A+=1}}for(b=0;b<g;b++)for(y=0;y<m;y++){var R=h+y+T*b,L=h+y+T*(b+1),I=h+(y+1)+T*(b+1),D=h+(y+1)+T*b;s.push(R,L,D),s.push(L,I,D),M+=6}a.addGroup(p,M,v),p+=M,h+=A}f("z","y","x",-1,-1,n,e,t,o=Math.floor(o)||1,i,0),f("z","y","x",1,-1,n,e,-t,o,i,1),f("x","z","y",1,1,t,n,e,r,o,2),f("x","z","y",1,-1,t,n,-e,r,o,3),f("x","y","z",1,-1,t,e,n,r,i,4),f("x","y","z",-1,-1,t,e,-n,r,i,5),this.setIndex(s),this.addAttribute("position",new mi(u,3)),this.addAttribute("normal",new mi(l,3)),this.addAttribute("uv",new mi(c,2))}function no(t,e,n,r){ai.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r},this.fromBufferGeometry(new ro(t,e,n,r)),this.mergeVertices()}function ro(t,e,n,r){Qi.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r};var i,o,a=(t=t||1)/2,s=(e=e||1)/2,u=Math.floor(n)||1,l=Math.floor(r)||1,c=u+1,h=l+1,p=t/u,f=e/l,d=[],m=[],g=[],v=[];for(o=0;o<h;o++){var y=o*f-s;for(i=0;i<c;i++){var b=i*p-a;m.push(b,-y,0),g.push(0,0,1),v.push(i/u),v.push(1-o/l)}}for(o=0;o<l;o++)for(i=0;i<u;i++){var _=i+c*o,x=i+c*(o+1),w=i+1+c*(o+1),E=i+1+c*o;d.push(_,x,E),d.push(x,w,E)}this.setIndex(d),this.addAttribute("position",new mi(m,3)),this.addAttribute("normal",new mi(g,3)),this.addAttribute("uv",new mi(v,2))}function io(t){yr.call(this),this.type="MeshBasicMaterial",this.color=new Hn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=bt,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(t)}function oo(t){yr.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function ao(t,e){this.origin=void 0!==t?t:new We,this.direction=void 0!==e?e:new We}function so(t,e){this.start=void 0!==t?t:new We,this.end=void 0!==e?e:new We}function uo(t,e,n){this.a=void 0!==t?t:new We,this.b=void 0!==e?e:new We,this.c=void 0!==n?n:new We}function lo(t,e){$r.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new Qi,this.material=void 0!==e?e:new io({color:16777215*Math.random()}),this.drawMode=Me,this.updateMorphTargets()}function co(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program&&e.program&&t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function ho(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function po(){var t={};return{get:function(e,n){var r=e.id+","+n.id,i=t[r];return void 0===i&&(i=new function(){var t=[],e=0,n=[],r=[];return{opaque:n,transparent:r,init:function(){e=0,n.length=0,r.length=0},push:function(i,o,a,s,u){var l=t[e];void 0===l?(l={id:i.id,object:i,geometry:o,material:a,program:a.program,renderOrder:i.renderOrder,z:s,group:u},t[e]=l):(l.id=i.id,l.object=i,l.geometry=o,l.material=a,l.program=a.program,l.renderOrder=i.renderOrder,l.z=s,l.group=u),(!0===a.transparent?r:n).push(l),e++},sort:function(){n.length>1&&n.sort(co),r.length>1&&r.sort(ho)}}},t[r]=i),i},dispose:function(){t={}}}}function fo(t,e){return Math.abs(e[1])-Math.abs(t[1])}function mo(){var t=new function(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];var n;switch(e.type){case"DirectionalLight":n={direction:new We,color:new Hn,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Ge};break;case"SpotLight":n={position:new We,direction:new We,color:new Hn,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Ge};break;case"PointLight":n={position:new We,color:new Hn,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Ge,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":n={direction:new We,skyColor:new Hn,groundColor:new Hn};break;case"RectAreaLight":n={color:new Hn,position:new We,halfWidth:new We,halfHeight:new We}}return t[e.id]=n,n}}},e={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},n=new We,r=new He,i=new He;return{setup:function(o,a,s){for(var u=0,l=0,c=0,h=0,p=0,f=0,d=0,m=0,g=s.matrixWorldInverse,v=0,y=o.length;v<y;v++){var b=o[v],_=b.color,x=b.intensity,w=b.distance,E=b.shadow&&b.shadow.map?b.shadow.map.texture:null;if(b.isAmbientLight)u+=_.r*x,l+=_.g*x,c+=_.b*x;else if(b.isDirectionalLight){if((T=t.get(b)).color.copy(b.color).multiplyScalar(b.intensity),T.direction.setFromMatrixPosition(b.matrixWorld),n.setFromMatrixPosition(b.target.matrixWorld),T.direction.sub(n),T.direction.transformDirection(g),T.shadow=b.castShadow,b.castShadow){var S=b.shadow;T.shadowBias=S.bias,T.shadowRadius=S.radius,T.shadowMapSize=S.mapSize}e.directionalShadowMap[h]=E,e.directionalShadowMatrix[h]=b.shadow.matrix,e.directional[h]=T,h++}else if(b.isSpotLight)(T=t.get(b)).position.setFromMatrixPosition(b.matrixWorld),T.position.applyMatrix4(g),T.color.copy(_).multiplyScalar(x),T.distance=w,T.direction.setFromMatrixPosition(b.matrixWorld),n.setFromMatrixPosition(b.target.matrixWorld),T.direction.sub(n),T.direction.transformDirection(g),T.coneCos=Math.cos(b.angle),T.penumbraCos=Math.cos(b.angle*(1-b.penumbra)),T.decay=0===b.distance?0:b.decay,T.shadow=b.castShadow,b.castShadow&&(S=b.shadow,T.shadowBias=S.bias,T.shadowRadius=S.radius,T.shadowMapSize=S.mapSize),e.spotShadowMap[f]=E,e.spotShadowMatrix[f]=b.shadow.matrix,e.spot[f]=T,f++;else if(b.isRectAreaLight)(T=t.get(b)).color.copy(_).multiplyScalar(x/(b.width*b.height)),T.position.setFromMatrixPosition(b.matrixWorld),T.position.applyMatrix4(g),i.identity(),r.copy(b.matrixWorld),r.premultiply(g),i.extractRotation(r),T.halfWidth.set(.5*b.width,0,0),T.halfHeight.set(0,.5*b.height,0),T.halfWidth.applyMatrix4(i),T.halfHeight.applyMatrix4(i),e.rectArea[d]=T,d++;else if(b.isPointLight)(T=t.get(b)).position.setFromMatrixPosition(b.matrixWorld),T.position.applyMatrix4(g),T.color.copy(b.color).multiplyScalar(b.intensity),T.distance=b.distance,T.decay=0===b.distance?0:b.decay,T.shadow=b.castShadow,b.castShadow&&(S=b.shadow,T.shadowBias=S.bias,T.shadowRadius=S.radius,T.shadowMapSize=S.mapSize,T.shadowCameraNear=S.camera.near,T.shadowCameraFar=S.camera.far),e.pointShadowMap[p]=E,e.pointShadowMatrix[p]=b.shadow.matrix,e.point[p]=T,p++;else if(b.isHemisphereLight){var T;(T=t.get(b)).direction.setFromMatrixPosition(b.matrixWorld),T.direction.transformDirection(g),T.direction.normalize(),T.skyColor.copy(b.color).multiplyScalar(x),T.groundColor.copy(b.groundColor).multiplyScalar(x),e.hemi[m]=T,m++}}e.ambient[0]=u,e.ambient[1]=l,e.ambient[2]=c,e.directional.length=h,e.spot.length=f,e.rectArea.length=d,e.point.length=p,e.hemi.length=m,e.hash=h+","+p+","+f+","+d+","+m+","+a.length},state:e}}function go(t,e,n){var r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),!1===t.getShaderParameter(r,t.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==t.getShaderInfoLog(r)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",e===t.VERTEX_SHADER?"vertex":"fragment",t.getShaderInfoLog(r),function(t){for(var e=t.split("\n"),n=0;n<e.length;n++)e[n]=n+1+": "+e[n];return e.join("\n")}(n)),r}Qi.prototype=Object.assign(Object.create(r.prototype),{constructor:Qi,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(yi(t)>65535?di:pi)(t,1):this.index=t},addAttribute:function(t,e){return e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),void this.setIndex(e)):(this.attributes[t]=e,this):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void this.addAttribute(t,new si(arguments[1],arguments[2])))},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,n){this.groups.push({start:t,count:e,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var e=this.attributes.position;void 0!==e&&(t.applyToBufferAttribute(e),e.needsUpdate=!0);var n=this.attributes.normal;void 0!==n&&((new qe).getNormalMatrix(t).applyToBufferAttribute(n),n.needsUpdate=!0);return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:(Ai=new He,function(t){return Ai.makeRotationX(t),this.applyMatrix(Ai),this}),rotateY:(Oi=new He,function(t){return Oi.makeRotationY(t),this.applyMatrix(Oi),this}),rotateZ:(Ti=new He,function(t){return Ti.makeRotationZ(t),this.applyMatrix(Ti),this}),translate:(Si=new He,function(t,e,n){return Si.makeTranslation(t,e,n),this.applyMatrix(Si),this}),scale:(Ei=new He,function(t,e,n){return Ei.makeScale(t,e,n),this.applyMatrix(Ei),this}),lookAt:(wi=new $r,function(t){wi.lookAt(t),wi.updateMatrix(),this.applyMatrix(wi.matrix)}),center:function(){this.computeBoundingBox();var t=this.boundingBox.getCenter().negate();return this.translate(t.x,t.y,t.z),t},setFromObject:function(t){var e=t.geometry;if(t.isPoints||t.isLine){var n=new mi(3*e.vertices.length,3),r=new mi(3*e.colors.length,3);if(this.addAttribute("position",n.copyVector3sArray(e.vertices)),this.addAttribute("color",r.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var i=new mi(e.lineDistances.length,1);this.addAttribute("lineDistance",i.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},setFromPoints:function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];e.push(i.x,i.y,i.z||0)}return this.addAttribute("position",new mi(e,3)),this},updateFromObject:function(t){var e,n=t.geometry;if(t.isMesh){var r=n.__directGeometry;if(!0===n.elementsNeedUpdate&&(r=void 0,n.elementsNeedUpdate=!1),void 0===r)return this.fromGeometry(n);r.verticesNeedUpdate=n.verticesNeedUpdate,r.normalsNeedUpdate=n.normalsNeedUpdate,r.colorsNeedUpdate=n.colorsNeedUpdate,r.uvsNeedUpdate=n.uvsNeedUpdate,r.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=r}return!0===n.verticesNeedUpdate&&(void 0!==(e=this.attributes.position)&&(e.copyVector3sArray(n.vertices),e.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(e=this.attributes.normal)&&(e.copyVector3sArray(n.normals),e.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(e=this.attributes.color)&&(e.copyColorsArray(n.colors),e.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(e=this.attributes.uv)&&(e.copyVector2sArray(n.uvs),e.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(e=this.attributes.lineDistance)&&(e.copyArray(n.lineDistances),e.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(t.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new vi).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);if(this.addAttribute("position",new si(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){var n=new Float32Array(3*t.normals.length);this.addAttribute("normal",new si(n,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var r=new Float32Array(3*t.colors.length);this.addAttribute("color",new si(r,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var i=new Float32Array(2*t.uvs.length);this.addAttribute("uv",new si(i,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var o=new Float32Array(2*t.uvs2.length);this.addAttribute("uv2",new si(o,2).copyVector2sArray(t.uvs2))}if(t.indices.length>0){var a=new(yi(t.indices)>65535?Uint32Array:Uint16Array)(3*t.indices.length);this.setIndex(new si(a,1).copyIndicesArray(t.indices))}this.groups=t.groups;for(var s in t.morphTargets){for(var u=[],l=t.morphTargets[s],c=0,h=l.length;c<h;c++){var p=l[c],f=new mi(3*p.length,3);u.push(f.copyVector3sArray(p))}this.morphAttributes[s]=u}if(t.skinIndices.length>0){var d=new mi(4*t.skinIndices.length,4);this.addAttribute("skinIndex",d.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var m=new mi(4*t.skinWeights.length,4);this.addAttribute("skinWeight",m.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new xr);var t=this.attributes.position;void 0!==t?this.boundingBox.setFromBufferAttribute(t):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:(_i=new xr,xi=new We,function(){null===this.boundingSphere&&(this.boundingSphere=new wr);var t=this.attributes.position;if(t){var e=this.boundingSphere.center;_i.setFromBufferAttribute(t),_i.getCenter(e);for(var n=0,r=0,i=t.count;r<i;r++)xi.x=t.getX(r),xi.y=t.getY(r),xi.z=t.getZ(r),n=Math.max(n,e.distanceToSquared(xi));this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes,n=this.groups;if(e.position){var r=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new si(new Float32Array(r.length),3));else for(var i=e.normal.array,o=0,a=i.length;o<a;o++)i[o]=0;var s,u,l,c=e.normal.array,h=new We,p=new We,f=new We,d=new We,m=new We;if(t){var g=t.array;0===n.length&&this.addGroup(0,g.length);for(var v=0,y=n.length;v<y;++v){var b=n[v],_=b.start;for(o=_,a=_+b.count;o<a;o+=3)s=3*g[o+0],u=3*g[o+1],l=3*g[o+2],h.fromArray(r,s),p.fromArray(r,u),f.fromArray(r,l),d.subVectors(f,p),m.subVectors(h,p),d.cross(m),c[s]+=d.x,c[s+1]+=d.y,c[s+2]+=d.z,c[u]+=d.x,c[u+1]+=d.y,c[u+2]+=d.z,c[l]+=d.x,c[l+1]+=d.y,c[l+2]+=d.z}}else for(o=0,a=r.length;o<a;o+=9)h.fromArray(r,o),p.fromArray(r,o+3),f.fromArray(r,o+6),d.subVectors(f,p),m.subVectors(h,p),d.cross(m),c[o]=d.x,c[o+1]=d.y,c[o+2]=d.z,c[o+3]=d.x,c[o+4]=d.y,c[o+5]=d.z,c[o+6]=d.x,c[o+7]=d.y,c[o+8]=d.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0);var n=this.attributes;for(var r in n)if(void 0!==t.attributes[r])for(var i=n[r].array,o=t.attributes[r],a=o.array,s=0,u=o.itemSize*e;s<a.length;s++,u++)i[u]=a[s];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:(bi=new We,function(){for(var t=this.attributes.normal,e=0,n=t.count;e<n;e++)bi.x=t.getX(e),bi.y=t.getY(e),bi.z=t.getZ(e),bi.normalize(),t.setXYZ(e,bi.x,bi.y,bi.z)}),toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new Qi,e=this.index.array,n=this.attributes;for(var r in n){for(var i=n[r],o=i.array,a=i.itemSize,s=new o.constructor(e.length*a),u=0,l=0,c=0,h=e.length;c<h;c++){u=e[c]*a;for(var p=0;p<a;p++)s[l++]=o[u++]}t.addAttribute(r,new si(s,a))}return t},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};var r=this.index;if(null!==r){var i=Array.prototype.slice.call(r.array);t.data.index={type:r.array.constructor.name,array:i}}var o=this.attributes;for(var n in o){var a=o[n];i=Array.prototype.slice.call(a.array);t.data.attributes[n]={itemSize:a.itemSize,type:a.array.constructor.name,array:i,normalized:a.normalized}}var s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));var u=this.boundingSphere;return null!==u&&(t.data.boundingSphere={center:u.center.toArray(),radius:u.radius}),t},clone:function(){return(new Qi).copy(this)},copy:function(t){var e,n,r;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var i=t.index;null!==i&&this.setIndex(i.clone());var o=t.attributes;for(e in o){var a=o[e];this.addAttribute(e,a.clone())}var s=t.morphAttributes;for(e in s){var u=[],l=s[e];for(n=0,r=l.length;n<r;n++)u.push(l[n].clone());this.morphAttributes[e]=u}var c=t.groups;for(n=0,r=c.length;n<r;n++){var h=c[n];this.addGroup(h.start,h.count,h.materialIndex)}var p=t.boundingBox;null!==p&&(this.boundingBox=p.clone());var f=t.boundingSphere;return null!==f&&(this.boundingSphere=f.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),to.prototype=Object.create(ai.prototype),to.prototype.constructor=to,eo.prototype=Object.create(Qi.prototype),eo.prototype.constructor=eo,no.prototype=Object.create(ai.prototype),no.prototype.constructor=no,ro.prototype=Object.create(Qi.prototype),ro.prototype.constructor=ro,io.prototype=Object.create(yr.prototype),io.prototype.constructor=io,io.prototype.isMeshBasicMaterial=!0,io.prototype.copy=function(t){return yr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},oo.prototype=Object.create(yr.prototype),oo.prototype.constructor=oo,oo.prototype.isShaderMaterial=!0,oo.prototype.copy=function(t){return yr.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Xn.clone(t.uniforms),this.defines=t.defines,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},oo.prototype.toJSON=function(t){var e=yr.prototype.toJSON.call(this,t);return e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e},Object.assign(ao.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return(e||new We).copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:(Ui=new We,function(t){return this.origin.copy(this.at(t,Ui)),this}),closestPointToPoint:function(t,e){var n=e||new We;n.subVectors(t,this.origin);var r=n.dot(this.direction);return r<0?n.copy(this.origin):n.copy(this.direction).multiplyScalar(r).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:(ji=new We,function(t){var e=ji.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(ji.copy(this.direction).multiplyScalar(e).add(this.origin),ji.distanceToSquared(t))}),distanceSqToSegment:(Ii=new We,Di=new We,Ni=new We,function(t,e,n,r){Ii.copy(t).add(e).multiplyScalar(.5),Di.copy(e).sub(t).normalize(),Ni.copy(this.origin).sub(Ii);var i,o,a,s,u=.5*t.distanceTo(e),l=-this.direction.dot(Di),c=Ni.dot(this.direction),h=-Ni.dot(Di),p=Ni.lengthSq(),f=Math.abs(1-l*l);if(f>0)if(o=l*c-h,s=u*f,(i=l*h-c)>=0)if(o>=-s)if(o<=s){var d=1/f;a=(i*=d)*(i+l*(o*=d)+2*c)+o*(l*i+o+2*h)+p}else o=u,a=-(i=Math.max(0,-(l*o+c)))*i+o*(o+2*h)+p;else o=-u,a=-(i=Math.max(0,-(l*o+c)))*i+o*(o+2*h)+p;else o<=-s?a=-(i=Math.max(0,-(-l*u+c)))*i+(o=i>0?-u:Math.min(Math.max(-u,-h),u))*(o+2*h)+p:o<=s?(i=0,a=(o=Math.min(Math.max(-u,-h),u))*(o+2*h)+p):a=-(i=Math.max(0,-(l*u+c)))*i+(o=i>0?u:Math.min(Math.max(-u,-h),u))*(o+2*h)+p;else o=l>0?-u:u,a=-(i=Math.max(0,-(l*o+c)))*i+o*(o+2*h)+p;return n&&n.copy(this.direction).multiplyScalar(i).add(this.origin),r&&r.copy(Di).multiplyScalar(o).add(Ii),a}),intersectSphere:(Li=new We,function(t,e){Li.subVectors(t.center,this.origin);var n=Li.dot(this.direction),r=Li.dot(Li)-n*n,i=t.radius*t.radius;if(r>i)return null;var o=Math.sqrt(i-r),a=n-o,s=n+o;return a<0&&s<0?null:a<0?this.at(s,e):this.at(a,e)}),intersectsSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null},intersectPlane:function(t,e){var n=this.distanceToPlane(t);return null===n?null:this.at(n,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},intersectBox:function(t,e){var n,r,i,o,a,s,u=1/this.direction.x,l=1/this.direction.y,c=1/this.direction.z,h=this.origin;return u>=0?(n=(t.min.x-h.x)*u,r=(t.max.x-h.x)*u):(n=(t.max.x-h.x)*u,r=(t.min.x-h.x)*u),l>=0?(i=(t.min.y-h.y)*l,o=(t.max.y-h.y)*l):(i=(t.max.y-h.y)*l,o=(t.min.y-h.y)*l),n>o||i>r?null:((i>n||n!=n)&&(n=i),(o<r||r!=r)&&(r=o),c>=0?(a=(t.min.z-h.z)*c,s=(t.max.z-h.z)*c):(a=(t.max.z-h.z)*c,s=(t.min.z-h.z)*c),n>s||a>r?null:((a>n||n!=n)&&(n=a),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,e)))},intersectsBox:(Ri=new We,function(t){return null!==this.intersectBox(t,Ri)}),intersectTriangle:(Mi=new We,Ci=new We,ki=new We,Pi=new We,function(t,e,n,r,i){Ci.subVectors(e,t),ki.subVectors(n,t),Pi.crossVectors(Ci,ki);var o,a=this.direction.dot(Pi);if(a>0){if(r)return null;o=1}else{if(!(a<0))return null;o=-1,a=-a}Mi.subVectors(this.origin,t);var s=o*this.direction.dot(ki.crossVectors(Mi,ki));if(s<0)return null;var u=o*this.direction.dot(Ci.cross(Mi));if(u<0)return null;if(s+u>a)return null;var l=-o*Mi.dot(Pi);return l<0?null:this.at(l/a,i)}),applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}}),Object.assign(so.prototype,{set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return(t||new We).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return(t||new We).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){var n=e||new We;return this.delta(n).multiplyScalar(t).add(this.start)},closestPointToPointParameter:(Fi=new We,Bi=new We,function(t,e){Fi.subVectors(t,this.start),Bi.subVectors(this.end,this.start);var n=Bi.dot(Bi),r=Bi.dot(Fi)/n;return e&&(r=ze.clamp(r,0,1)),r}),closestPointToPoint:function(t,e,n){var r=this.closestPointToPointParameter(t,e),i=n||new We;return this.delta(i).multiplyScalar(r).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),Object.assign(uo,{normal:(Wi=new We,function(t,e,n,r){var i=r||new We;i.subVectors(n,e),Wi.subVectors(t,e),i.cross(Wi);var o=i.lengthSq();return o>0?i.multiplyScalar(1/Math.sqrt(o)):i.set(0,0,0)}),barycoordFromPoint:(Gi=new We,Hi=new We,Vi=new We,function(t,e,n,r,i){Gi.subVectors(r,e),Hi.subVectors(n,e),Vi.subVectors(t,e);var o=Gi.dot(Gi),a=Gi.dot(Hi),s=Gi.dot(Vi),u=Hi.dot(Hi),l=Hi.dot(Vi),c=o*u-a*a,h=i||new We;if(0===c)return h.set(-2,-1,-1);var p=1/c,f=(u*s-a*l)*p,d=(o*l-a*s)*p;return h.set(1-f-d,d,f)}),containsPoint:(zi=new We,function(t,e,n,r){var i=uo.barycoordFromPoint(t,e,n,r,zi);return i.x>=0&&i.y>=0&&i.x+i.y<=1})}),Object.assign(uo.prototype,{set:function(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this},setFromPointsAndIndices:function(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},area:(Zi=new We,Ji=new We,function(){return Zi.subVectors(this.c,this.b),Ji.subVectors(this.a,this.b),.5*Zi.cross(Ji).length()}),midpoint:function(t){return(t||new We).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(t){return uo.normal(this.a,this.b,this.c,t)},plane:function(t){return(t||new Er).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(t,e){return uo.barycoordFromPoint(t,this.a,this.b,this.c,e)},containsPoint:function(t){return uo.containsPoint(t,this.a,this.b,this.c)},closestPointToPoint:(qi=new Er,Xi=[new so,new so,new so],Yi=new We,$i=new We,function(t,e){var n=e||new We,r=1/0;if(qi.setFromCoplanarPoints(this.a,this.b,this.c),qi.projectPoint(t,Yi),!0===this.containsPoint(Yi))n.copy(Yi);else{Xi[0].set(this.a,this.b),Xi[1].set(this.b,this.c),Xi[2].set(this.c,this.a);for(var i=0;i<Xi.length;i++){Xi[i].closestPointToPoint(Yi,!0,$i);var o=Yi.distanceToSquared($i);o<r&&(r=o,n.copy($i))}}return n}),equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}),lo.prototype=Object.assign(Object.create($r.prototype),{constructor:lo,isMesh:!0,setDrawMode:function(t){this.drawMode=t},copy:function(t){return $r.prototype.copy.call(this,t),this.drawMode=t.drawMode,void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t,e,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,o=Object.keys(i);if(o.length>0){var a=i[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=a.length;t<e;t++)n=a[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}else{var s=r.morphTargets;if(void 0!==s&&s.length>0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=s.length;t<e;t++)n=s[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}},raycast:function(){var t=new He,e=new ao,n=new wr,r=new We,i=new We,o=new We,a=new We,s=new We,u=new We,l=new Ge,c=new Ge,h=new Ge,p=new We,f=new We,d=new We;function m(t,e,n,r,i,o,a){return uo.barycoordFromPoint(t,e,n,r,p),i.multiplyScalar(p.x),o.multiplyScalar(p.y),a.multiplyScalar(p.z),i.add(o).add(a),i.clone()}function g(t,e,n,r,i,o,a,s){if(null===(e.side===N?r.intersectTriangle(a,o,i,!0,s):r.intersectTriangle(i,o,a,e.side!==j,s)))return null;d.copy(s),d.applyMatrix4(t.matrixWorld);var u=n.ray.origin.distanceTo(d);return u<n.near||u>n.far?null:{distance:u,point:d.clone(),object:t}}function v(t,e,n,a,s,u,p,d){r.fromBufferAttribute(a,u),i.fromBufferAttribute(a,p),o.fromBufferAttribute(a,d);var v=g(t,t.material,e,n,r,i,o,f);return v&&(s&&(l.fromBufferAttribute(s,u),c.fromBufferAttribute(s,p),h.fromBufferAttribute(s,d),v.uv=m(f,r,i,o,l,c,h)),v.face=new Kr(u,p,d,uo.normal(r,i,o)),v.faceIndex=u),v}return function(p,d){var y,b=this.geometry,_=this.material,x=this.matrixWorld;if(void 0!==_&&(null===b.boundingSphere&&b.computeBoundingSphere(),n.copy(b.boundingSphere),n.applyMatrix4(x),!1!==p.ray.intersectsSphere(n)&&(t.getInverse(x),e.copy(p.ray).applyMatrix4(t),null===b.boundingBox||!1!==e.intersectsBox(b.boundingBox))))if(b.isBufferGeometry){var w,E,S,T,O,A=b.index,M=b.attributes.position,C=b.attributes.uv;if(null!==A)for(T=0,O=A.count;T<O;T+=3)w=A.getX(T),E=A.getX(T+1),S=A.getX(T+2),(y=v(this,p,e,M,C,w,E,S))&&(y.faceIndex=Math.floor(T/3),d.push(y));else if(void 0!==M)for(T=0,O=M.count;T<O;T+=3)(y=v(this,p,e,M,C,w=T,E=T+1,S=T+2))&&(y.index=w,d.push(y))}else if(b.isGeometry){var k,P,R,L,I=Array.isArray(_),D=b.vertices,N=b.faces,j=b.faceVertexUvs[0];j.length>0&&(L=j);for(var U=0,F=N.length;U<F;U++){var B=N[U],z=I?_[B.materialIndex]:_;if(void 0!==z){if(k=D[B.a],P=D[B.b],R=D[B.c],!0===z.morphTargets){var G=b.morphTargets,H=this.morphTargetInfluences;r.set(0,0,0),i.set(0,0,0),o.set(0,0,0);for(var V=0,W=G.length;V<W;V++){var q=H[V];if(0!==q){var X=G[V].vertices;r.addScaledVector(a.subVectors(X[B.a],k),q),i.addScaledVector(s.subVectors(X[B.b],P),q),o.addScaledVector(u.subVectors(X[B.c],R),q)}}r.add(k),i.add(P),o.add(R),k=r,P=i,R=o}if(y=g(this,z,p,e,k,P,R,f)){if(L&&L[U]){var Y=L[U];l.copy(Y[0]),c.copy(Y[1]),h.copy(Y[2]),y.uv=m(f,k,P,R,l,c,h)}y.face=B,y.faceIndex=U,d.push(y)}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var vo,yo,bo,_o,xo,wo,Eo,So,To,Oo,Ao,Mo,Co,ko,Po=0;function Ro(t){switch(t){case Pe:return["Linear","( value )"];case Re:return["sRGB","( value )"];case Ie:return["RGBE","( value )"];case Ne:return["RGBM","( value, 7.0 )"];case je:return["RGBM","( value, 16.0 )"];case Ue:return["RGBD","( value, 256.0 )"];case Le:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+t)}}function Lo(t,e){var n=Ro(e);return"vec4 "+t+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function Io(t){return""!==t}function Do(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights)}function No(t){return t.replace(/^[ \t]*#include +<([\w\d.]+)>/gm,function(t,e){var n=Yn[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return No(n)})}function jo(t){return t.replace(/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(t,e,n,r){for(var i="",o=parseInt(e);o<parseInt(n);o++)i+=r.replace(/\[ i \]/g,"[ "+o+" ]");return i})}function Uo(t,e,n,r,i,o){var a=t.context,s=r.defines,u=i.vertexShader,l=i.fragmentShader,c="SHADOWMAP_TYPE_BASIC";o.shadowMapType===L?c="SHADOWMAP_TYPE_PCF":o.shadowMapType===I&&(c="SHADOWMAP_TYPE_PCF_SOFT");var h="ENVMAP_TYPE_CUBE",p="ENVMAP_MODE_REFLECTION",f="ENVMAP_BLENDING_MULTIPLY";if(o.envMap){switch(r.envMap.mapping){case Mt:case Ct:h="ENVMAP_TYPE_CUBE";break;case Lt:case It:h="ENVMAP_TYPE_CUBE_UV";break;case kt:case Pt:h="ENVMAP_TYPE_EQUIREC";break;case Rt:h="ENVMAP_TYPE_SPHERE"}switch(r.envMap.mapping){case Ct:case Pt:p="ENVMAP_MODE_REFRACTION"}switch(r.combine){case bt:f="ENVMAP_BLENDING_MULTIPLY";break;case _t:f="ENVMAP_BLENDING_MIX";break;case xt:f="ENVMAP_BLENDING_ADD"}}var d,m,g,v,y,b,_,x,w=t.gammaFactor>0?t.gammaFactor:1,E=(d=r.extensions,m=o,g=e,[(d=d||{}).derivatives||m.envMapCubeUV||m.bumpMap||m.normalMap||m.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(d.fragDepth||m.logarithmicDepthBuffer)&&g.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",d.drawBuffers&&g.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(d.shaderTextureLOD||m.envMap)&&g.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Io).join("\n")),S=function(t){var e=[];for(var n in t){var r=t[n];!1!==r&&e.push("#define "+n+" "+r)}return e.join("\n")}(s),T=a.createProgram();r.isRawShaderMaterial?((v=[S].filter(Io).join("\n")).length>0&&(v+="\n"),(y=[E,S].filter(Io).join("\n")).length>0&&(y+="\n")):(v=["precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,S,o.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+w,"#define MAX_BONES "+o.maxBones,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+p:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.displacementMap&&o.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.flatShading?"#define FLAT_SHADED":"",o.skinning?"#define USE_SKINNING":"",o.useVertexTexture?"#define BONE_TEXTURE":"",o.morphTargets?"#define USE_MORPHTARGETS":"",o.morphNormals&&!1===o.flatShading?"#define USE_MORPHNORMALS":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+o.numClippingPlanes,o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+c:"",o.sizeAttenuation?"#define USE_SIZEATTENUATION":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&e.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Io).join("\n"),y=[E,"precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,S,o.alphaTest?"#define ALPHATEST "+o.alphaTest:"","#define GAMMA_FACTOR "+w,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+h:"",o.envMap?"#define "+p:"",o.envMap?"#define "+f:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.gradientMap?"#define USE_GRADIENTMAP":"",o.flatShading?"#define FLAT_SHADED":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+o.numClippingPlanes,"#define UNION_CLIPPING_PLANES "+(o.numClippingPlanes-o.numClipIntersection),o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+c:"",o.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",o.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&e.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",o.envMap&&e.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",o.toneMapping!==wt?"#define TONE_MAPPING":"",o.toneMapping!==wt?Yn.tonemapping_pars_fragment:"",o.toneMapping!==wt?function(t,e){var n;switch(e){case Et:n="Linear";break;case St:n="Reinhard";break;case Tt:n="Uncharted2";break;case Ot:n="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}("toneMapping",o.toneMapping):"",o.dithering?"#define DITHERING":"",o.outputEncoding||o.mapEncoding||o.envMapEncoding||o.emissiveMapEncoding?Yn.encodings_pars_fragment:"",o.mapEncoding?Lo("mapTexelToLinear",o.mapEncoding):"",o.envMapEncoding?Lo("envMapTexelToLinear",o.envMapEncoding):"",o.emissiveMapEncoding?Lo("emissiveMapTexelToLinear",o.emissiveMapEncoding):"",o.outputEncoding?(b="linearToOutputTexel",_=o.outputEncoding,x=Ro(_),"vec4 "+b+"( vec4 value ) { return LinearTo"+x[0]+x[1]+"; }"):"",o.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(Io).join("\n")),u=Do(u=No(u),o),l=Do(l=No(l),o),r.isShaderMaterial||(u=jo(u),l=jo(l));var O=v+u,A=y+l,M=go(a,a.VERTEX_SHADER,O),C=go(a,a.FRAGMENT_SHADER,A);a.attachShader(T,M),a.attachShader(T,C),void 0!==r.index0AttributeName?a.bindAttribLocation(T,0,r.index0AttributeName):!0===o.morphTargets&&a.bindAttribLocation(T,0,"position"),a.linkProgram(T);var k,P,R=a.getProgramInfoLog(T),D=a.getShaderInfoLog(M),N=a.getShaderInfoLog(C),j=!0,U=!0;return!1===a.getProgramParameter(T,a.LINK_STATUS)?(j=!1,console.error("THREE.WebGLProgram: shader error: ",a.getError(),"gl.VALIDATE_STATUS",a.getProgramParameter(T,a.VALIDATE_STATUS),"gl.getProgramInfoLog",R,D,N)):""!==R?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",R):""!==D&&""!==N||(U=!1),U&&(this.diagnostics={runnable:j,material:r,programLog:R,vertexShader:{log:D,prefix:v},fragmentShader:{log:N,prefix:y}}),a.deleteShader(M),a.deleteShader(C),this.getUniforms=function(){return void 0===k&&(k=new zn(a,T,t)),k},this.getAttributes=function(){return void 0===P&&(P=function(t,e){for(var n={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),i=0;i<r;i++){var o=t.getActiveAttrib(e,i).name;n[o]=t.getAttribLocation(e,o)}return n}(a,T)),P},this.destroy=function(){a.deleteProgram(T),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=Po++,this.code=n,this.usedTimes=1,this.program=T,this.vertexShader=M,this.fragmentShader=C,this}function Fo(t,e,n){var r=[],i={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow"},o=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];function a(t,e){var n;return t?t.isTexture?n=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),n=t.texture.encoding):n=Pe,n===Pe&&e&&(n=Le),n}this.getParameters=function(e,r,o,s,u,l,c){var h=i[e.type],p=c.isSkinnedMesh?function(t){var e=t.skeleton.bones;if(n.floatVertexTextures)return 1024;var r=n.maxVertexUniforms,i=Math.floor((r-20)/4),o=Math.min(i,e.length);return o<e.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+e.length+" bones. This GPU supports "+o+"."),0):o}(c):0,f=n.precision;null!==e.precision&&(f=n.getMaxPrecision(e.precision))!==e.precision&&console.warn("THREE.WebGLProgram.getParameters:",e.precision,"not supported, using",f,"instead.");var d=t.getRenderTarget();return{shaderID:h,precision:f,supportsVertexTextures:n.vertexTextures,outputEncoding:a(d?d.texture:null,t.gammaOutput),map:!!e.map,mapEncoding:a(e.map,t.gammaInput),envMap:!!e.envMap,envMapMode:e.envMap&&e.envMap.mapping,envMapEncoding:a(e.envMap,t.gammaInput),envMapCubeUV:!!e.envMap&&(e.envMap.mapping===Lt||e.envMap.mapping===It),lightMap:!!e.lightMap,aoMap:!!e.aoMap,emissiveMap:!!e.emissiveMap,emissiveMapEncoding:a(e.emissiveMap,t.gammaInput),bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,displacementMap:!!e.displacementMap,roughnessMap:!!e.roughnessMap,metalnessMap:!!e.metalnessMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,gradientMap:!!e.gradientMap,combine:e.combine,vertexColors:e.vertexColors,fog:!!s,useFog:e.fog,fogExp:s&&s.isFogExp2,flatShading:e.flatShading,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:n.logarithmicDepthBuffer,skinning:e.skinning&&p>0,maxBones:p,useVertexTexture:n.floatVertexTextures,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:r.directional.length,numPointLights:r.point.length,numSpotLights:r.spot.length,numRectAreaLights:r.rectArea.length,numHemiLights:r.hemi.length,numClippingPlanes:u,numClipIntersection:l,dithering:e.dithering,shadowMapEnabled:t.shadowMap.enabled&&c.receiveShadow&&o.length>0,shadowMapType:t.shadowMap.type,toneMapping:t.toneMapping,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:e.premultipliedAlpha,alphaTest:e.alphaTest,doubleSided:e.side===j,flipSided:e.side===N,depthPacking:void 0!==e.depthPacking&&e.depthPacking}},this.getProgramCode=function(e,n){var r=[];if(n.shaderID?r.push(n.shaderID):(r.push(e.fragmentShader),r.push(e.vertexShader)),void 0!==e.defines)for(var i in e.defines)r.push(i),r.push(e.defines[i]);for(var a=0;a<o.length;a++)r.push(n[o[a]]);return r.push(e.onBeforeCompile.toString()),r.push(t.gammaOutput),r.join()},this.acquireProgram=function(n,i,o,a){for(var s,u=0,l=r.length;u<l;u++){var c=r[u];if(c.code===a){++(s=c).usedTimes;break}}return void 0===s&&(s=new Uo(t,e,a,n,i,o),r.push(s)),s},this.releaseProgram=function(t){if(0==--t.usedTimes){var e=r.indexOf(t);r[e]=r[r.length-1],r.pop(),t.destroy()}},this.programs=r}function Bo(t,e,n,r,i,o,a){var s="undefined"!=typeof WebGL2RenderingContext&&t instanceof window.WebGL2RenderingContext,u={};function l(t,e){if(t.width>e||t.height>e){var n=e/Math.max(t.width,t.height),r=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return r.width=Math.floor(t.width*n),r.height=Math.floor(t.height*n),r.getContext("2d").drawImage(t,0,0,t.width,t.height,0,0,r.width,r.height),console.warn("THREE.WebGLRenderer: image is too big ("+t.width+"x"+t.height+"). Resized to "+r.width+"x"+r.height,t),r}return t}function c(t){return ze.isPowerOfTwo(t.width)&&ze.isPowerOfTwo(t.height)}function h(t,e){return t.generateMipmaps&&e&&t.minFilter!==Ut&&t.minFilter!==zt}function p(e){return e===Ut||e===Ft||e===Bt?t.NEAREST:t.LINEAR}function f(e){var n=e.target;n.removeEventListener("dispose",f),function(e){var n=r.get(e);if(e.image&&n.__image__webglTextureCube)t.deleteTexture(n.__image__webglTextureCube);else{if(void 0===n.__webglInit)return;t.deleteTexture(n.__webglTexture)}r.remove(e)}(n),n.isVideoTexture&&delete u[n.id],a.textures--}function d(e){var n=e.target;n.removeEventListener("dispose",d),function(e){var n=r.get(e),i=r.get(e.texture);if(!e)return;void 0!==i.__webglTexture&&t.deleteTexture(i.__webglTexture);e.depthTexture&&e.depthTexture.dispose();if(e.isWebGLRenderTargetCube)for(var o=0;o<6;o++)t.deleteFramebuffer(n.__webglFramebuffer[o]),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer[o]);else t.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer);r.remove(e.texture),r.remove(e)}(n),a.textures--}function m(e,p){var d=r.get(e);if(e.version>0&&d.__version!==e.version){var m=e.image;if(void 0===m)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",e);else{if(!1!==m.complete)return void function(e,r,p){void 0===e.__webglInit&&(e.__webglInit=!0,r.addEventListener("dispose",f),e.__webglTexture=t.createTexture(),r.isVideoTexture&&(u[r.id]=r),a.textures++);n.activeTexture(t.TEXTURE0+p),n.bindTexture(t.TEXTURE_2D,e.__webglTexture),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,r.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,r.unpackAlignment);var d=l(r.image,i.maxTextureSize);m=r,(m.wrapS!==Nt||m.wrapT!==Nt||m.minFilter!==Ut&&m.minFilter!==zt)&&!1===c(d)&&(d=function(t){if(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof ImageBitmap){var e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return e.width=ze.floorPowerOfTwo(t.width),e.height=ze.floorPowerOfTwo(t.height),e.getContext("2d").drawImage(t,0,0,e.width,e.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+t.width+"x"+t.height+"). Resized to "+e.width+"x"+e.height,t),e}return t}(d));var m;var v=c(d),y=o.convert(r.format),b=o.convert(r.type);g(t.TEXTURE_2D,r,v);var _,x=r.mipmaps;if(r.isDepthTexture){var w=t.DEPTH_COMPONENT;if(r.type===Zt){if(!s)throw new Error("Float Depth Texture only supported in WebGL2.0");w=t.DEPTH_COMPONENT32F}else s&&(w=t.DEPTH_COMPONENT16);r.format===ue&&w===t.DEPTH_COMPONENT&&r.type!==Xt&&r.type!==$t&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=Xt,b=o.convert(r.type)),r.format===le&&(w=t.DEPTH_STENCIL,r.type!==ee&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=ee,b=o.convert(r.type))),n.texImage2D(t.TEXTURE_2D,0,w,d.width,d.height,0,y,b,null)}else if(r.isDataTexture)if(x.length>0&&v){for(var E=0,S=x.length;E<S;E++)_=x[E],n.texImage2D(t.TEXTURE_2D,E,y,_.width,_.height,0,y,b,_.data);r.generateMipmaps=!1}else n.texImage2D(t.TEXTURE_2D,0,y,d.width,d.height,0,y,b,d.data);else if(r.isCompressedTexture)for(var E=0,S=x.length;E<S;E++)_=x[E],r.format!==ie&&r.format!==re?n.getCompressedTextureFormats().indexOf(y)>-1?n.compressedTexImage2D(t.TEXTURE_2D,E,y,_.width,_.height,0,_.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(t.TEXTURE_2D,E,y,_.width,_.height,0,y,b,_.data);else if(x.length>0&&v){for(var E=0,S=x.length;E<S;E++)_=x[E],n.texImage2D(t.TEXTURE_2D,E,y,y,b,_);r.generateMipmaps=!1}else n.texImage2D(t.TEXTURE_2D,0,y,y,b,d);h(r,v)&&t.generateMipmap(t.TEXTURE_2D);e.__version=r.version,r.onUpdate&&r.onUpdate(r)}(d,e,p);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",e)}}n.activeTexture(t.TEXTURE0+p),n.bindTexture(t.TEXTURE_2D,d.__webglTexture)}function g(n,a,s){var u;if(s?(t.texParameteri(n,t.TEXTURE_WRAP_S,o.convert(a.wrapS)),t.texParameteri(n,t.TEXTURE_WRAP_T,o.convert(a.wrapT)),t.texParameteri(n,t.TEXTURE_MAG_FILTER,o.convert(a.magFilter)),t.texParameteri(n,t.TEXTURE_MIN_FILTER,o.convert(a.minFilter))):(t.texParameteri(n,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(n,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),a.wrapS===Nt&&a.wrapT===Nt||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",a),t.texParameteri(n,t.TEXTURE_MAG_FILTER,p(a.magFilter)),t.texParameteri(n,t.TEXTURE_MIN_FILTER,p(a.minFilter)),a.minFilter!==Ut&&a.minFilter!==zt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",a)),u=e.get("EXT_texture_filter_anisotropic")){if(a.type===Zt&&null===e.get("OES_texture_float_linear"))return;if(a.type===Jt&&null===e.get("OES_texture_half_float_linear"))return;(a.anisotropy>1||r.get(a).__currentAnisotropy)&&(t.texParameterf(n,u.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy)}}function v(e,i,a,s){var u=o.convert(i.texture.format),l=o.convert(i.texture.type);n.texImage2D(s,0,u,i.width,i.height,0,u,l,null),t.bindFramebuffer(t.FRAMEBUFFER,e),t.framebufferTexture2D(t.FRAMEBUFFER,a,s,r.get(i.texture).__webglTexture,0),t.bindFramebuffer(t.FRAMEBUFFER,null)}function y(e,n){t.bindRenderbuffer(t.RENDERBUFFER,e),n.depthBuffer&&!n.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e)):n.depthBuffer&&n.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e)):t.renderbufferStorage(t.RENDERBUFFER,t.RGBA4,n.width,n.height),t.bindRenderbuffer(t.RENDERBUFFER,null)}function b(e){var n=r.get(e),i=!0===e.isWebGLRenderTargetCube;if(e.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,n){if(n&&n.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(t.FRAMEBUFFER,e),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),m(n.depthTexture,0);var i=r.get(n.depthTexture).__webglTexture;if(n.depthTexture.format===ue)t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,i,0);else{if(n.depthTexture.format!==le)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,i,0)}}(n.__webglFramebuffer,e)}else if(i){n.__webglDepthbuffer=[];for(var o=0;o<6;o++)t.bindFramebuffer(t.FRAMEBUFFER,n.__webglFramebuffer[o]),n.__webglDepthbuffer[o]=t.createRenderbuffer(),y(n.__webglDepthbuffer[o],e)}else t.bindFramebuffer(t.FRAMEBUFFER,n.__webglFramebuffer),n.__webglDepthbuffer=t.createRenderbuffer(),y(n.__webglDepthbuffer,e);t.bindFramebuffer(t.FRAMEBUFFER,null)}this.setTexture2D=m,this.setTextureCube=function(e,s){var u=r.get(e);if(6===e.image.length)if(e.version>0&&u.__version!==e.version){u.__image__webglTextureCube||(e.addEventListener("dispose",f),u.__image__webglTextureCube=t.createTexture(),a.textures++),n.activeTexture(t.TEXTURE0+s),n.bindTexture(t.TEXTURE_CUBE_MAP,u.__image__webglTextureCube),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipY);for(var p=e&&e.isCompressedTexture,d=e.image[0]&&e.image[0].isDataTexture,m=[],v=0;v<6;v++)m[v]=p||d?d?e.image[v].image:e.image[v]:l(e.image[v],i.maxCubemapSize);var y=c(m[0]),b=o.convert(e.format),_=o.convert(e.type);for(g(t.TEXTURE_CUBE_MAP,e,y),v=0;v<6;v++)if(p)for(var x,w=m[v].mipmaps,E=0,S=w.length;E<S;E++)x=w[E],e.format!==ie&&e.format!==re?n.getCompressedTextureFormats().indexOf(b)>-1?n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+v,E,b,x.width,x.height,0,x.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+v,E,b,x.width,x.height,0,b,_,x.data);else d?n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+v,0,b,m[v].width,m[v].height,0,b,_,m[v].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+v,0,b,b,_,m[v]);h(e,y)&&t.generateMipmap(t.TEXTURE_CUBE_MAP),u.__version=e.version,e.onUpdate&&e.onUpdate(e)}else n.activeTexture(t.TEXTURE0+s),n.bindTexture(t.TEXTURE_CUBE_MAP,u.__image__webglTextureCube)},this.setTextureCubeDynamic=function(e,i){n.activeTexture(t.TEXTURE0+i),n.bindTexture(t.TEXTURE_CUBE_MAP,r.get(e).__webglTexture)},this.setupRenderTarget=function(e){var i=r.get(e),o=r.get(e.texture);e.addEventListener("dispose",d),o.__webglTexture=t.createTexture(),a.textures++;var s=!0===e.isWebGLRenderTargetCube,u=c(e);if(s){i.__webglFramebuffer=[];for(var l=0;l<6;l++)i.__webglFramebuffer[l]=t.createFramebuffer()}else i.__webglFramebuffer=t.createFramebuffer();if(s){for(n.bindTexture(t.TEXTURE_CUBE_MAP,o.__webglTexture),g(t.TEXTURE_CUBE_MAP,e.texture,u),l=0;l<6;l++)v(i.__webglFramebuffer[l],e,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+l);h(e.texture,u)&&t.generateMipmap(t.TEXTURE_CUBE_MAP),n.bindTexture(t.TEXTURE_CUBE_MAP,null)}else n.bindTexture(t.TEXTURE_2D,o.__webglTexture),g(t.TEXTURE_2D,e.texture,u),v(i.__webglFramebuffer,e,t.COLOR_ATTACHMENT0,t.TEXTURE_2D),h(e.texture,u)&&t.generateMipmap(t.TEXTURE_2D),n.bindTexture(t.TEXTURE_2D,null);e.depthBuffer&&b(e)},this.updateRenderTargetMipmap=function(e){var i=e.texture;if(h(i,c(e))){var o=e.isWebGLRenderTargetCube?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,a=r.get(i).__webglTexture;n.bindTexture(o,a),t.generateMipmap(o),n.bindTexture(o,null)}},this.updateVideoTextures=function(){for(var t in u)u[t].update()}}function zo(t,e,n,r){Zr.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function Go(t){zo.call(this),this.cameras=t||[]}function Ho(t){var e=this,n=null,r=null,i=null;"undefined"!=typeof window&&"VRFrameData"in window&&(r=new window.VRFrameData);var o=new He,a=new zo;a.bounds=new Je(0,0,.5,1),a.layers.enable(1);var s=new zo;s.bounds=new Je(.5,0,.5,1),s.layers.enable(2);var u,l,c=new Go([a,s]);function h(){if(null!==n&&n.isPresenting){var r=n.getEyeParameters("left"),i=r.renderWidth,o=r.renderHeight;l=t.getPixelRatio(),u=t.getSize(),t.setDrawingBufferSize(2*i,o,1)}else e.enabled&&t.setDrawingBufferSize(u.width,u.height,l)}c.layers.enable(1),c.layers.enable(2),"undefined"!=typeof window&&window.addEventListener("vrdisplaypresentchange",h,!1),this.enabled=!1,this.getDevice=function(){return n},this.setDevice=function(t){void 0!==t&&(n=t)},this.setPoseTarget=function(t){void 0!==t&&(i=t)},this.getCamera=function(t){if(null===n)return t;n.depthNear=t.near,n.depthFar=t.far,n.getFrameData(r);var e=r.pose,u=null!==i?i:t;if(null!==e.position?u.position.fromArray(e.position):u.position.set(0,0,0),null!==e.orientation&&u.quaternion.fromArray(e.orientation),u.updateMatrixWorld(),!1===n.isPresenting)return t;a.near=t.near,s.near=t.near,a.far=t.far,s.far=t.far,c.matrixWorld.copy(t.matrixWorld),c.matrixWorldInverse.copy(t.matrixWorldInverse),a.matrixWorldInverse.fromArray(r.leftViewMatrix),s.matrixWorldInverse.fromArray(r.rightViewMatrix);var l=u.parent;null!==l&&(o.getInverse(l.matrixWorld),a.matrixWorldInverse.multiply(o),s.matrixWorldInverse.multiply(o)),a.matrixWorld.getInverse(a.matrixWorldInverse),s.matrixWorld.getInverse(s.matrixWorldInverse),a.projectionMatrix.fromArray(r.leftProjectionMatrix),s.projectionMatrix.fromArray(r.rightProjectionMatrix),c.projectionMatrix.copy(a.projectionMatrix);var h=n.getLayers();if(h.length){var p=h[0];null!==p.leftBounds&&4===p.leftBounds.length&&a.bounds.fromArray(p.leftBounds),null!==p.rightBounds&&4===p.rightBounds.length&&s.bounds.fromArray(p.rightBounds)}return c},this.submitFrame=function(){n&&n.isPresenting&&n.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",h)}}function Vo(t,e){return{convert:function(n){var r;if(n===Dt)return t.REPEAT;if(n===Nt)return t.CLAMP_TO_EDGE;if(n===jt)return t.MIRRORED_REPEAT;if(n===Ut)return t.NEAREST;if(n===Ft)return t.NEAREST_MIPMAP_NEAREST;if(n===Bt)return t.NEAREST_MIPMAP_LINEAR;if(n===zt)return t.LINEAR;if(n===Gt)return t.LINEAR_MIPMAP_NEAREST;if(n===Ht)return t.LINEAR_MIPMAP_LINEAR;if(n===Vt)return t.UNSIGNED_BYTE;if(n===Kt)return t.UNSIGNED_SHORT_4_4_4_4;if(n===Qt)return t.UNSIGNED_SHORT_5_5_5_1;if(n===te)return t.UNSIGNED_SHORT_5_6_5;if(n===Wt)return t.BYTE;if(n===qt)return t.SHORT;if(n===Xt)return t.UNSIGNED_SHORT;if(n===Yt)return t.INT;if(n===$t)return t.UNSIGNED_INT;if(n===Zt)return t.FLOAT;if(n===Jt&&null!==(r=e.get("OES_texture_half_float")))return r.HALF_FLOAT_OES;if(n===ne)return t.ALPHA;if(n===re)return t.RGB;if(n===ie)return t.RGBA;if(n===oe)return t.LUMINANCE;if(n===ae)return t.LUMINANCE_ALPHA;if(n===ue)return t.DEPTH_COMPONENT;if(n===le)return t.DEPTH_STENCIL;if(n===$)return t.FUNC_ADD;if(n===Z)return t.FUNC_SUBTRACT;if(n===J)return t.FUNC_REVERSE_SUBTRACT;if(n===tt)return t.ZERO;if(n===et)return t.ONE;if(n===nt)return t.SRC_COLOR;if(n===rt)return t.ONE_MINUS_SRC_COLOR;if(n===it)return t.SRC_ALPHA;if(n===ot)return t.ONE_MINUS_SRC_ALPHA;if(n===at)return t.DST_ALPHA;if(n===st)return t.ONE_MINUS_DST_ALPHA;if(n===ut)return t.DST_COLOR;if(n===lt)return t.ONE_MINUS_DST_COLOR;if(n===ct)return t.SRC_ALPHA_SATURATE;if((n===ce||n===he||n===pe||n===fe)&&null!==(r=e.get("WEBGL_compressed_texture_s3tc"))){if(n===ce)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===he)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===pe)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===fe)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((n===de||n===me||n===ge||n===ve)&&null!==(r=e.get("WEBGL_compressed_texture_pvrtc"))){if(n===de)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===me)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===ge)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===ve)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===ye&&null!==(r=e.get("WEBGL_compressed_texture_etc1")))return r.COMPRESSED_RGB_ETC1_WEBGL;if((n===K||n===Q)&&null!==(r=e.get("EXT_blend_minmax"))){if(n===K)return r.MIN_EXT;if(n===Q)return r.MAX_EXT}return n===ee&&null!==(r=e.get("WEBGL_depth_texture"))?r.UNSIGNED_INT_24_8_WEBGL:0}}}function Wo(t){console.log("THREE.WebGLRenderer",S);var e=void 0!==(t=t||{}).canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=void 0!==t.context?t.context:null,r=void 0!==t.alpha&&t.alpha,i=void 0===t.depth||t.depth,o=void 0===t.stencil||t.stencil,a=void 0!==t.antialias&&t.antialias,s=void 0===t.premultipliedAlpha||t.premultipliedAlpha,u=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,l=void 0!==t.powerPreference?t.powerPreference:"default",c=[],h=[],p=null,f=[],d=[];this.domElement=e,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=Et,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var m,g,v,y,b,_,x,w,E,T,C,P,R,L,I,D,U,F,z,G=this,$=!1,Z=null,J=null,K=-1,Q="",tt=null,et=null,nt=new Je,rt=new Je,it=null,ot=0,at=e.width,st=e.height,ut=1,lt=new Je(0,0,at,st),ct=new Je(0,0,at,st),bt=!1,_t=new Sr,xt=new function(){var t=this,e=null,n=0,r=!1,i=!1,o=new Er,a=new qe,s={value:null,needsUpdate:!1};function u(){s.value!==e&&(s.value=e,s.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0}function l(e,n,r,i){var u=null!==e?e.length:0,l=null;if(0!==u){if(l=s.value,!0!==i||null===l){var c=r+4*u,h=n.matrixWorldInverse;a.getNormalMatrix(h),(null===l||l.length<c)&&(l=new Float32Array(c));for(var p=0,f=r;p!==u;++p,f+=4)o.copy(e[p]).applyMatrix4(h,a),o.normal.toArray(l,f),l[f+3]=o.constant}s.value=l,s.needsUpdate=!0}return t.numPlanes=u,l}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(t,i,o){var a=0!==t.length||i||0!==n||r;return r=i,e=l(t,o,0),n=t.length,a},this.beginShadows=function(){i=!0,l(null)},this.endShadows=function(){i=!1,u()},this.setState=function(t,o,a,c,h,p){if(!r||null===t||0===t.length||i&&!a)i?l(null):u();else{var f=i?0:n,d=4*f,m=h.clippingState||null;s.value=m,m=l(t,c,d,p);for(var g=0;g!==d;++g)m[g]=e[g];h.clippingState=m,this.numIntersection=o?this.numPlanes:0,this.numPlanes+=f}}},wt=!1,St=!1,Tt=new He,Ot=new We,At={geometries:0,textures:0},Mt={frame:0,calls:0,vertices:0,faces:0,points:0};function Ct(){return null===Z?ut:1}this.info={render:Mt,memory:At,programs:null};try{var kt={alpha:r,depth:i,stencil:o,antialias:a,premultipliedAlpha:s,preserveDrawingBuffer:u,powerPreference:l};if(e.addEventListener("webglcontextlost",It,!1),e.addEventListener("webglcontextrestored",Dt,!1),null===(m=n||e.getContext("webgl",kt)||e.getContext("experimental-webgl",kt)))throw null!==e.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===m.getShaderPrecisionFormat&&(m.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){console.error("THREE.WebGLRenderer: "+t.message)}function Pt(){(g=new function(t){var e={};return{get:function(n){if(void 0!==e[n])return e[n];var r;switch(n){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":r=t.getExtension("WEBGL_compressed_texture_etc1");break;default:r=t.getExtension(n)}return null===r&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),e[n]=r,r}}}(m)).get("WEBGL_depth_texture"),g.get("OES_texture_float"),g.get("OES_texture_float_linear"),g.get("OES_texture_half_float"),g.get("OES_texture_half_float_linear"),g.get("OES_standard_derivatives"),g.get("OES_element_index_uint"),g.get("ANGLE_instanced_arrays"),z=new Vo(m,g),v=new function(t,e,n){var r;function i(e){if("highp"===e){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var o=void 0!==n.precision?n.precision:"highp",a=i(o);a!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",a,"instead."),o=a);var s=!0===n.logarithmicDepthBuffer,u=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),l=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),c=t.getParameter(t.MAX_TEXTURE_SIZE),h=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),p=t.getParameter(t.MAX_VERTEX_ATTRIBS),f=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),d=t.getParameter(t.MAX_VARYING_VECTORS),m=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),g=l>0,v=!!e.get("OES_texture_float");return{getMaxAnisotropy:function(){if(void 0!==r)return r;var n=e.get("EXT_texture_filter_anisotropic");return r=null!==n?t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:o,logarithmicDepthBuffer:s,maxTextures:u,maxVertexTextures:l,maxTextureSize:c,maxCubemapSize:h,maxAttributes:p,maxVertexUniforms:f,maxVaryings:d,maxFragmentUniforms:m,vertexTextures:g,floatFragmentTextures:v,floatVertexTextures:g&&v}}(m,g,t),(y=new function(t,e,n){var r=new function(){var e=!1,n=new Je,r=null,i=new Je(0,0,0,0);return{setMask:function(n){r===n||e||(t.colorMask(n,n,n,n),r=n)},setLocked:function(t){e=t},setClear:function(e,r,o,a,s){!0===s&&(e*=a,r*=a,o*=a),n.set(e,r,o,a),!1===i.equals(n)&&(t.clearColor(e,r,o,a),i.copy(n))},reset:function(){e=!1,r=null,i.set(-1,0,0,0)}}},i=new function(){var e=!1,n=null,r=null,i=null;return{setTest:function(e){e?B(t.DEPTH_TEST):z(t.DEPTH_TEST)},setMask:function(r){n===r||e||(t.depthMask(r),n=r)},setFunc:function(e){if(r!==e){if(e)switch(e){case ht:t.depthFunc(t.NEVER);break;case pt:t.depthFunc(t.ALWAYS);break;case ft:t.depthFunc(t.LESS);break;case dt:t.depthFunc(t.LEQUAL);break;case mt:t.depthFunc(t.EQUAL);break;case gt:t.depthFunc(t.GEQUAL);break;case vt:t.depthFunc(t.GREATER);break;case yt:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}else t.depthFunc(t.LEQUAL);r=e}},setLocked:function(t){e=t},setClear:function(e){i!==e&&(t.clearDepth(e),i=e)},reset:function(){e=!1,n=null,r=null,i=null}}},o=new function(){var e=!1,n=null,r=null,i=null,o=null,a=null,s=null,u=null,l=null;return{setTest:function(e){e?B(t.STENCIL_TEST):z(t.STENCIL_TEST)},setMask:function(r){n===r||e||(t.stencilMask(r),n=r)},setFunc:function(e,n,a){r===e&&i===n&&o===a||(t.stencilFunc(e,n,a),r=e,i=n,o=a)},setOp:function(e,n,r){a===e&&s===n&&u===r||(t.stencilOp(e,n,r),a=e,s=n,u=r)},setLocked:function(t){e=t},setClear:function(e){l!==e&&(t.clearStencil(e),l=e)},reset:function(){e=!1,n=null,r=null,i=null,o=null,a=null,s=null,u=null,l=null}}},a=t.getParameter(t.MAX_VERTEX_ATTRIBS),s=new Uint8Array(a),u=new Uint8Array(a),l=new Uint8Array(a),c={},h=null,p=null,f=null,d=null,m=null,g=null,v=null,y=null,b=null,_=!1,x=null,w=null,E=null,S=null,T=null,C=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),k=parseFloat(/^WebGL\ ([0-9])/.exec(t.getParameter(t.VERSION))[1]),P=parseFloat(k)>=1,R=null,L={},I=new Je,D=new Je;function U(e,n,r){var i=new Uint8Array(4),o=t.createTexture();t.bindTexture(e,o),t.texParameteri(e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(e,t.TEXTURE_MAG_FILTER,t.NEAREST);for(var a=0;a<r;a++)t.texImage2D(n+a,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,i);return o}var F={};function B(e){!0!==c[e]&&(t.enable(e),c[e]=!0)}function z(e){!1!==c[e]&&(t.disable(e),c[e]=!1)}function G(e,r,i,o,a,s,u,l){if(e!==H?B(t.BLEND):z(t.BLEND),e!==Y){if(e!==f||l!==_)switch(e){case W:l?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE,t.ONE,t.ONE)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE));break;case q:l?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.ONE_MINUS_SRC_COLOR));break;case X:l?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.SRC_COLOR));break;default:l?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA))}d=null,m=null,g=null,v=null,y=null,b=null}else a=a||r,s=s||i,u=u||o,r===d&&a===v||(t.blendEquationSeparate(n.convert(r),n.convert(a)),d=r,v=a),i===m&&o===g&&s===y&&u===b||(t.blendFuncSeparate(n.convert(i),n.convert(o),n.convert(s),n.convert(u)),m=i,g=o,y=s,b=u);f=e,_=l}function $(e){x!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),x=e)}function Z(e){e!==O?(B(t.CULL_FACE),e!==w&&(e===A?t.cullFace(t.BACK):e===M?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):z(t.CULL_FACE),w=e}function J(e,n,r){e?(B(t.POLYGON_OFFSET_FILL),S===n&&T===r||(t.polygonOffset(n,r),S=n,T=r)):z(t.POLYGON_OFFSET_FILL)}function K(e){void 0===e&&(e=t.TEXTURE0+C-1),R!==e&&(t.activeTexture(e),R=e)}return F[t.TEXTURE_2D]=U(t.TEXTURE_2D,t.TEXTURE_2D,1),F[t.TEXTURE_CUBE_MAP]=U(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),r.setClear(0,0,0,1),i.setClear(1),o.setClear(0),B(t.DEPTH_TEST),i.setFunc(dt),$(!1),Z(A),B(t.CULL_FACE),B(t.BLEND),G(V),{buffers:{color:r,depth:i,stencil:o},initAttributes:function(){for(var t=0,e=s.length;t<e;t++)s[t]=0},enableAttribute:function(n){s[n]=1,0===u[n]&&(t.enableVertexAttribArray(n),u[n]=1),0!==l[n]&&(e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(n,0),l[n]=0)},enableAttributeAndDivisor:function(n,r){s[n]=1,0===u[n]&&(t.enableVertexAttribArray(n),u[n]=1),l[n]!==r&&(e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(n,r),l[n]=r)},disableUnusedAttributes:function(){for(var e=0,n=u.length;e!==n;++e)u[e]!==s[e]&&(t.disableVertexAttribArray(e),u[e]=0)},enable:B,disable:z,getCompressedTextureFormats:function(){if(null===h&&(h=[],e.get("WEBGL_compressed_texture_pvrtc")||e.get("WEBGL_compressed_texture_s3tc")||e.get("WEBGL_compressed_texture_etc1")))for(var n=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS),r=0;r<n.length;r++)h.push(n[r]);return h},useProgram:function(e){return p!==e&&(t.useProgram(e),p=e,!0)},setBlending:G,setMaterial:function(e,n){e.side===j?z(t.CULL_FACE):B(t.CULL_FACE);var o=e.side===N;n&&(o=!o),$(o),!0===e.transparent?G(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha):G(H),i.setFunc(e.depthFunc),i.setTest(e.depthTest),i.setMask(e.depthWrite),r.setMask(e.colorWrite),J(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:$,setCullFace:Z,setLineWidth:function(e){e!==E&&(P&&t.lineWidth(e),E=e)},setPolygonOffset:J,setScissorTest:function(e){e?B(t.SCISSOR_TEST):z(t.SCISSOR_TEST)},activeTexture:K,bindTexture:function(e,n){null===R&&K();var r=L[R];void 0===r&&(r={type:void 0,texture:void 0},L[R]=r),r.type===e&&r.texture===n||(t.bindTexture(e,n||F[e]),r.type=e,r.texture=n)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(e){!1===I.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),I.copy(e))},viewport:function(e){!1===D.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),D.copy(e))},reset:function(){for(var e=0;e<u.length;e++)1===u[e]&&(t.disableVertexAttribArray(e),u[e]=0);c={},h=null,R=null,L={},p=null,f=null,x=null,w=null,r.reset(),i.reset(),o.reset()}}}(m,g,z)).scissor(rt.copy(ct).multiplyScalar(ut)),y.viewport(nt.copy(lt).multiplyScalar(ut)),b=new function(){var t={};return{get:function(e){var n=e.uuid,r=t[n];return void 0===r&&(r={},t[n]=r),r},remove:function(e){delete t[e.uuid]},clear:function(){t={}}}},_=new Bo(m,g,y,b,v,z,At),x=new Or(m),w=new function(t,e,n){var r={},i={};function o(t){var a=t.target,s=r[a.id];null!==s.index&&e.remove(s.index);for(var u in s.attributes)e.remove(s.attributes[u]);a.removeEventListener("dispose",o),delete r[a.id];var l=i[a.id];l&&(e.remove(l),delete i[a.id]),(l=i[s.id])&&(e.remove(l),delete i[s.id]),n.geometries--}return{get:function(t,e){var i=r[e.id];return i||(e.addEventListener("dispose",o),e.isBufferGeometry?i=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new Qi).setFromObject(t)),i=e._bufferGeometry),r[e.id]=i,n.geometries++,i)},update:function(n){var r=n.index,i=n.attributes;null!==r&&e.update(r,t.ELEMENT_ARRAY_BUFFER);for(var o in i)e.update(i[o],t.ARRAY_BUFFER);var a=n.morphAttributes;for(var o in a)for(var s=a[o],u=0,l=s.length;u<l;u++)e.update(s[u],t.ARRAY_BUFFER)},getWireframeAttribute:function(n){var r=i[n.id];if(r)return r;var o,a=[],s=n.index,u=n.attributes;if(null!==s)for(var l=0,c=(o=s.array).length;l<c;l+=3){var h=o[l+0],p=o[l+1],f=o[l+2];a.push(h,p,p,f,f,h)}else for(l=0,c=(o=u.position.array).length/3-1;l<c;l+=3)h=l+0,p=l+1,f=l+2,a.push(h,p,p,f,f,h);return r=new(yi(a)>65535?di:pi)(a,1),e.update(r,t.ELEMENT_ARRAY_BUFFER),i[n.id]=r,r}}}(m,x,At),E=new function(t,e){var n={};return{update:function(r){var i=e.frame,o=r.geometry,a=t.get(r,o);return n[a.id]!==i&&(o.isGeometry&&a.updateFromObject(r),t.update(a),n[a.id]=i),a},clear:function(){n={}}}}(w,Mt),L=new function(t){var e={},n=new Float32Array(8);return{update:function(r,i,o,a){var s=r.morphTargetInfluences,u=s.length,l=e[i.id];if(void 0===l){l=[];for(var c=0;c<u;c++)l[c]=[c,0];e[i.id]=l}var h=o.morphTargets&&i.morphAttributes.position,p=o.morphNormals&&i.morphAttributes.normal;for(c=0;c<u;c++)0!==(f=l[c])[1]&&(h&&i.removeAttribute("morphTarget"+c),p&&i.removeAttribute("morphNormal"+c));for(c=0;c<u;c++)(f=l[c])[0]=c,f[1]=s[c];for(l.sort(fo),c=0;c<8;c++){var f;if(f=l[c]){var d=f[0],m=f[1];if(m){h&&i.addAttribute("morphTarget"+c,h[d]),p&&i.addAttribute("morphNormal"+c,p[d]),n[c]=m;continue}}n[c]=0}a.getUniforms().setValue(t,"morphTargetInfluences",n)}}}(m),C=new Fo(G,g,v),T=new mo,P=new po,R=new function(t,e,n,r){var i,o,a,s=new Hn(0),u=0;function l(t,n){e.buffers.color.setClear(t.r,t.g,t.b,n,r)}return{getClearColor:function(){return s},setClearColor:function(t,e){s.set(t),l(s,u=void 0!==e?e:1)},getClearAlpha:function(){return u},setClearAlpha:function(t){l(s,u=t)},render:function(e,r,c,h){var p=r.background;null===p?l(s,u):p&&p.isColor&&(l(p,1),h=!0),(t.autoClear||h)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),p&&p.isCubeTexture?(void 0===a&&((a=new lo(new eo(1,1,1),new oo({uniforms:$n.cube.uniforms,vertexShader:$n.cube.vertexShader,fragmentShader:$n.cube.fragmentShader,side:N,depthTest:!0,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),a.geometry.removeAttribute("uv"),a.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},n.update(a.geometry)),a.material.uniforms.tCube.value=p,e.push(a,a.geometry,a.material,0,null)):p&&p.isTexture&&(void 0===i&&(i=new Jr(-1,1,1,-1,0,1),o=new lo(new ro(2,2),new io({depthTest:!1,depthWrite:!1,fog:!1})),n.update(o.geometry)),o.material.map=p,t.renderBufferDirect(i,null,o.geometry,o.material,o,null))}}}(G,y,w,s),I=new function(t,e,n){var r;this.setMode=function(t){r=t},this.render=function(e,i){t.drawArrays(r,e,i),n.calls++,n.vertices+=i,r===t.TRIANGLES?n.faces+=i/3:r===t.POINTS&&(n.points+=i)},this.renderInstances=function(i,o,a){var s=e.get("ANGLE_instanced_arrays");if(null!==s){var u=i.attributes.position;u.isInterleavedBufferAttribute?(a=u.data.count,s.drawArraysInstancedANGLE(r,0,a,i.maxInstancedCount)):s.drawArraysInstancedANGLE(r,o,a,i.maxInstancedCount),n.calls++,n.vertices+=a*i.maxInstancedCount,r===t.TRIANGLES?n.faces+=i.maxInstancedCount*a/3:r===t.POINTS&&(n.points+=i.maxInstancedCount*a)}else console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}}(m,g,Mt),D=new function(t,e,n){var r,i,o;this.setMode=function(t){r=t},this.setIndex=function(t){i=t.type,o=t.bytesPerElement},this.render=function(e,a){t.drawElements(r,a,i,e*o),n.calls++,n.vertices+=a,r===t.TRIANGLES?n.faces+=a/3:r===t.POINTS&&(n.points+=a)},this.renderInstances=function(a,s,u){var l=e.get("ANGLE_instanced_arrays");null!==l?(l.drawElementsInstancedANGLE(r,u,i,s*o,a.maxInstancedCount),n.calls++,n.vertices+=u*a.maxInstancedCount,r===t.TRIANGLES?n.faces+=a.maxInstancedCount*u/3:r===t.POINTS&&(n.points+=a.maxInstancedCount*u)):console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}}(m,g,Mt),U=new Jn(G,m,y,_,v),F=new Qn(G,m,y,_,v),G.info.programs=C.programs,G.context=m,G.capabilities=v,G.extensions=g,G.properties=b,G.renderLists=P,G.state=y}Pt();var Rt=new Ho(G);this.vr=Rt;var Lt=new Tr(G,E,v.maxTextureSize);function It(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),$=!0}function Dt(){console.log("THREE.WebGLRenderer: Context Restored."),$=!1,Pt()}function Nt(t){var e,n=t.target;n.removeEventListener("dispose",Nt),jt(e=n),b.remove(e)}function jt(t){var e=b.get(t).program;t.program=void 0,void 0!==e&&C.releaseProgram(e)}this.shadowMap=Lt,this.getContext=function(){return m},this.getContextAttributes=function(){return m.getContextAttributes()},this.forceContextLoss=function(){var t=g.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=g.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return ut},this.setPixelRatio=function(t){void 0!==t&&(ut=t,this.setSize(at,st,!1))},this.getSize=function(){return{width:at,height:st}},this.setSize=function(t,n,r){var i=Rt.getDevice();i&&i.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(at=t,st=n,e.width=t*ut,e.height=n*ut,!1!==r&&(e.style.width=t+"px",e.style.height=n+"px"),this.setViewport(0,0,t,n))},this.getDrawingBufferSize=function(){return{width:at*ut,height:st*ut}},this.setDrawingBufferSize=function(t,n,r){at=t,st=n,ut=r,e.width=t*r,e.height=n*r,this.setViewport(0,0,t,n)},this.setViewport=function(t,e,n,r){lt.set(t,st-e-r,n,r),y.viewport(nt.copy(lt).multiplyScalar(ut))},this.setScissor=function(t,e,n,r){ct.set(t,st-e-r,n,r),y.scissor(rt.copy(ct).multiplyScalar(ut))},this.setScissorTest=function(t){y.setScissorTest(bt=t)},this.getClearColor=function(){return R.getClearColor()},this.setClearColor=function(){R.setClearColor.apply(R,arguments)},this.getClearAlpha=function(){return R.getClearAlpha()},this.setClearAlpha=function(){R.setClearAlpha.apply(R,arguments)},this.clear=function(t,e,n){var r=0;(void 0===t||t)&&(r|=m.COLOR_BUFFER_BIT),(void 0===e||e)&&(r|=m.DEPTH_BUFFER_BIT),(void 0===n||n)&&(r|=m.STENCIL_BUFFER_BIT),m.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(t,e,n,r){this.setRenderTarget(t),this.clear(e,n,r)},this.dispose=function(){e.removeEventListener("webglcontextlost",It,!1),e.removeEventListener("webglcontextrestored",Dt,!1),P.dispose(),Rt.dispose()},this.renderBufferImmediate=function(t,e,n){y.initAttributes();var r=b.get(t);t.hasPositions&&!r.position&&(r.position=m.createBuffer()),t.hasNormals&&!r.normal&&(r.normal=m.createBuffer()),t.hasUvs&&!r.uv&&(r.uv=m.createBuffer()),t.hasColors&&!r.color&&(r.color=m.createBuffer());var i=e.getAttributes();if(t.hasPositions&&(m.bindBuffer(m.ARRAY_BUFFER,r.position),m.bufferData(m.ARRAY_BUFFER,t.positionArray,m.DYNAMIC_DRAW),y.enableAttribute(i.position),m.vertexAttribPointer(i.position,3,m.FLOAT,!1,0,0)),t.hasNormals){if(m.bindBuffer(m.ARRAY_BUFFER,r.normal),!n.isMeshPhongMaterial&&!n.isMeshStandardMaterial&&!n.isMeshNormalMaterial&&!0===n.flatShading)for(var o=0,a=3*t.count;o<a;o+=9){var s=t.normalArray,u=(s[o+0]+s[o+3]+s[o+6])/3,l=(s[o+1]+s[o+4]+s[o+7])/3,c=(s[o+2]+s[o+5]+s[o+8])/3;s[o+0]=u,s[o+1]=l,s[o+2]=c,s[o+3]=u,s[o+4]=l,s[o+5]=c,s[o+6]=u,s[o+7]=l,s[o+8]=c}m.bufferData(m.ARRAY_BUFFER,t.normalArray,m.DYNAMIC_DRAW),y.enableAttribute(i.normal),m.vertexAttribPointer(i.normal,3,m.FLOAT,!1,0,0)}t.hasUvs&&n.map&&(m.bindBuffer(m.ARRAY_BUFFER,r.uv),m.bufferData(m.ARRAY_BUFFER,t.uvArray,m.DYNAMIC_DRAW),y.enableAttribute(i.uv),m.vertexAttribPointer(i.uv,2,m.FLOAT,!1,0,0)),t.hasColors&&n.vertexColors!==B&&(m.bindBuffer(m.ARRAY_BUFFER,r.color),m.bufferData(m.ARRAY_BUFFER,t.colorArray,m.DYNAMIC_DRAW),y.enableAttribute(i.color),m.vertexAttribPointer(i.color,3,m.FLOAT,!1,0,0)),y.disableUnusedAttributes(),m.drawArrays(m.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,n,r,i,o){var a=i.isMesh&&i.matrixWorld.determinant()<0;y.setMaterial(r,a);var s=Yt(t,e,r,i),u=n.id+"_"+s.id+"_"+(!0===r.wireframe),l=!1;u!==Q&&(Q=u,l=!0),i.morphTargetInfluences&&(L.update(i,n,r,s),l=!0);var c,h=n.index,p=n.attributes.position,f=1;!0===r.wireframe&&(h=w.getWireframeAttribute(n),f=2);var d=I;null!==h&&(c=x.get(h),(d=D).setIndex(c)),l&&(!function(t,e,n,r){if(n&&n.isInstancedBufferGeometry&&null===g.get("ANGLE_instanced_arrays"))return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");void 0===r&&(r=0);y.initAttributes();var i=n.attributes,o=e.getAttributes(),a=t.defaultAttributeValues;for(var s in o){var u=o[s];if(u>=0){var l=i[s];if(void 0!==l){var c=l.normalized,h=l.itemSize,p=x.get(l);if(void 0===p)continue;var f=p.buffer,d=p.type,v=p.bytesPerElement;if(l.isInterleavedBufferAttribute){var b=l.data,_=b.stride,w=l.offset;b&&b.isInstancedInterleavedBuffer?(y.enableAttributeAndDivisor(u,b.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=b.meshPerAttribute*b.count)):y.enableAttribute(u),m.bindBuffer(m.ARRAY_BUFFER,f),m.vertexAttribPointer(u,h,d,c,_*v,(r*_+w)*v)}else l.isInstancedBufferAttribute?(y.enableAttributeAndDivisor(u,l.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=l.meshPerAttribute*l.count)):y.enableAttribute(u),m.bindBuffer(m.ARRAY_BUFFER,f),m.vertexAttribPointer(u,h,d,c,0,r*h*v)}else if(void 0!==a){var E=a[s];if(void 0!==E)switch(E.length){case 2:m.vertexAttrib2fv(u,E);break;case 3:m.vertexAttrib3fv(u,E);break;case 4:m.vertexAttrib4fv(u,E);break;default:m.vertexAttrib1fv(u,E)}}}}y.disableUnusedAttributes()}(r,s,n),null!==h&&m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,c.buffer));var v=0;null!==h?v=h.count:void 0!==p&&(v=p.count);var b=n.drawRange.start*f,_=n.drawRange.count*f,E=null!==o?o.start*f:0,S=null!==o?o.count*f:1/0,T=Math.max(b,E),O=Math.min(v,b+_,E+S)-1,A=Math.max(0,O-T+1);if(0!==A){if(i.isMesh)if(!0===r.wireframe)y.setLineWidth(r.wireframeLinewidth*Ct()),d.setMode(m.LINES);else switch(i.drawMode){case Me:d.setMode(m.TRIANGLES);break;case Ce:d.setMode(m.TRIANGLE_STRIP);break;case ke:d.setMode(m.TRIANGLE_FAN)}else if(i.isLine){var M=r.linewidth;void 0===M&&(M=1),y.setLineWidth(M*Ct()),i.isLineSegments?d.setMode(m.LINES):i.isLineLoop?d.setMode(m.LINE_LOOP):d.setMode(m.LINE_STRIP)}else i.isPoints&&d.setMode(m.POINTS);n&&n.isInstancedBufferGeometry?n.maxInstancedCount>0&&d.renderInstances(n,T,A):d.render(T,A)}},this.compile=function(t,e){c.length=0,h.length=0,t.traverse(function(t){t.isLight&&(c.push(t),t.castShadow&&h.push(t))}),T.setup(c,h,e),t.traverse(function(e){if(e.material)if(Array.isArray(e.material))for(var n=0;n<e.material.length;n++)Xt(e.material[n],t.fog,e);else Xt(e.material,t.fog,e)})};var Ut,Ft,Bt,zt=!1,Gt=null;function Ht(t){null!==Gt&&Gt(t);var e=Rt.getDevice();e&&e.isPresenting?e.requestAnimationFrame(Ht):window.requestAnimationFrame(Ht)}function Wt(t,e,n,r){for(var i=0,o=t.length;i<o;i++){var a=t[i],s=a.object,u=a.geometry,l=void 0===r?a.material:r,c=a.group;if(n.isArrayCamera){et=n;for(var h=n.cameras,p=0,f=h.length;p<f;p++){var d=h[p];if(s.layers.test(d.layers)){var m=d.bounds,g=m.x*at,v=m.y*st,b=m.z*at,_=m.w*st;y.viewport(nt.set(g,v,b,_).multiplyScalar(ut)),qt(s,e,d,u,l,c)}}}else et=null,qt(s,e,n,u,l,c)}}function qt(t,e,n,r,i,o){if(t.onBeforeRender(G,e,n,r,i,o),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){var a=t.isMesh&&t.matrixWorld.determinant()<0;y.setMaterial(i,a);var s=Yt(n,e.fog,i,t);Q="",u=s,l=i,t.render(function(t){G.renderBufferImmediate(t,u,l)})}else G.renderBufferDirect(n,e.fog,r,i,t,o);var u,l;t.onAfterRender(G,e,n,r,i,o)}function Xt(t,e,n){var r=b.get(t),i=C.getParameters(t,T.state,h,e,xt.numPlanes,xt.numIntersection,n),o=C.getProgramCode(t,i),a=r.program,s=!0;if(void 0===a)t.addEventListener("dispose",Nt);else if(a.code!==o)jt(t);else{if(void 0!==i.shaderID)return;s=!1}if(s){if(i.shaderID){var u=$n[i.shaderID];r.shader={name:t.type,uniforms:Xn.clone(u.uniforms),vertexShader:u.vertexShader,fragmentShader:u.fragmentShader}}else r.shader={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};t.onBeforeCompile(r.shader),a=C.acquireProgram(t,r.shader,i,o),r.program=a,t.program=a}var l=a.getAttributes();if(t.morphTargets){t.numSupportedMorphTargets=0;for(var c=0;c<G.maxMorphTargets;c++)l["morphTarget"+c]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals){t.numSupportedMorphNormals=0;for(c=0;c<G.maxMorphNormals;c++)l["morphNormal"+c]>=0&&t.numSupportedMorphNormals++}var p=r.shader.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(r.numClippingPlanes=xt.numPlanes,r.numIntersection=xt.numIntersection,p.clippingPlanes=xt.uniform),r.fog=e,r.lightsHash=T.state.hash,t.lights&&(p.ambientLightColor.value=T.state.ambient,p.directionalLights.value=T.state.directional,p.spotLights.value=T.state.spot,p.rectAreaLights.value=T.state.rectArea,p.pointLights.value=T.state.point,p.hemisphereLights.value=T.state.hemi,p.directionalShadowMap.value=T.state.directionalShadowMap,p.directionalShadowMatrix.value=T.state.directionalShadowMatrix,p.spotShadowMap.value=T.state.spotShadowMap,p.spotShadowMatrix.value=T.state.spotShadowMatrix,p.pointShadowMap.value=T.state.pointShadowMap,p.pointShadowMatrix.value=T.state.pointShadowMatrix);var f=r.program.getUniforms(),d=zn.seqWithValue(f.seq,p);r.uniformsList=d}function Yt(t,e,n,r){ot=0;var i=b.get(n);if(wt&&(St||t!==tt)){var o=t===tt&&n.id===K;xt.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,t,i,o)}!1===n.needsUpdate&&(void 0===i.program?n.needsUpdate=!0:n.fog&&i.fog!==e?n.needsUpdate=!0:n.lights&&i.lightsHash!==T.state.hash?n.needsUpdate=!0:void 0===i.numClippingPlanes||i.numClippingPlanes===xt.numPlanes&&i.numIntersection===xt.numIntersection||(n.needsUpdate=!0)),n.needsUpdate&&(Xt(n,e,r),n.needsUpdate=!1);var a,s,u,l,c,h,p,f,d,g,_,x,w,E,S,O,A=!1,M=!1,C=!1,k=i.program,P=k.getUniforms(),R=i.shader.uniforms;if(y.useProgram(k.program)&&(A=!0,M=!0,C=!0),n.id!==K&&(K=n.id,M=!0),A||t!==tt){if(P.setValue(m,"projectionMatrix",t.projectionMatrix),v.logarithmicDepthBuffer&&P.setValue(m,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),tt!==(et||t)&&(tt=et||t,M=!0,C=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial||n.envMap){var L=P.map.cameraPosition;void 0!==L&&L.setValue(m,Ot.setFromMatrixPosition(t.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&P.setValue(m,"viewMatrix",t.matrixWorldInverse)}if(n.skinning){P.setOptional(m,r,"bindMatrix"),P.setOptional(m,r,"bindMatrixInverse");var I=r.skeleton;if(I){var D=I.bones;if(v.floatVertexTextures){if(void 0===I.boneTexture){var N=Math.sqrt(4*D.length);N=ze.ceilPowerOfTwo(N),N=Math.max(N,4);var j=new Float32Array(N*N*4);j.set(I.boneMatrices);var U=new tn(j,N,N,ie,Zt);I.boneMatrices=j,I.boneTexture=U,I.boneTextureSize=N}P.setValue(m,"boneTexture",I.boneTexture),P.setValue(m,"boneTextureSize",I.boneTextureSize)}else P.setOptional(m,I,"boneMatrices")}}return M&&(P.setValue(m,"toneMappingExposure",G.toneMappingExposure),P.setValue(m,"toneMappingWhitePoint",G.toneMappingWhitePoint),n.lights&&(O=C,(S=R).ambientLightColor.needsUpdate=O,S.directionalLights.needsUpdate=O,S.pointLights.needsUpdate=O,S.spotLights.needsUpdate=O,S.rectAreaLights.needsUpdate=O,S.hemisphereLights.needsUpdate=O),e&&n.fog&&(E=e,(w=R).fogColor.value=E.color,E.isFog?(w.fogNear.value=E.near,w.fogFar.value=E.far):E.isFogExp2&&(w.fogDensity.value=E.density)),n.isMeshBasicMaterial?$t(R,n):n.isMeshLambertMaterial?($t(R,n),_=R,(x=n).emissiveMap&&(_.emissiveMap.value=x.emissiveMap)):n.isMeshPhongMaterial?($t(R,n),n.isMeshToonMaterial?(Kt(d=R,g=n),g.gradientMap&&(d.gradientMap.value=g.gradientMap)):Kt(R,n)):n.isMeshStandardMaterial?($t(R,n),n.isMeshPhysicalMaterial?(f=n,(p=R).clearCoat.value=f.clearCoat,p.clearCoatRoughness.value=f.clearCoatRoughness,Qt(p,f)):Qt(R,n)):n.isMeshDepthMaterial?($t(R,n),c=R,(h=n).displacementMap&&(c.displacementMap.value=h.displacementMap,c.displacementScale.value=h.displacementScale,c.displacementBias.value=h.displacementBias)):n.isMeshDistanceMaterial?($t(R,n),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias);t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(R,n)):n.isMeshNormalMaterial?($t(R,n),function(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale);e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale));e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(R,n)):n.isLineBasicMaterial?(l=n,(u=R).diffuse.value=l.color,u.opacity.value=l.opacity,n.isLineDashedMaterial&&(s=n,(a=R).dashSize.value=s.dashSize,a.totalSize.value=s.dashSize+s.gapSize,a.scale.value=s.scale)):n.isPointsMaterial?function(t,e){if(t.diffuse.value=e.color,t.opacity.value=e.opacity,t.size.value=e.size*ut,t.scale.value=.5*st,t.map.value=e.map,null!==e.map){if(!0===e.map.matrixAutoUpdate){var n=e.map.offset,r=e.map.repeat,i=e.map.rotation,o=e.map.center;e.map.matrix.setUvTransform(n.x,n.y,r.x,r.y,i,o.x,o.y)}t.uvTransform.value.copy(e.map.matrix)}}(R,n):n.isShadowMaterial&&(R.color.value=n.color,R.opacity.value=n.opacity),void 0!==R.ltcMat&&(R.ltcMat.value=qn.LTC_MAT_TEXTURE),void 0!==R.ltcMag&&(R.ltcMag.value=qn.LTC_MAG_TEXTURE),zn.upload(m,i.uniformsList,R,G)),P.setValue(m,"modelViewMatrix",r.modelViewMatrix),P.setValue(m,"normalMatrix",r.normalMatrix),P.setValue(m,"modelMatrix",r.matrixWorld),k}function $t(t,e){var n;if(t.opacity.value=e.opacity,e.color&&(t.diffuse.value=e.color),e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.specularMap&&(t.specularMap.value=e.specularMap),e.envMap&&(t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap&&e.envMap.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity),e.map?n=e.map:e.specularMap?n=e.specularMap:e.displacementMap?n=e.displacementMap:e.normalMap?n=e.normalMap:e.bumpMap?n=e.bumpMap:e.roughnessMap?n=e.roughnessMap:e.metalnessMap?n=e.metalnessMap:e.alphaMap?n=e.alphaMap:e.emissiveMap&&(n=e.emissiveMap),void 0!==n){if(n.isWebGLRenderTarget&&(n=n.texture),!0===n.matrixAutoUpdate){var r=n.offset,i=n.repeat,o=n.rotation,a=n.center;n.matrix.setUvTransform(r.x,r.y,i.x,i.y,o,a.x,a.y)}t.uvTransform.value.copy(n.matrix)}}function Kt(t,e){t.specular.value=e.specular,t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function Qt(t,e){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}this.animate=function(t){Gt=t,function(){if(!zt){var t=Rt.getDevice();t&&t.isPresenting?t.requestAnimationFrame(Ht):window.requestAnimationFrame(Ht),zt=!0}}()},this.render=function(t,e,n,r){if(e&&e.isCamera){if(!$){Q="",K=-1,tt=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),Rt.enabled&&(e=Rt.getCamera(e)),Tt.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),_t.setFromMatrix(Tt),c.length=0,h.length=0,f.length=0,d.length=0,St=this.localClippingEnabled,wt=xt.init(this.clippingPlanes,St,e),(p=P.get(t,e)).init(),function t(e,n,r){if(!1===e.visible)return;var i=e.layers.test(n.layers);if(i)if(e.isLight)c.push(e),e.castShadow&&h.push(e);else if(e.isSprite)e.frustumCulled&&!_t.intersectsSprite(e)||f.push(e);else if(e.isLensFlare)d.push(e);else if(e.isImmediateRenderObject)r&&Ot.setFromMatrixPosition(e.matrixWorld).applyMatrix4(Tt),p.push(e,null,e.material,Ot.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.update(),!e.frustumCulled||_t.intersectsObject(e))){r&&Ot.setFromMatrixPosition(e.matrixWorld).applyMatrix4(Tt);var o=E.update(e),a=e.material;if(Array.isArray(a))for(var s=o.groups,u=0,l=s.length;u<l;u++){var m=s[u],g=a[m.materialIndex];g&&g.visible&&p.push(e,o,g,Ot.z,m)}else a.visible&&p.push(e,o,a,Ot.z,null)}var v=e.children;for(var u=0,l=v.length;u<l;u++)t(v[u],n,r)}(t,e,G.sortObjects),!0===G.sortObjects&&p.sort(),_.updateVideoTextures(),wt&&xt.beginShadows(),Lt.render(h,t,e),T.setup(c,h,e),wt&&xt.endShadows(),Mt.frame++,Mt.calls=0,Mt.vertices=0,Mt.faces=0,Mt.points=0,void 0===n&&(n=null),this.setRenderTarget(n),R.render(p,t,e,r);var i=p.opaque,o=p.transparent;if(t.overrideMaterial){var a=t.overrideMaterial;i.length&&Wt(i,t,e,a),o.length&&Wt(o,t,e,a)}else i.length&&Wt(i,t,e),o.length&&Wt(o,t,e);F.render(f,t,e),U.render(d,t,e,nt),n&&_.updateRenderTargetMipmap(n),y.buffers.depth.setTest(!0),y.buffers.depth.setMask(!0),y.buffers.color.setMask(!0),y.setPolygonOffset(!1),Rt.enabled&&Rt.submitFrame()}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFaceCulling=function(t,e){y.setCullFace(t),y.setFlipSided(e===k)},this.allocTextureUnit=function(){var t=ot;return t>=v.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+t+" texture units while this GPU supports only "+v.maxTextures),ot+=1,t},this.setTexture2D=(Ut=!1,function(t,e){t&&t.isWebGLRenderTarget&&(Ut||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),Ut=!0),t=t.texture),_.setTexture2D(t,e)}),this.setTexture=(Ft=!1,function(t,e){Ft||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),Ft=!0),_.setTexture2D(t,e)}),this.setTextureCube=(Bt=!1,function(t,e){t&&t.isWebGLRenderTargetCube&&(Bt||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Bt=!0),t=t.texture),t&&t.isCubeTexture||Array.isArray(t.image)&&6===t.image.length?_.setTextureCube(t,e):_.setTextureCubeDynamic(t,e)}),this.getRenderTarget=function(){return Z},this.setRenderTarget=function(t){Z=t,t&&void 0===b.get(t).__webglFramebuffer&&_.setupRenderTarget(t);var e=null,n=!1;if(t){var r=b.get(t).__webglFramebuffer;t.isWebGLRenderTargetCube?(e=r[t.activeCubeFace],n=!0):e=r,nt.copy(t.viewport),rt.copy(t.scissor),it=t.scissorTest}else nt.copy(lt).multiplyScalar(ut),rt.copy(ct).multiplyScalar(ut),it=bt;if(J!==e&&(m.bindFramebuffer(m.FRAMEBUFFER,e),J=e),y.viewport(nt),y.scissor(rt),y.setScissorTest(it),n){var i=b.get(t.texture);m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_CUBE_MAP_POSITIVE_X+t.activeCubeFace,i.__webglTexture,t.activeMipMapLevel)}},this.readRenderTargetPixels=function(t,e,n,r,i,o){if(t&&t.isWebGLRenderTarget){var a=b.get(t).__webglFramebuffer;if(a){var s=!1;a!==J&&(m.bindFramebuffer(m.FRAMEBUFFER,a),s=!0);try{var u=t.texture,l=u.format,c=u.type;if(l!==ie&&z.convert(l)!==m.getParameter(m.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(c===Vt||z.convert(c)===m.getParameter(m.IMPLEMENTATION_COLOR_READ_TYPE)||c===Zt&&(g.get("OES_texture_float")||g.get("WEBGL_color_buffer_float"))||c===Jt&&g.get("EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");m.checkFramebufferStatus(m.FRAMEBUFFER)===m.FRAMEBUFFER_COMPLETE?e>=0&&e<=t.width-r&&n>=0&&n<=t.height-i&&m.readPixels(e,n,r,i,z.convert(l),z.convert(c),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&m.bindFramebuffer(m.FRAMEBUFFER,J)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")}}function qo(t,e){this.name="",this.color=new Hn(t),this.density=void 0!==e?e:25e-5}function Xo(t,e,n){this.name="",this.color=new Hn(t),this.near=void 0!==e?e:1,this.far=void 0!==n?n:1e3}function Yo(){$r.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function $o(t,e,n,r,i){$r.call(this),this.lensFlares=[],this.positionScreen=new We,this.customUpdateCallback=void 0,void 0!==t&&this.add(t,e,n,r,i)}function Zo(t){yr.call(this),this.type="SpriteMaterial",this.color=new Hn(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(t)}function Jo(t){$r.call(this),this.type="Sprite",this.material=void 0!==t?t:new Zo}function Ko(){$r.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function Qo(t,e){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new He)}}function ta(){$r.call(this),this.type="Bone"}function ea(t,e){lo.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new He,this.bindMatrixInverse=new He;var n=new Qo(this.initBones());this.bind(n,this.matrixWorld),this.normalizeSkinWeights()}function na(t){yr.call(this),this.type="LineBasicMaterial",this.color=new Hn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(t)}function ra(t,e,n){if(1===n)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new ia(t,e);$r.call(this),this.type="Line",this.geometry=void 0!==t?t:new Qi,this.material=void 0!==e?e:new na({color:16777215*Math.random()})}function ia(t,e){ra.call(this,t,e),this.type="LineSegments"}function oa(t,e){ra.call(this,t,e),this.type="LineLoop"}function aa(t){yr.call(this),this.type="PointsMaterial",this.color=new Hn(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(t)}function sa(t,e){$r.call(this),this.type="Points",this.geometry=void 0!==t?t:new Qi,this.material=void 0!==e?e:new aa({color:16777215*Math.random()})}function ua(){$r.call(this),this.type="Group"}function la(t,e,n,r,i,o,a,s,u){Ze.call(this,t,e,n,r,i,o,a,s,u),this.generateMipmaps=!1;var l=this;t.addEventListener("loadeddata",function e(){t.removeEventListener("loadeddata",e,!1),l.needsUpdate=!0},!1)}function ca(t,e,n,r,i,o,a,s,u,l,c,h){Ze.call(this,null,o,a,s,u,l,r,i,c,h),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function ha(t,e,n,r,i,o,a,s,u,l){if((l=void 0!==l?l:ue)!==ue&&l!==le)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&l===ue&&(n=Xt),void 0===n&&l===le&&(n=ee),Ze.call(this,null,r,i,o,a,s,l,n,u),this.image={width:t,height:e},this.magFilter=void 0!==a?a:Ut,this.minFilter=void 0!==s?s:Ut,this.flipY=!1,this.generateMipmaps=!1}function pa(t){Qi.call(this),this.type="WireframeGeometry";var e,n,r,i,o,a,s,u,l,c,h=[],p=[0,0],f={},d=["a","b","c"];if(t&&t.isGeometry){var m=t.faces;for(e=0,r=m.length;e<r;e++){var g=m[e];for(n=0;n<3;n++)s=g[d[n]],u=g[d[(n+1)%3]],p[0]=Math.min(s,u),p[1]=Math.max(s,u),void 0===f[l=p[0]+","+p[1]]&&(f[l]={index1:p[0],index2:p[1]})}for(l in f)a=f[l],c=t.vertices[a.index1],h.push(c.x,c.y,c.z),c=t.vertices[a.index2],h.push(c.x,c.y,c.z)}else if(t&&t.isBufferGeometry){var v,y,b,_,x,w,E;if(c=new We,null!==t.index){for(v=t.attributes.position,y=t.index,0===(b=t.groups).length&&(b=[{start:0,count:y.count,materialIndex:0}]),i=0,o=b.length;i<o;++i)for(e=x=(_=b[i]).start,r=x+_.count;e<r;e+=3)for(n=0;n<3;n++)s=y.getX(e+n),u=y.getX(e+(n+1)%3),p[0]=Math.min(s,u),p[1]=Math.max(s,u),void 0===f[l=p[0]+","+p[1]]&&(f[l]={index1:p[0],index2:p[1]});for(l in f)a=f[l],c.fromBufferAttribute(v,a.index1),h.push(c.x,c.y,c.z),c.fromBufferAttribute(v,a.index2),h.push(c.x,c.y,c.z)}else for(e=0,r=(v=t.attributes.position).count/3;e<r;e++)for(n=0;n<3;n++)w=3*e+n,c.fromBufferAttribute(v,w),h.push(c.x,c.y,c.z),E=3*e+(n+1)%3,c.fromBufferAttribute(v,E),h.push(c.x,c.y,c.z)}this.addAttribute("position",new mi(h,3))}function fa(t,e,n){ai.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:n},this.fromBufferGeometry(new da(t,e,n)),this.mergeVertices()}function da(t,e,n){Qi.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:n};var r,i,o=[],a=[],s=[],u=[],l=new We,c=new We,h=new We,p=new We,f=new We,d=e+1;for(r=0;r<=n;r++){var m=r/n;for(i=0;i<=e;i++){var g=i/e;c=t(g,m,c),a.push(c.x,c.y,c.z),g-1e-5>=0?(h=t(g-1e-5,m,h),p.subVectors(c,h)):(h=t(g+1e-5,m,h),p.subVectors(h,c)),m-1e-5>=0?(h=t(g,m-1e-5,h),f.subVectors(c,h)):(h=t(g,m+1e-5,h),f.subVectors(h,c)),l.crossVectors(p,f).normalize(),s.push(l.x,l.y,l.z),u.push(g,m)}}for(r=0;r<n;r++)for(i=0;i<e;i++){var v=r*d+i,y=r*d+i+1,b=(r+1)*d+i+1,_=(r+1)*d+i;o.push(v,y,_),o.push(y,b,_)}this.setIndex(o),this.addAttribute("position",new mi(a,3)),this.addAttribute("normal",new mi(s,3)),this.addAttribute("uv",new mi(u,2))}function ma(t,e,n,r){ai.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},this.fromBufferGeometry(new ga(t,e,n,r)),this.mergeVertices()}function ga(t,e,n,r){Qi.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},n=n||1;var i=[],o=[];function a(t,e,n,r){var i,o,a=Math.pow(2,r),u=[];for(i=0;i<=a;i++){u[i]=[];var l=t.clone().lerp(n,i/a),c=e.clone().lerp(n,i/a),h=a-i;for(o=0;o<=h;o++)u[i][o]=0===o&&i===a?l:l.clone().lerp(c,o/h)}for(i=0;i<a;i++)for(o=0;o<2*(a-i)-1;o++){var p=Math.floor(o/2);o%2==0?(s(u[i][p+1]),s(u[i+1][p]),s(u[i][p])):(s(u[i][p+1]),s(u[i+1][p+1]),s(u[i+1][p]))}}function s(t){i.push(t.x,t.y,t.z)}function u(e,n){var r=3*e;n.x=t[r+0],n.y=t[r+1],n.z=t[r+2]}function l(t,e,n,r){r<0&&1===t.x&&(o[e]=t.x-1),0===n.x&&0===n.z&&(o[e]=r/2/Math.PI+.5)}function c(t){return Math.atan2(t.z,-t.x)}!function(t){for(var n=new We,r=new We,i=new We,o=0;o<e.length;o+=3)u(e[o+0],n),u(e[o+1],r),u(e[o+2],i),a(n,r,i,t)}(r=r||0),function(t){for(var e=new We,n=0;n<i.length;n+=3)e.x=i[n+0],e.y=i[n+1],e.z=i[n+2],e.normalize().multiplyScalar(t),i[n+0]=e.x,i[n+1]=e.y,i[n+2]=e.z}(n),function(){for(var t=new We,e=0;e<i.length;e+=3){t.x=i[e+0],t.y=i[e+1],t.z=i[e+2];var n=c(t)/2/Math.PI+.5,r=(a=t,Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))/Math.PI+.5);o.push(n,1-r)}var a;(function(){for(var t=new We,e=new We,n=new We,r=new We,a=new Ge,s=new Ge,u=new Ge,h=0,p=0;h<i.length;h+=9,p+=6){t.set(i[h+0],i[h+1],i[h+2]),e.set(i[h+3],i[h+4],i[h+5]),n.set(i[h+6],i[h+7],i[h+8]),a.set(o[p+0],o[p+1]),s.set(o[p+2],o[p+3]),u.set(o[p+4],o[p+5]),r.copy(t).add(e).add(n).divideScalar(3);var f=c(r);l(a,p+0,t,f),l(s,p+2,e,f),l(u,p+4,n,f)}})(),function(){for(var t=0;t<o.length;t+=6){var e=o[t+0],n=o[t+2],r=o[t+4],i=Math.max(e,n,r),a=Math.min(e,n,r);i>.9&&a<.1&&(e<.2&&(o[t+0]+=1),n<.2&&(o[t+2]+=1),r<.2&&(o[t+4]+=1))}}()}(),this.addAttribute("position",new mi(i,3)),this.addAttribute("normal",new mi(i.slice(),3)),this.addAttribute("uv",new mi(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}function va(t,e){ai.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new ya(t,e)),this.mergeVertices()}function ya(t,e){ga.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function ba(t,e){ai.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new _a(t,e)),this.mergeVertices()}function _a(t,e){ga.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function xa(t,e){ai.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new wa(t,e)),this.mergeVertices()}function wa(t,e){var n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1];ga.call(this,r,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Ea(t,e){ai.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Sa(t,e)),this.mergeVertices()}function Sa(t,e){var n=(1+Math.sqrt(5))/2,r=1/n,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r];ga.call(this,i,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Ta(t,e,n,r,i,o){ai.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed.");var a=new Oa(t,e,n,r,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals,this.fromBufferGeometry(a),this.mergeVertices()}function Oa(t,e,n,r,i){Qi.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i},e=e||64,n=n||1,r=r||8,i=i||!1;var o=t.computeFrenetFrames(e,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;var a,s,u=new We,l=new We,c=new Ge,h=new We,p=[],f=[],d=[],m=[];function g(i){h=t.getPointAt(i/e,h);var a=o.normals[i],c=o.binormals[i];for(s=0;s<=r;s++){var d=s/r*Math.PI*2,m=Math.sin(d),g=-Math.cos(d);l.x=g*a.x+m*c.x,l.y=g*a.y+m*c.y,l.z=g*a.z+m*c.z,l.normalize(),f.push(l.x,l.y,l.z),u.x=h.x+n*l.x,u.y=h.y+n*l.y,u.z=h.z+n*l.z,p.push(u.x,u.y,u.z)}}!function(){for(a=0;a<e;a++)g(a);g(!1===i?e:0),function(){for(a=0;a<=e;a++)for(s=0;s<=r;s++)c.x=a/e,c.y=s/r,d.push(c.x,c.y)}(),function(){for(s=1;s<=e;s++)for(a=1;a<=r;a++){var t=(r+1)*(s-1)+(a-1),n=(r+1)*s+(a-1),i=(r+1)*s+a,o=(r+1)*(s-1)+a;m.push(t,n,o),m.push(n,i,o)}}()}(),this.setIndex(m),this.addAttribute("position",new mi(p,3)),this.addAttribute("normal",new mi(f,3)),this.addAttribute("uv",new mi(d,2))}function Aa(t,e,n,r,i,o,a){ai.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:o},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Ma(t,e,n,r,i,o)),this.mergeVertices()}function Ma(t,e,n,r,i,o){Qi.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:o},t=t||1,e=e||.4,n=Math.floor(n)||64,r=Math.floor(r)||8,i=i||2,o=o||3;var a,s,u=[],l=[],c=[],h=[],p=new We,f=new We,d=new We,m=new We,g=new We,v=new We,y=new We;for(a=0;a<=n;++a){var b=a/n*i*Math.PI*2;for(A(b,i,o,t,d),A(b+.01,i,o,t,m),v.subVectors(m,d),y.addVectors(m,d),g.crossVectors(v,y),y.crossVectors(g,v),g.normalize(),y.normalize(),s=0;s<=r;++s){var _=s/r*Math.PI*2,x=-e*Math.cos(_),w=e*Math.sin(_);p.x=d.x+(x*y.x+w*g.x),p.y=d.y+(x*y.y+w*g.y),p.z=d.z+(x*y.z+w*g.z),l.push(p.x,p.y,p.z),f.subVectors(p,d).normalize(),c.push(f.x,f.y,f.z),h.push(a/n),h.push(s/r)}}for(s=1;s<=n;s++)for(a=1;a<=r;a++){var E=(r+1)*(s-1)+(a-1),S=(r+1)*s+(a-1),T=(r+1)*s+a,O=(r+1)*(s-1)+a;u.push(E,S,O),u.push(S,T,O)}function A(t,e,n,r,i){var o=Math.cos(t),a=Math.sin(t),s=n/e*t,u=Math.cos(s);i.x=r*(2+u)*.5*o,i.y=r*(2+u)*a*.5,i.z=r*Math.sin(s)*.5}this.setIndex(u),this.addAttribute("position",new mi(l,3)),this.addAttribute("normal",new mi(c,3)),this.addAttribute("uv",new mi(h,2))}function Ca(t,e,n,r,i){ai.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},this.fromBufferGeometry(new ka(t,e,n,r,i)),this.mergeVertices()}function ka(t,e,n,r,i){Qi.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},t=t||1,e=e||.4,n=Math.floor(n)||8,r=Math.floor(r)||6,i=i||2*Math.PI;var o,a,s=[],u=[],l=[],c=[],h=new We,p=new We,f=new We;for(o=0;o<=n;o++)for(a=0;a<=r;a++){var d=a/r*i,m=o/n*Math.PI*2;p.x=(t+e*Math.cos(m))*Math.cos(d),p.y=(t+e*Math.cos(m))*Math.sin(d),p.z=e*Math.sin(m),u.push(p.x,p.y,p.z),h.x=t*Math.cos(d),h.y=t*Math.sin(d),f.subVectors(p,h).normalize(),l.push(f.x,f.y,f.z),c.push(a/r),c.push(o/n)}for(o=1;o<=n;o++)for(a=1;a<=r;a++){var g=(r+1)*o+a-1,v=(r+1)*(o-1)+a-1,y=(r+1)*(o-1)+a,b=(r+1)*o+a;s.push(g,v,b),s.push(v,y,b)}this.setIndex(s),this.addAttribute("position",new mi(u,3)),this.addAttribute("normal",new mi(l,3)),this.addAttribute("uv",new mi(c,2))}zo.prototype=Object.assign(Object.create(Zr.prototype),{constructor:zo,isPerspectiveCamera:!0,copy:function(t,e){return Zr.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){var e=.5*this.getFilmHeight()/t;this.fov=2*ze.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*ze.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*ze.RAD2DEG*Math.atan(Math.tan(.5*ze.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,n,r,i,o){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,e=t*Math.tan(.5*ze.DEG2RAD*this.fov)/this.zoom,n=2*e,r=this.aspect*n,i=-.5*r,o=this.view;if(null!==this.view&&this.view.enabled){var a=o.fullWidth,s=o.fullHeight;i+=o.offsetX*r/a,e-=o.offsetY*n/s,r*=o.width/a,n*=o.height/s}var u=this.filmOffset;0!==u&&(i+=t*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,e,e-n,t,this.far)},toJSON:function(t){var e=$r.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}),Go.prototype=Object.assign(Object.create(zo.prototype),{constructor:Go,isArrayCamera:!0}),qo.prototype.isFogExp2=!0,qo.prototype.clone=function(){return new qo(this.color.getHex(),this.density)},qo.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},Xo.prototype.isFog=!0,Xo.prototype.clone=function(){return new Xo(this.color.getHex(),this.near,this.far)},Xo.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},Yo.prototype=Object.assign(Object.create($r.prototype),{constructor:Yo,copy:function(t,e){return $r.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var e=$r.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}}),$o.prototype=Object.assign(Object.create($r.prototype),{constructor:$o,isLensFlare:!0,copy:function(t){$r.prototype.copy.call(this,t),this.positionScreen.copy(t.positionScreen),this.customUpdateCallback=t.customUpdateCallback;for(var e=0,n=t.lensFlares.length;e<n;e++)this.lensFlares.push(t.lensFlares[e]);return this},add:function(t,e,n,r,i,o){void 0===e&&(e=-1),void 0===n&&(n=0),void 0===o&&(o=1),void 0===i&&(i=new Hn(16777215)),void 0===r&&(r=V),n=Math.min(n,Math.max(0,n)),this.lensFlares.push({texture:t,size:e,distance:n,x:0,y:0,z:0,scale:1,rotation:0,opacity:o,color:i,blending:r})},updateLensFlares:function(){var t,e,n=this.lensFlares.length,r=2*-this.positionScreen.x,i=2*-this.positionScreen.y;for(t=0;t<n;t++)(e=this.lensFlares[t]).x=this.positionScreen.x+r*e.distance,e.y=this.positionScreen.y+i*e.distance,e.wantedRotation=e.x*Math.PI*.25,e.rotation+=.25*(e.wantedRotation-e.rotation)}}),Zo.prototype=Object.create(yr.prototype),Zo.prototype.constructor=Zo,Zo.prototype.isSpriteMaterial=!0,Zo.prototype.copy=function(t){return yr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this},Jo.prototype=Object.assign(Object.create($r.prototype),{constructor:Jo,isSprite:!0,raycast:(vo=new We,yo=new We,bo=new We,function(t,e){yo.setFromMatrixPosition(this.matrixWorld),t.ray.closestPointToPoint(yo,vo),bo.setFromMatrixScale(this.matrixWorld);var n=bo.x*bo.y/4;if(!(yo.distanceToSquared(vo)>n)){var r=t.ray.origin.distanceTo(vo);r<t.near||r>t.far||e.push({distance:r,point:vo.clone(),face:null,object:this})}}),clone:function(){return new this.constructor(this.material).copy(this)}}),Ko.prototype=Object.assign(Object.create($r.prototype),{constructor:Ko,copy:function(t){$r.prototype.copy.call(this,t,!1);for(var e=t.levels,n=0,r=e.length;n<r;n++){var i=e[n];this.addLevel(i.object.clone(),i.distance)}return this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var n=this.levels,r=0;r<n.length&&!(e<n[r].distance);r++);n.splice(r,0,{distance:e,object:t}),this.add(t)},getObjectForDistance:function(t){for(var e=this.levels,n=1,r=e.length;n<r&&!(t<e[n].distance);n++);return e[n-1].object},raycast:(wo=new We,function(t,e){wo.setFromMatrixPosition(this.matrixWorld);var n=t.ray.origin.distanceTo(wo);this.getObjectForDistance(n).raycast(t,e)}),update:(_o=new We,xo=new We,function(t){var e=this.levels;if(e.length>1){_o.setFromMatrixPosition(t.matrixWorld),xo.setFromMatrixPosition(this.matrixWorld);var n=_o.distanceTo(xo);e[0].object.visible=!0;for(var r=1,i=e.length;r<i&&n>=e[r].distance;r++)e[r-1].object.visible=!1,e[r].object.visible=!0;for(;r<i;r++)e[r].object.visible=!1}}),toJSON:function(t){var e=$r.prototype.toJSON.call(this,t);e.object.levels=[];for(var n=this.levels,r=0,i=n.length;r<i;r++){var o=n[r];e.object.levels.push({object:o.object.uuid,distance:o.distance})}return e}}),Object.assign(Qo.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var n=new He;this.bones[t]&&n.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(n)}},pose:function(){var t,e,n;for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:(Eo=new He,So=new He,function(){for(var t=this.bones,e=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,o=t.length;i<o;i++){var a=t[i]?t[i].matrixWorld:So;Eo.multiplyMatrices(a,e[i]),Eo.toArray(n,16*i)}void 0!==r&&(r.needsUpdate=!0)}),clone:function(){return new Qo(this.bones,this.boneInverses)}}),ta.prototype=Object.assign(Object.create($r.prototype),{constructor:ta,isBone:!0}),ea.prototype=Object.assign(Object.create(lo.prototype),{constructor:ea,isSkinnedMesh:!0,initBones:function(){var t,e,n,r,i=[];if(this.geometry&&void 0!==this.geometry.bones){for(n=0,r=this.geometry.bones.length;n<r;n++)e=this.geometry.bones[n],t=new ta,i.push(t),t.name=e.name,t.position.fromArray(e.pos),t.quaternion.fromArray(e.rotq),void 0!==e.scl&&t.scale.fromArray(e.scl);for(n=0,r=this.geometry.bones.length;n<r;n++)-1!==(e=this.geometry.bones[n]).parent&&null!==e.parent&&void 0!==i[e.parent]?i[e.parent].add(i[n]):this.add(i[n])}return this.updateMatrixWorld(!0),i},bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var t,e;if(this.geometry&&this.geometry.isGeometry)for(e=0;e<this.geometry.skinWeights.length;e++){var n=this.geometry.skinWeights[e];(t=1/n.manhattanLength())!==1/0?n.multiplyScalar(t):n.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){var r=new Je,i=this.geometry.attributes.skinWeight;for(e=0;e<i.count;e++)r.x=i.getX(e),r.y=i.getY(e),r.z=i.getZ(e),r.w=i.getW(e),(t=1/r.manhattanLength())!==1/0?r.multiplyScalar(t):r.set(1,0,0,0),i.setXYZW(e,r.x,r.y,r.z,r.w)}},updateMatrixWorld:function(t){lo.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),na.prototype=Object.create(yr.prototype),na.prototype.constructor=na,na.prototype.isLineBasicMaterial=!0,na.prototype.copy=function(t){return yr.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this},ra.prototype=Object.assign(Object.create($r.prototype),{constructor:ra,isLine:!0,raycast:(To=new He,Oo=new ao,Ao=new wr,function(t,e){var n=t.linePrecision,r=n*n,i=this.geometry,o=this.matrixWorld;if(null===i.boundingSphere&&i.computeBoundingSphere(),Ao.copy(i.boundingSphere),Ao.applyMatrix4(o),!1!==t.ray.intersectsSphere(Ao)){To.getInverse(o),Oo.copy(t.ray).applyMatrix4(To);var a=new We,s=new We,u=new We,l=new We,c=this&&this.isLineSegments?2:1;if(i.isBufferGeometry){var h=i.index,p=i.attributes.position.array;if(null!==h)for(var f=h.array,d=0,m=f.length-1;d<m;d+=c){var g=f[d],v=f[d+1];a.fromArray(p,3*g),s.fromArray(p,3*v),Oo.distanceSqToSegment(a,s,l,u)>r||(l.applyMatrix4(this.matrixWorld),(_=t.ray.origin.distanceTo(l))<t.near||_>t.far||e.push({distance:_,point:u.clone().applyMatrix4(this.matrixWorld),index:d,face:null,faceIndex:null,object:this}))}else for(d=0,m=p.length/3-1;d<m;d+=c)a.fromArray(p,3*d),s.fromArray(p,3*d+3),Oo.distanceSqToSegment(a,s,l,u)>r||(l.applyMatrix4(this.matrixWorld),(_=t.ray.origin.distanceTo(l))<t.near||_>t.far||e.push({distance:_,point:u.clone().applyMatrix4(this.matrixWorld),index:d,face:null,faceIndex:null,object:this}))}else if(i.isGeometry){var y=i.vertices,b=y.length;for(d=0;d<b-1;d+=c){var _;Oo.distanceSqToSegment(y[d],y[d+1],l,u)>r||(l.applyMatrix4(this.matrixWorld),(_=t.ray.origin.distanceTo(l))<t.near||_>t.far||e.push({distance:_,point:u.clone().applyMatrix4(this.matrixWorld),index:d,face:null,faceIndex:null,object:this}))}}}}),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),ia.prototype=Object.assign(Object.create(ra.prototype),{constructor:ia,isLineSegments:!0}),oa.prototype=Object.assign(Object.create(ra.prototype),{constructor:oa,isLineLoop:!0}),aa.prototype=Object.create(yr.prototype),aa.prototype.constructor=aa,aa.prototype.isPointsMaterial=!0,aa.prototype.copy=function(t){return yr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this},sa.prototype=Object.assign(Object.create($r.prototype),{constructor:sa,isPoints:!0,raycast:(Mo=new He,Co=new ao,ko=new wr,function(t,e){var n=this,r=this.geometry,i=this.matrixWorld,o=t.params.Points.threshold;if(null===r.boundingSphere&&r.computeBoundingSphere(),ko.copy(r.boundingSphere),ko.applyMatrix4(i),ko.radius+=o,!1!==t.ray.intersectsSphere(ko)){Mo.getInverse(i),Co.copy(t.ray).applyMatrix4(Mo);var a=o/((this.scale.x+this.scale.y+this.scale.z)/3),s=a*a,u=new We;if(r.isBufferGeometry){var l=r.index,c=r.attributes.position.array;if(null!==l)for(var h=l.array,p=0,f=h.length;p<f;p++){var d=h[p];u.fromArray(c,3*d),v(u,d)}else{p=0;for(var m=c.length/3;p<m;p++)u.fromArray(c,3*p),v(u,p)}}else{var g=r.vertices;for(p=0,m=g.length;p<m;p++)v(g[p],p)}}function v(r,o){var a=Co.distanceSqToPoint(r);if(a<s){var u=Co.closestPointToPoint(r);u.applyMatrix4(i);var l=t.ray.origin.distanceTo(u);if(l<t.near||l>t.far)return;e.push({distance:l,distanceToRay:Math.sqrt(a),point:u.clone(),index:o,face:null,object:n})}}}),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),ua.prototype=Object.assign(Object.create($r.prototype),{constructor:ua,isGroup:!0}),la.prototype=Object.assign(Object.create(Ze.prototype),{constructor:la,isVideoTexture:!0,update:function(){var t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),ca.prototype=Object.create(Ze.prototype),ca.prototype.constructor=ca,ca.prototype.isCompressedTexture=!0,ha.prototype=Object.create(Ze.prototype),ha.prototype.constructor=ha,ha.prototype.isDepthTexture=!0,pa.prototype=Object.create(Qi.prototype),pa.prototype.constructor=pa,fa.prototype=Object.create(ai.prototype),fa.prototype.constructor=fa,da.prototype=Object.create(Qi.prototype),da.prototype.constructor=da,ma.prototype=Object.create(ai.prototype),ma.prototype.constructor=ma,ga.prototype=Object.create(Qi.prototype),ga.prototype.constructor=ga,va.prototype=Object.create(ai.prototype),va.prototype.constructor=va,ya.prototype=Object.create(ga.prototype),ya.prototype.constructor=ya,ba.prototype=Object.create(ai.prototype),ba.prototype.constructor=ba,_a.prototype=Object.create(ga.prototype),_a.prototype.constructor=_a,xa.prototype=Object.create(ai.prototype),xa.prototype.constructor=xa,wa.prototype=Object.create(ga.prototype),wa.prototype.constructor=wa,Ea.prototype=Object.create(ai.prototype),Ea.prototype.constructor=Ea,Sa.prototype=Object.create(ga.prototype),Sa.prototype.constructor=Sa,Ta.prototype=Object.create(ai.prototype),Ta.prototype.constructor=Ta,Oa.prototype=Object.create(Qi.prototype),Oa.prototype.constructor=Oa,Aa.prototype=Object.create(ai.prototype),Aa.prototype.constructor=Aa,Ma.prototype=Object.create(Qi.prototype),Ma.prototype.constructor=Ma,Ca.prototype=Object.create(ai.prototype),Ca.prototype.constructor=Ca,ka.prototype=Object.create(Qi.prototype),ka.prototype.constructor=ka;var Pa=function(t,e,n){n=n||2;var r,i,o,a,s,u,l,c=e&&e.length,h=c?e[0]*n:t.length,p=Ra(t,0,h,n,!0),f=[];if(!p)return f;if(c&&(p=function(t,e,n,r){var i,o,a,s,u,l=[];for(i=0,o=e.length;i<o;i++)a=e[i]*r,s=i<o-1?e[i+1]*r:t.length,(u=Ra(t,a,s,r,!1))===u.next&&(u.steiner=!0),l.push(Ga(u));for(l.sort(Fa),i=0;i<l.length;i++)Ba(l[i],n),n=La(n,n.next);return n}(t,e,p,n)),t.length>80*n){r=o=t[0],i=a=t[1];for(var d=n;d<h;d+=n)s=t[d],u=t[d+1],s<r&&(r=s),u<i&&(i=u),s>o&&(o=s),u>a&&(a=u);l=0!==(l=Math.max(o-r,a-i))?1/l:0}return Ia(p,f,n,r,i,l),f};function Ra(t,e,n,r,i){var o,a;if(i===function(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}(t,e,n,r)>0)for(o=e;o<n;o+=r)a=$a(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=$a(o,t[o],t[o+1],a);return a&&Wa(a,a.next)&&(Za(a),a=a.next),a}function La(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!Wa(r,r.next)&&0!==Va(r.prev,r,r.next))r=r.next;else{if(Za(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function Ia(t,e,n,r,i,o,a){if(t){!a&&o&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=za(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,a,s,u,l=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<l&&(s++,r=r.nextZ);e++);for(u=l;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,l*=2}while(a>1)}(i)}(t,r,i,o);for(var s,u,l=t;t.prev!==t.next;)if(s=t.prev,u=t.next,o?Na(t,r,i,o):Da(t))e.push(s.i/n),e.push(t.i/n),e.push(u.i/n),Za(t),t=u.next,l=u.next;else if((t=u)===l){a?1===a?Ia(t=ja(t,e,n),e,n,r,i,o,2):2===a&&Ua(t,e,n,r,i,o):Ia(La(t),e,n,r,i,o,1);break}}}function Da(t){var e=t.prev,n=t,r=t.next;if(Va(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(Ha(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&Va(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function Na(t,e,n,r){var i=t.prev,o=t,a=t.next;if(Va(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,u=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,l=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,c=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,h=za(s,u,e,n,r),p=za(l,c,e,n,r),f=t.nextZ;f&&f.z<=p;){if(f!==t.prev&&f!==t.next&&Ha(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&Va(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(f=t.prevZ;f&&f.z>=h;){if(f!==t.prev&&f!==t.next&&Ha(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&Va(f.prev,f,f.next)>=0)return!1;f=f.prevZ}return!0}function ja(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!Wa(i,o)&&qa(i,r,r.next,o)&&Xa(i,o)&&Xa(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),Za(r),Za(r.next),r=t=o),r=r.next}while(r!==t);return r}function Ua(t,e,n,r,i,o){var a,s,u=t;do{for(var l=u.next.next;l!==u.prev;){if(u.i!==l.i&&(s=l,(a=u).next.i!==s.i&&a.prev.i!==s.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&qa(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(a,s)&&Xa(a,s)&&Xa(s,a)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(a,s))){var c=Ya(u,l);return u=La(u,u.next),c=La(c,c.next),Ia(u,e,n,r,i,o),void Ia(c,e,n,r,i,o)}l=l.next}u=u.next}while(u!==t)}function Fa(t,e){return t.x-e.x}function Ba(t,e){if(e=function(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===a)return n.prev;var u,l=n,c=n.x,h=n.y,p=1/0;r=n.next;for(;r!==l;)i>=r.x&&r.x>=c&&i!==r.x&&Ha(o<h?i:a,o,c,h,o<h?a:i,o,r.x,r.y)&&((u=Math.abs(o-r.y)/(i-r.x))<p||u===p&&r.x>n.x)&&Xa(r,t)&&(n=r,p=u),r=r.next;return n}(t,e)){var n=Ya(e,t);La(n,n.next)}}function za(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Ga(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}function Ha(t,e,n,r,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(r-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function Va(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Wa(t,e){return t.x===e.x&&t.y===e.y}function qa(t,e,n,r){return!!(Wa(t,e)&&Wa(n,r)||Wa(t,r)&&Wa(n,e))||Va(t,e,n)>0!=Va(t,e,r)>0&&Va(n,r,t)>0!=Va(n,r,e)>0}function Xa(t,e){return Va(t.prev,t,t.next)<0?Va(t,e,t.next)>=0&&Va(t,t.prev,e)>=0:Va(t,e,t.prev)<0||Va(t,t.next,e)<0}function Ya(t,e){var n=new Ja(t.i,t.x,t.y),r=new Ja(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function $a(t,e,n,r){var i=new Ja(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Za(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Ja(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var Ka={area:function(t){for(var e=t.length,n=0,r=e-1,i=0;i<e;r=i++)n+=t[r].x*t[i].y-t[i].x*t[r].y;return.5*n},isClockWise:function(t){return Ka.area(t)<0},triangulateShape:function(t,e){function n(t){var e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function r(t,e){for(var n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}var i=[],o=[],a=[];n(t),r(i,t);var s=t.length;for(e.forEach(n),l=0;l<e.length;l++)o.push(s),s+=e[l].length,r(i,e[l]);for(var u=Pa(i,o),l=0;l<u.length;l+=3)a.push(u.slice(l,l+3));return a}};function Qa(t,e){ai.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new ts(t,e)),this.mergeVertices()}function ts(t,e){void 0!==t&&(Qi.call(this),this.type="ExtrudeBufferGeometry",t=Array.isArray(t)?t:[t],this.addShapeList(t,e),this.computeVertexNormals())}function es(t,e){ai.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:e},this.fromBufferGeometry(new ns(t,e)),this.mergeVertices()}function ns(t,e){var n=(e=e||{}).font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new ai;var r=n.generateShapes(t,e.size,e.curveSegments);e.amount=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),ts.call(this,r,e),this.type="TextBufferGeometry"}function rs(t,e,n,r,i,o,a){ai.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new is(t,e,n,r,i,o,a)),this.mergeVertices()}function is(t,e,n,r,i,o,a){Qi.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},t=t||1,e=Math.max(3,Math.floor(e)||8),n=Math.max(2,Math.floor(n)||6),r=void 0!==r?r:0,i=void 0!==i?i:2*Math.PI;var s,u,l=(o=void 0!==o?o:0)+(a=void 0!==a?a:Math.PI),c=0,h=[],p=new We,f=new We,d=[],m=[],g=[],v=[];for(u=0;u<=n;u++){var y=[],b=u/n;for(s=0;s<=e;s++){var _=s/e;p.x=-t*Math.cos(r+_*i)*Math.sin(o+b*a),p.y=t*Math.cos(o+b*a),p.z=t*Math.sin(r+_*i)*Math.sin(o+b*a),m.push(p.x,p.y,p.z),f.set(p.x,p.y,p.z).normalize(),g.push(f.x,f.y,f.z),v.push(_,1-b),y.push(c++)}h.push(y)}for(u=0;u<n;u++)for(s=0;s<e;s++){var x=h[u][s+1],w=h[u][s],E=h[u+1][s],S=h[u+1][s+1];(0!==u||o>0)&&d.push(x,w,S),(u!==n-1||l<Math.PI)&&d.push(w,E,S)}this.setIndex(d),this.addAttribute("position",new mi(m,3)),this.addAttribute("normal",new mi(g,3)),this.addAttribute("uv",new mi(v,2))}function os(t,e,n,r,i,o){ai.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},this.fromBufferGeometry(new as(t,e,n,r,i,o)),this.mergeVertices()}function as(t,e,n,r,i,o){Qi.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},t=t||.5,e=e||1,i=void 0!==i?i:0,o=void 0!==o?o:2*Math.PI,n=void 0!==n?Math.max(3,n):8;var a,s,u,l=[],c=[],h=[],p=[],f=t,d=(e-t)/(r=void 0!==r?Math.max(1,r):1),m=new We,g=new Ge;for(s=0;s<=r;s++){for(u=0;u<=n;u++)a=i+u/n*o,m.x=f*Math.cos(a),m.y=f*Math.sin(a),c.push(m.x,m.y,m.z),h.push(0,0,1),g.x=(m.x/e+1)/2,g.y=(m.y/e+1)/2,p.push(g.x,g.y);f+=d}for(s=0;s<r;s++){var v=s*(n+1);for(u=0;u<n;u++){var y=a=u+v,b=a+n+1,_=a+n+2,x=a+1;l.push(y,b,x),l.push(b,_,x)}}this.setIndex(l),this.addAttribute("position",new mi(c,3)),this.addAttribute("normal",new mi(h,3)),this.addAttribute("uv",new mi(p,2))}function ss(t,e,n,r){ai.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},this.fromBufferGeometry(new us(t,e,n,r)),this.mergeVertices()}function us(t,e,n,r){Qi.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},e=Math.floor(e)||12,n=n||0,r=r||2*Math.PI,r=ze.clamp(r,0,2*Math.PI);var i,o,a,s=[],u=[],l=[],c=1/e,h=new We,p=new Ge;for(o=0;o<=e;o++){var f=n+o*c*r,d=Math.sin(f),m=Math.cos(f);for(a=0;a<=t.length-1;a++)h.x=t[a].x*d,h.y=t[a].y,h.z=t[a].x*m,u.push(h.x,h.y,h.z),p.x=o/e,p.y=a/(t.length-1),l.push(p.x,p.y)}for(o=0;o<e;o++)for(a=0;a<t.length-1;a++){var g=i=a+o*t.length,v=i+t.length,y=i+t.length+1,b=i+1;s.push(g,v,b),s.push(v,y,b)}if(this.setIndex(s),this.addAttribute("position",new mi(u,3)),this.addAttribute("uv",new mi(l,2)),this.computeVertexNormals(),r===2*Math.PI){var _=this.attributes.normal.array,x=new We,w=new We,E=new We;for(i=e*t.length*3,o=0,a=0;o<t.length;o++,a+=3)x.x=_[a+0],x.y=_[a+1],x.z=_[a+2],w.x=_[i+a+0],w.y=_[i+a+1],w.z=_[i+a+2],E.addVectors(x,w).normalize(),_[a+0]=_[i+a+0]=E.x,_[a+1]=_[i+a+1]=E.y,_[a+2]=_[i+a+2]=E.z}}function ls(t,e){ai.call(this),this.type="ShapeGeometry","object"==typeof e&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new cs(t,e)),this.mergeVertices()}function cs(t,e){Qi.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:e},e=e||12;var n=[],r=[],i=[],o=[],a=0,s=0;if(!1===Array.isArray(t))l(t);else for(var u=0;u<t.length;u++)l(t[u]),this.addGroup(a,s,u),a+=s,s=0;function l(t){var a,u,l,c=r.length/3,h=t.extractPoints(e),p=h.shape,f=h.holes;if(!1===Ka.isClockWise(p))for(p=p.reverse(),a=0,u=f.length;a<u;a++)l=f[a],!0===Ka.isClockWise(l)&&(f[a]=l.reverse());var d=Ka.triangulateShape(p,f);for(a=0,u=f.length;a<u;a++)l=f[a],p=p.concat(l);for(a=0,u=p.length;a<u;a++){var m=p[a];r.push(m.x,m.y,0),i.push(0,0,1),o.push(m.x,m.y)}for(a=0,u=d.length;a<u;a++){var g=d[a],v=g[0]+c,y=g[1]+c,b=g[2]+c;n.push(v,y,b),s+=3}}this.setIndex(n),this.addAttribute("position",new mi(r,3)),this.addAttribute("normal",new mi(i,3)),this.addAttribute("uv",new mi(o,2))}function hs(t,e){if(e.shapes=[],Array.isArray(t))for(var n=0,r=t.length;n<r;n++){var i=t[n];e.shapes.push(i.uuid)}else e.shapes.push(t.uuid);return e}function ps(t,e){Qi.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e},e=void 0!==e?e:1;var n,r,i,o,a=[],s=Math.cos(ze.DEG2RAD*e),u=[0,0],l={},c=["a","b","c"];t.isBufferGeometry?(o=new ai).fromBufferGeometry(t):o=t.clone(),o.mergeVertices(),o.computeFaceNormals();for(var h=o.vertices,p=o.faces,f=0,d=p.length;f<d;f++)for(var m=p[f],g=0;g<3;g++)n=m[c[g]],r=m[c[(g+1)%3]],u[0]=Math.min(n,r),u[1]=Math.max(n,r),void 0===l[i=u[0]+","+u[1]]?l[i]={index1:u[0],index2:u[1],face1:f,face2:void 0}:l[i].face2=f;for(i in l){var v=l[i];if(void 0===v.face2||p[v.face1].normal.dot(p[v.face2].normal)<=s){var y=h[v.index1];a.push(y.x,y.y,y.z),y=h[v.index2],a.push(y.x,y.y,y.z)}}this.addAttribute("position",new mi(a,3))}function fs(t,e,n,r,i,o,a,s){ai.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new ds(t,e,n,r,i,o,a,s)),this.mergeVertices()}function ds(t,e,n,r,i,o,a,s){Qi.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s};var u=this;t=void 0!==t?t:1,e=void 0!==e?e:1,n=n||1,r=Math.floor(r)||8,i=Math.floor(i)||1,o=void 0!==o&&o,a=void 0!==a?a:0,s=void 0!==s?s:2*Math.PI;var l=[],c=[],h=[],p=[],f=0,d=[],m=n/2,g=0;function v(n){var i,o,d,v=new Ge,y=new We,b=0,_=!0===n?t:e,x=!0===n?1:-1;for(o=f,i=1;i<=r;i++)c.push(0,m*x,0),h.push(0,x,0),p.push(.5,.5),f++;for(d=f,i=0;i<=r;i++){var w=i/r*s+a,E=Math.cos(w),S=Math.sin(w);y.x=_*S,y.y=m*x,y.z=_*E,c.push(y.x,y.y,y.z),h.push(0,x,0),v.x=.5*E+.5,v.y=.5*S*x+.5,p.push(v.x,v.y),f++}for(i=0;i<r;i++){var T=o+i,O=d+i;!0===n?l.push(O,O+1,T):l.push(O+1,O,T),b+=3}u.addGroup(g,b,!0===n?1:2),g+=b}!function(){var o,v,y=new We,b=new We,_=0,x=(e-t)/n;for(v=0;v<=i;v++){var w=[],E=v/i,S=E*(e-t)+t;for(o=0;o<=r;o++){var T=o/r,O=T*s+a,A=Math.sin(O),M=Math.cos(O);b.x=S*A,b.y=-E*n+m,b.z=S*M,c.push(b.x,b.y,b.z),y.set(A,x,M).normalize(),h.push(y.x,y.y,y.z),p.push(T,1-E),w.push(f++)}d.push(w)}for(o=0;o<r;o++)for(v=0;v<i;v++){var C=d[v][o],k=d[v+1][o],P=d[v+1][o+1],R=d[v][o+1];l.push(C,k,R),l.push(k,P,R),_+=6}u.addGroup(g,_,0),g+=_}(),!1===o&&(t>0&&v(!0),e>0&&v(!1)),this.setIndex(l),this.addAttribute("position",new mi(c,3)),this.addAttribute("normal",new mi(h,3)),this.addAttribute("uv",new mi(p,2))}function ms(t,e,n,r,i,o,a){fs.call(this,0,t,e,n,r,i,o,a),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function gs(t,e,n,r,i,o,a){ds.call(this,0,t,e,n,r,i,o,a),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function vs(t,e,n,r){ai.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},this.fromBufferGeometry(new ys(t,e,n,r)),this.mergeVertices()}function ys(t,e,n,r){Qi.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},t=t||1,e=void 0!==e?Math.max(3,e):8,n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;var i,o,a=[],s=[],u=[],l=[],c=new We,h=new Ge;for(s.push(0,0,0),u.push(0,0,1),l.push(.5,.5),o=0,i=3;o<=e;o++,i+=3){var p=n+o/e*r;c.x=t*Math.cos(p),c.y=t*Math.sin(p),s.push(c.x,c.y,c.z),u.push(0,0,1),h.x=(s[i]/t+1)/2,h.y=(s[i+1]/t+1)/2,l.push(h.x,h.y)}for(i=1;i<=e;i++)a.push(i,i+1,0);this.setIndex(a),this.addAttribute("position",new mi(s,3)),this.addAttribute("normal",new mi(u,3)),this.addAttribute("uv",new mi(l,2))}Qa.prototype=Object.create(ai.prototype),Qa.prototype.constructor=Qa,ts.prototype=Object.create(Qi.prototype),ts.prototype.constructor=ts,ts.prototype.getArrays=function(){var t=this.getAttribute("position"),e=t?Array.prototype.slice.call(t.array):[],n=this.getAttribute("uv"),r=n?Array.prototype.slice.call(n.array):[],i=this.index;return{position:e,uv:r,index:i?Array.prototype.slice.call(i.array):[]}},ts.prototype.addShapeList=function(t,e){var n=t.length;e.arrays=this.getArrays();for(var r=0;r<n;r++){var i=t[r];this.addShape(i,e)}this.setIndex(e.arrays.index),this.addAttribute("position",new mi(e.arrays.position,3)),this.addAttribute("uv",new mi(e.arrays.uv,2))},ts.prototype.addShape=function(t,e){var n,r,i,o,a,s,u,l,c=e.arrays?e.arrays:this.getArrays(),h=c.position,p=c.index,f=c.uv,d=[],m=void 0!==e.amount?e.amount:100,g=void 0!==e.bevelThickness?e.bevelThickness:6,v=void 0!==e.bevelSize?e.bevelSize:g-2,y=void 0!==e.bevelSegments?e.bevelSegments:3,b=void 0===e.bevelEnabled||e.bevelEnabled,_=void 0!==e.curveSegments?e.curveSegments:12,x=void 0!==e.steps?e.steps:1,w=e.extrudePath,E=!1,S=void 0!==e.UVGenerator?e.UVGenerator:Qa.WorldUVGenerator;w&&(n=w.getSpacedPoints(x),E=!0,b=!1,r=void 0!==e.frames?e.frames:w.computeFrenetFrames(x,!1),i=new We,o=new We,a=new We),b||(y=0,g=0,v=0);var T=this,O=t.extractPoints(_),A=O.shape,M=O.holes;if(!Ka.isClockWise(A))for(A=A.reverse(),u=0,l=M.length;u<l;u++)s=M[u],Ka.isClockWise(s)&&(M[u]=s.reverse());var C=Ka.triangulateShape(A,M),k=A;for(u=0,l=M.length;u<l;u++)s=M[u],A=A.concat(s);function P(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}var R,L,I,D,N,j,U=A.length,F=C.length;function B(t,e,n){var r,i,o,a=t.x-e.x,s=t.y-e.y,u=n.x-t.x,l=n.y-t.y,c=a*a+s*s,h=a*l-s*u;if(Math.abs(h)>Number.EPSILON){var p=Math.sqrt(c),f=Math.sqrt(u*u+l*l),d=e.x-s/p,m=e.y+a/p,g=((n.x-l/f-d)*l-(n.y+u/f-m)*u)/(a*l-s*u),v=(r=d+a*g-t.x)*r+(i=m+s*g-t.y)*i;if(v<=2)return new Ge(r,i);o=Math.sqrt(v/2)}else{var y=!1;a>Number.EPSILON?u>Number.EPSILON&&(y=!0):a<-Number.EPSILON?u<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(l)&&(y=!0),y?(r=-s,i=a,o=Math.sqrt(c)):(r=a,i=s,o=Math.sqrt(c/2))}return new Ge(r/o,i/o)}for(var z=[],G=0,H=k.length,V=H-1,W=G+1;G<H;G++,V++,W++)V===H&&(V=0),W===H&&(W=0),z[G]=B(k[G],k[V],k[W]);var q,X,Y=[],$=z.concat();for(u=0,l=M.length;u<l;u++){for(s=M[u],q=[],G=0,V=(H=s.length)-1,W=G+1;G<H;G++,V++,W++)V===H&&(V=0),W===H&&(W=0),q[G]=B(s[G],s[V],s[W]);Y.push(q),$=$.concat(q)}for(R=0;R<y;R++){for(I=R/y,D=g*Math.cos(I*Math.PI/2),L=v*Math.sin(I*Math.PI/2),G=0,H=k.length;G<H;G++)J((N=P(k[G],z[G],L)).x,N.y,-D);for(u=0,l=M.length;u<l;u++)for(s=M[u],q=Y[u],G=0,H=s.length;G<H;G++)J((N=P(s[G],q[G],L)).x,N.y,-D)}for(L=v,G=0;G<U;G++)N=b?P(A[G],$[G],L):A[G],E?(o.copy(r.normals[0]).multiplyScalar(N.x),i.copy(r.binormals[0]).multiplyScalar(N.y),a.copy(n[0]).add(o).add(i),J(a.x,a.y,a.z)):J(N.x,N.y,0);for(X=1;X<=x;X++)for(G=0;G<U;G++)N=b?P(A[G],$[G],L):A[G],E?(o.copy(r.normals[X]).multiplyScalar(N.x),i.copy(r.binormals[X]).multiplyScalar(N.y),a.copy(n[X]).add(o).add(i),J(a.x,a.y,a.z)):J(N.x,N.y,m/x*X);for(R=y-1;R>=0;R--){for(I=R/y,D=g*Math.cos(I*Math.PI/2),L=v*Math.sin(I*Math.PI/2),G=0,H=k.length;G<H;G++)J((N=P(k[G],z[G],L)).x,N.y,m+D);for(u=0,l=M.length;u<l;u++)for(s=M[u],q=Y[u],G=0,H=s.length;G<H;G++)N=P(s[G],q[G],L),E?J(N.x,N.y+n[x-1].y,n[x-1].x+D):J(N.x,N.y,m+D)}function Z(t,e){var n,r;for(G=t.length;--G>=0;){n=G,(r=G-1)<0&&(r=t.length-1);var i=0,o=x+2*y;for(i=0;i<o;i++){var a=U*i,s=U*(i+1);Q(e+n+a,e+r+a,e+r+s,e+n+s)}}}function J(t,e,n){d.push(t),d.push(e),d.push(n)}function K(t,e,n){tt(t),tt(e),tt(n);var r=h.length/3,i=S.generateTopUV(T,h,r-3,r-2,r-1);et(i[0]),et(i[1]),et(i[2])}function Q(t,e,n,r){tt(t),tt(e),tt(r),tt(e),tt(n),tt(r);var i=h.length/3,o=S.generateSideWallUV(T,h,i-6,i-3,i-2,i-1);et(o[0]),et(o[1]),et(o[3]),et(o[1]),et(o[2]),et(o[3])}function tt(t){p.push(h.length/3),h.push(d[3*t+0]),h.push(d[3*t+1]),h.push(d[3*t+2])}function et(t){f.push(t.x),f.push(t.y)}!function(){var t=h.length/3;if(b){var n=0,r=U*n;for(G=0;G<F;G++)K((j=C[G])[2]+r,j[1]+r,j[0]+r);for(r=U*(n=x+2*y),G=0;G<F;G++)K((j=C[G])[0]+r,j[1]+r,j[2]+r)}else{for(G=0;G<F;G++)K((j=C[G])[2],j[1],j[0]);for(G=0;G<F;G++)K((j=C[G])[0]+U*x,j[1]+U*x,j[2]+U*x)}T.addGroup(t,h.length/3-t,void 0!==e.material?e.material:0)}(),function(){var t=h.length/3,n=0;for(Z(k,n),n+=k.length,u=0,l=M.length;u<l;u++)Z(s=M[u],n),n+=s.length;T.addGroup(t,h.length/3-t,void 0!==e.extrudeMaterial?e.extrudeMaterial:1)}(),e.arrays||(this.setIndex(p),this.addAttribute("position",new mi(h,3)),this.addAttribute("uv",new mi(f,2)))},Qa.WorldUVGenerator={generateTopUV:function(t,e,n,r,i){var o=e[3*n],a=e[3*n+1],s=e[3*r],u=e[3*r+1],l=e[3*i],c=e[3*i+1];return[new Ge(o,a),new Ge(s,u),new Ge(l,c)]},generateSideWallUV:function(t,e,n,r,i,o){var a=e[3*n],s=e[3*n+1],u=e[3*n+2],l=e[3*r],c=e[3*r+1],h=e[3*r+2],p=e[3*i],f=e[3*i+1],d=e[3*i+2],m=e[3*o],g=e[3*o+1],v=e[3*o+2];return Math.abs(s-c)<.01?[new Ge(a,1-u),new Ge(l,1-h),new Ge(p,1-d),new Ge(m,1-v)]:[new Ge(s,1-u),new Ge(c,1-h),new Ge(f,1-d),new Ge(g,1-v)]}},es.prototype=Object.create(ai.prototype),es.prototype.constructor=es,ns.prototype=Object.create(ts.prototype),ns.prototype.constructor=ns,rs.prototype=Object.create(ai.prototype),rs.prototype.constructor=rs,is.prototype=Object.create(Qi.prototype),is.prototype.constructor=is,os.prototype=Object.create(ai.prototype),os.prototype.constructor=os,as.prototype=Object.create(Qi.prototype),as.prototype.constructor=as,ss.prototype=Object.create(ai.prototype),ss.prototype.constructor=ss,us.prototype=Object.create(Qi.prototype),us.prototype.constructor=us,ls.prototype=Object.create(ai.prototype),ls.prototype.constructor=ls,ls.prototype.toJSON=function(){var t=ai.prototype.toJSON.call(this);return hs(this.parameters.shapes,t)},cs.prototype=Object.create(Qi.prototype),cs.prototype.constructor=cs,cs.prototype.toJSON=function(){var t=Qi.prototype.toJSON.call(this);return hs(this.parameters.shapes,t)},ps.prototype=Object.create(Qi.prototype),ps.prototype.constructor=ps,fs.prototype=Object.create(ai.prototype),fs.prototype.constructor=fs,ds.prototype=Object.create(Qi.prototype),ds.prototype.constructor=ds,ms.prototype=Object.create(fs.prototype),ms.prototype.constructor=ms,gs.prototype=Object.create(ds.prototype),gs.prototype.constructor=gs,vs.prototype=Object.create(ai.prototype),vs.prototype.constructor=vs,ys.prototype=Object.create(Qi.prototype),ys.prototype.constructor=ys;var bs=Object.freeze({WireframeGeometry:pa,ParametricGeometry:fa,ParametricBufferGeometry:da,TetrahedronGeometry:va,TetrahedronBufferGeometry:ya,OctahedronGeometry:ba,OctahedronBufferGeometry:_a,IcosahedronGeometry:xa,IcosahedronBufferGeometry:wa,DodecahedronGeometry:Ea,DodecahedronBufferGeometry:Sa,PolyhedronGeometry:ma,PolyhedronBufferGeometry:ga,TubeGeometry:Ta,TubeBufferGeometry:Oa,TorusKnotGeometry:Aa,TorusKnotBufferGeometry:Ma,TorusGeometry:Ca,TorusBufferGeometry:ka,TextGeometry:es,TextBufferGeometry:ns,SphereGeometry:rs,SphereBufferGeometry:is,RingGeometry:os,RingBufferGeometry:as,PlaneGeometry:no,PlaneBufferGeometry:ro,LatheGeometry:ss,LatheBufferGeometry:us,ShapeGeometry:ls,ShapeBufferGeometry:cs,ExtrudeGeometry:Qa,ExtrudeBufferGeometry:ts,EdgesGeometry:ps,ConeGeometry:ms,ConeBufferGeometry:gs,CylinderGeometry:fs,CylinderBufferGeometry:ds,CircleGeometry:vs,CircleBufferGeometry:ys,BoxGeometry:to,BoxBufferGeometry:eo});function _s(t){yr.call(this),this.type="ShadowMaterial",this.color=new Hn(0),this.opacity=1,this.lights=!0,this.transparent=!0,this.setValues(t)}function xs(t){oo.call(this,t),this.type="RawShaderMaterial"}function ws(t){yr.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Hn(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Hn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Ge(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Es(t){ws.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(t)}function Ss(t){yr.call(this),this.type="MeshPhongMaterial",this.color=new Hn(16777215),this.specular=new Hn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Hn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Ge(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=bt,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Ts(t){Ss.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(t)}function Os(t){yr.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Ge(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function As(t){yr.call(this),this.type="MeshLambertMaterial",this.color=new Hn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Hn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=bt,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Ms(t){na.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}_s.prototype=Object.create(yr.prototype),_s.prototype.constructor=_s,_s.prototype.isShadowMaterial=!0,xs.prototype=Object.create(oo.prototype),xs.prototype.constructor=xs,xs.prototype.isRawShaderMaterial=!0,ws.prototype=Object.create(yr.prototype),ws.prototype.constructor=ws,ws.prototype.isMeshStandardMaterial=!0,ws.prototype.copy=function(t){return yr.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Es.prototype=Object.create(ws.prototype),Es.prototype.constructor=Es,Es.prototype.isMeshPhysicalMaterial=!0,Es.prototype.copy=function(t){return ws.prototype.copy.call(this,t),this.defines={PHYSICAL:""},this.reflectivity=t.reflectivity,this.clearCoat=t.clearCoat,this.clearCoatRoughness=t.clearCoatRoughness,this},Ss.prototype=Object.create(yr.prototype),Ss.prototype.constructor=Ss,Ss.prototype.isMeshPhongMaterial=!0,Ss.prototype.copy=function(t){return yr.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Ts.prototype=Object.create(Ss.prototype),Ts.prototype.constructor=Ts,Ts.prototype.isMeshToonMaterial=!0,Ts.prototype.copy=function(t){return Ss.prototype.copy.call(this,t),this.gradientMap=t.gradientMap,this},Os.prototype=Object.create(yr.prototype),Os.prototype.constructor=Os,Os.prototype.isMeshNormalMaterial=!0,Os.prototype.copy=function(t){return yr.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},As.prototype=Object.create(yr.prototype),As.prototype.constructor=As,As.prototype.isMeshLambertMaterial=!0,As.prototype.copy=function(t){return yr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Ms.prototype=Object.create(na.prototype),Ms.prototype.constructor=Ms,Ms.prototype.isLineDashedMaterial=!0,Ms.prototype.copy=function(t){return na.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var Cs=Object.freeze({ShadowMaterial:_s,SpriteMaterial:Zo,RawShaderMaterial:xs,ShaderMaterial:oo,PointsMaterial:aa,MeshPhysicalMaterial:Es,MeshStandardMaterial:ws,MeshPhongMaterial:Ss,MeshToonMaterial:Ts,MeshNormalMaterial:Os,MeshLambertMaterial:As,MeshDepthMaterial:br,MeshDistanceMaterial:_r,MeshBasicMaterial:io,LineDashedMaterial:Ms,LineBasicMaterial:na,Material:yr}),ks={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function Ps(t,e,n){var r=this,i=!1,o=0,a=0,s=void 0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){a++,!1===i&&void 0!==r.onStart&&r.onStart(t,o,a),i=!0},this.itemEnd=function(t){o++,void 0!==r.onProgress&&r.onProgress(t,o,a),o===a&&(i=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(t){void 0!==r.onError&&r.onError(t)},this.resolveURL=function(t){return s?s(t):t},this.setURLModifier=function(t){return s=t,this}}var Rs=new Ps,Ls={};function Is(t){this.manager=void 0!==t?t:Rs}function Ds(t){this.manager=void 0!==t?t:Rs,this._parser=null}function Ns(t){this.manager=void 0!==t?t:Rs,this._parser=null}function js(t){this.manager=void 0!==t?t:Rs}function Us(t){this.manager=void 0!==t?t:Rs}function Fs(t){this.manager=void 0!==t?t:Rs}function Bs(){this.type="Curve",this.arcLengthDivisions=200}function zs(t,e,n,r,i,o,a,s){Bs.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=n||1,this.yRadius=r||1,this.aStartAngle=i||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=a||!1,this.aRotation=s||0}function Gs(t,e,n,r,i,o){zs.call(this,t,e,n,n,r,i,o),this.type="ArcCurve"}function Hs(){var t=0,e=0,n=0,r=0;function i(i,o,a,s){t=i,e=a,n=-3*i+3*o-2*a-s,r=2*i-2*o+a+s}return{initCatmullRom:function(t,e,n,r,o){i(e,n,o*(n-t),o*(r-e))},initNonuniformCatmullRom:function(t,e,n,r,o,a,s){var u=(e-t)/o-(n-t)/(o+a)+(n-e)/a,l=(n-e)/a-(r-e)/(a+s)+(r-n)/s;i(e,n,u*=a,l*=a)},calc:function(i){var o=i*i;return t+e*i+n*o+r*(o*i)}}}Object.assign(Is.prototype,{load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=ks.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout(function(){e&&e(o),i.manager.itemEnd(t)},0),o;if(void 0===Ls[t]){var a=t.match(/^data:(.*?)(;base64)?,(.*)$/);if(a){var s=a[1],u=!!a[2],l=a[3];l=window.decodeURIComponent(l),u&&(l=window.atob(l));try{var c,h=(this.responseType||"").toLowerCase();switch(h){case"arraybuffer":case"blob":for(var p=new Uint8Array(l.length),f=0;f<l.length;f++)p[f]=l.charCodeAt(f);c="blob"===h?new Blob([p.buffer],{type:s}):p.buffer;break;case"document":var d=new DOMParser;c=d.parseFromString(l,s);break;case"json":c=JSON.parse(l);break;default:c=l}window.setTimeout(function(){e&&e(c),i.manager.itemEnd(t)},0)}catch(e){window.setTimeout(function(){r&&r(e),i.manager.itemEnd(t),i.manager.itemError(t)},0)}}else{Ls[t]=[],Ls[t].push({onLoad:e,onProgress:n,onError:r});var m=new XMLHttpRequest;m.open("GET",t,!0),m.addEventListener("load",function(e){var n=this.response;ks.add(t,n);var r=Ls[t];if(delete Ls[t],200===this.status){for(var o=0,a=r.length;o<a;o++){(s=r[o]).onLoad&&s.onLoad(n)}i.manager.itemEnd(t)}else if(0===this.status){console.warn("THREE.FileLoader: HTTP Status 0 received.");for(o=0,a=r.length;o<a;o++){(s=r[o]).onLoad&&s.onLoad(n)}i.manager.itemEnd(t)}else{for(o=0,a=r.length;o<a;o++){var s;(s=r[o]).onError&&s.onError(e)}i.manager.itemEnd(t),i.manager.itemError(t)}},!1),m.addEventListener("progress",function(e){for(var n=Ls[t],r=0,i=n.length;r<i;r++){var o=n[r];o.onProgress&&o.onProgress(e)}},!1),m.addEventListener("error",function(e){var n=Ls[t];delete Ls[t];for(var r=0,o=n.length;r<o;r++){var a=n[r];a.onError&&a.onError(e)}i.manager.itemEnd(t),i.manager.itemError(t)},!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(var g in this.requestHeader)m.setRequestHeader(g,this.requestHeader[g]);m.send(null)}return i.manager.itemStart(t),m}Ls[t].push({onLoad:e,onProgress:n,onError:r})},setPath:function(t){return this.path=t,this},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}}),Object.assign(Ds.prototype,{load:function(t,e,n,r){var i=this,o=[],a=new ca;a.image=o;var s=new Is(this.manager);function u(u){s.load(t[u],function(t){var n=i._parser(t,!0);o[u]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(l+=1)&&(1===n.mipmapCount&&(a.minFilter=zt),a.format=n.format,a.needsUpdate=!0,e&&e(a))},n,r)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(t))for(var l=0,c=0,h=t.length;c<h;++c)u(c);else s.load(t,function(t){var n=i._parser(t,!0);if(n.isCubemap)for(var r=n.mipmaps.length/n.mipmapCount,s=0;s<r;s++){o[s]={mipmaps:[]};for(var u=0;u<n.mipmapCount;u++)o[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+u]),o[s].format=n.format,o[s].width=n.width,o[s].height=n.height}else a.image.width=n.width,a.image.height=n.height,a.mipmaps=n.mipmaps;1===n.mipmapCount&&(a.minFilter=zt),a.format=n.format,a.needsUpdate=!0,e&&e(a)},n,r);return a},setPath:function(t){return this.path=t,this}}),Object.assign(Ns.prototype,{load:function(t,e,n,r){var i=this,o=new tn,a=new Is(this.manager);return a.setResponseType("arraybuffer"),a.load(t,function(t){var n=i._parser(t);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:Nt,o.wrapT=void 0!==n.wrapT?n.wrapT:Nt,o.magFilter=void 0!==n.magFilter?n.magFilter:zt,o.minFilter=void 0!==n.minFilter?n.minFilter:Ht,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps),1===n.mipmapCount&&(o.minFilter=zt),o.needsUpdate=!0,e&&e(o,n))},n,r),o}}),Object.assign(js.prototype,{crossOrigin:"Anonymous",load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=ks.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout(function(){e&&e(o),i.manager.itemEnd(t)},0),o;var a=document.createElementNS("http://www.w3.org/1999/xhtml","img");return a.addEventListener("load",function(){ks.add(t,this),e&&e(this),i.manager.itemEnd(t)},!1),a.addEventListener("error",function(e){r&&r(e),i.manager.itemEnd(t),i.manager.itemError(t)},!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(t),a.src=t,a},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Us.prototype,{crossOrigin:"Anonymous",load:function(t,e,n,r){var i=new en,o=new js(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var a=0;function s(n){o.load(t[n],function(t){i.images[n]=t,6===++a&&(i.needsUpdate=!0,e&&e(i))},void 0,r)}for(var u=0;u<t.length;++u)s(u);return i},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Fs.prototype,{crossOrigin:"Anonymous",load:function(t,e,n,r){var i=new Ze,o=new js(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,function(n){i.image=n;var r=t.search(/\.(jpg|jpeg)$/)>0||0===t.search(/^data\:image\/jpeg/);i.format=r?re:ie,i.needsUpdate=!0,void 0!==e&&e(i)},n,r),i},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Bs.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,e){var n=this.getUtoTmapping(t);return this.getPoint(n,e)},getPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,n,r=[],i=this.getPoint(0),o=0;for(r.push(0),n=1;n<=t;n++)o+=(e=this.getPoint(n/t)).distanceTo(i),r.push(o),i=e;return this.cacheArcLengths=r,r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var n,r=this.getLengths(),i=0,o=r.length;n=e||t*r[o-1];for(var a,s=0,u=o-1;s<=u;)if((a=r[i=Math.floor(s+(u-s)/2)]-n)<0)s=i+1;else{if(!(a>0)){u=i;break}u=i-1}if(r[i=u]===n)return i/(o-1);var l=r[i];return(i+(n-l)/(r[i+1]-l))/(o-1)},getTangent:function(t){var e=t-1e-4,n=t+1e-4;e<0&&(e=0),n>1&&(n=1);var r=this.getPoint(e);return this.getPoint(n).clone().sub(r).normalize()},getTangentAt:function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)},computeFrenetFrames:function(t,e){var n,r,i,o=new We,a=[],s=[],u=[],l=new We,c=new He;for(n=0;n<=t;n++)r=n/t,a[n]=this.getTangentAt(r),a[n].normalize();s[0]=new We,u[0]=new We;var h=Number.MAX_VALUE,p=Math.abs(a[0].x),f=Math.abs(a[0].y),d=Math.abs(a[0].z);for(p<=h&&(h=p,o.set(1,0,0)),f<=h&&(h=f,o.set(0,1,0)),d<=h&&o.set(0,0,1),l.crossVectors(a[0],o).normalize(),s[0].crossVectors(a[0],l),u[0].crossVectors(a[0],s[0]),n=1;n<=t;n++)s[n]=s[n-1].clone(),u[n]=u[n-1].clone(),l.crossVectors(a[n-1],a[n]),l.length()>Number.EPSILON&&(l.normalize(),i=Math.acos(ze.clamp(a[n-1].dot(a[n]),-1,1)),s[n].applyMatrix4(c.makeRotationAxis(l,i))),u[n].crossVectors(a[n],s[n]);if(!0===e)for(i=Math.acos(ze.clamp(s[0].dot(s[t]),-1,1)),i/=t,a[0].dot(l.crossVectors(s[0],s[t]))>0&&(i=-i),n=1;n<=t;n++)s[n].applyMatrix4(c.makeRotationAxis(a[n],i*n)),u[n].crossVectors(a[n],s[n]);return{tangents:a,normals:s,binormals:u}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),zs.prototype=Object.create(Bs.prototype),zs.prototype.constructor=zs,zs.prototype.isEllipseCurve=!0,zs.prototype.getPoint=function(t,e){for(var n=e||new Ge,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,o=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=o?0:r),!0!==this.aClockwise||o||(i===r?i=-r:i-=r);var a=this.aStartAngle+t*i,s=this.aX+this.xRadius*Math.cos(a),u=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){var l=Math.cos(this.aRotation),c=Math.sin(this.aRotation),h=s-this.aX,p=u-this.aY;s=h*l-p*c+this.aX,u=h*c+p*l+this.aY}return n.set(s,u)},zs.prototype.copy=function(t){return Bs.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},zs.prototype.toJSON=function(){var t=Bs.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},zs.prototype.fromJSON=function(t){return Bs.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Gs.prototype=Object.create(zs.prototype),Gs.prototype.constructor=Gs,Gs.prototype.isArcCurve=!0;var Vs=new We,Ws=new Hs,qs=new Hs,Xs=new Hs;function Ys(t,e,n,r){Bs.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=e||!1,this.curveType=n||"centripetal",this.tension=r||.5}function $s(t,e,n,r,i){var o=.5*(r-e),a=.5*(i-n),s=t*t;return(2*n-2*r+o+a)*(t*s)+(-3*n+3*r-2*o-a)*s+o*t+n}function Zs(t,e,n,r){return(a=1-t)*a*e+2*(1-(o=t))*o*n+(i=t)*i*r;var i,o,a}function Js(t,e,n,r,i){return(l=1-t)*l*l*e+3*(u=1-(s=t))*u*s*n+3*(1-(a=t))*a*a*r+(o=t)*o*o*i;var o,a,s,u,l}function Ks(t,e,n,r){Bs.call(this),this.type="CubicBezierCurve",this.v0=t||new Ge,this.v1=e||new Ge,this.v2=n||new Ge,this.v3=r||new Ge}function Qs(t,e,n,r){Bs.call(this),this.type="CubicBezierCurve3",this.v0=t||new We,this.v1=e||new We,this.v2=n||new We,this.v3=r||new We}function tu(t,e){Bs.call(this),this.type="LineCurve",this.v1=t||new Ge,this.v2=e||new Ge}function eu(t,e){Bs.call(this),this.type="LineCurve3",this.v1=t||new We,this.v2=e||new We}function nu(t,e,n){Bs.call(this),this.type="QuadraticBezierCurve",this.v0=t||new Ge,this.v1=e||new Ge,this.v2=n||new Ge}function ru(t,e,n){Bs.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new We,this.v1=e||new We,this.v2=n||new We}function iu(t){Bs.call(this),this.type="SplineCurve",this.points=t||[]}Ys.prototype=Object.create(Bs.prototype),Ys.prototype.constructor=Ys,Ys.prototype.isCatmullRomCurve3=!0,Ys.prototype.getPoint=function(t,e){var n,r,i,o,a=e||new We,s=this.points,u=s.length,l=(u-(this.closed?0:1))*t,c=Math.floor(l),h=l-c;if(this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/s.length)+1)*s.length:0===h&&c===u-1&&(c=u-2,h=1),this.closed||c>0?n=s[(c-1)%u]:(Vs.subVectors(s[0],s[1]).add(s[0]),n=Vs),r=s[c%u],i=s[(c+1)%u],this.closed||c+2<u?o=s[(c+2)%u]:(Vs.subVectors(s[u-1],s[u-2]).add(s[u-1]),o=Vs),"centripetal"===this.curveType||"chordal"===this.curveType){var p="chordal"===this.curveType?.5:.25,f=Math.pow(n.distanceToSquared(r),p),d=Math.pow(r.distanceToSquared(i),p),m=Math.pow(i.distanceToSquared(o),p);d<1e-4&&(d=1),f<1e-4&&(f=d),m<1e-4&&(m=d),Ws.initNonuniformCatmullRom(n.x,r.x,i.x,o.x,f,d,m),qs.initNonuniformCatmullRom(n.y,r.y,i.y,o.y,f,d,m),Xs.initNonuniformCatmullRom(n.z,r.z,i.z,o.z,f,d,m)}else"catmullrom"===this.curveType&&(Ws.initCatmullRom(n.x,r.x,i.x,o.x,this.tension),qs.initCatmullRom(n.y,r.y,i.y,o.y,this.tension),Xs.initCatmullRom(n.z,r.z,i.z,o.z,this.tension));return a.set(Ws.calc(h),qs.calc(h),Xs.calc(h)),a},Ys.prototype.copy=function(t){Bs.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push(r.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Ys.prototype.toJSON=function(){var t=Bs.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++){var r=this.points[e];t.points.push(r.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},Ys.prototype.fromJSON=function(t){Bs.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push((new We).fromArray(r))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Ks.prototype=Object.create(Bs.prototype),Ks.prototype.constructor=Ks,Ks.prototype.isCubicBezierCurve=!0,Ks.prototype.getPoint=function(t,e){var n=e||new Ge,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(Js(t,r.x,i.x,o.x,a.x),Js(t,r.y,i.y,o.y,a.y)),n},Ks.prototype.copy=function(t){return Bs.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Ks.prototype.toJSON=function(){var t=Bs.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Ks.prototype.fromJSON=function(t){return Bs.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},Qs.prototype=Object.create(Bs.prototype),Qs.prototype.constructor=Qs,Qs.prototype.isCubicBezierCurve3=!0,Qs.prototype.getPoint=function(t,e){var n=e||new We,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(Js(t,r.x,i.x,o.x,a.x),Js(t,r.y,i.y,o.y,a.y),Js(t,r.z,i.z,o.z,a.z)),n},Qs.prototype.copy=function(t){return Bs.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Qs.prototype.toJSON=function(){var t=Bs.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Qs.prototype.fromJSON=function(t){return Bs.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},tu.prototype=Object.create(Bs.prototype),tu.prototype.constructor=tu,tu.prototype.isLineCurve=!0,tu.prototype.getPoint=function(t,e){var n=e||new Ge;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},tu.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},tu.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},tu.prototype.copy=function(t){return Bs.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},tu.prototype.toJSON=function(){var t=Bs.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},tu.prototype.fromJSON=function(t){return Bs.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},eu.prototype=Object.create(Bs.prototype),eu.prototype.constructor=eu,eu.prototype.isLineCurve3=!0,eu.prototype.getPoint=function(t,e){var n=e||new We;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},eu.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},eu.prototype.copy=function(t){return Bs.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},eu.prototype.toJSON=function(){var t=Bs.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},eu.prototype.fromJSON=function(t){return Bs.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},nu.prototype=Object.create(Bs.prototype),nu.prototype.constructor=nu,nu.prototype.isQuadraticBezierCurve=!0,nu.prototype.getPoint=function(t,e){var n=e||new Ge,r=this.v0,i=this.v1,o=this.v2;return n.set(Zs(t,r.x,i.x,o.x),Zs(t,r.y,i.y,o.y)),n},nu.prototype.copy=function(t){return Bs.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},nu.prototype.toJSON=function(){var t=Bs.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},nu.prototype.fromJSON=function(t){return Bs.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},ru.prototype=Object.create(Bs.prototype),ru.prototype.constructor=ru,ru.prototype.isQuadraticBezierCurve3=!0,ru.prototype.getPoint=function(t,e){var n=e||new We,r=this.v0,i=this.v1,o=this.v2;return n.set(Zs(t,r.x,i.x,o.x),Zs(t,r.y,i.y,o.y),Zs(t,r.z,i.z,o.z)),n},ru.prototype.copy=function(t){return Bs.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ru.prototype.toJSON=function(){var t=Bs.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ru.prototype.fromJSON=function(t){return Bs.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},iu.prototype=Object.create(Bs.prototype),iu.prototype.constructor=iu,iu.prototype.isSplineCurve=!0,iu.prototype.getPoint=function(t,e){var n=e||new Ge,r=this.points,i=(r.length-1)*t,o=Math.floor(i),a=i-o,s=r[0===o?o:o-1],u=r[o],l=r[o>r.length-2?r.length-1:o+1],c=r[o>r.length-3?r.length-1:o+2];return n.set($s(a,s.x,u.x,l.x,c.x),$s(a,s.y,u.y,l.y,c.y)),n},iu.prototype.copy=function(t){Bs.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push(r.clone())}return this},iu.prototype.toJSON=function(){var t=Bs.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++){var r=this.points[e];t.points.push(r.toArray())}return t},iu.prototype.fromJSON=function(t){Bs.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push((new Ge).fromArray(r))}return this};var ou=Object.freeze({ArcCurve:Gs,CatmullRomCurve3:Ys,CubicBezierCurve:Ks,CubicBezierCurve3:Qs,EllipseCurve:zs,LineCurve:tu,LineCurve3:eu,QuadraticBezierCurve:nu,QuadraticBezierCurve3:ru,SplineCurve:iu});function au(){Bs.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function su(t){au.call(this),this.type="Path",this.currentPoint=new Ge,t&&this.setFromPoints(t)}function uu(t){su.call(this,t),this.uuid=ze.generateUUID(),this.type="Shape",this.holes=[]}function lu(t,e){$r.call(this),this.type="Light",this.color=new Hn(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function cu(t,e,n){lu.call(this,t,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy($r.DefaultUp),this.updateMatrix(),this.groundColor=new Hn(e)}function hu(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new Ge(512,512),this.map=null,this.matrix=new He}function pu(){hu.call(this,new zo(50,1,.5,500))}function fu(t,e,n,r,i,o){lu.call(this,t,e),this.type="SpotLight",this.position.copy($r.DefaultUp),this.updateMatrix(),this.target=new $r,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==o?o:1,this.shadow=new pu}function du(t,e,n,r){lu.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new hu(new zo(90,1,.5,500))}function mu(){hu.call(this,new Jr(-5,5,5,-5,.5,500))}function gu(t,e){lu.call(this,t,e),this.type="DirectionalLight",this.position.copy($r.DefaultUp),this.updateMatrix(),this.target=new $r,this.shadow=new mu}function vu(t,e){lu.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function yu(t,e,n,r){lu.call(this,t,e),this.type="RectAreaLight",this.position.set(0,1,0),this.updateMatrix(),this.width=void 0!==n?n:10,this.height=void 0!==r?r:10}function bu(t,e,n,r){ku.call(this,t,e,n,r)}function _u(t,e,n){ku.call(this,t,e,n)}function xu(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n}function wu(t,e,n,r){xu.call(this,t,e,n,r)}function Eu(t,e,n,r){ku.call(this,t,e,n,r)}function Su(t,e,n,r){ku.call(this,t,e,n,r)}function Tu(t,e,n,r){ku.call(this,t,e,n,r)}function Ou(t,e,n,r){xu.call(this,t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Au(t,e,n,r){xu.call(this,t,e,n,r)}function Mu(t,e,n,r){xu.call(this,t,e,n,r)}au.prototype=Object.assign(Object.create(Bs.prototype),{constructor:au,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new tu(e,t))},getPoint:function(t){for(var e=t*this.getLength(),n=this.getCurveLengths(),r=0;r<n.length;){if(n[r]>=e){var i=n[r]-e,o=this.curves[r],a=o.getLength(),s=0===a?0:1-i/a;return o.getPointAt(s)}r++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,n=0,r=this.curves.length;n<r;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,n=[],r=0,i=this.curves;r<i.length;r++)for(var o=i[r],a=o&&o.isEllipseCurve?2*t:o&&o.isLineCurve?1:o&&o.isSplineCurve?t*o.points.length:t,s=o.getPoints(a),u=0;u<s.length;u++){var l=s[u];e&&e.equals(l)||(n.push(l),e=l)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(t){Bs.prototype.copy.call(this,t),this.curves=[];for(var e=0,n=t.curves.length;e<n;e++){var r=t.curves[e];this.curves.push(r.clone())}return this.autoClose=t.autoClose,this},toJSON:function(){var t=Bs.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var e=0,n=this.curves.length;e<n;e++){var r=this.curves[e];t.curves.push(r.toJSON())}return t},fromJSON:function(t){Bs.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var e=0,n=t.curves.length;e<n;e++){var r=t.curves[e];this.curves.push((new ou[r.type]).fromJSON(r))}return this}}),su.prototype=Object.assign(Object.create(au.prototype),{constructor:su,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y)},moveTo:function(t,e){this.currentPoint.set(t,e)},lineTo:function(t,e){var n=new tu(this.currentPoint.clone(),new Ge(t,e));this.curves.push(n),this.currentPoint.set(t,e)},quadraticCurveTo:function(t,e,n,r){var i=new nu(this.currentPoint.clone(),new Ge(t,e),new Ge(n,r));this.curves.push(i),this.currentPoint.set(n,r)},bezierCurveTo:function(t,e,n,r,i,o){var a=new Ks(this.currentPoint.clone(),new Ge(t,e),new Ge(n,r),new Ge(i,o));this.curves.push(a),this.currentPoint.set(i,o)},splineThru:function(t){var e=new iu([this.currentPoint.clone()].concat(t));this.curves.push(e),this.currentPoint.copy(t[t.length-1])},arc:function(t,e,n,r,i,o){var a=this.currentPoint.x,s=this.currentPoint.y;this.absarc(t+a,e+s,n,r,i,o)},absarc:function(t,e,n,r,i,o){this.absellipse(t,e,n,n,r,i,o)},ellipse:function(t,e,n,r,i,o,a,s){var u=this.currentPoint.x,l=this.currentPoint.y;this.absellipse(t+u,e+l,n,r,i,o,a,s)},absellipse:function(t,e,n,r,i,o,a,s){var u=new zs(t,e,n,r,i,o,a,s);if(this.curves.length>0){var l=u.getPoint(0);l.equals(this.currentPoint)||this.lineTo(l.x,l.y)}this.curves.push(u);var c=u.getPoint(1);this.currentPoint.copy(c)},copy:function(t){return au.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=au.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return au.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),uu.prototype=Object.assign(Object.create(su.prototype),{constructor:uu,getPointsHoles:function(t){for(var e=[],n=0,r=this.holes.length;n<r;n++)e[n]=this.holes[n].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){su.prototype.copy.call(this,t),this.holes=[];for(var e=0,n=t.holes.length;e<n;e++){var r=t.holes[e];this.holes.push(r.clone())}return this},toJSON:function(){var t=su.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var e=0,n=this.holes.length;e<n;e++){var r=this.holes[e];t.holes.push(r.toJSON())}return t},fromJSON:function(t){su.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var e=0,n=t.holes.length;e<n;e++){var r=t.holes[e];this.holes.push((new su).fromJSON(r))}return this}}),lu.prototype=Object.assign(Object.create($r.prototype),{constructor:lu,isLight:!0,copy:function(t){return $r.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){var e=$r.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),cu.prototype=Object.assign(Object.create(lu.prototype),{constructor:cu,isHemisphereLight:!0,copy:function(t){return lu.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(hu.prototype,{copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),pu.prototype=Object.assign(Object.create(hu.prototype),{constructor:pu,isSpotLightShadow:!0,update:function(t){var e=this.camera,n=2*ze.RAD2DEG*t.angle,r=this.mapSize.width/this.mapSize.height,i=t.distance||e.far;n===e.fov&&r===e.aspect&&i===e.far||(e.fov=n,e.aspect=r,e.far=i,e.updateProjectionMatrix())}}),fu.prototype=Object.assign(Object.create(lu.prototype),{constructor:fu,isSpotLight:!0,copy:function(t){return lu.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),du.prototype=Object.assign(Object.create(lu.prototype),{constructor:du,isPointLight:!0,copy:function(t){return lu.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),mu.prototype=Object.assign(Object.create(hu.prototype),{constructor:mu}),gu.prototype=Object.assign(Object.create(lu.prototype),{constructor:gu,isDirectionalLight:!0,copy:function(t){return lu.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),vu.prototype=Object.assign(Object.create(lu.prototype),{constructor:vu,isAmbientLight:!0}),yu.prototype=Object.assign(Object.create(lu.prototype),{constructor:yu,isRectAreaLight:!0,copy:function(t){return lu.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){var e=lu.prototype.toJSON.call(this,t);return e.object.width=this.width,e.object.height=this.height,e}}),bu.prototype=Object.assign(Object.create(ku.prototype),{constructor:bu,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:we,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),_u.prototype=Object.assign(Object.create(ku.prototype),{constructor:_u,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:we,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Object.assign(xu.prototype,{evaluate:function(t){var e=this.parameterPositions,n=this._cachedIndex,r=e[n],i=e[n-1];t:{e:{var o;n:{r:if(!(t<r)){for(var a=n+2;;){if(void 0===r){if(t<i)break r;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,i)}if(n===a)break;if(i=r,t<(r=e[++n]))break e}o=e.length;break n}if(t>=i)break t;var s=e[1];t<s&&(n=2,i=s);for(a=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(n===a)break;if(r=i,t>=(i=e[--n-1]))break e}o=n,n=0}for(;n<o;){var u=n+o>>>1;t<e[u]?o=u:n=u+1}if(r=e[n],void 0===(i=e[n-1]))return this._cachedIndex=0,this.beforeStart_(0,t,r);if(void 0===r)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,i,t)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,t,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r,o=0;o!==r;++o)e[o]=n[i+o];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(xu.prototype,{beforeStart_:xu.prototype.copySampleValue_,afterEnd_:xu.prototype.copySampleValue_}),wu.prototype=Object.assign(Object.create(xu.prototype),{constructor:wu,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,u=(n-e)/(r-e),l=s+a;s!==l;s+=4)Ve.slerpFlat(i,0,o,s-a,o,s,u);return i}}),Eu.prototype=Object.assign(Object.create(ku.prototype),{constructor:Eu,ValueTypeName:"quaternion",DefaultInterpolation:Ee,InterpolantFactoryMethodLinear:function(t){return new wu(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),Su.prototype=Object.assign(Object.create(ku.prototype),{constructor:Su,ValueTypeName:"color"}),Tu.prototype=Object.assign(Object.create(ku.prototype),{constructor:Tu,ValueTypeName:"number"}),Ou.prototype=Object.assign(Object.create(xu.prototype),{constructor:Ou,DefaultSettings_:{endingStart:Te,endingEnd:Te},intervalChanged_:function(t,e,n){var r=this.parameterPositions,i=t-2,o=t+1,a=r[i],s=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case Oe:i=t,a=2*e-n;break;case Ae:a=e+r[i=r.length-2]-r[i+1];break;default:i=t,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case Oe:o=t,s=2*n-e;break;case Ae:o=1,s=n+r[1]-r[0];break;default:o=t-1,s=e}var u=.5*(n-e),l=this.valueSize;this._weightPrev=u/(e-a),this._weightNext=u/(s-n),this._offsetPrev=i*l,this._offsetNext=o*l},interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,u=s-a,l=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,p=this._weightNext,f=(n-e)/(r-e),d=f*f,m=d*f,g=-h*m+2*h*d-h*f,v=(1+h)*m+(-1.5-2*h)*d+(-.5+h)*f+1,y=(-1-p)*m+(1.5+p)*d+.5*f,b=p*m-p*d,_=0;_!==a;++_)i[_]=g*o[l+_]+v*o[u+_]+y*o[s+_]+b*o[c+_];return i}}),Au.prototype=Object.assign(Object.create(xu.prototype),{constructor:Au,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,u=s-a,l=(n-e)/(r-e),c=1-l,h=0;h!==a;++h)i[h]=o[u+h]*c+o[s+h]*l;return i}}),Mu.prototype=Object.assign(Object.create(xu.prototype),{constructor:Mu,interpolate_:function(t){return this.copySampleValue_(t-1)}});var Cu={arraySlice:function(t,e,n){return Cu.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var e=t.length,n=new Array(e),r=0;r!==e;++r)n[r]=r;return n.sort(function(e,n){return t[e]-t[n]}),n},sortedArray:function(t,e,n){for(var r=t.length,i=new t.constructor(r),o=0,a=0;a!==r;++o)for(var s=n[o]*e,u=0;u!==e;++u)i[a++]=t[s+u];return i},flattenJSON:function(t,e,n,r){for(var i=1,o=t[0];void 0!==o&&void 0===o[r];)o=t[i++];if(void 0!==o){var a=o[r];if(void 0!==a)if(Array.isArray(a))do{void 0!==(a=o[r])&&(e.push(o.time),n.push.apply(n,a)),o=t[i++]}while(void 0!==o);else if(void 0!==a.toArray)do{void 0!==(a=o[r])&&(e.push(o.time),a.toArray(n,n.length)),o=t[i++]}while(void 0!==o);else do{void 0!==(a=o[r])&&(e.push(o.time),n.push(a)),o=t[i++]}while(void 0!==o)}}};function ku(t,e,n,r){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Cu.convertArray(e,this.TimeBufferType),this.values=Cu.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation),this.validate(),this.optimize()}function Pu(t,e,n,r){ku.call(this,t,e,n,r)}function Ru(t,e,n){this.name=t,this.tracks=n,this.duration=void 0!==e?e:-1,this.uuid=ze.generateUUID(),this.duration<0&&this.resetDuration(),this.optimize()}function Lu(t){this.manager=void 0!==t?t:Rs,this.textures={}}function Iu(t){this.manager=void 0!==t?t:Rs}Object.assign(ku,{parse:function(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var e=ku._getTrackTypeForValueTypeName(t.type);if(void 0===t.times){var n=[],r=[];Cu.flattenJSON(t.keys,n,r,"value"),t.times=n,t.values=r}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)},toJSON:function(t){var e,n=t.constructor;if(void 0!==n.toJSON)e=n.toJSON(t);else{e={name:t.name,times:Cu.convertArray(t.times,Array),values:Cu.convertArray(t.values,Array)};var r=t.getInterpolation();r!==t.DefaultInterpolation&&(e.interpolation=r)}return e.type=t.ValueTypeName,e},_getTrackTypeForValueTypeName:function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Tu;case"vector":case"vector2":case"vector3":case"vector4":return Pu;case"color":return Su;case"quaternion":return Eu;case"bool":case"boolean":return _u;case"string":return bu}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}}),Object.assign(ku.prototype,{constructor:ku,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Ee,InterpolantFactoryMethodDiscrete:function(t){return new Mu(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new Au(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new Ou(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case we:e=this.InterpolantFactoryMethodDiscrete;break;case Ee:e=this.InterpolantFactoryMethodLinear;break;case Se:e=this.InterpolantFactoryMethodSmooth}if(void 0!==e)this.createInterpolant=e;else{var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}console.warn("THREE.KeyframeTrack:",n)}},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return we;case this.InterpolantFactoryMethodLinear:return Ee;case this.InterpolantFactoryMethodSmooth:return Se}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]*=t;return this},trim:function(t,e){for(var n=this.times,r=n.length,i=0,o=r-1;i!==r&&n[i]<t;)++i;for(;-1!==o&&n[o]>e;)--o;if(++o,0!==i||o!==r){i>=o&&(i=(o=Math.max(o,1))-1);var a=this.getValueSize();this.times=Cu.arraySlice(n,i,o),this.values=Cu.arraySlice(this.values,i*a,o*a)}return this},validate:function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var o=null,a=0;a!==i;a++){var s=n[a];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,s),t=!1;break}if(null!==o&&o>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,s,o),t=!1;break}o=s}if(void 0!==r&&Cu.isTypedArray(r)){a=0;for(var u=r.length;a!==u;++a){var l=r[a];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,l),t=!1;break}}}return t},optimize:function(){for(var t=this.times,e=this.values,n=this.getValueSize(),r=this.getInterpolation()===Se,i=1,o=t.length-1,a=1;a<o;++a){var s=!1,u=t[a];if(u!==t[a+1]&&(1!==a||u!==u[0]))if(r)s=!0;else for(var l=a*n,c=l-n,h=l+n,p=0;p!==n;++p){var f=e[l+p];if(f!==e[c+p]||f!==e[h+p]){s=!0;break}}if(s){if(a!==i){t[i]=t[a];var d=a*n,m=i*n;for(p=0;p!==n;++p)e[m+p]=e[d+p]}++i}}if(o>0){t[i]=t[o];for(d=o*n,m=i*n,p=0;p!==n;++p)e[m+p]=e[d+p];++i}return i!==t.length&&(this.times=Cu.arraySlice(t,0,i),this.values=Cu.arraySlice(e,0,i*n)),this}}),Pu.prototype=Object.assign(Object.create(ku.prototype),{constructor:Pu,ValueTypeName:"vector"}),Object.assign(Ru,{parse:function(t){for(var e=[],n=t.tracks,r=1/(t.fps||1),i=0,o=n.length;i!==o;++i)e.push(ku.parse(n[i]).scale(r));return new Ru(t.name,t.duration,e)},toJSON:function(t){for(var e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e},i=0,o=n.length;i!==o;++i)e.push(ku.toJSON(n[i]));return r},CreateFromMorphTargetSequence:function(t,e,n,r){for(var i=e.length,o=[],a=0;a<i;a++){var s=[],u=[];s.push((a+i-1)%i,a,(a+1)%i),u.push(0,1,0);var l=Cu.getKeyframeOrder(s);s=Cu.sortedArray(s,1,l),u=Cu.sortedArray(u,1,l),r||0!==s[0]||(s.push(i),u.push(u[0])),o.push(new Tu(".morphTargetInfluences["+e[a].name+"]",s,u).scale(1/n))}return new Ru(t,-1,o)},findByName:function(t,e){var n=t;if(!Array.isArray(t)){var r=t;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===e)return n[i];return null},CreateClipsFromMorphTargetSequences:function(t,e,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,o=0,a=t.length;o<a;o++){var s=t[o],u=s.name.match(i);if(u&&u.length>1){var l=r[h=u[1]];l||(r[h]=l=[]),l.push(s)}}var c=[];for(var h in r)c.push(Ru.CreateFromMorphTargetSequence(h,r[h],e,n));return c},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(t,e,n,r,i){if(0!==n.length){var o=[],a=[];Cu.flattenJSON(n,o,a,r),0!==o.length&&i.push(new t(e,o,a))}},r=[],i=t.name||"default",o=t.length||-1,a=t.fps||30,s=t.hierarchy||[],u=0;u<s.length;u++){var l=s[u].keys;if(l&&0!==l.length)if(l[0].morphTargets){for(var c={},h=0;h<l.length;h++)if(l[h].morphTargets)for(var p=0;p<l[h].morphTargets.length;p++)c[l[h].morphTargets[p]]=-1;for(var f in c){var d=[],m=[];for(p=0;p!==l[h].morphTargets.length;++p){var g=l[h];d.push(g.time),m.push(g.morphTarget===f?1:0)}r.push(new Tu(".morphTargetInfluence["+f+"]",d,m))}o=c.length*(a||1)}else{var v=".bones["+e[u].name+"]";n(Pu,v+".position",l,"pos",r),n(Eu,v+".quaternion",l,"rot",r),n(Pu,v+".scale",l,"scl",r)}}return 0===r.length?null:new Ru(i,o,r)}}),Object.assign(Ru.prototype,{resetDuration:function(){for(var t=0,e=0,n=this.tracks.length;e!==n;++e){var r=this.tracks[e];t=Math.max(t,r.times[r.times.length-1])}this.duration=t},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}}),Object.assign(Lu.prototype,{load:function(t,e,n,r){var i=this;new Is(i.manager).load(t,function(t){e(i.parse(JSON.parse(t)))},n,r)},setTextures:function(t){this.textures=t},parse:function(t){var e=this.textures;function n(t){return void 0===e[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),e[t]}var r=new Cs[t.type];if(void 0!==t.uuid&&(r.uuid=t.uuid),void 0!==t.name&&(r.name=t.name),void 0!==t.color&&r.color.setHex(t.color),void 0!==t.roughness&&(r.roughness=t.roughness),void 0!==t.metalness&&(r.metalness=t.metalness),void 0!==t.emissive&&r.emissive.setHex(t.emissive),void 0!==t.specular&&r.specular.setHex(t.specular),void 0!==t.shininess&&(r.shininess=t.shininess),void 0!==t.clearCoat&&(r.clearCoat=t.clearCoat),void 0!==t.clearCoatRoughness&&(r.clearCoatRoughness=t.clearCoatRoughness),void 0!==t.uniforms&&(r.uniforms=t.uniforms),void 0!==t.vertexShader&&(r.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(r.fragmentShader=t.fragmentShader),void 0!==t.vertexColors&&(r.vertexColors=t.vertexColors),void 0!==t.fog&&(r.fog=t.fog),void 0!==t.flatShading&&(r.flatShading=t.flatShading),void 0!==t.blending&&(r.blending=t.blending),void 0!==t.side&&(r.side=t.side),void 0!==t.opacity&&(r.opacity=t.opacity),void 0!==t.transparent&&(r.transparent=t.transparent),void 0!==t.alphaTest&&(r.alphaTest=t.alphaTest),void 0!==t.depthTest&&(r.depthTest=t.depthTest),void 0!==t.depthWrite&&(r.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(r.colorWrite=t.colorWrite),void 0!==t.wireframe&&(r.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(r.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(r.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(r.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(r.rotation=t.rotation),1!==t.linewidth&&(r.linewidth=t.linewidth),void 0!==t.dashSize&&(r.dashSize=t.dashSize),void 0!==t.gapSize&&(r.gapSize=t.gapSize),void 0!==t.scale&&(r.scale=t.scale),void 0!==t.skinning&&(r.skinning=t.skinning),void 0!==t.morphTargets&&(r.morphTargets=t.morphTargets),void 0!==t.dithering&&(r.dithering=t.dithering),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.shading&&(r.flatShading=1===t.shading),void 0!==t.size&&(r.size=t.size),void 0!==t.sizeAttenuation&&(r.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(r.map=n(t.map)),void 0!==t.alphaMap&&(r.alphaMap=n(t.alphaMap),r.transparent=!0),void 0!==t.bumpMap&&(r.bumpMap=n(t.bumpMap)),void 0!==t.bumpScale&&(r.bumpScale=t.bumpScale),void 0!==t.normalMap&&(r.normalMap=n(t.normalMap)),void 0!==t.normalScale){var i=t.normalScale;!1===Array.isArray(i)&&(i=[i,i]),r.normalScale=(new Ge).fromArray(i)}return void 0!==t.displacementMap&&(r.displacementMap=n(t.displacementMap)),void 0!==t.displacementScale&&(r.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(r.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(r.roughnessMap=n(t.roughnessMap)),void 0!==t.metalnessMap&&(r.metalnessMap=n(t.metalnessMap)),void 0!==t.emissiveMap&&(r.emissiveMap=n(t.emissiveMap)),void 0!==t.emissiveIntensity&&(r.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(r.specularMap=n(t.specularMap)),void 0!==t.envMap&&(r.envMap=n(t.envMap)),void 0!==t.reflectivity&&(r.reflectivity=t.reflectivity),void 0!==t.lightMap&&(r.lightMap=n(t.lightMap)),void 0!==t.lightMapIntensity&&(r.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(r.aoMap=n(t.aoMap)),void 0!==t.aoMapIntensity&&(r.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(r.gradientMap=n(t.gradientMap)),r}}),Object.assign(Iu.prototype,{load:function(t,e,n,r){var i=this;new Is(i.manager).load(t,function(t){e(i.parse(JSON.parse(t)))},n,r)},parse:function(t){var e=new Qi,n=t.data.index;if(void 0!==n){var r=new Fu[n.type](n.array);e.setIndex(new si(r,1))}var i=t.data.attributes;for(var o in i){var a=i[o];r=new Fu[a.type](a.array);e.addAttribute(o,new si(r,a.itemSize,a.normalized))}var s=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==s)for(var u=0,l=s.length;u!==l;++u){var c=s[u];e.addGroup(c.start,c.count,c.materialIndex)}var h=t.data.boundingSphere;if(void 0!==h){var p=new We;void 0!==h.center&&p.fromArray(h.center),e.boundingSphere=new wr(p,h.radius)}return e}});var Du,Nu,ju,Uu,Fu={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Bu(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}}Bu.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=this.handlers,n=0,r=e.length;n<r;n+=2){var i=e[n],o=e[n+1];if(i.test(t))return o}return null}},Object.assign(Bu.prototype,{crossOrigin:void 0,initMaterials:function(t,e,n){for(var r=[],i=0;i<t.length;++i)r[i]=this.createMaterial(t[i],e,n);return r},createMaterial:(Du={NoBlending:H,NormalBlending:V,AdditiveBlending:W,SubtractiveBlending:q,MultiplyBlending:X,CustomBlending:Y},Nu=new Hn,ju=new Fs,Uu=new Lu,function(t,e,n){var r={};function i(t,i,o,a,s){var u,l=e+t,c=Bu.Handlers.get(l);null!==c?u=c.load(l):(ju.setCrossOrigin(n),u=ju.load(l)),void 0!==i&&(u.repeat.fromArray(i),1!==i[0]&&(u.wrapS=Dt),1!==i[1]&&(u.wrapT=Dt)),void 0!==o&&u.offset.fromArray(o),void 0!==a&&("repeat"===a[0]&&(u.wrapS=Dt),"mirror"===a[0]&&(u.wrapS=jt),"repeat"===a[1]&&(u.wrapT=Dt),"mirror"===a[1]&&(u.wrapT=jt)),void 0!==s&&(u.anisotropy=s);var h=ze.generateUUID();return r[h]=u,h}var o={uuid:ze.generateUUID(),type:"MeshLambertMaterial"};for(var a in t){var s=t[a];switch(a){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":o.name=s;break;case"blending":o.blending=Du[s];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",a,"is no longer supported.");break;case"colorDiffuse":o.color=Nu.fromArray(s).getHex();break;case"colorSpecular":o.specular=Nu.fromArray(s).getHex();break;case"colorEmissive":o.emissive=Nu.fromArray(s).getHex();break;case"specularCoef":o.shininess=s;break;case"shading":"basic"===s.toLowerCase()&&(o.type="MeshBasicMaterial"),"phong"===s.toLowerCase()&&(o.type="MeshPhongMaterial"),"standard"===s.toLowerCase()&&(o.type="MeshStandardMaterial");break;case"mapDiffuse":o.map=i(s,t.mapDiffuseRepeat,t.mapDiffuseOffset,t.mapDiffuseWrap,t.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":o.emissiveMap=i(s,t.mapEmissiveRepeat,t.mapEmissiveOffset,t.mapEmissiveWrap,t.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":o.lightMap=i(s,t.mapLightRepeat,t.mapLightOffset,t.mapLightWrap,t.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":o.aoMap=i(s,t.mapAORepeat,t.mapAOOffset,t.mapAOWrap,t.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":o.bumpMap=i(s,t.mapBumpRepeat,t.mapBumpOffset,t.mapBumpWrap,t.mapBumpAnisotropy);break;case"mapBumpScale":o.bumpScale=s;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":o.normalMap=i(s,t.mapNormalRepeat,t.mapNormalOffset,t.mapNormalWrap,t.mapNormalAnisotropy);break;case"mapNormalFactor":o.normalScale=[s,s];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":o.specularMap=i(s,t.mapSpecularRepeat,t.mapSpecularOffset,t.mapSpecularWrap,t.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":o.metalnessMap=i(s,t.mapMetalnessRepeat,t.mapMetalnessOffset,t.mapMetalnessWrap,t.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":o.roughnessMap=i(s,t.mapRoughnessRepeat,t.mapRoughnessOffset,t.mapRoughnessWrap,t.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":o.alphaMap=i(s,t.mapAlphaRepeat,t.mapAlphaOffset,t.mapAlphaWrap,t.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":o.side=N;break;case"doubleSided":o.side=j;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),o.opacity=s;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":o[a]=s;break;case"vertexColors":!0===s&&(o.vertexColors=G),"face"===s&&(o.vertexColors=z);break;default:console.error("THREE.Loader.createMaterial: Unsupported",a,s)}}return"MeshBasicMaterial"===o.type&&delete o.emissive,"MeshPhongMaterial"!==o.type&&delete o.specular,o.opacity<1&&(o.transparent=!0),Uu.setTextures(r),Uu.parse(o)})});var zu,Gu={decodeText:function(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var e="",n=0,r=t.length;n<r;n++)e+=String.fromCharCode(t[n]);return e},extractUrlBase:function(t){var e=t.split("/");return 1===e.length?"./":(e.pop(),e.join("/")+"/")}};function Hu(t){"boolean"==typeof t&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),t=void 0),this.manager=void 0!==t?t:Rs,this.withCredentials=!1}function Vu(t){this.manager=void 0!==t?t:Rs,this.texturePath=""}Object.assign(Hu.prototype,{load:function(t,e,n,r){var i=this,o=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:Gu.extractUrlBase(t),a=new Is(this.manager);a.setWithCredentials(this.withCredentials),a.load(t,function(n){var r=JSON.parse(n),a=r.metadata;if(void 0!==a){var s=a.type;if(void 0!==s){if("object"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.ObjectLoader instead.");if("scene"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.SceneLoader instead.")}}var u=i.parse(r,o);e(u.geometry,u.materials)},n,r)},setTexturePath:function(t){this.texturePath=t},parse:function(){return function(t,e){void 0!==t.data&&(t=t.data),void 0!==t.scale?t.scale=1/t.scale:t.scale=1;var n=new ai;return function(t,e){function n(t,e){return t&1<<e}var r,i,o,a,s,u,l,c,h,p,f,d,m,g,v,y,b,_,x,w,E,S,T,O,A,M=t.faces,C=t.vertices,k=t.normals,P=t.colors,R=t.scale,L=0;if(void 0!==t.uvs){for(r=0;r<t.uvs.length;r++)t.uvs[r].length&&L++;for(r=0;r<L;r++)e.faceVertexUvs[r]=[]}for(a=0,s=C.length;a<s;)(_=new We).x=C[a++]*R,_.y=C[a++]*R,_.z=C[a++]*R,e.vertices.push(_);for(a=0,s=M.length;a<s;)if(f=n(p=M[a++],0),d=n(p,1),m=n(p,3),g=n(p,4),v=n(p,5),y=n(p,6),b=n(p,7),f){if((w=new Kr).a=M[a],w.b=M[a+1],w.c=M[a+3],(E=new Kr).a=M[a+1],E.b=M[a+2],E.c=M[a+3],a+=4,d&&(h=M[a++],w.materialIndex=h,E.materialIndex=h),o=e.faces.length,m)for(r=0;r<L;r++)for(O=t.uvs[r],e.faceVertexUvs[r][o]=[],e.faceVertexUvs[r][o+1]=[],i=0;i<4;i++)A=new Ge(O[2*(c=M[a++])],O[2*c+1]),2!==i&&e.faceVertexUvs[r][o].push(A),0!==i&&e.faceVertexUvs[r][o+1].push(A);if(g&&(l=3*M[a++],w.normal.set(k[l++],k[l++],k[l]),E.normal.copy(w.normal)),v)for(r=0;r<4;r++)l=3*M[a++],T=new We(k[l++],k[l++],k[l]),2!==r&&w.vertexNormals.push(T),0!==r&&E.vertexNormals.push(T);if(y&&(S=P[u=M[a++]],w.color.setHex(S),E.color.setHex(S)),b)for(r=0;r<4;r++)S=P[u=M[a++]],2!==r&&w.vertexColors.push(new Hn(S)),0!==r&&E.vertexColors.push(new Hn(S));e.faces.push(w),e.faces.push(E)}else{if((x=new Kr).a=M[a++],x.b=M[a++],x.c=M[a++],d&&(h=M[a++],x.materialIndex=h),o=e.faces.length,m)for(r=0;r<L;r++)for(O=t.uvs[r],e.faceVertexUvs[r][o]=[],i=0;i<3;i++)A=new Ge(O[2*(c=M[a++])],O[2*c+1]),e.faceVertexUvs[r][o].push(A);if(g&&(l=3*M[a++],x.normal.set(k[l++],k[l++],k[l])),v)for(r=0;r<3;r++)l=3*M[a++],T=new We(k[l++],k[l++],k[l]),x.vertexNormals.push(T);if(y&&(u=M[a++],x.color.setHex(P[u])),b)for(r=0;r<3;r++)u=M[a++],x.vertexColors.push(new Hn(P[u]));e.faces.push(x)}}(t,n),function(t,e){var n=void 0!==t.influencesPerVertex?t.influencesPerVertex:2;if(t.skinWeights)for(var r=0,i=t.skinWeights.length;r<i;r+=n){var o=t.skinWeights[r],a=n>1?t.skinWeights[r+1]:0,s=n>2?t.skinWeights[r+2]:0,u=n>3?t.skinWeights[r+3]:0;e.skinWeights.push(new Je(o,a,s,u))}if(t.skinIndices)for(r=0,i=t.skinIndices.length;r<i;r+=n){var l=t.skinIndices[r],c=n>1?t.skinIndices[r+1]:0,h=n>2?t.skinIndices[r+2]:0,p=n>3?t.skinIndices[r+3]:0;e.skinIndices.push(new Je(l,c,h,p))}e.bones=t.bones,e.bones&&e.bones.length>0&&(e.skinWeights.length!==e.skinIndices.length||e.skinIndices.length!==e.vertices.length)&&console.warn("When skinning, number of vertices ("+e.vertices.length+"), skinIndices ("+e.skinIndices.length+"), and skinWeights ("+e.skinWeights.length+") should match.")}(t,n),function(t,e){var n=t.scale;if(void 0!==t.morphTargets)for(var r=0,i=t.morphTargets.length;r<i;r++){e.morphTargets[r]={},e.morphTargets[r].name=t.morphTargets[r].name,e.morphTargets[r].vertices=[];for(var o=e.morphTargets[r].vertices,a=t.morphTargets[r].vertices,s=0,u=a.length;s<u;s+=3){var l=new We;l.x=a[s]*n,l.y=a[s+1]*n,l.z=a[s+2]*n,o.push(l)}}if(void 0!==t.morphColors&&t.morphColors.length>0){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');var c=e.faces,h=t.morphColors[0].colors;for(r=0,i=c.length;r<i;r++)c[r].color.fromArray(h,3*r)}}(t,n),function(t,e){var n=[],r=[];void 0!==t.animation&&r.push(t.animation),void 0!==t.animations&&(t.animations.length?r=r.concat(t.animations):r.push(t.animations));for(var i=0;i<r.length;i++){var o=Ru.parseAnimation(r[i],e.bones);o&&n.push(o)}if(e.morphTargets){var a=Ru.CreateClipsFromMorphTargetSequences(e.morphTargets,10);n=n.concat(a)}n.length>0&&(e.animations=n)}(t,n),n.computeFaceNormals(),n.computeBoundingSphere(),void 0===t.materials||0===t.materials.length?{geometry:n}:{geometry:n,materials:Bu.prototype.initMaterials(t.materials,e,this.crossOrigin)}}}()}),Object.assign(Vu.prototype,{load:function(t,e,n,r){""===this.texturePath&&(this.texturePath=t.substring(0,t.lastIndexOf("/")+1));var i=this;new Is(i.manager).load(t,function(n){var o=null;try{o=JSON.parse(n)}catch(e){return void 0!==r&&r(e),void console.error("THREE:ObjectLoader: Can't parse "+t+".",e.message)}var a=o.metadata;void 0!==a&&void 0!==a.type&&"geometry"!==a.type.toLowerCase()?i.parse(o,e):console.error("THREE.ObjectLoader: Can't load "+t+". Use THREE.JSONLoader instead.")},n,r)},setTexturePath:function(t){this.texturePath=t},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t,e){var n=this.parseShape(t.shapes),r=this.parseGeometries(t.geometries,n),i=this.parseImages(t.images,function(){void 0!==e&&e(s)}),o=this.parseTextures(t.textures,i),a=this.parseMaterials(t.materials,o),s=this.parseObject(t.object,r,a);return t.animations&&(s.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==e&&e(s),s},parseShape:function(t){var e={};if(void 0!==t)for(var n=0,r=t.length;n<r;n++){var i=(new uu).fromJSON(t[n]);e[i.uuid]=i}return e},parseGeometries:function(t,e){var n={};if(void 0!==t)for(var r=new Hu,i=new Iu,o=0,a=t.length;o<a;o++){var s,u=t[o];switch(u.type){case"PlaneGeometry":case"PlaneBufferGeometry":s=new bs[u.type](u.width,u.height,u.widthSegments,u.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":s=new bs[u.type](u.width,u.height,u.depth,u.widthSegments,u.heightSegments,u.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new bs[u.type](u.radius,u.segments,u.thetaStart,u.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new bs[u.type](u.radiusTop,u.radiusBottom,u.height,u.radialSegments,u.heightSegments,u.openEnded,u.thetaStart,u.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new bs[u.type](u.radius,u.height,u.radialSegments,u.heightSegments,u.openEnded,u.thetaStart,u.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new bs[u.type](u.radius,u.widthSegments,u.heightSegments,u.phiStart,u.phiLength,u.thetaStart,u.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":s=new bs[u.type](u.radius,u.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new bs[u.type](u.innerRadius,u.outerRadius,u.thetaSegments,u.phiSegments,u.thetaStart,u.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new bs[u.type](u.radius,u.tube,u.radialSegments,u.tubularSegments,u.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new bs[u.type](u.radius,u.tube,u.tubularSegments,u.radialSegments,u.p,u.q);break;case"LatheGeometry":case"LatheBufferGeometry":s=new bs[u.type](u.points,u.segments,u.phiStart,u.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":s=new bs[u.type](u.vertices,u.indices,u.radius,u.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":var l=[];for(o=0,a=u.shapes.length;o<a;o++){var c=e[u.shapes[o]];l.push(c)}s=new bs[u.type](l,u.curveSegments);break;case"BufferGeometry":s=i.parse(u);break;case"Geometry":s=r.parse(u,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+u.type+'"');continue}s.uuid=u.uuid,void 0!==u.name&&(s.name=u.name),n[u.uuid]=s}return n},parseMaterials:function(t,e){var n={};if(void 0!==t){var r=new Lu;r.setTextures(e);for(var i=0,o=t.length;i<o;i++){var a=t[i];if("MultiMaterial"===a.type){for(var s=[],u=0;u<a.materials.length;u++)s.push(r.parse(a.materials[u]));n[a.uuid]=s}else n[a.uuid]=r.parse(a)}}return n},parseAnimations:function(t){for(var e=[],n=0;n<t.length;n++){var r=Ru.parse(t[n]);e.push(r)}return e},parseImages:function(t,e){var n=this,r={};function i(t){return n.manager.itemStart(t),o.load(t,function(){n.manager.itemEnd(t)},void 0,function(){n.manager.itemEnd(t),n.manager.itemError(t)})}if(void 0!==t&&t.length>0){var o=new js(new Ps(e));o.setCrossOrigin(this.crossOrigin);for(var a=0,s=t.length;a<s;a++){var u=t[a],l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u.url)?u.url:n.texturePath+u.url;r[u.uuid]=i(l)}}return r},parseTextures:function(t,e){function n(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var r={};if(void 0!==t)for(var i=0,o=t.length;i<o;i++){var a=t[i];void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===e[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image);var s=new Ze(e[a.image]);s.needsUpdate=!0,s.uuid=a.uuid,void 0!==a.name&&(s.name=a.name),void 0!==a.mapping&&(s.mapping=n(a.mapping,qu)),void 0!==a.offset&&s.offset.fromArray(a.offset),void 0!==a.repeat&&s.repeat.fromArray(a.repeat),void 0!==a.center&&s.center.fromArray(a.center),void 0!==a.rotation&&(s.rotation=a.rotation),void 0!==a.wrap&&(s.wrapS=n(a.wrap[0],Xu),s.wrapT=n(a.wrap[1],Xu)),void 0!==a.minFilter&&(s.minFilter=n(a.minFilter,Yu)),void 0!==a.magFilter&&(s.magFilter=n(a.magFilter,Yu)),void 0!==a.anisotropy&&(s.anisotropy=a.anisotropy),void 0!==a.flipY&&(s.flipY=a.flipY),r[a.uuid]=s}return r},parseObject:(zu=new He,function(t,e,n){var r;function i(t){return void 0===e[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),e[t]}function o(t){if(void 0!==t){if(Array.isArray(t)){for(var e=[],r=0,i=t.length;r<i;r++){var o=t[r];void 0===n[o]&&console.warn("THREE.ObjectLoader: Undefined material",o),e.push(n[o])}return e}return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),n[t]}}switch(t.type){case"Scene":r=new Yo,void 0!==t.background&&Number.isInteger(t.background)&&(r.background=new Hn(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?r.fog=new Xo(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(r.fog=new qo(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":r=new zo(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(r.focus=t.focus),void 0!==t.zoom&&(r.zoom=t.zoom),void 0!==t.filmGauge&&(r.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(r.filmOffset=t.filmOffset),void 0!==t.view&&(r.view=Object.assign({},t.view));break;case"OrthographicCamera":r=new Jr(t.left,t.right,t.top,t.bottom,t.near,t.far);break;case"AmbientLight":r=new vu(t.color,t.intensity);break;case"DirectionalLight":r=new gu(t.color,t.intensity);break;case"PointLight":r=new du(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":r=new yu(t.color,t.intensity,t.width,t.height);break;case"SpotLight":r=new fu(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":r=new cu(t.color,t.groundColor,t.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var a=i(t.geometry),s=o(t.material);r=a.bones&&a.bones.length>0?new ea(a,s):new lo(a,s);break;case"LOD":r=new Ko;break;case"Line":r=new ra(i(t.geometry),o(t.material),t.mode);break;case"LineLoop":r=new oa(i(t.geometry),o(t.material));break;case"LineSegments":r=new ia(i(t.geometry),o(t.material));break;case"PointCloud":case"Points":r=new sa(i(t.geometry),o(t.material));break;case"Sprite":r=new Jo(o(t.material));break;case"Group":r=new ua;break;default:r=new $r}if(r.uuid=t.uuid,void 0!==t.name&&(r.name=t.name),void 0!==t.matrix?(zu.fromArray(t.matrix),zu.decompose(r.position,r.quaternion,r.scale)):(void 0!==t.position&&r.position.fromArray(t.position),void 0!==t.rotation&&r.rotation.fromArray(t.rotation),void 0!==t.quaternion&&r.quaternion.fromArray(t.quaternion),void 0!==t.scale&&r.scale.fromArray(t.scale)),void 0!==t.castShadow&&(r.castShadow=t.castShadow),void 0!==t.receiveShadow&&(r.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(r.shadow.bias=t.shadow.bias),void 0!==t.shadow.radius&&(r.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&r.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(r.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.children)for(var u=t.children,l=0;l<u.length;l++)r.add(this.parseObject(u[l],e,n));if("LOD"===t.type)for(var c=t.levels,h=0;h<c.length;h++){var p=c[h],f=r.getObjectByProperty("uuid",p.object);void 0!==f&&r.addLevel(f,p.distance)}return r})});var Wu,qu={UVMapping:At,CubeReflectionMapping:Mt,CubeRefractionMapping:Ct,EquirectangularReflectionMapping:kt,EquirectangularRefractionMapping:Pt,SphericalReflectionMapping:Rt,CubeUVReflectionMapping:Lt,CubeUVRefractionMapping:It},Xu={RepeatWrapping:Dt,ClampToEdgeWrapping:Nt,MirroredRepeatWrapping:jt},Yu={NearestFilter:Ut,NearestMipMapNearestFilter:Ft,NearestMipMapLinearFilter:Bt,LinearFilter:zt,LinearMipMapNearestFilter:Gt,LinearMipMapLinearFilter:Ht};function $u(t){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.manager=void 0!==t?t:Rs,this.options=void 0}function Zu(){this.type="ShapePath",this.subPaths=[],this.currentPath=null}function Ju(t){this.type="Font",this.data=t}function Ku(t){this.manager=void 0!==t?t:Rs}$u.prototype={constructor:$u,setOptions:function(t){return this.options=t,this},load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t);var i=this,o=ks.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout(function(){e&&e(o),i.manager.itemEnd(t)},0),o;fetch(t).then(function(t){return t.blob()}).then(function(t){return createImageBitmap(t,i.options)}).then(function(n){ks.add(t,n),e&&e(n),i.manager.itemEnd(t)}).catch(function(e){r&&r(e),i.manager.itemEnd(t),i.manager.itemError(t)})},setCrossOrigin:function(){return this},setPath:function(t){return this.path=t,this}},Object.assign(Zu.prototype,{moveTo:function(t,e){this.currentPath=new su,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e)},lineTo:function(t,e){this.currentPath.lineTo(t,e)},quadraticCurveTo:function(t,e,n,r){this.currentPath.quadraticCurveTo(t,e,n,r)},bezierCurveTo:function(t,e,n,r,i,o){this.currentPath.bezierCurveTo(t,e,n,r,i,o)},splineThru:function(t){this.currentPath.splineThru(t)},toShapes:function(t,e){function n(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n],o=new uu;o.curves=i.curves,e.push(o)}return e}function r(t,e){for(var n=e.length,r=!1,i=n-1,o=0;o<n;i=o++){var a=e[i],s=e[o],u=s.x-a.x,l=s.y-a.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(a=e[o],u=-u,s=e[i],l=-l),t.y<a.y||t.y>s.y)continue;if(t.y===a.y){if(t.x===a.x)return!0}else{var c=l*(t.x-a.x)-u*(t.y-a.y);if(0===c)return!0;if(c<0)continue;r=!r}}else{if(t.y!==a.y)continue;if(s.x<=t.x&&t.x<=a.x||a.x<=t.x&&t.x<=s.x)return!0}}return r}var i=Ka.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===e)return n(o);var a,s,u,l=[];if(1===o.length)return s=o[0],(u=new uu).curves=s.curves,l.push(u),l;var c=!i(o[0].getPoints());c=t?!c:c;var h,p,f=[],d=[],m=[],g=0;d[g]=void 0,m[g]=[];for(var v=0,y=o.length;v<y;v++)a=i(h=(s=o[v]).getPoints()),(a=t?!a:a)?(!c&&d[g]&&g++,d[g]={s:new uu,p:h},d[g].s.curves=s.curves,c&&g++,m[g]=[]):m[g].push({h:s,p:h[0]});if(!d[0])return n(o);if(d.length>1){for(var b=!1,_=[],x=0,w=d.length;x<w;x++)f[x]=[];for(x=0,w=d.length;x<w;x++)for(var E=m[x],S=0;S<E.length;S++){for(var T=E[S],O=!0,A=0;A<d.length;A++)r(T.p,d[A].p)&&(x!==A&&_.push({froms:x,tos:A,hole:S}),O?(O=!1,f[A].push(T)):b=!0);O&&f[x].push(T)}_.length>0&&(b||(m=f))}v=0;for(var M=d.length;v<M;v++){u=d[v].s,l.push(u);for(var C=0,k=(p=m[v]).length;C<k;C++)u.holes.push(p[C].h)}return l}}),Object.assign(Ju.prototype,{isFont:!0,generateShapes:function(t,e,n){function r(t,e,n,r){var o=i.glyphs[t]||i.glyphs["?"];if(o){var a,s,u,l,c,h,p,f,d,m=new Zu,g=[];if(o.o)for(var v=o._cachedOutline||(o._cachedOutline=o.o.split(" ")),y=0,b=v.length;y<b;){switch(v[y++]){case"m":a=v[y++]*e+n,s=v[y++]*e+r,m.moveTo(a,s);break;case"l":a=v[y++]*e+n,s=v[y++]*e+r,m.lineTo(a,s);break;case"q":u=v[y++]*e+n,l=v[y++]*e+r,c=v[y++]*e+n,h=v[y++]*e+r,m.quadraticCurveTo(c,h,u,l),(d=g[g.length-1])&&(d.x,d.y);break;case"b":u=v[y++]*e+n,l=v[y++]*e+r,c=v[y++]*e+n,h=v[y++]*e+r,p=v[y++]*e+n,f=v[y++]*e+r,m.bezierCurveTo(c,h,p,f,u,l),(d=g[g.length-1])&&(d.x,d.y)}}return{offsetX:o.ha*e,path:m}}}void 0===e&&(e=100),void 0===n&&(n=4);for(var i=this.data,o=function(t){for(var n=String(t).split(""),o=e/i.resolution,a=(i.boundingBox.yMax-i.boundingBox.yMin+i.underlineThickness)*o,s=0,u=0,l=[],c=0;c<n.length;c++){var h=n[c];if("\n"===h)s=0,u-=a;else{var p=r(h,o,s,u);s+=p.offsetX,l.push(p.path)}}return l}(t),a=[],s=0,u=o.length;s<u;s++)Array.prototype.push.apply(a,o[s].toShapes());return a}}),Object.assign(Ku.prototype,{load:function(t,e,n,r){var i=this,o=new Is(this.manager);o.setPath(this.path),o.load(t,function(t){var n;try{n=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(t.substring(65,t.length-2))}var r=i.parse(n);e&&e(r)},n,r)},parse:function(t){return new Ju(t)},setPath:function(t){return this.path=t,this}});var Qu,tl,el,nl,rl,il,ol,al,sl,ul,ll,cl,hl,pl,fl,dl,ml,gl,vl,yl,bl,_l,xl,wl,El,Sl,Tl,Ol,Al,Ml,Cl,kl,Pl,Rl,Ll,Il,Dl,Nl,jl,Ul={getContext:function(){return void 0===Wu&&(Wu=new(window.AudioContext||window.webkitAudioContext)),Wu},setContext:function(t){Wu=t}};function Fl(t){this.manager=void 0!==t?t:Rs}function Bl(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new zo,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new zo,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function zl(t,e,n){$r.call(this),this.type="CubeCamera";var r=new zo(90,1,t,e);r.up.set(0,-1,0),r.lookAt(new We(1,0,0)),this.add(r);var i=new zo(90,1,t,e);i.up.set(0,-1,0),i.lookAt(new We(-1,0,0)),this.add(i);var o=new zo(90,1,t,e);o.up.set(0,0,1),o.lookAt(new We(0,1,0)),this.add(o);var a=new zo(90,1,t,e);a.up.set(0,0,-1),a.lookAt(new We(0,-1,0)),this.add(a);var s=new zo(90,1,t,e);s.up.set(0,-1,0),s.lookAt(new We(0,0,1)),this.add(s);var u=new zo(90,1,t,e);u.up.set(0,-1,0),u.lookAt(new We(0,0,-1)),this.add(u);var l={format:re,magFilter:zt,minFilter:zt};this.renderTarget=new Qe(n,n,l),this.renderTarget.texture.name="CubeCamera",this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,l=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,n.activeCubeFace=0,t.render(e,r,n),n.activeCubeFace=1,t.render(e,i,n),n.activeCubeFace=2,t.render(e,o,n),n.activeCubeFace=3,t.render(e,a,n),n.activeCubeFace=4,t.render(e,s,n),n.texture.generateMipmaps=l,n.activeCubeFace=5,t.render(e,u,n),t.setRenderTarget(null)},this.clear=function(t,e,n,r){for(var i=this.renderTarget,o=0;o<6;o++)i.activeCubeFace=o,t.setRenderTarget(i),t.clear(e,n,r);t.setRenderTarget(null)}}function Gl(){$r.call(this),this.type="AudioListener",this.context=Ul.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function Hl(t){$r.call(this),this.type="Audio",this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function Vl(t){Hl.call(this,t),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function Wl(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function ql(t,e,n){this.binding=t,this.valueSize=n;var r,i=Float64Array;switch(e){case"quaternion":r=this._slerp;break;case"string":case"bool":i=Array,r=this._select;break;default:r=this._lerp}this.buffer=new i(4*n),this._mixBufferRegion=r,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}function Xl(t,e,n){var r=n||Yl.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}function Yl(t,e,n){this.path=e,this.parsedPath=n||Yl.parseTrackName(e),this.node=Yl.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function $l(){this.uuid=ze.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var e=0,n=arguments.length;e!==n;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}function Zl(t,e,n){this._mixer=t,this._clip=e,this._localRoot=n||null;for(var r=e.tracks,i=r.length,o=new Array(i),a={endingStart:Te,endingEnd:Te},s=0;s!==i;++s){var u=r[s].createInterpolant(null);o[s]=u,u.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=_e,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Jl(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Kl(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}function Ql(){Qi.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function tc(t,e,n,r){this.uuid=ze.generateUUID(),this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===r}function ec(t,e){this.uuid=ze.generateUUID(),this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function nc(t,e,n){ec.call(this,t,e),this.meshPerAttribute=n||1}function rc(t,e,n){si.call(this,t,e),this.meshPerAttribute=n||1}function ic(t,e,n,r){this.ray=new ao(t,e),this.near=n||0,this.far=r||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function oc(t,e){return t.distance-e.distance}function ac(t,e,n,r){if(!1!==t.visible&&(t.raycast(e,n),!0===r))for(var i=t.children,o=0,a=i.length;o<a;o++)ac(i[o],e,n,!0)}function sc(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function uc(t,e,n){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==n?n:0,this}function lc(t,e,n){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==n?n:0,this}function cc(t){$r.call(this),this.material=t,this.render=function(){}}function hc(t,e,n,r){this.object=t,this.size=void 0!==e?e:1;var i=void 0!==n?n:16711680,o=void 0!==r?r:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=3*s.faces.length:s&&s.isBufferGeometry&&(a=s.attributes.normal.count);var u=new Qi,l=new mi(2*a*3,3);u.addAttribute("position",l),ia.call(this,u,new na({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function pc(t,e){$r.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;for(var n=new Qi,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,o=1;i<32;i++,o++){var a=i/32*Math.PI*2,s=o/32*Math.PI*2;r.push(Math.cos(a),Math.sin(a),1,Math.cos(s),Math.sin(s),1)}n.addAttribute("position",new mi(r,3));var u=new na({fog:!1});this.cone=new ia(n,u),this.add(this.cone),this.update()}function fc(t){for(var e=function t(e){var n=[];e&&e.isBone&&n.push(e);for(var r=0;r<e.children.length;r++)n.push.apply(n,t(e.children[r]));return n}(t),n=new Qi,r=[],i=[],o=new Hn(0,0,1),a=new Hn(0,1,0),s=0;s<e.length;s++){var u=e[s];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(o.r,o.g,o.b),i.push(a.r,a.g,a.b))}n.addAttribute("position",new mi(r,3)),n.addAttribute("color",new mi(i,3));var l=new na({vertexColors:G,depthTest:!1,depthWrite:!1,transparent:!0});ia.call(this,n,l),this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function dc(t,e,n){this.light=t,this.light.updateMatrixWorld(),this.color=n;var r=new is(e,4,2),i=new io({wireframe:!0,fog:!1});lo.call(this,r,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function mc(t,e){$r.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;var n=new na({fog:!1}),r=new Qi;r.addAttribute("position",new si(new Float32Array(15),3)),this.line=new ra(r,n),this.add(this.line),this.update()}function gc(t,e,n){$r.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;var r=new _a(e);r.rotateY(.5*Math.PI),this.material=new io({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=G);var i=r.getAttribute("position"),o=new Float32Array(3*i.count);r.addAttribute("color",new si(o,3)),this.add(new lo(r,this.material)),this.update()}function vc(t,e,n,r){t=t||10,e=e||10,n=new Hn(void 0!==n?n:4473924),r=new Hn(void 0!==r?r:8947848);for(var i=e/2,o=t/e,a=t/2,s=[],u=[],l=0,c=0,h=-a;l<=e;l++,h+=o){s.push(-a,0,h,a,0,h),s.push(h,0,-a,h,0,a);var p=l===i?n:r;p.toArray(u,c),c+=3,p.toArray(u,c),c+=3,p.toArray(u,c),c+=3,p.toArray(u,c),c+=3}var f=new Qi;f.addAttribute("position",new mi(s,3)),f.addAttribute("color",new mi(u,3));var d=new na({vertexColors:G});ia.call(this,f,d)}function yc(t,e,n,r,i,o){t=t||10,e=e||16,n=n||8,r=r||64,i=new Hn(void 0!==i?i:4473924),o=new Hn(void 0!==o?o:8947848);var a,s,u,l,c,h,p,f=[],d=[];for(l=0;l<=e;l++)u=l/e*(2*Math.PI),a=Math.sin(u)*t,s=Math.cos(u)*t,f.push(0,0,0),f.push(a,0,s),p=1&l?i:o,d.push(p.r,p.g,p.b),d.push(p.r,p.g,p.b);for(l=0;l<=n;l++)for(p=1&l?i:o,h=t-t/n*l,c=0;c<r;c++)u=c/r*(2*Math.PI),a=Math.sin(u)*h,s=Math.cos(u)*h,f.push(a,0,s),d.push(p.r,p.g,p.b),u=(c+1)/r*(2*Math.PI),a=Math.sin(u)*h,s=Math.cos(u)*h,f.push(a,0,s),d.push(p.r,p.g,p.b);var m=new Qi;m.addAttribute("position",new mi(f,3)),m.addAttribute("color",new mi(d,3));var g=new na({vertexColors:G});ia.call(this,m,g)}function bc(t,e,n,r){this.object=t,this.size=void 0!==e?e:1;var i=void 0!==n?n:16776960,o=void 0!==r?r:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var u=new Qi,l=new mi(2*a*3,3);u.addAttribute("position",l),ia.call(this,u,new na({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function _c(t,e,n){$r.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===e&&(e=1);var r=new Qi;r.addAttribute("position",new mi([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));var i=new na({fog:!1});this.lightPlane=new ra(r,i),this.add(this.lightPlane),(r=new Qi).addAttribute("position",new mi([0,0,0,0,0,1],3)),this.targetLine=new ra(r,i),this.add(this.targetLine),this.update()}function xc(t){var e=new Qi,n=new na({color:16777215,vertexColors:z}),r=[],i=[],o={},a=new Hn(16755200),s=new Hn(16711680),u=new Hn(43775),l=new Hn(16777215),c=new Hn(3355443);function h(t,e,n){p(t,n),p(e,n)}function p(t,e){r.push(0,0,0),i.push(e.r,e.g,e.b),void 0===o[t]&&(o[t]=[]),o[t].push(r.length/3-1)}h("n1","n2",a),h("n2","n4",a),h("n4","n3",a),h("n3","n1",a),h("f1","f2",a),h("f2","f4",a),h("f4","f3",a),h("f3","f1",a),h("n1","f1",a),h("n2","f2",a),h("n3","f3",a),h("n4","f4",a),h("p","n1",s),h("p","n2",s),h("p","n3",s),h("p","n4",s),h("u1","u2",u),h("u2","u3",u),h("u3","u1",u),h("c","t",l),h("p","c",c),h("cn1","cn2",c),h("cn3","cn4",c),h("cf1","cf2",c),h("cf3","cf4",c),e.addAttribute("position",new mi(r,3)),e.addAttribute("color",new mi(i,3)),ia.call(this,e,n),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}function wc(t,e){this.object=t,void 0===e&&(e=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new Qi;i.setIndex(new si(n,1)),i.addAttribute("position",new si(r,3)),ia.call(this,i,new na({color:e})),this.matrixAutoUpdate=!1,this.update()}function Ec(t,e){this.type="Box3Helper",this.box=t;var n=void 0!==e?e:16776960,r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Qi;i.setIndex(new si(r,1)),i.addAttribute("position",new mi([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),ia.call(this,i,new na({color:n})),this.geometry.computeBoundingSphere()}function Sc(t,e,n){this.type="PlaneHelper",this.plane=t,this.size=void 0===e?1:e;var r=void 0!==n?n:16776960,i=new Qi;i.addAttribute("position",new mi([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),i.computeBoundingSphere(),ra.call(this,i,new na({color:r}));var o=new Qi;o.addAttribute("position",new mi([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),o.computeBoundingSphere(),this.add(new lo(o,new io({color:r,opacity:.2,transparent:!0,depthWrite:!1})))}function Tc(t,e,n,r,i,o){$r.call(this),void 0===r&&(r=16776960),void 0===n&&(n=1),void 0===i&&(i=.2*n),void 0===o&&(o=.2*i),void 0===Il&&((Il=new Qi).addAttribute("position",new mi([0,0,0,0,1,0],3)),(Dl=new ds(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(e),this.line=new ra(Il,new na({color:r})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new lo(Dl,new io({color:r})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,i,o)}function Oc(t){var e=[0,0,0,t=t||1,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=new Qi;n.addAttribute("position",new mi(e,3)),n.addAttribute("color",new mi([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var r=new na({vertexColors:G});ia.call(this,n,r)}Object.assign(Fl.prototype,{load:function(t,e,n,r){var i=new Is(this.manager);i.setResponseType("arraybuffer"),i.load(t,function(t){Ul.getContext().decodeAudioData(t,function(t){e(t)})},n,r)}}),Object.assign(Bl.prototype,{update:(sl=new He,ul=new He,function(t){if(Qu!==this||tl!==t.focus||el!==t.fov||nl!==t.aspect*this.aspect||rl!==t.near||il!==t.far||ol!==t.zoom||al!==this.eyeSep){Qu=this,tl=t.focus,el=t.fov,nl=t.aspect*this.aspect,rl=t.near,il=t.far,ol=t.zoom;var e,n,r=t.projectionMatrix.clone(),i=(al=this.eyeSep/2)*rl/tl,o=rl*Math.tan(ze.DEG2RAD*el*.5)/ol;ul.elements[12]=-al,sl.elements[12]=al,e=-o*nl+i,n=o*nl+i,r.elements[0]=2*rl/(n-e),r.elements[8]=(n+e)/(n-e),this.cameraL.projectionMatrix.copy(r),e=-o*nl-i,n=o*nl-i,r.elements[0]=2*rl/(n-e),r.elements[8]=(n+e)/(n-e),this.cameraR.projectionMatrix.copy(r)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(ul),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(sl)})}),zl.prototype=Object.create($r.prototype),zl.prototype.constructor=zl,Gl.prototype=Object.assign(Object.create($r.prototype),{constructor:Gl,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(t){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){this.gain.gain.value=t},updateMatrixWorld:(ll=new We,cl=new Ve,hl=new We,pl=new We,function(t){$r.prototype.updateMatrixWorld.call(this,t);var e=this.context.listener,n=this.up;this.matrixWorld.decompose(ll,cl,hl),pl.set(0,0,-1).applyQuaternion(cl),e.positionX?(e.positionX.setValueAtTime(ll.x,this.context.currentTime),e.positionY.setValueAtTime(ll.y,this.context.currentTime),e.positionZ.setValueAtTime(ll.z,this.context.currentTime),e.forwardX.setValueAtTime(pl.x,this.context.currentTime),e.forwardY.setValueAtTime(pl.y,this.context.currentTime),e.forwardZ.setValueAtTime(pl.z,this.context.currentTime),e.upX.setValueAtTime(n.x,this.context.currentTime),e.upY.setValueAtTime(n.y,this.context.currentTime),e.upZ.setValueAtTime(n.z,this.context.currentTime)):(e.setPosition(ll.x,ll.y,ll.z),e.setOrientation(pl.x,pl.y,pl.z,n.x,n.y,n.z))})}),Hl.prototype=Object.assign(Object.create($r.prototype),{constructor:Hl,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.onended=this.onEnded.bind(this),t.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,t.start(this.startTime,this.offset),this.isPlaying=!0,this.source=t,this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.offset=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.value=t,this}}),Vl.prototype=Object.assign(Object.create(Hl.prototype),{constructor:Vl,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){this.panner.refDistance=t},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){this.panner.rolloffFactor=t},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){this.panner.distanceModel=t},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){this.panner.maxDistance=t},updateMatrixWorld:(fl=new We,function(t){$r.prototype.updateMatrixWorld.call(this,t),fl.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(fl.x,fl.y,fl.z)})}),Object.assign(Wl.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),n=0;n<e.length;n++)t+=e[n];return t/e.length}}),Object.assign(ql.prototype,{accumulate:function(t,e){var n=this.buffer,r=this.valueSize,i=t*r+r,o=this.cumulativeWeight;if(0===o){for(var a=0;a!==r;++a)n[i+a]=n[a];o=e}else{var s=e/(o+=e);this._mixBufferRegion(n,i,0,s,r)}this.cumulativeWeight=o},apply:function(t){var e=this.valueSize,n=this.buffer,r=t*e+e,i=this.cumulativeWeight,o=this.binding;if(this.cumulativeWeight=0,i<1){var a=3*e;this._mixBufferRegion(n,r,a,1-i,e)}for(var s=e,u=e+e;s!==u;++s)if(n[s]!==n[s+e]){o.setValue(n,r);break}},saveOriginalState:function(){var t=this.binding,e=this.buffer,n=this.valueSize,r=3*n;t.getValue(e,r);for(var i=n,o=r;i!==o;++i)e[i]=e[r+i%n];this.cumulativeWeight=0},restoreOriginalState:function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_select:function(t,e,n,r,i){if(r>=.5)for(var o=0;o!==i;++o)t[e+o]=t[n+o]},_slerp:function(t,e,n,r){Ve.slerpFlat(t,e,t,e,t,n,r)},_lerp:function(t,e,n,r,i){for(var o=1-r,a=0;a!==i;++a){var s=e+a;t[s]=t[s]*o+t[n+a]*r}}}),Object.assign(Xl.prototype,{getValue:function(t,e){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(t,e)},setValue:function(t,e){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}),Object.assign(Yl,{Composite:Xl,create:function(t,e,n){return t&&t.isAnimationObjectGroup?new Yl.Composite(t,e,n):new Yl(t,e,n)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(/[^\w-]/g,"")},parseTrackName:(dl=new RegExp("^"+/((?:[\w-]+[\/:])*)/.source+/([\w-\.]+)?/.source+/(?:\.([\w-]+)(?:\[(.+)\])?)?/.source+/\.([\w-]+)(?:\[(.+)\])?/.source+"$"),ml=["material","materials","bones"],function(t){var e=dl.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==ml.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}),findNode:function(t,e){if(!e||""===e||"root"===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var n=function(t){for(var n=0;n<t.bones.length;n++){var r=t.bones[n];if(r.name===e)return r}return null}(t.skeleton);if(n)return n}if(t.children){var r=function(t){for(var n=0;n<t.length;n++){var i=t[n];if(i.name===e||i.uuid===e)return i;var o=r(i.children);if(o)return o}return null},i=r(t.children);if(i)return i}return null}}),Object.assign(Yl.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)t[e++]=n[r]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,n=e.objectName,r=e.propertyName,i=e.propertyIndex;if(t||(t=Yl.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(n){var o=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var a=0;a<t.length;a++)if(t[a].name===o){o=a;break}break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==o){if(void 0===t[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[o]}}var s=t[r];if(void 0!==s){var u=this.Versioning.None;void 0!==t.needsUpdate?(u=this.Versioning.NeedsUpdate,this.targetObject=t):void 0!==t.matrixWorldNeedsUpdate&&(u=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=t);var l=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(a=0;a<this.node.geometry.morphAttributes.position.length;a++)if(t.geometry.morphAttributes.position[a].name===i){i=a;break}}else{if(!t.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(a=0;a<this.node.geometry.morphTargets.length;a++)if(t.geometry.morphTargets[a].name===i){i=a;break}}}l=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(l=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(l=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][u]}else{var c=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+r+" but it wasn't found.",t)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Yl.prototype,{_getValue_unbound:Yl.prototype.getValue,_setValue_unbound:Yl.prototype.setValue}),Object.assign($l.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,e=t.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._paths,o=this._parsedPaths,a=this._bindings,s=a.length,u=0,l=arguments.length;u!==l;++u){var c=arguments[u],h=c.uuid,p=r[h],f=void 0;if(void 0===p){p=e++,r[h]=p,t.push(c);for(var d=0,m=s;d!==m;++d)a[d].push(new Yl(c,i[d],o[d]))}else if(p<n){f=t[p];var g=--n,v=t[g];r[v.uuid]=p,t[p]=v,r[h]=g,t[g]=c;for(d=0,m=s;d!==m;++d){var y=a[d],b=y[g],_=y[p];y[p]=b,void 0===_&&(_=new Yl(c,i[d],o[d])),y[g]=_}}else t[p]!==f&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var t=this._objects,e=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,i=r.length,o=0,a=arguments.length;o!==a;++o){var s=arguments[o],u=s.uuid,l=n[u];if(void 0!==l&&l>=e){var c=e++,h=t[c];n[h.uuid]=l,t[l]=h,n[u]=c,t[c]=s;for(var p=0,f=i;p!==f;++p){var d=r[p],m=d[c],g=d[l];d[l]=m,d[c]=g}}}this.nCachedObjects_=e},uncache:function(){for(var t=this._objects,e=t.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._bindings,o=i.length,a=0,s=arguments.length;a!==s;++a){var u=arguments[a].uuid,l=r[u];if(void 0!==l)if(delete r[u],l<n){var c=--n,h=t[c],p=t[v=--e];r[h.uuid]=l,t[l]=h,r[p.uuid]=c,t[c]=p,t.pop();for(var f=0,d=o;f!==d;++f){var m=(y=i[f])[c],g=y[v];y[l]=m,y[c]=g,y.pop()}}else{var v;r[(p=t[v=--e]).uuid]=l,t[l]=p,t.pop();for(f=0,d=o;f!==d;++f){var y;(y=i[f])[l]=y[v],y.pop()}}}this.nCachedObjects_=n},subscribe_:function(t,e){var n=this._bindingsIndicesByPath,r=n[t],i=this._bindings;if(void 0!==r)return i[r];var o=this._paths,a=this._parsedPaths,s=this._objects,u=s.length,l=this.nCachedObjects_,c=new Array(u);r=i.length,n[t]=r,o.push(t),a.push(e),i.push(c);for(var h=l,p=s.length;h!==p;++h){var f=s[h];c[h]=new Yl(f,t,e)}return c},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){var r=this._paths,i=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];e[t[a]]=n,o[n]=s,o.pop(),i[n]=i[a],i.pop(),r[n]=r[a],r.pop()}}}),Object.assign(Zl.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){var r=this._clip.duration,i=t._clip.duration,o=i/r,a=r/i;t.warp(1,o,e),this.warp(a,1,e)}return this},crossFadeTo:function(t,e,n){return t.crossFadeFrom(this,e,n)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,n){var r=this._mixer,i=r.time,o=this._timeScaleInterpolant,a=this.timeScale;null===o&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,u=o.sampleValues;return s[0]=i,s[1]=i+n,u[0]=t/a,u[1]=e/a,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var o=(t-i)*n;if(o<0||0===n)return;this._startTime=null,e=n*o}e*=this._updateTimeScale(t);var a=this._updateTime(e),s=this._updateWeight(t);if(s>0)for(var u=this._interpolants,l=this._propertyBindings,c=0,h=u.length;c!==h;++c)u[c].evaluate(a),l[c].accumulate(r,s)}else this._updateWeight(t)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=e,e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n)e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}return this._effectiveTimeScale=e,e},_updateTime:function(t){var e=this.time+t;if(0===t)return e;var n=this._clip.duration,r=this.loop,i=this._loopCount;if(r===be){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(e>=n)e=n;else{if(!(e<0))break t;e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{var o=r===xe;if(-1===i&&(t>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),e>=n||e<0){var a=Math.floor(e/n);e-=n*a,i+=Math.abs(a);var s=this.repetitions-i;if(s<0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=t>0?n:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(0===s){var u=t<0;this._setEndings(u,!u,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}if(o&&1==(1&i))return this.time=e,n-e}return this.time=e,e},_setEndings:function(t,e,n){var r=this._interpolantSettings;n?(r.endingStart=Oe,r.endingEnd=Oe):(r.endingStart=t?this.zeroSlopeAtStart?Oe:Te:Ae,r.endingEnd=e?this.zeroSlopeAtEnd?Oe:Te:Ae)},_scheduleFading:function(t,e,n){var r=this._mixer,i=r.time,o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);var a=o.parameterPositions,s=o.sampleValues;return a[0]=i,s[0]=e,a[1]=i+t,s[1]=n,this}}),Jl.prototype=Object.assign(Object.create(r.prototype),{constructor:Jl,_bindAction:function(t,e){var n=t._localRoot||this._root,r=t._clip.tracks,i=r.length,o=t._propertyBindings,a=t._interpolants,s=n.uuid,u=this._bindingsByRootAndName,l=u[s];void 0===l&&(l={},u[s]=l);for(var c=0;c!==i;++c){var h=r[c],p=h.name,f=l[p];if(void 0!==f)o[c]=f;else{if(void 0!==(f=o[c])){null===f._cacheIndex&&(++f.referenceCount,this._addInactiveBinding(f,s,p));continue}var d=e&&e._propertyBindings[c].binding.parsedPath;++(f=new ql(Yl.create(n,p,d),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(f,s,p),o[c]=f}a[c].resultBuffer=f.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,n=t._clip.uuid,r=this._actionsByClip[n];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,n,e)}for(var i=t._propertyBindings,o=0,a=i.length;o!==a;++o){var s=i[o];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,n){var r=this._actions,i=this._actionsByClip,o=i[e];if(void 0===o)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=o;else{var a=o.knownActions;t._byClipCacheIndex=a.length,a.push(t)}t._cacheIndex=r.length,r.push(t),o.actionByRoot[n]=t},_removeInactiveAction:function(t){var e=this._actions,n=e[e.length-1],r=t._cacheIndex;n._cacheIndex=r,e[r]=n,e.pop(),t._cacheIndex=null;var i=t._clip.uuid,o=this._actionsByClip,a=o[i],s=a.knownActions,u=s[s.length-1],l=t._byClipCacheIndex;u._byClipCacheIndex=l,s[l]=u,s.pop(),t._byClipCacheIndex=null,delete a.actionByRoot[(t._localRoot||this._root).uuid],0===s.length&&delete o[i],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(t){var e=this._actions,n=t._cacheIndex,r=this._nActiveActions++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackAction:function(t){var e=this._actions,n=t._cacheIndex,r=--this._nActiveActions,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_addInactiveBinding:function(t,e,n){var r=this._bindingsByRootAndName,i=r[e],o=this._bindings;void 0===i&&(i={},r[e]=i),i[n]=t,t._cacheIndex=o.length,o.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,n=t.binding,r=n.rootNode.uuid,i=n.path,o=this._bindingsByRootAndName,a=o[r],s=e[e.length-1],u=t._cacheIndex;s._cacheIndex=u,e[u]=s,e.pop(),delete a[i];t:{for(var l in a)break t;delete o[r]}},_lendBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,n=t[e];return void 0===n&&((n=new Au(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=e,t[e]=n),n},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,i=e[r];t.__cacheIndex=r,e[r]=t,i.__cacheIndex=n,e[n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"==typeof t?Ru.findByName(n,t):t,o=null!==i?i.uuid:t,a=this._actionsByClip[o],s=null;if(void 0!==a){var u=a.actionByRoot[r];if(void 0!==u)return u;s=a.knownActions[0],null===i&&(i=s._clip)}if(null===i)return null;var l=new Zl(this,i,e);return this._bindAction(l,s),this._addInactiveAction(l,o,r),l},existingAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"==typeof t?Ru.findByName(n,t):t,o=i?i.uuid:t,a=this._actionsByClip[o];return void 0!==a?a.actionByRoot[r]||null:null},stopAllAction:function(){var t=this._actions,e=this._nActiveActions,n=this._bindings,r=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==e;++i)t[i].reset();for(i=0;i!==r;++i)n[i].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,n=this._nActiveActions,r=this.time+=t,i=Math.sign(t),o=this._accuIndex^=1,a=0;a!==n;++a){e[a]._update(r,t,i,o)}var s=this._bindings,u=this._nActiveBindings;for(a=0;a!==u;++a)s[a].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,n=t.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var o=i.knownActions,a=0,s=o.length;a!==s;++a){var u=o[a];this._deactivateAction(u);var l=u._cacheIndex,c=e[e.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,c._cacheIndex=l,e[l]=c,e.pop(),this._removeInactiveBindingsForAction(u)}delete r[n]}},uncacheRoot:function(t){var e=t.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[e];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var o=this._bindingsByRootAndName[e];if(void 0!==o)for(var a in o){var s=o[a];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(t,e){var n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),Kl.prototype.clone=function(){return new Kl(void 0===this.value.clone?this.value:this.value.clone())},Ql.prototype=Object.assign(Object.create(Qi.prototype),{constructor:Ql,isInstancedBufferGeometry:!0,copy:function(t){return Qi.prototype.copy.call(this,t),this.maxInstancedCount=t.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)}}),Object.defineProperties(tc.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(tc.prototype,{isInterleavedBufferAttribute:!0,setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this},setXYZ:function(t,e,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=i,this}}),Object.defineProperty(ec.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(ec.prototype,{isInterleavedBuffer:!0,setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==t?t.length/this.stride:0,this.array=t},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.dynamic=t.dynamic,this},copyAt:function(t,e,n){t*=this.stride,n*=e.stride;for(var r=0,i=this.stride;r<i;r++)this.array[t+r]=e.array[n+r];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}}),nc.prototype=Object.assign(Object.create(ec.prototype),{constructor:nc,isInstancedInterleavedBuffer:!0,copy:function(t){return ec.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),rc.prototype=Object.assign(Object.create(si.prototype),{constructor:rc,isInstancedBufferAttribute:!0,copy:function(t){return si.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),Object.assign(ic.prototype,{linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize()):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e){var n=[];return ac(t,this,n,e),n.sort(oc),n},intersectObjects:function(t,e){var n=[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),n;for(var r=0,i=t.length;r<i;r++)ac(t[r],this,n,e);return n.sort(oc),n}}),Object.assign(sc.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var e=("undefined"==typeof performance?Date:performance).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}}),Object.assign(uc.prototype,{set:function(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.radius=t.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t.x,t.z),this.phi=Math.acos(ze.clamp(t.y/this.radius,-1,1))),this}}),Object.assign(lc.prototype,{set:function(t,e,n){return this.radius=t,this.theta=e,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.radius=Math.sqrt(t.x*t.x+t.z*t.z),this.theta=Math.atan2(t.x,t.z),this.y=t.y,this}}),cc.prototype=Object.create($r.prototype),cc.prototype.constructor=cc,cc.prototype.isImmediateRenderObject=!0,hc.prototype=Object.create(ia.prototype),hc.prototype.constructor=hc,hc.prototype.update=(gl=new We,vl=new We,yl=new qe,function(){var t=["a","b","c"];this.object.updateMatrixWorld(!0),yl.getNormalMatrix(this.object.matrixWorld);var e=this.object.matrixWorld,n=this.geometry.attributes.position,r=this.object.geometry;if(r&&r.isGeometry)for(var i=r.vertices,o=r.faces,a=0,s=0,u=o.length;s<u;s++)for(var l=o[s],c=0,h=l.vertexNormals.length;c<h;c++){var p=i[l[t[c]]],f=l.vertexNormals[c];gl.copy(p).applyMatrix4(e),vl.copy(f).applyMatrix3(yl).normalize().multiplyScalar(this.size).add(gl),n.setXYZ(a,gl.x,gl.y,gl.z),a+=1,n.setXYZ(a,vl.x,vl.y,vl.z),a+=1}else if(r&&r.isBufferGeometry){var d=r.attributes.position,m=r.attributes.normal;for(a=0,c=0,h=d.count;c<h;c++)gl.set(d.getX(c),d.getY(c),d.getZ(c)).applyMatrix4(e),vl.set(m.getX(c),m.getY(c),m.getZ(c)),vl.applyMatrix3(yl).normalize().multiplyScalar(this.size).add(gl),n.setXYZ(a,gl.x,gl.y,gl.z),a+=1,n.setXYZ(a,vl.x,vl.y,vl.z),a+=1}n.needsUpdate=!0}),pc.prototype=Object.create($r.prototype),pc.prototype.constructor=pc,pc.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},pc.prototype.update=(bl=new We,_l=new We,function(){this.light.updateMatrixWorld();var t=this.light.distance?this.light.distance:1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),bl.setFromMatrixPosition(this.light.matrixWorld),_l.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(_l.sub(bl)),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}),fc.prototype=Object.create(ia.prototype),fc.prototype.constructor=fc,fc.prototype.updateMatrixWorld=(xl=new We,wl=new He,El=new He,function(t){var e=this.bones,n=this.geometry,r=n.getAttribute("position");El.getInverse(this.root.matrixWorld);for(var i=0,o=0;i<e.length;i++){var a=e[i];a.parent&&a.parent.isBone&&(wl.multiplyMatrices(El,a.matrixWorld),xl.setFromMatrixPosition(wl),r.setXYZ(o,xl.x,xl.y,xl.z),wl.multiplyMatrices(El,a.parent.matrixWorld),xl.setFromMatrixPosition(wl),r.setXYZ(o+1,xl.x,xl.y,xl.z),o+=2)}n.getAttribute("position").needsUpdate=!0,$r.prototype.updateMatrixWorld.call(this,t)}),dc.prototype=Object.create(lo.prototype),dc.prototype.constructor=dc,dc.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},dc.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},mc.prototype=Object.create($r.prototype),mc.prototype.constructor=mc,mc.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},mc.prototype.update=function(){var t=.5*this.light.width,e=.5*this.light.height,n=this.line.geometry.attributes.position,r=n.array;r[0]=t,r[1]=-e,r[2]=0,r[3]=t,r[4]=e,r[5]=0,r[6]=-t,r[7]=e,r[8]=0,r[9]=-t,r[10]=-e,r[11]=0,r[12]=t,r[13]=-e,r[14]=0,n.needsUpdate=!0,void 0!==this.color?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)},gc.prototype=Object.create($r.prototype),gc.prototype.constructor=gc,gc.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},gc.prototype.update=(Sl=new We,Tl=new Hn,Ol=new Hn,function(){var t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var e=t.geometry.getAttribute("color");Tl.copy(this.light.color),Ol.copy(this.light.groundColor);for(var n=0,r=e.count;n<r;n++){var i=n<r/2?Tl:Ol;e.setXYZ(n,i.r,i.g,i.b)}e.needsUpdate=!0}t.lookAt(Sl.setFromMatrixPosition(this.light.matrixWorld).negate())}),vc.prototype=Object.create(ia.prototype),vc.prototype.constructor=vc,yc.prototype=Object.create(ia.prototype),yc.prototype.constructor=yc,bc.prototype=Object.create(ia.prototype),bc.prototype.constructor=bc,bc.prototype.update=(Al=new We,Ml=new We,Cl=new qe,function(){this.object.updateMatrixWorld(!0),Cl.getNormalMatrix(this.object.matrixWorld);for(var t=this.object.matrixWorld,e=this.geometry.attributes.position,n=this.object.geometry,r=n.vertices,i=n.faces,o=0,a=0,s=i.length;a<s;a++){var u=i[a],l=u.normal;Al.copy(r[u.a]).add(r[u.b]).add(r[u.c]).divideScalar(3).applyMatrix4(t),Ml.copy(l).applyMatrix3(Cl).normalize().multiplyScalar(this.size).add(Al),e.setXYZ(o,Al.x,Al.y,Al.z),o+=1,e.setXYZ(o,Ml.x,Ml.y,Ml.z),o+=1}e.needsUpdate=!0}),_c.prototype=Object.create($r.prototype),_c.prototype.constructor=_c,_c.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},_c.prototype.update=(kl=new We,Pl=new We,Rl=new We,function(){kl.setFromMatrixPosition(this.light.matrixWorld),Pl.setFromMatrixPosition(this.light.target.matrixWorld),Rl.subVectors(Pl,kl),this.lightPlane.lookAt(Rl),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Rl),this.targetLine.scale.z=Rl.length()}),xc.prototype=Object.create(ia.prototype),xc.prototype.constructor=xc,xc.prototype.update=function(){var t,e,n=new We,r=new Zr;function i(i,o,a,s){n.set(o,a,s).unproject(r);var u=e[i];if(void 0!==u)for(var l=t.getAttribute("position"),c=0,h=u.length;c<h;c++)l.setXYZ(u[c],n.x,n.y,n.z)}return function(){t=this.geometry,e=this.pointMap;r.projectionMatrix.copy(this.camera.projectionMatrix),i("c",0,0,-1),i("t",0,0,1),i("n1",-1,-1,-1),i("n2",1,-1,-1),i("n3",-1,1,-1),i("n4",1,1,-1),i("f1",-1,-1,1),i("f2",1,-1,1),i("f3",-1,1,1),i("f4",1,1,1),i("u1",.7,1.1,-1),i("u2",-.7,1.1,-1),i("u3",0,2,-1),i("cf1",-1,0,1),i("cf2",1,0,1),i("cf3",0,-1,1),i("cf4",0,1,1),i("cn1",-1,0,-1),i("cn2",1,0,-1),i("cn3",0,-1,-1),i("cn4",0,1,-1),t.getAttribute("position").needsUpdate=!0}}(),wc.prototype=Object.create(ia.prototype),wc.prototype.constructor=wc,wc.prototype.update=(Ll=new xr,function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Ll.setFromObject(this.object),!Ll.isEmpty()){var e=Ll.min,n=Ll.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=e.x,i[4]=n.y,i[5]=n.z,i[6]=e.x,i[7]=e.y,i[8]=n.z,i[9]=n.x,i[10]=e.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=e.z,i[15]=e.x,i[16]=n.y,i[17]=e.z,i[18]=e.x,i[19]=e.y,i[20]=e.z,i[21]=n.x,i[22]=e.y,i[23]=e.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}}),wc.prototype.setFromObject=function(t){return this.object=t,this.update(),this},Ec.prototype=Object.create(ia.prototype),Ec.prototype.constructor=Ec,Ec.prototype.updateMatrixWorld=function(t){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),$r.prototype.updateMatrixWorld.call(this,t))},Sc.prototype=Object.create(ra.prototype),Sc.prototype.constructor=Sc,Sc.prototype.updateMatrixWorld=function(t){var e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.lookAt(this.plane.normal),$r.prototype.updateMatrixWorld.call(this,t)},Tc.prototype=Object.create($r.prototype),Tc.prototype.constructor=Tc,Tc.prototype.setDirection=(jl=new We,function(t){t.y>.99999?this.quaternion.set(0,0,0,1):t.y<-.99999?this.quaternion.set(1,0,0,0):(jl.set(t.z,0,-t.x).normalize(),Nl=Math.acos(t.y),this.quaternion.setFromAxisAngle(jl,Nl))}),Tc.prototype.setLength=function(t,e,n){void 0===e&&(e=.2*t),void 0===n&&(n=.2*e),this.line.scale.set(1,Math.max(0,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()},Tc.prototype.setColor=function(t){this.line.material.color.copy(t),this.cone.material.color.copy(t)},Oc.prototype=Object.create(ia.prototype),Oc.prototype.constructor=Oc;var Ac={createMultiMaterialObject:function(t,e){for(var n=new ua,r=0,i=e.length;r<i;r++)n.add(new lo(t,e[r]));return n},detach:function(t,e,n){t.applyMatrix(e.matrixWorld),e.remove(t),n.add(t)},attach:function(t,e,n){t.applyMatrix((new He).getInverse(n.matrixWorld)),e.remove(t),n.add(t)}};function Mc(t,e,n,r,i,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new Kr(t,e,n,i,o,a)}var Cc,kc=0,Pc=1;function Rc(t){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),t}function Lc(t){return void 0===t&&(t=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),t.isMultiMaterial=!0,t.materials=t,t.clone=function(){return t.slice()},t}function Ic(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new sa(t,e)}function Dc(t){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Jo(t)}function Nc(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new sa(t,e)}function jc(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new aa(t)}function Uc(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new aa(t)}function Fc(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new aa(t)}function Bc(t,e,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new We(t,e,n)}function zc(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new si(t,e).setDynamic(!0)}function Gc(t,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new ui(t,e)}function Hc(t,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new li(t,e)}function Vc(t,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new ci(t,e)}function Wc(t,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new hi(t,e)}function qc(t,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new pi(t,e)}function Xc(t,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new fi(t,e)}function Yc(t,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new di(t,e)}function $c(t,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new mi(t,e)}function Zc(t,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new gi(t,e)}function Jc(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Ys.call(this,t),this.type="catmullrom",this.closed=!0}function Kc(t){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Ys.call(this,t),this.type="catmullrom"}function Qc(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Ys.call(this,t),this.type="catmullrom"}function th(t){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new Oc(t)}function eh(t,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new wc(t,e)}function nh(t,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new ia(new ps(t.geometry),new na({color:void 0!==e?e:16777215}))}function rh(t,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new ia(new pa(t.geometry),new na({color:void 0!==e?e:16777215}))}function ih(t){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Is(t)}function oh(t){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Ns(t)}Bs.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(Bs.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},Object.assign(au.prototype,{createPointsGeometry:function(t){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getPoints(t);return this.createGeometry(e)},createSpacedPointsGeometry:function(t){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getSpacedPoints(t);return this.createGeometry(e)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var e=new ai,n=0,r=t.length;n<r;n++){var i=t[n];e.vertices.push(new We(i.x,i.y,i.z||0))}return e}}),Object.assign(su.prototype,{fromPoints:function(t){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),Jc.prototype=Object.create(Ys.prototype),Kc.prototype=Object.create(Ys.prototype),Qc.prototype=Object.create(Ys.prototype),Object.assign(Qc.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),vc.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},fc.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Bu.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Gu.extractUrlBase(t)}}),Object.assign(Zn.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(xr.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),so.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Object.assign(ze,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),ze.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),ze.ceilPowerOfTwo(t)}}),Object.assign(qe.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(t){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(He.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){return void 0===Cc&&(Cc=new We),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),Cc.setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(t){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,e,n,r,i,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,r,n,i,o)}}),Er.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},Ve.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(ao.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(uu.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Qa(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new ls(this,t)}}),Object.assign(Ge.prototype,{fromAttribute:function(t,e,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(We.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,e,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Je.prototype,{fromAttribute:function(t,e,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),ai.prototype.computeTangents=function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},Object.assign($r.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)}}),Object.defineProperties($r.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(Ko.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Qo.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Object.defineProperty(Bs.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),zo.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(lu.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(si.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}}}),Object.assign(Qi.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addDrawCall:function(t,e,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(Qi.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Kl.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(yr.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Hn}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===U}}}),Object.defineProperties(Ss.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(oo.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(Wo.prototype,{getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}}),Object.defineProperties(Wo.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),this.shadowMap.cullFace=t}}}),Object.defineProperties(Tr.prototype,{cullFace:{get:function(){return this.renderReverseSided?M:A},set:function(t){var e=t!==A;console.warn("WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to "+e+"."),this.renderReverseSided=e}}}),Object.defineProperties(Ke.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.assign(Ho.prototype,{getStandingMatrix:function(){console.warn("THREE.WebVRManager: .getStandingMatrix() has been removed.")}}),Object.defineProperties(Ho.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}}}),Hl.prototype.load=function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var e=this;return(new Fl).load(t,function(t){e.setBuffer(t)}),this},Wl.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},zl.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)};var ah={merge:function(t,e,n){var r;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),e.isMesh&&(e.matrixAutoUpdate&&e.updateMatrix(),r=e.matrix,e=e.geometry),t.merge(e,r,n)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}},sh={crossOrigin:void 0,loadTexture:function(t,e,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new Fs;i.setCrossOrigin(this.crossOrigin);var o=i.load(t,n,void 0,r);return e&&(o.mapping=e),o},loadTextureCube:function(t,e,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new Us;i.setCrossOrigin(this.crossOrigin);var o=i.load(t,n,void 0,r);return e&&(o.mapping=e),o},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}};function uh(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(t,e){console.warn("THREE.Projector: .projectVector() is now vector.project()."),t.project(e)},this.unprojectVector=function(t,e){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),t.unproject(e)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}}function lh(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}}},function(t,e){},function(t,e,n){var r=n(6),i=n(4).document,o=r(i)&&r(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,e,n){var r=n(4),i=n(38),o=n(64),a=n(305),s=n(12).f;t.exports=function(t){var e=i.Symbol||(i.Symbol=o?{}:r.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:a.f(t)})}},function(t,e,n){var r=n(122)("keys"),i=n(63);t.exports=function(t){return r[t]||(r[t]=i(t))}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){var r=n(4).document;t.exports=r&&r.documentElement},function(t,e,n){var r=n(6),i=n(3),o=function(t,e){if(i(t),!r(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,r){try{(r=n(31)(Function.call,n(28).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return o(t,n),e?t.__proto__=n:r(t,n),t}}({},!1):void 0),check:o}},function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,e,n){var r=n(6),i=n(192).set;t.exports=function(t,e,n){var o,a=e.constructor;return a!==n&&"function"==typeof a&&(o=a.prototype)!==n.prototype&&r(o)&&i&&i(t,o),t}},function(t,e,n){"use strict";var r=n(41),i=n(40);t.exports=function(t){var e=String(i(this)),n="",o=r(t);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(n+=e);return n}},function(t,e){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,e){var n=Math.expm1;t.exports=!n||n(10)>22025.465794806718||n(10)<22025.465794806718||-2e-17!=n(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:n},function(t,e,n){var r=n(41),i=n(40);t.exports=function(t){return function(e,n){var o,a,s=String(i(e)),u=r(n),l=s.length;return u<0||u>=l?t?"":void 0:(o=s.charCodeAt(u))<55296||o>56319||u+1===l||(a=s.charCodeAt(u+1))<56320||a>57343?t?s.charAt(u):o:t?s.slice(u,u+2):a-56320+(o-55296<<10)+65536}}},function(t,e,n){"use strict";var r=n(64),i=n(0),o=n(24),a=n(23),s=n(22),u=n(84),l=n(200),c=n(82),h=n(29),p=n(7)("iterator"),f=!([].keys&&"next"in[].keys()),d=function(){return this};t.exports=function(t,e,n,m,g,v,y){l(n,e,m);var b,_,x,w=function(t){if(!f&&t in O)return O[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},E=e+" Iterator",S="values"==g,T=!1,O=t.prototype,A=O[p]||O["@@iterator"]||g&&O[g],M=A||w(g),C=g?S?w("entries"):M:void 0,k="Array"==e?O.entries||A:A;if(k&&(x=h(k.call(new t)))!==Object.prototype&&x.next&&(c(x,E,!0),r||s(x,p)||a(x,p,d)),S&&A&&"values"!==A.name&&(T=!0,M=function(){return A.call(this)}),r&&!y||!f&&!T&&O[p]||a(O,p,M),u[e]=M,u[E]=d,g)if(b={values:S?M:w("values"),keys:v?M:w("keys"),entries:C},y)for(_ in b)_ in O||o(O,_,b[_]);else i(i.P+i.F*(f||T),e,b);return b}},function(t,e,n){"use strict";var r=n(67),i=n(62),o=n(82),a={};n(23)(a,n(7)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=r(a,{next:i(1,n)}),o(t,e+" Iterator")}},function(t,e,n){var r=n(126),i=n(40);t.exports=function(t,e,n){if(r(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(t))}},function(t,e,n){var r=n(7)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[r]=!1,!"/./"[t](e)}catch(t){}}return!0}},function(t,e,n){var r=n(84),i=n(7)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||o[i]===t)}},function(t,e,n){"use strict";var r=n(12),i=n(62);t.exports=function(t,e,n){e in t?r.f(t,e,i(0,n)):t[e]=n}},function(t,e,n){var r=n(98),i=n(7)("iterator"),o=n(84);t.exports=n(38).getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[r(t)]}},function(t,e,n){var r=n(799);t.exports=function(t,e){return new(r(t))(e)}},function(t,e,n){"use strict";var r=n(14),i=n(66),o=n(13);t.exports=function(t){for(var e=r(this),n=o(e.length),a=arguments.length,s=i(a>1?arguments[1]:void 0,n),u=a>2?arguments[2]:void 0,l=void 0===u?n:i(u,n);l>s;)e[s++]=t;return e}},function(t,e,n){"use strict";var r=n(52),i=n(321),o=n(84),a=n(27);t.exports=n(199)(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,i(1)):i(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(t,e,n){var r,i,o,a=n(31),s=n(311),u=n(191),l=n(187),c=n(4),h=c.process,p=c.setImmediate,f=c.clearImmediate,d=c.MessageChannel,m=c.Dispatch,g=0,v={},y=function(){var t=+this;if(v.hasOwnProperty(t)){var e=v[t];delete v[t],e()}},b=function(t){y.call(t.data)};p&&f||(p=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return v[++g]=function(){s("function"==typeof t?t:Function(t),e)},r(g),g},f=function(t){delete v[t]},"process"==n(32)(h)?r=function(t){h.nextTick(a(y,t,1))}:m&&m.now?r=function(t){m.now(a(y,t,1))}:d?(o=(i=new d).port2,i.port1.onmessage=b,r=a(o.postMessage,o,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(r=function(t){c.postMessage(t+"","*")},c.addEventListener("message",b,!1)):r="onreadystatechange"in l("script")?function(t){u.appendChild(l("script")).onreadystatechange=function(){u.removeChild(this),y.call(t)}}:function(t){setTimeout(a(y,t,1),0)}),t.exports={set:p,clear:f}},function(t,e,n){var r=n(4),i=n(209).set,o=r.MutationObserver||r.WebKitMutationObserver,a=r.process,s=r.Promise,u="process"==n(32)(a);t.exports=function(){var t,e,n,l=function(){var r,i;for(u&&(r=a.domain)&&r.exit();t;){i=t.fn,t=t.next;try{i()}catch(r){throw t?n():e=void 0,r}}e=void 0,r&&r.enter()};if(u)n=function(){a.nextTick(l)};else if(o){var c=!0,h=document.createTextNode("");new o(l).observe(h,{characterData:!0}),n=function(){h.data=c=!c}}else if(s&&s.resolve){var p=s.resolve();n=function(){p.then(l)}}else n=function(){i.call(r,l)};return function(r){var i={fn:r,next:void 0};e&&(e.next=i),t||(t=i,n()),e=i}}},function(t,e,n){"use strict";var r=n(17);t.exports.f=function(t){return new function(t){var e,n;this.promise=new t(function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r}),this.resolve=r(e),this.reject=r(n)}(t)}},function(t,e,n){"use strict";var r=n(4),i=n(11),o=n(64),a=n(132),s=n(23),u=n(72),l=n(5),c=n(70),h=n(41),p=n(13),f=n(330),d=n(68).f,m=n(12).f,g=n(207),v=n(82),y="ArrayBuffer",b="DataView",_="prototype",x="Wrong index!",w=r[y],E=r[b],S=r.Math,T=r.RangeError,O=r.Infinity,A=w,M=S.abs,C=S.pow,k=S.floor,P=S.log,R=S.LN2,L=i?"_b":"buffer",I=i?"_l":"byteLength",D=i?"_o":"byteOffset";function N(t,e,n){var r,i,o,a=Array(n),s=8*n-e-1,u=(1<<s)-1,l=u>>1,c=23===e?C(2,-24)-C(2,-77):0,h=0,p=t<0||0===t&&1/t<0?1:0;for((t=M(t))!=t||t===O?(i=t!=t?1:0,r=u):(r=k(P(t)/R),t*(o=C(2,-r))<1&&(r--,o*=2),(t+=r+l>=1?c/o:c*C(2,1-l))*o>=2&&(r++,o/=2),r+l>=u?(i=0,r=u):r+l>=1?(i=(t*o-1)*C(2,e),r+=l):(i=t*C(2,l-1)*C(2,e),r=0));e>=8;a[h++]=255&i,i/=256,e-=8);for(r=r<<e|i,s+=e;s>0;a[h++]=255&r,r/=256,s-=8);return a[--h]|=128*p,a}function j(t,e,n){var r,i=8*n-e-1,o=(1<<i)-1,a=o>>1,s=i-7,u=n-1,l=t[u--],c=127&l;for(l>>=7;s>0;c=256*c+t[u],u--,s-=8);for(r=c&(1<<-s)-1,c>>=-s,s+=e;s>0;r=256*r+t[u],u--,s-=8);if(0===c)c=1-a;else{if(c===o)return r?NaN:l?-O:O;r+=C(2,e),c-=a}return(l?-1:1)*r*C(2,c-e)}function U(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function F(t){return[255&t]}function B(t){return[255&t,t>>8&255]}function z(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function G(t){return N(t,52,8)}function H(t){return N(t,23,4)}function V(t,e,n){m(t[_],e,{get:function(){return this[n]}})}function W(t,e,n,r){var i=f(+n);if(i+e>t[I])throw T(x);var o=t[L]._b,a=i+t[D],s=o.slice(a,a+e);return r?s:s.reverse()}function q(t,e,n,r,i,o){var a=f(+n);if(a+e>t[I])throw T(x);for(var s=t[L]._b,u=a+t[D],l=r(+i),c=0;c<e;c++)s[u+c]=l[o?c:e-c-1]}if(a.ABV){if(!l(function(){w(1)})||!l(function(){new w(-1)})||l(function(){return new w,new w(1.5),new w(NaN),w.name!=y})){for(var X,Y=(w=function(t){return c(this,w),new A(f(t))})[_]=A[_],$=d(A),Z=0;$.length>Z;)(X=$[Z++])in w||s(w,X,A[X]);o||(Y.constructor=w)}var J=new E(new w(2)),K=E[_].setInt8;J.setInt8(0,2147483648),J.setInt8(1,2147483649),!J.getInt8(0)&&J.getInt8(1)||u(E[_],{setInt8:function(t,e){K.call(this,t,e<<24>>24)},setUint8:function(t,e){K.call(this,t,e<<24>>24)}},!0)}else w=function(t){c(this,w,y);var e=f(t);this._b=g.call(Array(e),0),this[I]=e},E=function(t,e,n){c(this,E,b),c(t,w,b);var r=t[I],i=h(e);if(i<0||i>r)throw T("Wrong offset!");if(i+(n=void 0===n?r-i:p(n))>r)throw T("Wrong length!");this[L]=t,this[D]=i,this[I]=n},i&&(V(w,"byteLength","_l"),V(E,"buffer","_b"),V(E,"byteLength","_l"),V(E,"byteOffset","_o")),u(E[_],{getInt8:function(t){return W(this,1,t)[0]<<24>>24},getUint8:function(t){return W(this,1,t)[0]},getInt16:function(t){var e=W(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=W(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return U(W(this,4,t,arguments[1]))},getUint32:function(t){return U(W(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return j(W(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return j(W(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){q(this,1,t,F,e)},setUint8:function(t,e){q(this,1,t,F,e)},setInt16:function(t,e){q(this,2,t,B,e,arguments[2])},setUint16:function(t,e){q(this,2,t,B,e,arguments[2])},setInt32:function(t,e){q(this,4,t,z,e,arguments[2])},setUint32:function(t,e){q(this,4,t,z,e,arguments[2])},setFloat32:function(t,e){q(this,4,t,H,e,arguments[2])},setFloat64:function(t,e){q(this,8,t,G,e,arguments[2])}});v(w,y),v(E,b),s(E[_],a.VIEW,!0),e[y]=w,e[b]=E},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.author,n=t.issued,r=t.title,i="";return e&&(i+=e[0].family||e[0].literal),n&&n["date-parts"][0]&&(i+=n["date-parts"][0][0]),r&&(i+=r.match(/^(?:(?:the|a|an)\s+)?(\S+)/i)[1]),i}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=["dropping-particle","given"],r=["suffix"],i=["non-dropping-particle","family"],o=function(e){return e.map(function(e){return t[e]||""}).filter(Boolean).join(" ")};if(t.literal)return t.literal;if(e){var a=o(r)?", "+o(r):"",s=o(n)?", "+o(n):"";return o(i)+a+s}return""+o(n.concat(r,i))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={},i={};e.addTemplate=function(t,e){r[t]=e},e.addLocale=function(t,e){i[t]=e},e.getTemplate=function(t){return r[t]},e.getLocale=function(t){return i[t]},e.hasTemplate=function(t){return r.hasOwnProperty(t)},e.hasLocale=function(t){return i.hasOwnProperty(t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default={url:/^(https?:\/\/)?((([a-z\d]([a-z\d-]*[a-z\d])*)\.)+[a-z]{2,}|((\d{1,3}\.){3}\d{1,3})|localhost)(:\d+)?(\/[-a-z\d%_.~+:]*)*(\?[;&a-z\d%_.~+=-]*)?(#[-a-z\d_]*)?$/i,bibtxt:/^\s*(\[(?!\s*[{[]).*?\]\s*(\n\s*[^[]((?!:)\S)+\s*:\s*.+?\s*)*\s*)+$/,bibtex:/^(?:\s*@\s*[^@]+?\s*\{\s*[^@]+?\s*,\s*[^@]+\})+\s*$/,wikidata:[/^\s*(Q\d+)\s*$/,/^\s*((?:Q\d+(?:\s+|,|))*Q\d+)\s*$/,/^(https?:\/\/(?:www\.)wikidata.org\/w\/api\.php(?:\?.*)?)$/,/\/(Q\d+)(?:[#?/]|\s*$)/],json:[[/((?:\[|:|,)\s*)'((?:\\'|[^'])*?[^\\])?'(?=\s*(?:\]|}|,))/g,'$1"$2"'],[/((?:(?:"|]|}|\/[gmi]|\.|(?:\d|\.|-)*\d)\s*,|{)\s*)(?:"([^":\n]+?)"|'([^":\n]+?)'|([^":\n]+?))(\s*):/g,'$1"$2$3$4"$5:']],doi:[/^\s*(https?:\/\/(?:dx\.)?doi\.org\/(10.\d{4,9}\/[-._;()/:A-Z0-9]+))\s*$/i,/^\s*(10.\d{4,9}\/[-._;()/:A-Z0-9]+)\s*$/i,/^\s*(?:(?:10.\d{4,9}\/[-._;()/:A-Z0-9]+)\s*)+$/i],name:/ ((?:[a-z]+ )*(?:[A-Z][a-z]*[-])*(?:[A-Z][a-z]*)$)/}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(348),o=(r=i)&&r.__esModule?r:{default:r};e.default=function(t){try{return(0,o.default)("GET",t).getBody("utf8")}catch(e){return console.error("[set]","File '"+t+"' could not be fetched:",e.message),"[]"}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(n(100)),i=s(n(99)),o=s(n(138)),a=n(352);function s(t){return t&&t.__esModule?t:{default:t}}e.default=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.maxChainLength,s=void 0===n?10:n,u=e.generateGraph,l=void 0===u||u,c=e.forceType||(0,i.default)(t),h=c.match(/^(array|object)\//)?(0,r.default)(t):t,p=[{type:c,data:t}];"array/csl"!==c;){if(s--<=0)return console.error("[set]","Max. number of parsing iterations reached"),[];h=(0,o.default)(h,c),c=(0,i.default)(h),p.push({type:c})}return h.map(l?function(t){return(0,a.applyGraph)(t,p)}:a.removeGraph)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=u(n(101)),i=u(n(217)),o=u(n(363)),a=u(n(141)),s=u(n(86));function u(t){return t&&t.__esModule?t:{default:t}}var l=function(t,e){var n=Array.isArray(t)?t:"string"==typeof t?t.split("|"):"",o=r.default.getEntities(n,[e],"labels"),a=JSON.parse((0,i.default)(o)).entities||{};return Object.keys(a).map(function(t){return(a[t].labels[e]||{}).value})},c=function(t){return t.P1545?parseInt(t.P1545[0]):-1},h={P31:"type",P50:"author",P57:"director",P86:"composer",P98:"editor",P110:"illustrator",P123:"publisher",P136:"genre",P212:"ISBN",P236:"ISSN",P291:"publisher-place",P304:"page",P348:"version",P356:"DOI",P393:"edition",P433:"issue",P478:"volume",P577:"issued",P655:"translator",P698:"PMID",P932:"PMCID",P953:"URL",P957:"ISBN",P1104:"number-of-pages",P1433:"container-title",P1476:"title",P2093:"author",P2860:!1,P921:!1,P3181:!1,P364:!1};e.default=function(t,e,n){if(h.hasOwnProperty(t)){if(!1!==h[t]){var r=h[t];return e?[r,function(t,e){var r=e[0].value;switch(t){case"P31":var i=(0,o.default)(r);return i||(console.warn("[set]","Wikidata entry type not recognized: "+r+'. Defaulting to "book".'),"book");case"P50":case"P57":case"P86":case"P98":case"P110":case"P655":return e.map(function(t){var e=t.value,r=t.qualifiers,i=(0,s.default)(l(e,n)[0]);return i._ordinal=c(r),i});case"P577":return(0,a.default)(r);case"P123":case"P136":case"P291":case"P1433":return l(r,n)[0];case"P2093":return e.map(function(t){var e=t.value,n=t.qualifiers,r=(0,s.default)(e);return r._ordinal=c(n),r});default:return r}}(t,e)]:r}}else console.info("[set]","Unknown property: "+t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=u(n(142)),i=u(n(138)),o=u(n(221)),a=u(n(376)),s=u(n(378));function u(t){return t&&t.__esModule?t:{default:t}}function l(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var c,h,p=(c=regeneratorRuntime.mark(function t(e,n){var u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=n,t.next="api/wikidata"===t.t0?3:"object/wikidata"===t.t0?4:"api/doi"===t.t0?5:"url/else"===t.t0?6:"array/else"===t.t0?7:15;break;case 3:return t.abrupt("return",(0,o.default)(e));case 4:return t.abrupt("return",(0,a.default)(e));case 5:return t.abrupt("return",(0,s.default)(e));case 6:return t.abrupt("return",(0,o.default)(e));case 7:return t.t1=(u=[]).concat,t.t2=u,t.t3=l,t.next=12,Promise.all(e.map(function(t){return(0,r.default)(t)}));case 12:return t.t4=t.sent,t.t5=(0,t.t3)(t.t4),t.abrupt("return",t.t1.apply.call(t.t1,t.t2,t.t5));case 15:return t.abrupt("return",(0,i.default)(e,n));case 16:case"end":return t.stop()}},t,this)}),h=function(){var t=c.apply(this,arguments);return new Promise(function(e,n){return function r(i,o){try{var a=t[i](o),s=a.value}catch(t){return void n(t)}if(!a.done)return Promise.resolve(s).then(function(t){r("next",t)},function(t){r("throw",t)});e(s)}("next")})},function(t,e){return h.apply(this,arguments)});e.default=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n(375);var r,i,o=(r=regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(e);case 3:return t.abrupt("return",t.sent.text());case 6:return t.prev=6,t.t0=t.catch(0),console.error("[set]","File '"+e+"' could not be fetched:",t.t0.message),t.abrupt("return","[]");case 10:case"end":return t.stop()}},t,this,[[0,6]])}),i=function(){var t=r.apply(this,arguments);return new Promise(function(e,n){return function r(i,o){try{var a=t[i](o),s=a.value}catch(t){return void n(t)}if(!a.done)return Promise.resolve(s).then(function(t){r("next",t)},function(t){r("throw",t)});e(s)}("next")})},function(t){return i.apply(this,arguments)});e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=u(n(946)),i=u(n(947)),o=u(n(948)),a=u(n(949)),s=u(n(950));function u(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function l(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this instanceof l?(this._options=e||{},this.log=[],this.data=[],this.set(t,e),this.options(e),this.save(),this):new l(t,e)}Object.assign(l.prototype,r,i,o,a,s),l.prototype[Symbol.iterator]=regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(this.data,"t0",1);case 1:case"end":return t.stop()}},t,this)}),e.default=l},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";t.exports=n(477)},function(t,e,n){"use strict";var r=n(115),i=n(57),o=n(256),a=(n(257),n(108));n(59),n(478);function s(t,e,n){this.props=t,this.context=e,this.refs=a,this.updater=n||o}function u(t,e,n){this.props=t,this.context=e,this.refs=a,this.updater=n||o}function l(){}s.prototype.isReactComponent={},s.prototype.setState=function(t,e){"object"!=typeof t&&"function"!=typeof t&&null!=t&&r("85"),this.updater.enqueueSetState(this,t),e&&this.updater.enqueueCallback(this,e,"setState")},s.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this),t&&this.updater.enqueueCallback(this,t,"forceUpdate")},l.prototype=s.prototype,u.prototype=new l,u.prototype.constructor=u,i(u.prototype,s.prototype),u.prototype.isPureReactComponent=!0,t.exports={Component:s,PureComponent:u}},function(t,e,n){"use strict";n(116);var r={isMounted:function(t){return!1},enqueueCallback:function(t,e){},enqueueForceUpdate:function(t){},enqueueReplaceState:function(t,e){},enqueueSetState:function(t,e){}};t.exports=r},function(t,e,n){"use strict";var r=!1;t.exports=r},function(t,e,n){"use strict";t.exports={current:null}},function(t,e,n){"use strict";var r="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103;t.exports=r},function(t,e,n){"use strict";var r=n(57),i=n(108),o=n(59),a="mixins";t.exports=function(t,e,n){var s=[],u={mixins:"DEFINE_MANY",statics:"DEFINE_MANY",propTypes:"DEFINE_MANY",contextTypes:"DEFINE_MANY",childContextTypes:"DEFINE_MANY",getDefaultProps:"DEFINE_MANY_MERGED",getInitialState:"DEFINE_MANY_MERGED",getChildContext:"DEFINE_MANY_MERGED",render:"DEFINE_ONCE",componentWillMount:"DEFINE_MANY",componentDidMount:"DEFINE_MANY",componentWillReceiveProps:"DEFINE_MANY",shouldComponentUpdate:"DEFINE_ONCE",componentWillUpdate:"DEFINE_MANY",componentDidUpdate:"DEFINE_MANY",componentWillUnmount:"DEFINE_MANY",updateComponent:"OVERRIDE_BASE"},l={displayName:function(t,e){t.displayName=e},mixins:function(t,e){if(e)for(var n=0;n<e.length;n++)c(t,e[n])},childContextTypes:function(t,e){t.childContextTypes=r({},t.childContextTypes,e)},contextTypes:function(t,e){t.contextTypes=r({},t.contextTypes,e)},getDefaultProps:function(t,e){t.getDefaultProps?t.getDefaultProps=p(t.getDefaultProps,e):t.getDefaultProps=e},propTypes:function(t,e){t.propTypes=r({},t.propTypes,e)},statics:function(t,e){!function(t,e){if(e)for(var n in e){var r=e[n];if(e.hasOwnProperty(n)){var i=n in l;o(!i,'ReactClass: You are attempting to define a reserved property, `%s`, that shouldn\'t be on the "statics" key. Define it as an instance property instead; it will still be accessible on the constructor.',n);var a=n in t;o(!a,"ReactClass: You are attempting to define `%s` on your component more than once. This conflict may be due to a mixin.",n),t[n]=r}}}(t,e)},autobind:function(){}};function c(t,n){if(n){o("function"!=typeof n,"ReactClass: You're attempting to use a component class or function as a mixin. Instead, just use a regular object."),o(!e(n),"ReactClass: You're attempting to use a component as a mixin. Instead, just use a regular object.");var r,i,s,c=t.prototype,h=c.__reactAutoBindPairs;n.hasOwnProperty(a)&&l.mixins(t,n.mixins);for(var d in n)if(n.hasOwnProperty(d)&&d!==a){var m=n[d],v=c.hasOwnProperty(d);if(r=v,i=d,s=u.hasOwnProperty(i)?u[i]:null,g.hasOwnProperty(i)&&o("OVERRIDE_BASE"===s,"ReactClassInterface: You are attempting to override `%s` from your class specification. Ensure that your method names do not overlap with React methods.",i),r&&o("DEFINE_MANY"===s||"DEFINE_MANY_MERGED"===s,"ReactClassInterface: You are attempting to define `%s` on your component more than once. This conflict may be due to a mixin.",i),l.hasOwnProperty(d))l[d](t,m);else{var y=u.hasOwnProperty(d);if("function"!=typeof m||y||v||!1===n.autobind)if(v){var b=u[d];o(y&&("DEFINE_MANY_MERGED"===b||"DEFINE_MANY"===b),"ReactClass: Unexpected spec policy %s for key %s when mixing in component specs.",b,d),"DEFINE_MANY_MERGED"===b?c[d]=p(c[d],m):"DEFINE_MANY"===b&&(c[d]=f(c[d],m))}else c[d]=m;else h.push(d,m),c[d]=m}}}}function h(t,e){o(t&&e&&"object"==typeof t&&"object"==typeof e,"mergeIntoWithNoDuplicateKeys(): Cannot merge non-objects.");for(var n in e)e.hasOwnProperty(n)&&(o(void 0===t[n],"mergeIntoWithNoDuplicateKeys(): Tried to merge two objects with the same key: `%s`. This conflict may be due to a mixin; in particular, this may be caused by two getInitialState() or getDefaultProps() methods returning objects with clashing keys.",n),t[n]=e[n]);return t}function p(t,e){return function(){var n=t.apply(this,arguments),r=e.apply(this,arguments);if(null==n)return r;if(null==r)return n;var i={};return h(i,n),h(i,r),i}}function f(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}var d={componentDidMount:function(){this.__isMounted=!0}},m={componentWillUnmount:function(){this.__isMounted=!1}},g={replaceState:function(t,e){this.updater.enqueueReplaceState(this,t,e)},isMounted:function(){return!!this.__isMounted}},v=function(){};return r(v.prototype,t.prototype,g),function(t){var e=function(t,r,a){this.__reactAutoBindPairs.length&&function(t){for(var e,n=t.__reactAutoBindPairs,r=0;r<n.length;r+=2){var i=n[r],o=n[r+1];t[i]=(e=t,o.bind(e))}}(this),this.props=t,this.context=r,this.refs=i,this.updater=a||n,this.state=null;var s=this.getInitialState?this.getInitialState():null;o("object"==typeof s&&!Array.isArray(s),"%s.getInitialState(): must return an object or null",e.displayName||"ReactCompositeComponent"),this.state=s};e.prototype=new v,e.prototype.constructor=e,e.prototype.__reactAutoBindPairs=[],s.forEach(c.bind(null,e)),c(e,d),c(e,t),c(e,m),e.getDefaultProps&&(e.defaultProps=e.getDefaultProps()),o(e.prototype.render,"createClass(...): Class specification must implement a `render` method.");for(var r in u)e.prototype[r]||(e.prototype[r]=null);return e}}},function(t,e,n){"use strict";var r=n(492),i=n(266),o=n(270),a=n(267);t.exports={Parser:r,ProcessingInstructions:i,IsValidNodeDefinitions:o,ProcessNodeDefinitions:a}},function(t,e){t.exports=Array.isArray||function(t){return null!=t&&t.length>=0&&"[object Array]"===Object.prototype.toString.call(t)}},function(t,e,n){var r=n(60),i=n(174),o=n(507),a=!{toString:null}.propertyIsEnumerable("toString"),s=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],u=function(){"use strict";return arguments.propertyIsEnumerable("length")}(),l=function(t,e){for(var n=0;n<t.length;){if(t[n]===e)return!0;n+=1}return!1},c=r("function"!=typeof Object.keys||u?function(t){if(Object(t)!==t)return[];var e,n,r=[],c=u&&o(t);for(e in t)!i(e,t)||c&&"length"===e||(r[r.length]=e);if(a)for(n=s.length-1;n>=0;)i(e=s[n],t)&&!l(r,e)&&(r[r.length]=e),n-=1;return r}:function(t){return Object(t)!==t?[]:Object.keys(t)});t.exports=c},function(t,e,n){var r=n(173),i=n(60),o=n(37),a=n(510),s=o(function(t,e){return 1===t?i(e):r(t,a(t,[],e))});t.exports=s},function(t,e){var n=t.exports={get firstChild(){var t=this.children;return t&&t[0]||null},get lastChild(){var t=this.children;return t&&t[t.length-1]||null},get nodeType(){return i[this.type]||i.element}},r={tagName:"name",childNodes:"children",parentNode:"parent",previousSibling:"prev",nextSibling:"next",nodeValue:"data"},i={element:1,text:3,cdata:4,comment:8};Object.keys(r).forEach(function(t){var e=r[t];Object.defineProperty(n,t,{get:function(){return this[e]||null},set:function(t){return this[e]=t,t}})})},function(t,e,n){"use strict";var r=n(526),i=n(267);t.exports=function(){var t=new i;return{defaultProcessingInstructions:[{shouldProcessNode:r.shouldProcessEveryNode,processNode:t.processDefaultNode}]}}},function(t,e,n){"use strict";var r=n(268),i=["area","base","br","col","embed","hr","img","input","keygen","link","meta","param","source","track","wbr","menuitem","textarea"];t.exports=function(){return{processDefaultNode:function(t,e,n){return"text"===t.type?t.data:"comment"!==t.type&&(i.indexOf(t.name)>-1?r.createElement(t,n):r.createElement(t,n,t.data,e))}}}},function(t,e,n){"use strict";var r=n(527),i=n(537),o=n(538),a=n(1),s=n(540);t.exports={createElement:function(t,e,n,u){var l={key:e};t.attribs&&(l=o(function(t,e){var n=e[0],i=e[1];return"style"===(n=s[n.replace(/[-:]/,"")]||n)?i=function(t){for(var e,n,i,o=(t=t||"").split(/;(?!base64)/),a={},s=0;s<o.length;++s)(e=o[s].split(":")).length>2&&(e[1]=e.slice(1).join(":")),n=e[0],"string"==typeof(i=e[1])&&(i=i.trim()),null!=n&&null!=i&&n.length>0&&i.length>0&&(a[r(n)]=i);return a}(i):"class"===n?n="className":"for"===n&&(n="htmlFor"),"string"==typeof i&&(i=i),t[n]=i||n,t},l,i(t.attribs))),u=u||[];var c=null!=n?[n].concat(u):u;return a.createElement.apply(null,[t.name,l].concat(c))}}},function(t,e){t.exports=function(t,e){for(var n=0;n<t.length;n++)e(n,t[n])}},function(t,e,n){"use strict";t.exports={alwaysValid:function(){return!0}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=a(n(250)),o=a(n(545));function a(t){return t&&t.__esModule?t:{default:t}}function s(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var u=function(t,e,n){return i.default.ucs2.encode(t.slice(e,n))};function l(t,e){return e.forEach(function(e){t.push(e.offset),t.push(e.offset+e.length)}),t}var c=function(){function t(e){var n=e.flat,r=void 0!==n&&n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.flat=r}return r(t,[{key:"relevantStyles",value:function(t){return this.ranges.filter(function(e){return t>=e.offset&&t<e.offset+e.length}).map(function(t){return t.style})}},{key:"nodeIterator",value:function(t,e,n){var r=this,i=this.relevantIndexes.slice(this.relevantIndexes.indexOf(e),this.relevantIndexes.indexOf(n));return i.forEach(function(e,o){var a=r.relevantStyles(e),s=i[o+1]?i[o+1]-e:1,l=u(r.textArray,e,e+s);t.pushContent(l,a,r.flat),!i[o+1]&&e<n&&t.pushContent(u(r.textArray,e+1,n),r.relevantStyles(n-1),r.flat)}),t}},{key:"parse",value:function(t){var e=this,n=t.text,r=t.inlineStyleRanges,a=t.entityRanges,c=t.decoratorRanges,h=void 0===c?[]:c;this.textArray=i.default.ucs2.decode(n),this.ranges=r,this.iterator=0,this.relevantIndexes=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=[];return(i=l(i=l(i=l(i,e),n),r)).push(0),i.push(t.length),i.filter(function(t,e,n){return n.indexOf(t)===e}).sort(function(t,e){return t-e})}(n,r,a,h);var p=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments[2],r=arguments[3],i=0,a=[].concat(s(t),s(e)).sort(function(t,e){return t.offset-e.offset}),l=[];return a.length<1?(l.push(new o.default({block:r,start:0,end:n.length})),l):(a.forEach(function(t){t.offset>i&&l.push(new o.default({block:r,start:i,end:t.offset})),l.push(new o.default({block:r,entity:t.key,decorator:t.component,decoratorProps:t.decoratorProps,decoratedText:t.component?u(n,t.offset,t.offset+t.length):void 0,start:t.offset,end:t.offset+t.length,contentState:t.contentState})),i=t.offset+t.length}),i<n.length&&l.push(new o.default({block:r,start:i,end:n.length})),l)}(a,h,this.textArray,t).map(function(t){return e.nodeIterator(t,t.start,t.end)});return new o.default({block:t,content:p})}}]),t}();e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={draftEntitiesNames:{LINK:"LINK",BLOCK_ASSET:"BLOCK_ASSET",INLINE_ASSET:"INLINE_ASSET",NOTE_POINTER:"NOTE_POINTER"}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=p(n(560)),i=p(n(573)),o=p(n(621)),a=p(n(648)),s=p(n(651)),u=p(n(654)),l=p(n(684)),c=p(n(696)),h=p(n(50));function p(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}e.default={image:r,imagesgallery:i,webpage:o,video:a,audio:s,table:u,mobiliscene:l,bib:c,utils:h}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={id:"image",accepts:["image"],assetPickingRules:{image:{web:["rgb_image_asset_id","cmyb_image_asset_id"],micro:["rgb_image_asset_id","bw_image_asset_id"],"epub-fixed":["rgb_image_asset_id","bw_image_asset_id"],pdf:["cmyb_image_asset_id","rgb_image_asset_id","bw_image_asset_id"],"epub-reflowable":["bw_image_asset_id","rgb_image_asset_id"]}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return[].slice.call(t.querySelectorAll("*"),0).filter(a)};var r=/input|select|textarea|button|object/;function i(t){var e=t.offsetWidth<=0&&t.offsetHeight<=0;if(e&&!t.innerHTML)return!0;var n=window.getComputedStyle(t);return e?"visible"!==n.getPropertyValue("overflow"):"none"==n.getPropertyValue("display")}function o(t,e){var n=t.nodeName.toLowerCase();return(r.test(n)&&!t.disabled||("a"===n?t.href||e:e))&&function(t){for(var e=t;e&&e!==document.body;){if(i(e))return!1;e=e.parentNode}return!0}(t)}function a(t){var e=t.getAttribute("tabindex");null===e&&(e=void 0);var n=isNaN(e);return(n||e>=0)&&o(t,!n)}t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.assertNodeList=s,e.setElement=function(t){var e=t;if("string"==typeof e){var n=document.querySelectorAll(e);s(n,e),e="length"in n?n[0]:n}return a=e||a},e.validateElement=u,e.hide=function(t){u(t)&&(t||a).setAttribute("aria-hidden","true")},e.show=function(t){u(t)&&(t||a).removeAttribute("aria-hidden")},e.documentNotReadyOrSSRTesting=function(){a=null},e.resetForTesting=function(){a=null};var r,i=n(277),o=(r=i)&&r.__esModule?r:{default:r};var a=null;function s(t,e){if(!t||!t.length)throw new Error("react-modal: No elements were found for selector "+e+".")}function u(t){return!(!t&&!a)||((0,o.default)(!1,["react-modal: App element is not defined.","Please use `Modal.setAppElement(el)` or set `appElement={el}`.","This is needed so screen readers don't see main content","when modal is opened. It is not recommended, but you can opt-out","by setting `ariaHideApp={false}`."].join(" ")),!1)}},function(t,e,n){"use strict";var r=function(){};t.exports=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.get=function(){return r},e.add=function(t){r[t]||(r[t]=0);return r[t]+=1,t},e.remove=function(t){r[t]&&(r[t]-=1);return t},e.totalCount=function(){return Object.keys(r).reduce(function(t,e){return t+r[e]},0)};var r={}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.canUseDOM=void 0;var r,i=n(569);var o=((r=i)&&r.__esModule?r:{default:r}).default,a=o.canUseDOM?window.HTMLElement:{};e.canUseDOM=o.canUseDOM;e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={id:"imagesgallery",accepts:["imagesgallery"],assetPickingRules:{image:{web:["rgb_image_asset_id","cmyb_image_asset_id"],micro:["rgb_image_asset_id","bw_image_asset_id"],"epub-fixed":["rgb_image_asset_id","bw_image_asset_id"],pdf:["cmyb_image_asset_id","rgb_image_asset_id","bw_image_asset_id"],"epub-reflowable":["bw_image_asset_id","rgb_image_asset_id"]}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=n(178),o=n(282),a={create:function(t){return(0,i.mapObj)(t,function(t){var e=r(t,2),n=e[0],o=e[1];return[n,{_name:n+"_"+(0,i.hashObject)(o),_definition:o}]})},rehydrate:function(){var t=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];(0,o.addRenderedClassNames)(t)}},s={renderStatic:function(t){return(0,o.reset)(),(0,o.startBuffering)(),{html:t(),css:{content:(0,o.flushToString)(),renderedClassNames:(0,o.getRenderedClassNames)()}}}},u={suppressStyleInjection:function(){(0,o.reset)(),(0,o.startBuffering)()},clearBufferAndResumeStyleInjection:function(){(0,o.reset)()}};e.default={StyleSheet:a,StyleSheetServer:s,StyleSheetTestUtils:u,css:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return(0,o.injectAndGetClassName)(!0,e)}},t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(577),o=(r=i)&&r.__esModule?r:{default:r},a=n(579),s=n(178),u=null,l={fontFamily:function t(e){return Array.isArray(e)?e.map(t).join(","):"object"==typeof e?(d(e.fontFamily,"@font-face",[e],!1),'"'+e.fontFamily+'"'):e},animationName:function(t){if("object"!=typeof t)return t;var e="keyframe_"+(0,s.hashObject)(t),n="@keyframes "+e+"{";return Object.keys(t).forEach(function(e){n+=(0,a.generateCSS)(e,[t[e]],l,!1)}),f(e,n+="}"),e}},c={},h="",p=!1,f=function(t,e){if(!c[t]){if(!p){if("undefined"==typeof document)throw new Error("Cannot automatically buffer without a document");p=!0,(0,o.default)(g)}h+=e,c[t]=!0}},d=function(t,e,n,r){if(!c[t]){var i=(0,a.generateCSS)(e,n,l,r);f(t,i)}};e.injectStyleOnce=d;e.reset=function(){h="",c={},p=!1,u=null};e.startBuffering=function(){if(p)throw new Error("Cannot buffer while already buffering");p=!0};var m=function(){p=!1;var t=h;return h="",t};e.flushToString=m;var g=function(){var t=m();t.length>0&&function(t){if(null==u&&null==(u=document.querySelector("style[data-aphrodite]"))){var e=document.head||document.getElementsByTagName("head")[0];(u=document.createElement("style")).type="text/css",u.setAttribute("data-aphrodite",""),e.appendChild(u)}u.styleSheet?u.styleSheet.cssText+=t:u.appendChild(document.createTextNode(t))}(t)};e.flushToStyleTag=g;e.getRenderedClassNames=function(){return Object.keys(c)};e.addRenderedClassNames=function(t){t.forEach(function(t){c[t]=!0})};e.injectAndGetClassName=function(t,e){var n=e.filter(function(t){return t});if(0===n.length)return"";var r=n.map(function(t){return t._name}).join("-o_O-");return d(r,"."+r,n.map(function(t){return t._definition}),t),r}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={Webkit:{transform:!0,transformOrigin:!0,transformOriginX:!0,transformOriginY:!0,backfaceVisibility:!0,perspective:!0,perspectiveOrigin:!0,transformStyle:!0,transformOriginZ:!0,animation:!0,animationDelay:!0,animationDirection:!0,animationFillMode:!0,animationDuration:!0,animationIterationCount:!0,animationName:!0,animationPlayState:!0,animationTimingFunction:!0,appearance:!0,userSelect:!0,fontKerning:!0,textEmphasisPosition:!0,textEmphasis:!0,textEmphasisStyle:!0,textEmphasisColor:!0,boxDecorationBreak:!0,clipPath:!0,maskImage:!0,maskMode:!0,maskRepeat:!0,maskPosition:!0,maskClip:!0,maskOrigin:!0,maskSize:!0,maskComposite:!0,mask:!0,maskBorderSource:!0,maskBorderMode:!0,maskBorderSlice:!0,maskBorderWidth:!0,maskBorderOutset:!0,maskBorderRepeat:!0,maskBorder:!0,maskType:!0,textDecorationStyle:!0,textDecorationSkip:!0,textDecorationLine:!0,textDecorationColor:!0,filter:!0,fontFeatureSettings:!0,breakAfter:!0,breakBefore:!0,breakInside:!0,columnCount:!0,columnFill:!0,columnGap:!0,columnRule:!0,columnRuleColor:!0,columnRuleStyle:!0,columnRuleWidth:!0,columns:!0,columnSpan:!0,columnWidth:!0,flex:!0,flexBasis:!0,flexDirection:!0,flexGrow:!0,flexFlow:!0,flexShrink:!0,flexWrap:!0,alignContent:!0,alignItems:!0,alignSelf:!0,justifyContent:!0,order:!0,transition:!0,transitionDelay:!0,transitionDuration:!0,transitionProperty:!0,transitionTimingFunction:!0,backdropFilter:!0,scrollSnapType:!0,scrollSnapPointsX:!0,scrollSnapPointsY:!0,scrollSnapDestination:!0,scrollSnapCoordinate:!0,shapeImageThreshold:!0,shapeImageMargin:!0,shapeImageOutside:!0,hyphens:!0,flowInto:!0,flowFrom:!0,regionFragment:!0,textSizeAdjust:!0},Moz:{appearance:!0,userSelect:!0,boxSizing:!0,textAlignLast:!0,textDecorationStyle:!0,textDecorationSkip:!0,textDecorationLine:!0,textDecorationColor:!0,tabSize:!0,hyphens:!0,fontFeatureSettings:!0,breakAfter:!0,breakBefore:!0,breakInside:!0,columnCount:!0,columnFill:!0,columnGap:!0,columnRule:!0,columnRuleColor:!0,columnRuleStyle:!0,columnRuleWidth:!0,columns:!0,columnSpan:!0,columnWidth:!0},ms:{flex:!0,flexBasis:!1,flexDirection:!0,flexGrow:!1,flexFlow:!0,flexShrink:!1,flexWrap:!0,alignContent:!1,alignItems:!1,alignSelf:!1,justifyContent:!1,order:!1,transform:!0,transformOrigin:!0,transformOriginX:!0,transformOriginY:!0,userSelect:!0,wrapFlow:!0,wrapThrough:!0,wrapMargin:!0,scrollSnapType:!0,scrollSnapPointsX:!0,scrollSnapPointsY:!0,scrollSnapDestination:!0,scrollSnapCoordinate:!0,touchAction:!0,hyphens:!0,flowInto:!0,flowFrom:!0,breakBefore:!0,breakAfter:!0,breakInside:!0,regionFragment:!0,gridTemplateColumns:!0,gridTemplateRows:!0,gridTemplateAreas:!0,gridTemplate:!0,gridAutoColumns:!0,gridAutoRows:!0,gridAutoFlow:!0,grid:!0,gridRowStart:!0,gridColumnStart:!0,gridRowEnd:!0,gridRow:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnGap:!0,gridRowGap:!0,gridArea:!0,gridGap:!0,textSizeAdjust:!0}},t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=c(n(2)),o=c(n(1)),a=n(80),s=c(n(61)),u=c(n(81)),l=c(n(286));function c(t){return t&&t.__esModule?t:{default:t}}function h(t,e){var n=e.theme,i=t.direction,c=t.icon,h=t.onClick,f=t.size,d=function(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}(t,["direction","icon","onClick","size"]),m=a.StyleSheet.create((0,u.default)(p,n));return o.default.createElement("button",r({type:"button",className:(0,a.css)(m.arrow,m["arrow__direction__"+i],f&&m["arrow__size__"+f]),onClick:h,onTouchEnd:h},d),o.default.createElement(l.default,{fill:!!n.arrow&&n.arrow.fill||s.default.arrow.fill,type:c}))}h.propTypes={direction:i.default.oneOf(["left","right"]),icon:i.default.string,onClick:i.default.func.isRequired,size:i.default.oneOf(["medium","small"]).isRequired},h.defaultProps={size:"medium"},h.contextTypes={theme:i.default.object.isRequired};var p={arrow:{background:"none",border:"none",borderRadius:4,cursor:"pointer",outline:"none",padding:10,position:"absolute",top:"50%",WebkitTouchCallout:"none",userSelect:"none"},arrow__size__medium:{height:s.default.arrow.height,marginTop:s.default.arrow.height/-2,width:40,"@media (min-width: 768px)":{width:70}},arrow__size__small:{height:s.default.thumbnail.size,marginTop:s.default.thumbnail.size/-2,width:30,"@media (min-width: 500px)":{width:40}},arrow__direction__right:{right:s.default.container.gutter.horizontal},arrow__direction__left:{left:s.default.container.gutter.horizontal}};e.default=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=l(n(2)),o=l(n(1)),a=l(n(598)),s=l(n(599)),u=l(n(600));function l(t){return t&&t.__esModule?t:{default:t}}var c={arrowLeft:a.default,arrowRight:s.default,close:u.default},h=function(t){var e=t.fill,n=t.type,i=function(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}(t,["fill","type"]),a=c[n];return o.default.createElement("span",r({dangerouslySetInnerHTML:{__html:a(e)}},i))};h.propTypes={fill:i.default.string,type:i.default.oneOf(Object.keys(c))},h.defaultProps={fill:"white"},e.default=h},function(t,e,n){"use strict";e.__esModule=!0;var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=u(n(609)),o=u(n(1)),a=u(n(2)),s=(u(n(277)),n(610));function u(t){return t&&t.__esModule?t:{default:t}}a.default.any,a.default.func,a.default.node;var l=function(t){function e(n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,n,i));return o.performAppear=function(t,e){o.currentlyTransitioningKeys[t]=!0,e.componentWillAppear?e.componentWillAppear(o._handleDoneAppearing.bind(o,t,e)):o._handleDoneAppearing(t,e)},o._handleDoneAppearing=function(t,e){e.componentDidAppear&&e.componentDidAppear(),delete o.currentlyTransitioningKeys[t];var n=(0,s.getChildMapping)(o.props.children);n&&n.hasOwnProperty(t)||o.performLeave(t,e)},o.performEnter=function(t,e){o.currentlyTransitioningKeys[t]=!0,e.componentWillEnter?e.componentWillEnter(o._handleDoneEntering.bind(o,t,e)):o._handleDoneEntering(t,e)},o._handleDoneEntering=function(t,e){e.componentDidEnter&&e.componentDidEnter(),delete o.currentlyTransitioningKeys[t];var n=(0,s.getChildMapping)(o.props.children);n&&n.hasOwnProperty(t)||o.performLeave(t,e)},o.performLeave=function(t,e){o.currentlyTransitioningKeys[t]=!0,e.componentWillLeave?e.componentWillLeave(o._handleDoneLeaving.bind(o,t,e)):o._handleDoneLeaving(t,e)},o._handleDoneLeaving=function(t,e){e.componentDidLeave&&e.componentDidLeave(),delete o.currentlyTransitioningKeys[t];var n=(0,s.getChildMapping)(o.props.children);n&&n.hasOwnProperty(t)?o.keysToEnter.push(t):o.setState(function(e){var n=r({},e.children);return delete n[t],{children:n}})},o.childRefs=Object.create(null),o.state={children:(0,s.getChildMapping)(n.children)},o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.componentWillMount=function(){this.currentlyTransitioningKeys={},this.keysToEnter=[],this.keysToLeave=[]},e.prototype.componentDidMount=function(){var t=this.state.children;for(var e in t)t[e]&&this.performAppear(e,this.childRefs[e])},e.prototype.componentWillReceiveProps=function(t){var e=(0,s.getChildMapping)(t.children),n=this.state.children;this.setState({children:(0,s.mergeChildMappings)(n,e)});for(var r in e){var i=n&&n.hasOwnProperty(r);!e[r]||i||this.currentlyTransitioningKeys[r]||this.keysToEnter.push(r)}for(var o in n){var a=e&&e.hasOwnProperty(o);!n[o]||a||this.currentlyTransitioningKeys[o]||this.keysToLeave.push(o)}},e.prototype.componentDidUpdate=function(){var t=this,e=this.keysToEnter;this.keysToEnter=[],e.forEach(function(e){return t.performEnter(e,t.childRefs[e])});var n=this.keysToLeave;this.keysToLeave=[],n.forEach(function(e){return t.performLeave(e,t.childRefs[e])})},e.prototype.render=function(){var t=this,e=[],n=function(n){var r=t.state.children[n];if(r){var a="string"!=typeof r.ref,s=t.props.childFactory(r),u=function(e){t.childRefs[n]=e};s===r&&a&&(u=(0,i.default)(r.ref,u)),e.push(o.default.cloneElement(s,{key:n,ref:u}))}};for(var a in this.state.children)n(a);var s=r({},this.props);return delete s.transitionLeave,delete s.transitionName,delete s.transitionAppear,delete s.transitionEnter,delete s.childFactory,delete s.transitionLeaveTimeout,delete s.transitionEnterTimeout,delete s.transitionAppearTimeout,delete s.component,o.default.createElement(this.props.component,s,e)},e}(o.default.Component);l.displayName="TransitionGroup",l.propTypes={},l.defaultProps={component:"span",childFactory:function(t){return t}},e.default=l,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=!("undefined"==typeof window||!window.document||!window.document.createElement),t.exports=e.default},function(t,e,n){"use strict";e.__esModule=!0,e.nameShape=void 0,e.transitionTimeout=function(t){var e="transition"+t+"Timeout",n="transition"+t;return function(t){if(t[n]){if(null==t[e])return new Error(e+" wasn't supplied to CSSTransitionGroup: this can cause unreliable animations and won't be supported in a future version of React. See https://fb.me/react-animation-transition-group-timeout for more information.");if("number"!=typeof t[e])return new Error(e+" must be a number (in milliseconds)")}return null}};i(n(1));var r=i(n(2));function i(t){return t&&t.__esModule?t:{default:t}}e.nameShape=r.default.oneOfType([r.default.string,r.default.shape({enter:r.default.string,leave:r.default.string,active:r.default.string}),r.default.shape({enter:r.default.string,enterActive:r.default.string,leave:r.default.string,leaveActive:r.default.string,appear:r.default.string,appearActive:r.default.string})])},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={id:"webpage",accepts:["webpage"],assetPickingRules:{element:{web:["url","backup_asset_id","screencast_video_asset_id","rgb_image_asset_id","bw_image_asset_id"],micro:["rgb_image_asset_id","bw_image_asset_id"],"epub-reflowable":["rgb_image_asset_id","bw_image_asset_id"],pdf:["cmyb_image_asset_id","rgb_image_asset_id","bw_image_asset_id"],"epub-fixed":["screencast_video_asset_id","bw_image_asset_id","rgb_image_asset_id"]}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(1),a=(u(o),u(n(2)),n(49)),s=u(n(120));function u(t){return t&&t.__esModule?t:{default:t}}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var c=function(t){function e(){var t,n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=r=l(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(o))),r._isLoading=function(){r.props.isLoading(!0)},r._isNotLoading=function(){r.props.isLoading(!1)},r._handleCanPlay=function(){r.props.onReady()},r._handlePlay=function(){r.props.onPlay(!0),r._isNotLoading()},r._handlePause=function(){r.props.onPause(!1)},r._handleEnded=function(){r.props.onEnded(!1)},r._handleError=function(t){r.props.onError(t),r._isNotLoading()},r._handleProgress=function(t){var e=t.target,n=e.buffered,i=e.duration,o=0;i>0&&n.length&&(o=n.end(n.length-1)/i),r.props.onProgress(o)},r._handleDuration=function(t){var e=t.target.duration;r.props.onDuration(e)},r._handleTimeUpdate=function(t){var e=t.target.currentTime;r.props.onTimeUpdate(e)},r._handleVolumeChange=function(t){var e=t.target,n=e.volume,i=e.muted;r.props.onMute(i),r.props.onVolumeChange(n)},l(r,n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Component),i(e,[{key:"play",value:function(){return this._player.play()}},{key:"pause",value:function(){this._player.pause()}},{key:"stop",value:function(){this._player.pause(0),this._player.currentTime=0}},{key:"seekTo",value:function(t){this._player.readyState>0&&(this._player.currentTime=t)}},{key:"mute",value:function(t){this._player.muted=t}},{key:"setVolume",value:function(t){this._player.volume=t}},{key:"render",value:function(){var t=this,e=this.props,n=e.vendor,i=e.src,a=e.extraProps;return(0,o.createElement)(n,r({ref:function(e){return t._player=e},src:i},a,this._playerEvents))}},{key:"instance",get:function(){return this._player}},{key:"node",get:function(){return(0,a.findDOMNode)(this._player)}},{key:"_playerEvents",get:function(){return{onCanPlay:this._handleCanPlay,onPlay:this._handlePlay,onPlaying:this._isNotLoading,onPause:this._handlePause,onEnded:this._handleEnded,onWaiting:this._isLoading,onError:this._handleError,onProgress:this._handleProgress,onLoadedMetadata:this._handleDuration,onTimeUpdate:this._handleTimeUpdate,onVolumeChange:this._handleVolumeChange}}}]),e}();c.propTypes=s.default,e.default=c,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={id:"video",accepts:["video"],assetPickingRules:{element:{web:["hd_video_asset_id","sd_video_asset_id"],micro:["rgb_image_asset_id","bw_image_asset_id"],"epub-fixed":["sd_video_asset_id","rgb_image_asset_id","bw_image_asset_id"],pdf:["cmyb_image_asset_id","rgb_image_asset_id","bw_image_asset_id"],"epub-reflowable":["bw_image_asset_id","rgb_image_asset_id"]}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={id:"audio",accepts:["audio"],assetPickingRules:{track:{web:["audio_track_asset_id"],micro:[],"epub-fixed":["audio_track_asset_id"],pdf:[],"epub-reflowable":[]}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={id:"table",accepts:["table"],assetPickingRules:{data:{web:["data_asset_id"],micro:["data_asset_id"],"epub-fixed":["data_asset_id"],pdf:["data_asset_id"],"epub-reflowable":["data_asset_id"]}}}},function(t,e,n){"use strict";t.exports=function(t,e){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return t.apply(e,n)}}},function(t,e,n){"use strict";var r=n(26),i=n(667),o=n(669),a=n(670),s=n(671),u=n(297),l="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||n(672);t.exports=function(t){return new Promise(function(e,c){var h=t.data,p=t.headers;r.isFormData(h)&&delete p["Content-Type"];var f=new XMLHttpRequest,d="onreadystatechange",m=!1;if("undefined"==typeof window||!window.XDomainRequest||"withCredentials"in f||s(t.url)||(f=new window.XDomainRequest,d="onload",m=!0,f.onprogress=function(){},f.ontimeout=function(){}),t.auth){var g=t.auth.username||"",v=t.auth.password||"";p.Authorization="Basic "+l(g+":"+v)}if(f.open(t.method.toUpperCase(),o(t.url,t.params,t.paramsSerializer),!0),f.timeout=t.timeout,f[d]=function(){if(f&&(4===f.readyState||m)&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in f?a(f.getAllResponseHeaders()):null,r={data:t.responseType&&"text"!==t.responseType?f.response:f.responseText,status:1223===f.status?204:f.status,statusText:1223===f.status?"No Content":f.statusText,headers:n,config:t,request:f};i(e,c,r),f=null}},f.onerror=function(){c(u("Network Error",t,null,f)),f=null},f.ontimeout=function(){c(u("timeout of "+t.timeout+"ms exceeded",t,"ECONNABORTED",f)),f=null},r.isStandardBrowserEnv()){var y=n(673),b=(t.withCredentials||s(t.url))&&t.xsrfCookieName?y.read(t.xsrfCookieName):void 0;b&&(p[t.xsrfHeaderName]=b)}if("setRequestHeader"in f&&r.forEach(p,function(t,e){void 0===h&&"content-type"===e.toLowerCase()?delete p[e]:f.setRequestHeader(e,t)}),t.withCredentials&&(f.withCredentials=!0),t.responseType)try{f.responseType=t.responseType}catch(e){if("json"!==t.responseType)throw e}"function"==typeof t.onDownloadProgress&&f.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then(function(t){f&&(f.abort(),c(t),f=null)}),void 0===h&&(h=null),f.send(h)})}},function(t,e,n){"use strict";var r=n(668);t.exports=function(t,e,n,i,o){var a=new Error(t);return r(a,e,n,i,o)}},function(t,e,n){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},function(t,e,n){"use strict";function r(t){this.message=t}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,t.exports=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.computeColumns=e.formatData=void 0;var r=n(681);e.formatData=function(t,e){switch(e.split(".").pop()){case"csv":return(0,r.csvParse)(t);case"tsv":return(0,r.tsvParse)(t);case"json":default:return t}},e.computeColumns=function(t){var e={};return t.forEach(function(t){Object.keys(t).forEach(function(t){e[t]="bla"})}),Object.keys(e).map(function(t){return{Header:t,accessor:t}})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={id:"mobiliscene",accepts:["mobiliscene"],assetPickingRules:{element:{web:["content_asset_id","screencast_video_asset_id","rgb_image_asset_id","bw_image_asset_id"],"epub-fixed":["screencast_video_asset_id","rgb_image_asset_id","bw_image_asset_id"],pdf:["cmyb_image_asset_id","rgb_image_asset_id","bw_image_asset_id"],"epub-reflowable":["bw_image_asset_id","rgb_image_asset_id"],micro:["rgb_image_asset_id","bw_image_asset_id"]}}}},function(t,e,n){"use strict";(function(t){function r(){return"undefined"!=typeof window}function i(t){const e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let e=0;e<t.length;++e)n[e]=t[e];return e}function o(e){const n=new t(e.byteLength),r=new Uint8Array(e);for(let t=0;t<n.length;++t)n[t]=r[t];return n}function a(t,e){if(!t)throw e}n.d(e,"c",function(){return r}),n.d(e,"d",function(){return i}),n.d(e,"a",function(){return o}),n.d(e,"b",function(){return a})}).call(e,n(689).Buffer)},,function(t,e,n){t.exports=!n(11)&&!n(5)(function(){return 7!=Object.defineProperty(n(187)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){e.f=n(7)},function(t,e,n){var r=n(22),i=n(27),o=n(123)(!1),a=n(189)("IE_PROTO");t.exports=function(t,e){var n,s=i(t),u=0,l=[];for(n in s)n!=a&&r(s,n)&&l.push(n);for(;e.length>u;)r(s,n=e[u++])&&(~o(l,n)||l.push(n));return l}},function(t,e,n){var r=n(12),i=n(3),o=n(65);t.exports=n(11)?Object.defineProperties:function(t,e){i(t);for(var n,a=o(e),s=a.length,u=0;s>u;)r.f(t,n=a[u++],e[n]);return t}},function(t,e,n){var r=n(27),i=n(68).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return a&&"[object Window]"==o.call(t)?function(t){try{return i(t)}catch(t){return a.slice()}}(t):i(r(t))}},function(t,e,n){"use strict";var r=n(65),i=n(124),o=n(97),a=n(14),s=n(96),u=Object.assign;t.exports=!u||n(5)(function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach(function(t){e[t]=t}),7!=u({},t)[n]||Object.keys(u({},e)).join("")!=r})?function(t,e){for(var n=a(t),u=arguments.length,l=1,c=i.f,h=o.f;u>l;)for(var p,f=s(arguments[l++]),d=c?r(f).concat(c(f)):r(f),m=d.length,g=0;m>g;)h.call(f,p=d[g++])&&(n[p]=f[p]);return n}:u},function(t,e,n){"use strict";var r=n(17),i=n(6),o=n(311),a=[].slice,s={};t.exports=Function.bind||function(t){var e=r(this),n=a.call(arguments,1),u=function(){var r=n.concat(a.call(arguments));return this instanceof u?function(t,e,n){if(!(e in s)){for(var r=[],i=0;i<e;i++)r[i]="a["+i+"]";s[e]=Function("F,a","return new F("+r.join(",")+")")}return s[e](t,n)}(e,r.length,r):o(e,r,t)};return i(e.prototype)&&(u.prototype=e.prototype),u}},function(t,e){t.exports=function(t,e,n){var r=void 0===n;switch(e.length){case 0:return r?t():t.call(n);case 1:return r?t(e[0]):t.call(n,e[0]);case 2:return r?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){var r=n(4).parseInt,i=n(83).trim,o=n(193),a=/^[-+]?0[xX]/;t.exports=8!==r(o+"08")||22!==r(o+"0x16")?function(t,e){var n=i(String(t),3);return r(n,e>>>0||(a.test(n)?16:10))}:r},function(t,e,n){var r=n(4).parseFloat,i=n(83).trim;t.exports=1/r(n(193)+"-0")!=-1/0?function(t){var e=i(String(t),3),n=r(e);return 0===n&&"-"==e.charAt(0)?-0:n}:r},function(t,e,n){var r=n(32);t.exports=function(t,e){if("number"!=typeof t&&"Number"!=r(t))throw TypeError(e);return+t}},function(t,e,n){var r=n(6),i=Math.floor;t.exports=function(t){return!r(t)&&isFinite(t)&&i(t)===t}},function(t,e){t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},function(t,e,n){var r=n(196),i=Math.pow,o=i(2,-52),a=i(2,-23),s=i(2,127)*(2-a),u=i(2,-126);t.exports=Math.fround||function(t){var e,n,i=Math.abs(t),l=r(t);return i<u?l*(i/u/a+1/o-1/o)*u*a:(n=(e=(1+a/o)*i)-(e-i))>s||n!=n?l*(1/0):l*n}},function(t,e,n){var r=n(3);t.exports=function(t,e,n,i){try{return i?e(r(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&r(o.call(t)),e}}},function(t,e,n){var r=n(17),i=n(14),o=n(96),a=n(13);t.exports=function(t,e,n,s,u){r(e);var l=i(t),c=o(l),h=a(l.length),p=u?h-1:0,f=u?-1:1;if(n<2)for(;;){if(p in c){s=c[p],p+=f;break}if(p+=f,u?p<0:h<=p)throw TypeError("Reduce of empty array with no initial value")}for(;u?p>=0:h>p;p+=f)p in c&&(s=e(s,c[p],p,l));return s}},function(t,e,n){"use strict";var r=n(14),i=n(66),o=n(13);t.exports=[].copyWithin||function(t,e){var n=r(this),a=o(n.length),s=i(t,a),u=i(e,a),l=arguments.length>2?arguments[2]:void 0,c=Math.min((void 0===l?a:i(l,a))-u,a-s),h=1;for(u<s&&s<u+c&&(h=-1,u+=c-1,s+=c-1);c-- >0;)u in n?n[s]=n[u]:delete n[s],s+=h,u+=h;return n}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){n(11)&&"g"!=/./g.flags&&n(12).f(RegExp.prototype,"flags",{configurable:!0,get:n(128)})},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,n){var r=n(3),i=n(6),o=n(211);t.exports=function(t,e){if(r(t),i(e)&&e.constructor===t)return e;var n=o.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){"use strict";var r=n(326),i=n(85);t.exports=n(131)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=r.getEntry(i(this,"Map"),t);return e&&e.v},set:function(t,e){return r.def(i(this,"Map"),0===t?0:t,e)}},r,!0)},function(t,e,n){"use strict";var r=n(12).f,i=n(67),o=n(72),a=n(31),s=n(70),u=n(71),l=n(199),c=n(321),h=n(69),p=n(11),f=n(51).fastKey,d=n(85),m=p?"_s":"size",g=function(t,e){var n,r=f(e);if("F"!==r)return t._i[r];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,l){var c=t(function(t,r){s(t,c,e,"_i"),t._t=e,t._i=i(null),t._f=void 0,t._l=void 0,t[m]=0,void 0!=r&&u(r,n,t[l],t)});return o(c.prototype,{clear:function(){for(var t=d(this,e),n=t._i,r=t._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];t._f=t._l=void 0,t[m]=0},delete:function(t){var n=d(this,e),r=g(n,t);if(r){var i=r.n,o=r.p;delete n._i[r.i],r.r=!0,o&&(o.n=i),i&&(i.p=o),n._f==r&&(n._f=i),n._l==r&&(n._l=o),n[m]--}return!!r},forEach:function(t){d(this,e);for(var n,r=a(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!g(d(this,e),t)}}),p&&r(c.prototype,"size",{get:function(){return d(this,e)[m]}}),c},def:function(t,e,n){var r,i,o=g(t,e);return o?o.v=n:(t._l=o={i:i=f(e,!0),k:e,v:n,p:r=t._l,n:void 0,r:!1},t._f||(t._f=o),r&&(r.n=o),t[m]++,"F"!==i&&(t._i[i]=o)),t},getEntry:g,setStrong:function(t,e,n){l(t,e,function(t,n){this._t=d(t,e),this._k=n,this._l=void 0},function(){for(var t=this._k,e=this._l;e&&e.r;)e=e.p;return this._t&&(this._l=e=e?e.n:this._t._f)?c(0,"keys"==t?e.k:"values"==t?e.v:[e.k,e.v]):(this._t=void 0,c(1))},n?"entries":"values",!n,!0),h(e)}}},function(t,e,n){"use strict";var r=n(326),i=n(85);t.exports=n(131)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return r.def(i(this,"Set"),t=0===t?0:t,t)}},r)},function(t,e,n){"use strict";var r,i=n(43)(0),o=n(24),a=n(51),s=n(309),u=n(329),l=n(6),c=n(5),h=n(85),p=a.getWeak,f=Object.isExtensible,d=u.ufstore,m={},g=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},v={get:function(t){if(l(t)){var e=p(t);return!0===e?d(h(this,"WeakMap")).get(t):e?e[this._i]:void 0}},set:function(t,e){return u.def(h(this,"WeakMap"),t,e)}},y=t.exports=n(131)("WeakMap",g,v,u,!0,!0);c(function(){return 7!=(new y).set((Object.freeze||Object)(m),7).get(m)})&&(s((r=u.getConstructor(g,"WeakMap")).prototype,v),a.NEED=!0,i(["delete","has","get","set"],function(t){var e=y.prototype,n=e[t];o(e,t,function(e,i){if(l(e)&&!f(e)){this._f||(this._f=new r);var o=this._f[t](e,i);return"set"==t?this:o}return n.call(this,e,i)})}))},function(t,e,n){"use strict";var r=n(72),i=n(51).getWeak,o=n(3),a=n(6),s=n(70),u=n(71),l=n(43),c=n(22),h=n(85),p=l(5),f=l(6),d=0,m=function(t){return t._l||(t._l=new g)},g=function(){this.a=[]},v=function(t,e){return p(t.a,function(t){return t[0]===e})};g.prototype={get:function(t){var e=v(this,t);if(e)return e[1]},has:function(t){return!!v(this,t)},set:function(t,e){var n=v(this,t);n?n[1]=e:this.a.push([t,e])},delete:function(t){var e=f(this.a,function(e){return e[0]===t});return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,n,o){var l=t(function(t,r){s(t,l,e,"_i"),t._t=e,t._i=d++,t._l=void 0,void 0!=r&&u(r,n,t[o],t)});return r(l.prototype,{delete:function(t){if(!a(t))return!1;var n=i(t);return!0===n?m(h(this,e)).delete(t):n&&c(n,this._i)&&delete n[this._i]},has:function(t){if(!a(t))return!1;var n=i(t);return!0===n?m(h(this,e)).has(t):n&&c(n,this._i)}}),l},def:function(t,e,n){var r=i(o(e),!0);return!0===r?m(t).set(e,n):r[t._i]=n,t},ufstore:m}},function(t,e,n){var r=n(41),i=n(13);t.exports=function(t){if(void 0===t)return 0;var e=r(t),n=i(e);if(e!==n)throw RangeError("Wrong length!");return n}},function(t,e,n){var r=n(68),i=n(124),o=n(3),a=n(4).Reflect;t.exports=a&&a.ownKeys||function(t){var e=r.f(o(t)),n=i.f;return n?e.concat(n(t)):e}},function(t,e,n){"use strict";var r=n(125),i=n(6),o=n(13),a=n(31),s=n(7)("isConcatSpreadable");t.exports=function t(e,n,u,l,c,h,p,f){for(var d,m,g=c,v=0,y=!!p&&a(p,f,3);v<l;){if(v in u){if(d=y?y(u[v],v,n):u[v],m=!1,i(d)&&(m=void 0!==(m=d[s])?!!m:r(d)),m&&h>0)g=t(e,n,d,o(d.length),g,h-1)-1;else{if(g>=9007199254740991)throw TypeError();e[g]=d}g++}v++}return g}},function(t,e,n){var r=n(13),i=n(195),o=n(40);t.exports=function(t,e,n,a){var s=String(o(t)),u=s.length,l=void 0===n?" ":String(n),c=r(e);if(c<=u||""==l)return s;var h=c-u,p=i.call(l,Math.ceil(h/l.length));return p.length>h&&(p=p.slice(0,h)),a?p+s:s+p}},function(t,e,n){var r=n(65),i=n(27),o=n(97).f;t.exports=function(t){return function(e){for(var n,a=i(e),s=r(a),u=s.length,l=0,c=[];u>l;)o.call(a,n=s[l++])&&c.push(t?[n,a[n]]:a[n]);return c}}},function(t,e,n){var r=n(98),i=n(336);t.exports=function(t){return function(){if(r(this)!=t)throw TypeError(t+"#toJSON isn't generic");return i(this)}}},function(t,e,n){var r=n(71);t.exports=function(t,e){var n=[];return r(t,!1,n.push,n,e),n}},function(t,e){t.exports=Math.scale||function(t,e,n,r,i){return 0===arguments.length||t!=t||e!=e||n!=n||r!=r||i!=i?NaN:t===1/0||t===-1/0?t:(t-e)*(i-r)/(n-e)+r}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t){switch(t){case"article":case"article-journal":case"article-magazine":case"article-newspaper":return"article";case"book":return"book";case"chapter":return"incollection";case"manuscript":return"unpublished";case"paper-conference":return"inproceedings";case"patent":return"patent";case"report":return"techreport";case"thesis":return"phdthesis";case"graphic":case"interview":case"motion_picture":case"personal_communication":case"webpage":return"misc";default:return console.warn("CSL publication type not recognized: "+t+'}. Interpreting as "misc".'),"misc"}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();e.default=function(t){var e=r(t["date-parts"],1)[0];return 3===e.length?e[0].padStart(4,"0")+"-"+e[1].padStart(2,"0")+"-"+e[2].padStart(2,"0"):""}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(136),o=(r=i)&&r.__esModule?r:{default:r},a=n(137);var s={"|":"{\\textbar}","<":"{\\textless}",">":"{\\textgreater}","~":"{\\textasciitilde}","^":"{\\textasciicircum}","\\":"{\\textbackslash}","{":"\\{\\vphantom{\\}}","}":"\\vphantom{\\{}\\}"};e.default=function(t,e){var n=e?a.htmlDict:a.textDict,r=["title"],i=t.map(function(t){var e=(0,o.default)(t),i=Object.keys(e.properties).map(function(t){var i=e.properties[t].replace(/[|<>~^\\{}]/g,function(t){return s[t]}),o=i===parseInt(i).toString()?"":r.includes(t)?"{{":"{",a=o.replace(/{/g,"}").split("").reverse().join("");return""+n.li_start+t+"="+o+i+a+","+n.li_end}).join("");return n.en_start+"@"+e.type+"{"+e.label+","+n.ul_start+i+n.ul_end+"}"+n.en_end}).join("");return""+n.wr_start+i+n.wr_end}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(136),o=(r=i)&&r.__esModule?r:{default:r},a=n(137);e.default=function(t,e){var n=e?a.htmlDict:a.textDict,r=t.map(function(t){var e=(0,o.default)(t),r=Object.keys(e.properties).map(function(t){return""+n.li_start+t+": "+e.properties[t]+n.li_end}).join("");return n.en_start+"["+e.label+"]"+n.ul_start+n.li_start+"type: "+e.type+n.li_end+r+n.ul_end+n.en_end}).join("\n");return""+n.wr_start+r+n.wr_end}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=n(137),o=function(t){return"object"===(void 0===t?"undefined":r(t))&&null!==t?0===t.length?"[]":0===Object.keys(t).length?"{}":function(t){var e=","+i.htmlDict.li_end+i.htmlDict.li_start;if(Array.isArray(t)){var n=t.map(function(t){return o(t)});return"["+i.htmlDict.ul_start+i.htmlDict.li_start+n.join(e)+i.htmlDict.li_end+i.htmlDict.ul_end+"]"}var r=Object.keys(t).map(function(e){return'"'+e+'": '+o(t[e])});return"{"+i.htmlDict.ul_start+i.htmlDict.li_start+r.join(e)+i.htmlDict.li_end+i.htmlDict.ul_end+"}"}(t):JSON.stringify(t)+""};e.default=function(t){var e=t.map(function(t,e,n){var r=e<n.length-1?",":"",a=Object.keys(t).map(function(e,n,r){var a=n<r.length-1?",":"";return i.htmlDict.li_start+'"'+e+'": '+o(t[e])+a+i.htmlDict.li_end}).join("");return i.htmlDict.en_start+"{"+i.htmlDict.ul_start+a+i.htmlDict.ul_end+"}"+r+i.htmlDict.en_end});return i.htmlDict.wr_start+"["+e+"]"+i.htmlDict.wr_end}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(213),o=(r=i)&&r.__esModule?r:{default:r};e.default=function(t){return(0,o.default)(t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(215),o=n(913),a=(r=o)&&r.__esModule?r:{default:r};e.default=function(t){return(0,i.hasTemplate)(t)?(0,i.getTemplate)(t):a.default.hasOwnProperty(t)?a.default[t]:a.default.apa}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(215),o=n(914),a=(r=o)&&r.__esModule?r:{default:r};e.default=function(t){return(0,i.hasLocale)(t)?(0,i.getLocale)(t):a.default.hasOwnProperty(t)?a.default[t]:a.default["en-US"]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(95),o=(r=i)&&r.__esModule?r:{default:r};var a={};e.default=function(t,e,n,r,i){var s=t+"|"+e,u=void 0;return a.hasOwnProperty(s)?(u=a[s]).sys.retrieveItem=r:u=a[s]=new o.default.Engine({retrieveLocale:i,retrieveItem:r},n,e,!0),u}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t){return function(e){return t.find(function(t){return t.id===e})}}},function(t,e,n){"use strict";var r=n(917),i=n(918);t.exports=function(t,e,n){var o,a=new XMLHttpRequest;if("string"!=typeof t)throw new TypeError("The method must be a string.");if("string"!=typeof e)throw new TypeError("The URL/path must be a string.");null!==n&&void 0!==n||(n={});if("object"!=typeof n)throw new TypeError("Options must be an object (or null).");t=t.toUpperCase(),n.headers=n.headers||{},(o=/^([\w-]+:)?\/\/([^\/]+)/.exec(e))&&o[2]!=location.host||(n.headers["X-Requested-With"]="XMLHttpRequest");n.qs&&(e=i(e,n.qs));n.json&&(n.body=JSON.stringify(n.json),n.headers["content-type"]="application/json");a.open(t,e,!1);for(var s in n.headers)a.setRequestHeader(s.toLowerCase(),n.headers[s]);a.send(n.body?n.body:null);var u={};return a.getAllResponseHeaders().split("\r\n").forEach(function(t){var e=t.split(":");e.length>1&&(u[e[0].toLowerCase()]=e.slice(1).join(":").trim())}),new r(a.status,u,a.responseText)}},function(t,e,n){"use strict";var r=n(919),i=n(920),o=n(351);t.exports={formats:o,parse:i,stringify:r}},function(t,e,n){"use strict";var r=Object.prototype.hasOwnProperty,i=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}();e.arrayToObject=function(t,e){for(var n=e&&e.plainObjects?Object.create(null):{},r=0;r<t.length;++r)void 0!==t[r]&&(n[r]=t[r]);return n},e.merge=function(t,n,i){if(!n)return t;if("object"!=typeof n){if(Array.isArray(t))t.push(n);else{if("object"!=typeof t)return[t,n];(i.plainObjects||i.allowPrototypes||!r.call(Object.prototype,n))&&(t[n]=!0)}return t}if("object"!=typeof t)return[t].concat(n);var o=t;return Array.isArray(t)&&!Array.isArray(n)&&(o=e.arrayToObject(t,i)),Array.isArray(t)&&Array.isArray(n)?(n.forEach(function(n,o){r.call(t,o)?t[o]&&"object"==typeof t[o]?t[o]=e.merge(t[o],n,i):t.push(n):t[o]=n}),t):Object.keys(n).reduce(function(t,r){var o=n[r];return Object.prototype.hasOwnProperty.call(t,r)?t[r]=e.merge(t[r],o,i):t[r]=o,t},o)},e.decode=function(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(e){return t}},e.encode=function(t){if(0===t.length)return t;for(var e="string"==typeof t?t:String(t),n="",r=0;r<e.length;++r){var o=e.charCodeAt(r);45===o||46===o||95===o||126===o||o>=48&&o<=57||o>=65&&o<=90||o>=97&&o<=122?n+=e.charAt(r):o<128?n+=i[o]:o<2048?n+=i[192|o>>6]+i[128|63&o]:o<55296||o>=57344?n+=i[224|o>>12]+i[128|o>>6&63]+i[128|63&o]:(r+=1,o=65536+((1023&o)<<10|1023&e.charCodeAt(r)),n+=i[240|o>>18]+i[128|o>>12&63]+i[128|o>>6&63]+i[128|63&o])}return n},e.compact=function(t,n){if("object"!=typeof t||null===t)return t;var r=n||[],i=r.indexOf(t);if(-1!==i)return r[i];if(r.push(t),Array.isArray(t)){for(var o=[],a=0;a<t.length;++a)t[a]&&"object"==typeof t[a]?o.push(e.compact(t[a],r)):void 0!==t[a]&&o.push(t[a]);return o}return Object.keys(t).forEach(function(n){t[n]=e.compact(t[n],r)}),t},e.isRegExp=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},e.isBuffer=function(t){return null!==t&&void 0!==t&&!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}},function(t,e,n){"use strict";var r=String.prototype.replace,i=/%20/g;t.exports={default:"RFC3986",formatters:{RFC1738:function(t){return r.call(t,i,"+")},RFC3986:function(t){return t}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.applyGraph=function(t,e){var n=function(t){return"array/else"===t.type};return Array.isArray(t._graph)?e.find(n)&&(e.splice.apply(e,[e.findIndex(n),1].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(t._graph.slice(0,-1)))),t._graph=e):t._graph=e,t},e.removeGraph=function(t){return delete t._graph,t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(101),o=(r=i)&&r.__esModule?r:{default:r};e.default=function(t){return[].concat(o.default.getEntities(t.split(/(?:\s+|,\s*)/g),["en"]))}},function(t,e,n){const r=n(139),{isPlainObject:i,forceArray:o,shortLang:a}=n(53);t.exports=function(t,e,n,s){if(i(t)&&({ids:t,languages:e,props:n,format:s}=t),s=s||"json",!(t&&t.length>0))throw new Error("no id provided");(t=o(t)).length>50&&console.warn("getEntities accepts 50 ids max to match Wikidata API limitations:\n      this request won't get all the desired entities.\n      You can use getManyEntities instead to generate several request urls\n      to work around this limitation");const u={action:"wbgetentities",ids:t.join("|"),format:s};return e&&(e=o(e).map(a),u.languages=e.join("|")),n&&n.length>0&&(u.props=o(n).join("|")),r(u)}},function(t,e,n){const{fixedEncodeURIComponent:r}=n(53);t.exports=function(t){return`https://query.wikidata.org/sparql?format=json&query=${r(t)}`}},function(t,e,n){const{simplifyClaims:r}=n(357),i=n(358),o=n(359);t.exports=((t,e)=>{const n={id:t.id,type:t.type,modified:t.modified};return a(t,n,"labels"),a(t,n,"descriptions"),a(t,n,"aliases"),null!=t.claims&&(n.claims=r(t.claims,e)),null!=t.sitelinks&&(n.sitelinks=o(t.sitelinks,e)),n});const a=(t,e,n)=>{null!=t[n]&&(e[n]=i[n](t[n]))}},function(t,e,n){const r=n(929),{uniq:i}=n(53),o=function(t,...e){const{propertyPrefix:n}=h(e),r={};for(let i in t){let o=t[i];n&&(i=n+":"+i),r[i]=a(o,...e)}return r},a=function(t,...e){const{keepNonTruthy:n,areSubSnaks:r}=h(e);return n||r||(t=u(t)),(t=t.map(t=>c(t,...e)).filter(l))[0]&&"object"!=typeof t[0]?i(t):t},s=function(t,e){const{rank:n}=e;return t[n]||(t[n]=[]),t[n].push(e),t},u=function(t){const e=t.reduce(s,{});return e.preferred||e.normal||[]},l=t=>null!=t,c=function(t,...e){e=h(e);const{keepQualifiers:n,keepReferences:i,keepIds:a,keepHashes:s}=e,{mainsnak:u}=t;var l,c,p,f;if(u){if(l=u.datatype,!(c=u.datavalue))return null}else{if(!t||!t.datavalue)return null;c=t.datavalue,l=t.datatype,t.hash?p=!0:f=!0}const d=r(l,c,e);if(p)return s?{value:d,hash:t.hash}:d;if(f)return d;if(!(n||i||a))return d;const m={value:d},g=Object.assign({},e,{areSubSnaks:!0,keepHashes:s});return n&&(m.qualifiers=o(t.qualifiers,g)),i&&(t.references=t.references||[],m.references=t.references.map(t=>{const e=o(t.snaks,g);return s?{snaks:e,hash:t.hash}:e})),a&&(m.id=t.id),m},h=function(t){if(null==t)return{};if(t[0]&&"object"==typeof t[0])return t[0];var[e,n,r]=t;return{entityPrefix:e,propertyPrefix:n,keepQualifiers:r}};t.exports={simplifyClaims:o,simplifyPropertyClaims:a,simplifyClaim:c}},function(t,e){const n=t=>e=>Object.keys(e).reduce(r(e,t),{}),r=(t,e)=>(n,r)=>{const o=t[r];return n[r]=e?o.map(i):o.value,n},i=t=>t.value,o=n(!1);t.exports={labels:o,descriptions:o,aliases:n(!0)}},function(t,e,n){const{getSitelinkUrl:r}=n(360);t.exports=((t,e={})=>{const{addUrl:n}=e;return Object.keys(t).reduce(i(t,n),{})});const i=(t,e)=>(n,i)=>{const{title:o}=t[i];return n[i]=e?{title:o,url:r(i,o)}:o,n}},function(t,e,n){const{fixedEncodeURIComponent:r,replaceSpaceByUnderscores:i,isPlainObject:o}=n(53),{isPropertyId:a}=n(140),s="https://www.wikidata.org/wiki/",u=n(930),l=t=>{if("commons"===t)return{lang:"en",project:"commons"};if("wikidata"===t)return{lang:"en",project:"wikidata"};const[e,n,r]=t.split("wik");if(null!=r)throw new Error(`invalid sitelink: ${t}`);if(-1===u.indexOf(e))throw new Error(`sitelink lang not found: ${e}`);const i=c[n];if(!i)throw new Error(`sitelink project not found: ${i}`);return{lang:e,project:i}},c={i:"wikipedia",isource:"wikisource",iquote:"wikiquote",tionary:"wiktionary",ibooks:"wikibooks",iversity:"wikiversity",ivoyage:"wikivoyage",inews:"wikinews"};t.exports={getSitelinkUrl:(t,e)=>{if(o(t)&&(e=t.title,t=t.site),!t)throw new Error("missing a site");if(!e)throw new Error("missing a title");if("commons"===t)return`https://commons.wikimedia.org/wiki/${e}`;if("wikidata"===t)return a(e)?`${s}Property:${e}`:`${s}${e}`;const{lang:n,project:u}=l(t);return`https://${n}.${u}.org/wiki/${e=r(i(e))}`},getSitelinkData:l,isSitelinkKey:t=>{try{return l(t),!0}catch(t){return!1}}}},function(t,e){t.exports=function(t){"string"==typeof t&&(t=JSON.parse(t));const{vars:e}=t.head,r=t.results.bindings;if(1===e.length){const t=e[0];return r.map(e=>n(e[t])).filter(t=>null!=t)}{const[t,n]=l(e);return r.map(c(t,n))}};const n=function(t){if(!t)return;var{datatype:e}=t;return e=e&&e.replace("http://www.w3.org/2001/XMLSchema#",""),(r[t.type]||o(e))(t)},r={uri:t=>u(t.value),bnode:()=>null},i=t=>parseFloat(t.value),o=function(t){return t=t&&t.replace("http://www.w3.org/2001/XMLSchema#",""),a[t]||s},a={decimal:i,integer:i,float:i,double:i,boolean:t=>"true"===t.value},s=t=>t.value,u=function(t){return t.replace("http://www.wikidata.org/entity/","").replace("http://www.wikidata.org/prop/direct/","")},l=function(t){const e=[],n=[];for(let r of t)t.indexOf(`${r}Label`)>-1?e.push(r):/^\w+Label$/.test(r)||n.push(r);return[e,n]},c=function(t,e){return function(r){const i={};for(let e of t){let t=n(r[e]);if(null!=t){let n=r[`${e}Label`]&&r[`${e}Label`].value;i[e]={value:t,label:n}}}for(let t of e)i[t]=n(r[t]);return i}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=a(n(101)),o=a(n(219));function a(t){return t&&t.__esModule?t:{default:t}}e.default=function(t){return Object.keys(t.entities).map(function(e){var n=t.entities[e],a=n.labels,s=n.claims,u=i.default.simplifyClaims(s,null,null,!0),l={_wikiId:e,id:e};return Object.keys(u).forEach(function(t){var e=(0,o.default)(t,u[t],"en");if(e){var n=r(e,2),i=n[0],a=n[1];Array.isArray(l[i])?l[i]=l[i].concat(a):void 0!==a&&(l[i]=a)}}),Array.isArray(l.author)&&l.author.sort(function(t,e){return t._ordinal-e._ordinal}),l.title||(l.title=a.en.value),l})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={Q49848:"article",Q191067:"article",Q13442814:"article-journal",Q18918145:"article-journal",Q38926:"article-newspaper",Q5707594:"article-newspaper",Q30070590:"article-magazine",Q686822:"bill",Q3331189:"book",Q571:"book",Q1555508:"broadcast",Q15416:"broadcast",Q1980247:"chapter",Q1172284:"dataset",Q10389811:"entry",Q19389637:"entry",Q17329259:"entry-encyclopedia",Q30070753:"figure",Q1027879:"graphic",Q4502142:"graphic",Q478798:"graphic",Q838948:"graphic",Q178651:"interview",Q49371:"legislation",Q820655:"legislation",Q2334719:"legal_case",Q87167:"manuscript",Q4006:"map",Q11424:"motion_picture",Q30070675:"motion_picture",Q187947:"musical_score",Q18536349:"pamphlet",Q190399:"pamphlet",Q26973022:"paper-conference",Q23927052:"paper-conference",Q253623:"patent",Q30070565:"personal_communication",Q30070439:"personal_communication",Q133492:"personal_communication",Q628523:"personal_communication",Q7216866:"post",Q17928402:"post-blog",Q10870555:"report",Q265158:"review",Q637866:"review-book",Q7366:"song",Q3741908:"song",Q30070318:"song",Q24634210:"song",Q861911:"speech",Q1266946:"thesis",Q187685:"thesis",Q131569:"treaty",Q36774:"webpage"};e.default=function(t){return r[t]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t){return t.split(/(?:\s+)/g).map(function(t){return"https://doi.org/"+t.trim()})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=o(n(348)),i=o(n(366));function o(t){return t&&t.__esModule?t:{default:t}}var a=function(t){try{return JSON.parse((0,r.default)("GET",t,{headers:{Accept:"application/vnd.citationstyles.csl+json"},allowRedirectHeaders:["Accept"]}).getBody("utf8"))}catch(e){return console.error("[set]","File '"+t+"' could not be fetched:",e.message),{}}};e.default=function(t){return[].concat(t).map(a).map(i.default)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(931),o=(r=i)&&r.__esModule?r:{default:r};e.default=function(t){var e={type:(0,o.default)(t.type)};return["submitted","issued","event-date","original-date","container","accessed"].forEach(function(e){t[e]&&"number"==typeof t[e]["date-parts"][0]&&(t[e]["date-parts"]=[t[e]["date-parts"]])}),Object.assign({},t,e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=o(n(141)),i=o(n(86));function o(t){return t&&t.__esModule?t:{default:t}}e.default=function(t){var e={type:"article-journal"};return Object.keys(t).forEach(function(n){e[n]=t[n].value[0]}),e.hasOwnProperty("authors")&&(e.author=t.authors.value.map(i.default)),e.hasOwnProperty("firstpage")&&(e.page=e["page-first"]=e.firstpage),e.hasOwnProperty("date")&&(e.issued=(0,r.default)(e.date)),e.hasOwnProperty("journal")&&(e["container-title"]=e.journal),e.hasOwnProperty("doi")&&(e.id=e.DOI=e.doi),e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=o(n(369)),i=o(n(932));function o(t){return t&&t.__esModule?t:{default:t}}var a=/\\url|\\href|{\\[a-zA-Z]+}|\$\\[a-zA-Z]+\$|\$[_^]{[0-9()+=\-n]}\$|`{2,3}|'{2,3}|-{2,3}|[!?]!|!\?|{\\~}|\\[#$%&~_^\\{}]|{\\(?:[a-z] |[`"'^~=.])\\?[a-zA-Z]}|[\s\S]/g,s=/^\s$/,u=/^[@{}"=,\\]$/,l={'"':'"',"{":"}","":""};e.default=function(t){var e=[],n=t.replace(/(\\[`"'^~=.]){\\?([A-Za-z])}/g,"{$1$2}").replace(/(\\[a-z]) ?{\\?([A-Za-z])}/g,"{$1 $2}").match(a),o=new r.default(n);try{for(o.consumeWhitespace();o.tokensLeft();){o.consumeToken("@",{spaced:!1}),o.consumeWhitespace();var c=o.consume([s,u],{inverse:!0}).toLowerCase();o.consumeToken("{");var h=o.consume([s,u],{inverse:!0});o.consumeToken(",");for(var p={},f=function(){var t=o.consume([s,"="],{inverse:!0}).toLowerCase();o.consumeToken("=");var e=o.consume(/^({|"|)$/g),n=l[e];if(!l.hasOwnProperty(e))throw new SyntaxError("Unexpected field delimiter at index "+o.index+". Expected "+Object.keys(l).map(function(t){return'"'+t+'"'}).join(", ")+'; got "'+e+'"');var r=0,a=o.consume(function(t,e){if("{"===t&&r++,o.tokensLeft()<n.length)throw new SyntaxError("Unmatched delimiter at index "+o.index+": Expected "+n);return n.length?"}"===t&&r--||!o.matchesSequence(n):![s,u].some(function(e){return e.test(t)})},{tokenMap:function(t){if(i.default.hasOwnProperty(t))return i.default[t];if(t.match(/^\\[#$%&~_^\\{}]$/))return t.slice(1);if(t.length>1)throw new SyntaxError("Escape sequence not recognized: "+t);return t}});return p[t]=a,o.consumeN(n.length),o.consumeWhitespace(),o.matches("}")?"break":(o.consumeToken(",",{spaced:!1}),o.consumeWhitespace(),o.matches("}")?"break":void 0)};o.tokensLeft()&&"break"!==f(););o.consumeToken("}",{spaced:!1}),o.consumeWhitespace(),e.push({type:c,label:h,properties:p})}}catch(t){console.error("Uncaught SyntaxError: "+t.message+". Returning completed entries."),e.pop()}return e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.stack=e,this.index=0,this.current=this.stack[this.index]}return r(t,[{key:"tokensLeft",value:function(){return this.stack.length-this.index}},{key:"matches",value:function(e){return t.getMatchCallback(e)(this.current,this.index,this.stack)}},{key:"matchesSequence",value:function(e){var n=this.stack.slice(this.index,this.index+e.length).join("");return"string"==typeof e?n===e:e.every(function(e,r){return t.getMatchCallback(e)(n[r])})}},{key:"consumeToken",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:/^[\s\S]$/,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(n.inverse,n.spaced),i=void 0===r||r;i&&this.consumeWhitespace();var o=this.current;if(!t.getMatchCallback(e)(o,this.index,this.stack))throw new SyntaxError("Unexpected token at index "+this.index+": Expected "+t.getPatternText(e)+', got "'+o+'"');return this.current=this.stack[++this.index],i&&this.consumeWhitespace(),o}},{key:"consumeWhitespace",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:/^\s$/,e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).optional,n=void 0===e||e;return this.consume(t,{min:+!n})}},{key:"consumeN",value:function(t){if(this.tokensLeft()<t)throw new SyntaxError("Not enough tokens left");for(var e=this.index;t--;)this.current=this.stack[++this.index];return this.stack.slice(e,this.index).join("")}},{key:"consumeSequence",value:function(t){if(this.matchesSequence(t))return this.consumeN(t.length);throw new SyntaxError('Expected "'+t+'", got "'+this.consumeN(t.length)+'"')}},{key:"consume",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:/^[\s\S]$/,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.min,i=void 0===r?0:r,o=n.max,a=void 0===o?1/0:o,s=n.inverse,u=void 0!==s&&s,l=n.tokenMap,c=n.tokenFilter,h=this.index,p=t.getMatchCallback(e);p(this.current,this.index,this.stack)!==u;)this.current=this.stack[++this.index];var f=this.stack.slice(h,this.index);if(f.length<i)throw new SyntaxError("Not enough "+t.getPatternText(e));if(f.length>a)throw new SyntaxError("Too many "+t.getPatternText(e));return l&&(f=f.map(l)),c&&(f=f.filter(c)),f.join("")}}],[{key:"getPatternText",value:function(t){return'"'+(t instanceof RegExp?t.source:t)+'"'}},{key:"getMatchCallback",value:function(e){if(Array.isArray(e)){var n=e.map(t.getMatchCallback);return function(t){return n.some(function(e){return e(t)})}}return e instanceof Function?e:e instanceof RegExp?function(t){return e.test(t)}:function(t){return e===t}}}]),t}();e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=/\n\s*(?=\[)/g,o=/^\[(.+?)\]\s*(?:\n([\s\S]+))?$/,a=/((?=.)\s)*\n\s*/g,s=/^(.+?)\s*:\s*(.+)$/,u=function(t){var e=t.match(o)||[],n=r(e,3),i=n[1],u=n[2];if(i&&u){var l={type:"book",label:i,properties:{}};return u.trim().split(a).filter(function(t){return t}).forEach(function(t){var e=t.match(s)||[],n=r(e,3),i=n[1],o=n[2];i&&("type"===i?l.type=o:l.properties[i]=o)}),l}return{}};e.text=function(t){return t.trim().split(i).map(u)},e.textEntry=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=a(n(372)),o=a(n(373));function a(t){return t&&t.__esModule?t:{default:t}}e.default=function(t){return[].concat(t).map(function(t){var e={},n=[];for(var a in t.properties){var s=t.properties[a],u=(0,i.default)(a,s)||[],l=r(u,2),c=l[0],h=l[1];c&&(/^[^:\s]+?:[^.\s]+(\.[^.\s]+)*$/.test(c)?n.push([c,h]):e[c]=h)}return e.type=(0,o.default)(t.type),e.id=e._label=t.label,n.forEach(function(t){for(var n=r(t,2),i=n[0],o=n[1],a=i.split(/:|\./g),s=e;a.length>0;){var u=a.shift();s=s[u]||(s[u]=a.length?isNaN(+a[0])?{}:[]:o)}}),e})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=o(n(86)),i=o(n(141));function o(t){return t&&t.__esModule?t:{default:t}}var a=function(t){return/{|}/.test(t)?{literal:t.replace(/[{}]/g,"")}:(0,r.default)(t)},s={address:"publisher-place",author:!0,booktitle:"container-title",doi:"DOI",date:"issued",edition:!0,editor:!0,isbn:"ISBN",issn:"ISSN",issue:"issue",journal:"container-title",location:"publisher-place",number:"issue",pages:"page",publisher:!0,series:"collection-title",title:!0,url:"URL",volume:!0,year:"issued:date-parts.0.0",month:"issued:date-parts.0.1",crossref:!1,keywords:!1,language:!1,note:!1,numpages:!1,pmid:!1};e.default=function(t,e){if(s.hasOwnProperty(t)){if(!1!==s[t]){var n=!0===s[t]?t:s[t];return[n,function(t,e){switch(n){case"author":case"editor":return o=[],e.replace(/%/g,"%0").replace(/{.*?}/g,function(t){return"%["+(o.push(t)-1)+"]"}).split(" and ").map(function(t){return t.replace(/%\[(\d+)\]/,function(t,e){return o[+e]}).replace(/%0/g,"%")}).map(a);case"issued":return/{|}/.test(r=e)?{literal:r.replace(/[{}]/g,"")}:(0,i.default)(r);case"edition":return e;case"page":return e.replace(/[—–]/,"-");default:return e.replace(/[{}]/g,"")}var r,o}(0,e)]}}else console.info("[set]","Unknown property: "+t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={article:"article-journal",book:"book",booklet:"book",proceedings:"book",manual:!1,mastersthesis:"thesis",misc:!1,inbook:"chapter",incollection:"chapter",conference:"paper-conference",inproceedings:"paper-conference",online:"website",patent:"patent",phdthesis:"thesis",techreport:"report",unpublished:"manuscript"};e.default=function(t){return r.hasOwnProperty(t)?!1===r[t]?"book":r[t]:(console.warn("[set]","BibTeX publication type not recognized: "+t+'. Defaulting to "book".'),"book")}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=n(216),a=(r=o)&&r.__esModule?r:{default:r};e.default=function(t){try{return JSON.parse(t)}catch(e){console.info("[set]","Input was not valid JSON, switching to experimental parser for invalid JSON");try{return a.default.json.forEach(function(e){var n=i(e,2),r=n[0],o=n[1];t=t.replace(r,o)}),JSON.parse(t)}catch(t){return void console.error("[set]","Experimental parser failed. Please improve the JSON. If this is not JSON, please re-read the supported formats.")}}}},function(t,e,n){n(935),t.exports=self.fetch.bind(self)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=a(n(101)),o=a(n(377));function a(t){return t&&t.__esModule?t:{default:t}}function s(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function r(i,o){try{var a=e[i](o),s=a.value}catch(t){return void n(t)}if(!a.done)return Promise.resolve(s).then(function(t){r("next",t)},function(t){r("throw",t)});t(s)}("next")})}}var u,l=(u=s(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.all(Object.keys(e.entities).map(function(){var t=s(regeneratorRuntime.mark(function t(n){var a,u,l,c,h,p=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.entities[n],u=a.labels,l=a.claims,c=i.default.simplifyClaims(l,null,null,!0),h={_wikiId:n,id:n},t.next=5,Promise.all(Object.keys(c).map(function(){var t=s(regeneratorRuntime.mark(function t(e){var n,i,a,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,o.default)(e,c[e],"en");case 2:(n=t.sent)&&(i=r(n,2),a=i[0],s=i[1],Array.isArray(h[a])?h[a]=h[a].concat(s):void 0!==s&&(h[a]=s));case 4:case"end":return t.stop()}},t,p)}));return function(e){return t.apply(this,arguments)}}()));case 5:return Array.isArray(h.author)&&h.author.sort(function(t,e){return t._ordinal-e._ordinal}),h.title||(h.title=u.en.value),t.abrupt("return",h);case 8:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}())));case 1:case"end":return t.stop()}},t,this)})),function(t){return u.apply(this,arguments)});e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(n(101)),i=s(n(221)),o=s(n(219)),a=s(n(86));function s(t){return t&&t.__esModule?t:{default:t}}function u(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function r(i,o){try{var a=e[i](o),s=a.value}catch(t){return void n(t)}if(!a.done)return Promise.resolve(s).then(function(t){r("next",t)},function(t){r("throw",t)});t(s)}("next")})}}var l,c,h=(l=u(regeneratorRuntime.mark(function t(e,n){var o,a,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=Array.isArray(e)?e:"string"==typeof e?e.split("|"):"",a=r.default.getEntities(o,[n],"labels"),t.t1=JSON,t.next=5,(0,i.default)(a);case 5:if(t.t2=t.sent,t.t0=t.t1.parse.call(t.t1,t.t2).entities,t.t0){t.next=9;break}t.t0={};case 9:return s=t.t0,t.abrupt("return",Object.keys(s).map(function(t){return(s[t].labels[n]||{}).value}));case 11:case"end":return t.stop()}},t,this)})),function(t,e){return l.apply(this,arguments)}),p=(c=u(regeneratorRuntime.mark(function t(e,n,r){var i,s=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,function(){var t=u(regeneratorRuntime.mark(function t(e,n){var i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:i=n[0].value,t.t0=e,t.next="P50"===t.t0?4:"P57"===t.t0?4:"P86"===t.t0?4:"P98"===t.t0?4:"P110"===t.t0?4:"P655"===t.t0?4:"P123"===t.t0?5:"P136"===t.t0?5:"P291"===t.t0?5:"P1433"===t.t0?5:8;break;case 4:return t.abrupt("return",Promise.all(n.map(function(){var t=u(regeneratorRuntime.mark(function t(e){var n,i=e.value,o=e.qualifiers;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=a.default,t.next=3,h(i,r);case 3:return t.t1=t.sent[0],(n=(0,t.t0)(t.t1))._ordinal=(e=o).P1545?parseInt(e.P1545[0]):-1,t.abrupt("return",n);case 7:case"end":return t.stop()}var e},t,s)}));return function(e){return t.apply(this,arguments)}}())));case 5:return t.next=7,h(i,r);case 7:return t.abrupt("return",t.sent[0]);case 8:case"end":return t.stop()}},t,s)}));return function(e,n){return t.apply(this,arguments)}}()(e,n);case 2:if(!(i=t.sent)){t.next=7;break}return t.abrupt("return",[(0,o.default)(e),i]);case 7:return t.abrupt("return",(0,o.default)(e,n,r));case 8:case"end":return t.stop()}},t,this)})),function(t,e,n){return c.apply(this,arguments)});e.default=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n(375);var r,i=n(366),o=(r=i)&&r.__esModule?r:{default:r};function a(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function r(i,o){try{var a=e[i](o),s=a.value}catch(t){return void n(t)}if(!a.done)return Promise.resolve(s).then(function(t){r("next",t)},function(t){r("throw",t)});t(s)}("next")})}}var s,u,l=(s=a(regeneratorRuntime.mark(function t(e){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(n=new Headers).append("Accept","application/vnd.citationstyles.csl+json"),t.next=5,fetch(e,{headers:n});case 5:return t.abrupt("return",t.sent.json());case 8:return t.prev=8,t.t0=t.catch(0),console.error("[set]","File '"+e+"' could not be fetched:",t.t0.message),t.abrupt("return",{});case 12:case"end":return t.stop()}},t,this,[[0,8]])})),function(t){return s.apply(this,arguments)}),c=(u=a(regeneratorRuntime.mark(function t(e){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([].concat(e).map(l));case 2:return n=t.sent,t.abrupt("return",n.map(o.default));case 4:case"end":return t.stop()}},t,this)})),function(t){return u.apply(this,arguments)});e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=n(86),a=(r=o)&&r.__esModule?r:{default:r};function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var u={author:2,"collection-editor":2,composer:2,"container-author":2,editor:2,"editorial-director":2,director:2,interviewer:2,illustrator:2,"original-author":2,"reviewed-author":2,recipient:2,translator:2,accessed:3,container:3,"event-date":3,issued:3,"original-date":3,submitted:3,categories:"object",id:["string","number"],type:"string",language:"string",journalAbbreviation:"string",shortTitle:"string",abstract:"string",annote:"string",archive:"string",archive_location:"string","archive-place":"string",authority:"string","call-number":"string","chapter-number":"string","citation-number":"string","citation-label":"string","collection-number":"string","collection-title":"string","container-title":"string","container-title-short":"string",dimensions:"string",DOI:"string",edition:["string","number"],event:"string","event-place":"string","first-reference-note-number":"string",genre:"string",ISBN:"string",ISSN:"string",issue:["string","number"],jurisdiction:"string",keyword:"string",locator:"string",medium:"string",note:"string",number:["string","number"],"number-of-pages":"string","number-of-volumes":["string","number"],"original-publisher":"string","original-publisher-place":"string","original-title":"string",page:"string","page-first":"string",PMCID:"string",PMID:"string",publisher:"string","publisher-place":"string",references:"string","reviewed-title":"string",scale:"string",section:"string",source:"string",status:"string",title:"string","title-short":"string",URL:"string",version:"string",volume:["string","number"],"year-suffix":"string"},l=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return"object"===(void 0===t?"undefined":i(t))&&(t.literal||t.given||t.family)?t:e&&"string"==typeof t?(0,a.default)(t):void 0},c=function t(e,n){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[].concat(u[e]);switch(u[e]){case 1:return l(n,r);case 2:return function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t instanceof Array)return t.map(function(t){return l(t,e)}).filter(Boolean)||void 0}(n,r);case 3:return function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n="date-parts";if(t&&t[n]instanceof Array&&t[n].every(function(t){return t instanceof Array})){if(t[n].every(function(t){return t.every(function(t){return"number"==typeof t})}))return s({},n,t[n].map(function(t){return t.slice()}));if(!e)return;if(t[n].every(function(t){return t.every(function(t){return"string"==typeof t})}))return s({},n,t[n].map(function(t){return t.map(parseFloat)}))}else if(t&&t instanceof Array&&t[0][n]instanceof Array){if(t[0][n].every(function(t){return"number"==typeof t}))return s({},n,[t[0][n].slice()]);if(!e)return;if(t[0][n].every(function(t){return"string"==typeof t}))return s({},n,[t[0][n].map(parseFloat)])}}(n,r)}return o.includes(void 0===n?"undefined":i(n))?n:/^_/.test(n)?n:r?"string"==typeof n&&o.includes("number")?parseFloat(n):"number"==typeof n&&o.includes("string")?n.toString():Array.isArray(n)&&n.length?t(e,n[0]):void 0:void 0};e.default=function(t){return t.map(function(t){var e={};for(var n in t){var r=c(n,t[n]);void 0!==r&&(e[n]=r)}return e})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(t,e,n){return t.replace(/^\s*<[a-z]+/i,function(t){return t+" data-"+e+'="'+n+'"'})},o=function(t,e){return"function"==typeof e?e(t):"string"==typeof e?e:""};e.getAttributedEntry=i,e.getPrefixedEntry=function(t,e){return i(t,"csl-entry-id",e)},e.getWrappedEntry=function(t,e,n){var i=n.prepend,a=n.append,s=t.match(/^(\s*<[a-z0-9:-]+(?:\s*[a-z0-9:-]+=(?:"(?:\\\\|\\"|[^"])*"|'(?:\\\\|\\'|[^'])*'|\w+))*\s*>)([\s\S]+)(<\/[a-z:]+>\s*)$/i)||[],u=r(s,4),l=u[1],c=u[2],h=u[3];return l+o(e,i)+c+o(e,a)+h}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t,e){for(var n=void 0;t.includes(n);)n=""+e+Math.random().toString().slice(2);return n}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){t.exports=n(467)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=m(n(19)),i=m(n(9)),o=m(n(10)),a=m(n(20)),s=m(n(21)),u=n(1),l=m(u),c=(m(n(2)),m(n(168))),h=m(n(473)),p=m(n(382)),f=m(n(388)),d=m(n(389));function m(t){return t&&t.__esModule?t:{default:t}}var g=function(t){function e(){return(0,i.default)(this,e),(0,a.default)(this,(e.__proto__||(0,r.default)(e)).apply(this,arguments))}return(0,s.default)(e,t),(0,o.default)(e,[{key:"render",value:function(){var t=this.props.url.query.id,e=d.default.montage.data.compositions[t],n=d.default.compositions.find(function(t){return t._id===e.target_composition_id});return l.default.createElement(f.default,null,l.default.createElement(c.default,null,l.default.createElement("title",null,n&&n.metadata.title||"Métis"," - ",d.default.montage.metadata.title||"composition")),l.default.createElement(p.default,null,l.default.createElement(h.default,{parameters:e,composition:n,compositions:d.default.compositions,resources:d.default.resources,montage:d.default.montage,assets:d.default.assets,renderingMode:"web"})))}}]),e}(u.Component);e.default=g},,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i,o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(1),u=m(s),l=m(n(2)),c=n(169),h=m(n(543)),p=m(n(703)),f=m(n(303)),d=n(704);function m(t){return t&&t.__esModule?t:{default:t}}function g(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var v=(i=r=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));n.getChildContext=function(){return{citationItems:n.state.citationItems}};var r=(0,d.makeAssets)(t),i=(0,d.makeCitationData)(t,r),o=i.citationData,a=i.citationItems;return n.state={assets:r,citationData:o,citationItems:a},n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.Component),a(e,[{key:"componentWillReceiveProps",value:function(t){if(this.props.composition._id!==t.composition._id||this.props.composition.contextualizations!==t.composition.contextualizations||this.props.composition.contextualizers!==t.composition.contextualizers||this.props.composition.resources!==t.composition.resources){var e=(0,d.makeAssets)(t),n=(0,d.makeCitationData)(t,e),r=n.citationData,i=n.citationItems;this.setState({assets:e,citationData:r,citationItems:i})}}},{key:"render",value:function(){var t=this.props,e=t.parameters,n=t.composition,r=t.compositions,i=t.montage,a=t.assets,s=t.resources,l=t.previewMode,d=this.state,m=d.citationData,v=d.citationItems,y=this.context,b=y.citationStyle,_=y.citationLocale,x=y.renderingMode,w=null;switch(e.template){case"article":w=h.default;break;case"fullscreen":w=p.default}var E=s.reduce(function(t,e){return o({},t,g({},e._id,e))},{}),S=a.reduce(function(t,e){return o({},t,g({},e._id,e))},{});return u.default.createElement("div",{className:"metis-DynamicMontageSection dynamic-composition "+e.template+" "+(l?"preview-mode":""),id:"composition-"+n._id},u.default.createElement("aside",{className:"aside-menu"},u.default.createElement(f.default,{montage:i,compositions:r})),u.default.createElement("section",{className:"main-content-container"},u.default.createElement(c.ReferencesManager,{style:b,locale:_,items:v,citations:m},w&&u.default.createElement(w,{parameters:e,composition:n,assets:S,resources:E}),u.default.createElement("style",null,i.data.css.shared_css_code,i.data.css[x+"_css_code"],e.css.shared_css_code,e.css[x+"_css_code"]))))}}]),e}(),r.contextTypes={citationStyle:l.default.string,citationLocale:l.default.string,renderingMode:l.default.string},r.childContextTypes={citationItems:l.default.object},i);e.default=v},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=f(n(114)),i=f(n(19)),o=f(n(9)),a=f(n(10)),s=f(n(20)),u=f(n(21)),l=n(254),c=f(l),h=f(n(2)),p=f(n(95));function f(t){return t&&t.__esModule?t:{default:t}}var d=new(n(261).Parser),m=function(t){function e(t){(0,o.default)(this,e);var n=(0,s.default)(this,(e.__proto__||(0,i.default)(e)).call(this,t));n.makeReactBibliography=function(t,e){t.updateItems((0,r.default)(e));var n=t.makeBibliography()[1].join("\n");return d.parse(n)};var a={retrieveLocale:function(){return n.props.locale},retrieveItem:function(t){return n.props.items[t]},variableWrapper:function(t,e,n,r){return"title"===t.variableNames[0]&&t.itemData.URL&&"bibliography"===t.context?e+'<a href="'+t.itemData.URL+'" target="blank">'+n+"</a>"+r:"URL"===t.variableNames[0]?e+'<a href="'+n+'" target="blank">'+n+"</a>"+r:e+n+r}},u=new p.default.Engine(a,t.style);return n.state={sys:a,bibliography:t.items&&t.style&&t.locale?n.makeReactBibliography(u,t.items):""},n}return(0,u.default)(e,t),(0,a.default)(e,[{key:"componentDidMount",value:function(){if(this.props.locale&&this.props.style){var t=new p.default.Engine(this.state.sys,this.props.style);this.setState({processor:t,bibliography:this.props.items&&this.makeReactBibliography(t,this.props.items)})}}},{key:"componentWillReceiveProps",value:function(t){if(!this.state.processor&&this.props.locale&&this.props.style){var e=new p.default.Engine(this.state.sys,t.style);this.setState({processor:e})}}},{key:"componentDidUpdate",value:function(t){var e=this;if((this.state.processor&&this.props.items!==t.items||!this.state.bibliography)&&this.setState({bibliography:this.makeReactBibliography(this.state.processor,this.props.items)}),this.props.locale!==t.locale){var n={retrieveLocale:function(){return e.props.locale},retrieveItem:function(t){return e.props.items[t]},variableWrapper:function(t,e,n,r){return"title"===t.variableNames[0]&&t.itemData.URL&&"bibliography"===t.context?e+'<a href="'+t.itemData.URL+'" target="blank">'+n+"</a>"+r:"URL"===t.variableNames[0]?e+'<a href="'+n+'" target="blank">'+n+"</a>"+r:e+n+r}},r=new p.default.Engine(n,this.props.style);this.setState({processor:r,bibliography:this.makeReactBibliography(r,this.props.items),sys:n})}if(this.props.style!==t.style){var i=new p.default.Engine(this.state.sys,this.props.style);this.setState({processor:i,bibliography:this.makeReactBibliography(i,this.props.items)})}}},{key:"render",value:function(){var t=this.props.componentClass,e=void 0===t?"Bibliography":t,n=this.state.bibliography;return n?c.default.createElement("div",{className:e},n):c.default.createElement("div",{className:e+" loading"},this.props.loadingContent||"loading")}}]),e}(l.Component);m.propTypes={componentClass:h.default.string,style:h.default.string,locale:h.default.string,items:h.default.object},e.default=m,t.exports=e.default},,,function(t,e,n){"use strict";var r=n(57),i=n(255),o=n(479),a=n(484),s=n(79),u=n(485),l=n(489),c=n(490),h=n(491),p=s.createElement,f=s.createFactory,d=s.cloneElement,m=r,g=function(t){return t},v={Children:{map:o.map,forEach:o.forEach,count:o.count,toArray:o.toArray,only:h},Component:i.Component,PureComponent:i.PureComponent,createElement:p,cloneElement:d,isValidElement:s.isValidElement,PropTypes:u,createClass:c,createFactory:f,createMixin:g,DOM:a,version:l,__spread:m};t.exports=v},function(t,e,n){"use strict";var r=function(){};t.exports=r},function(t,e,n){"use strict";var r=n(480),i=n(79),o=n(58),a=n(481),s=r.twoArgumentPooler,u=r.fourArgumentPooler,l=/\/+/g;function c(t){return(""+t).replace(l,"$&/")}function h(t,e){this.func=t,this.context=e,this.count=0}function p(t,e,n){var r=t.func,i=t.context;r.call(i,e,t.count++)}function f(t,e,n,r){this.result=t,this.keyPrefix=e,this.func=n,this.context=r,this.count=0}function d(t,e,n){var r=t.result,a=t.keyPrefix,s=t.func,u=t.context,l=s.call(u,e,t.count++);Array.isArray(l)?m(l,r,n,o.thatReturnsArgument):null!=l&&(i.isValidElement(l)&&(l=i.cloneAndReplaceKey(l,a+(!l.key||e&&e.key===l.key?"":c(l.key)+"/")+n)),r.push(l))}function m(t,e,n,r,i){var o="";null!=n&&(o=c(n)+"/");var s=f.getPooled(e,o,r,i);a(t,d,s),f.release(s)}function g(t,e,n){return null}h.prototype.destructor=function(){this.func=null,this.context=null,this.count=0},r.addPoolingTo(h,s),f.prototype.destructor=function(){this.result=null,this.keyPrefix=null,this.func=null,this.context=null,this.count=0},r.addPoolingTo(f,u);var v={forEach:function(t,e,n){if(null==t)return t;var r=h.getPooled(e,n);a(t,p,r),h.release(r)},map:function(t,e,n){if(null==t)return t;var r=[];return m(t,r,null,e,n),r},mapIntoWithKeyPrefixInternal:m,count:function(t,e){return a(t,g,null)},toArray:function(t){var e=[];return m(t,e,null,o.thatReturnsArgument),e}};t.exports=v},function(t,e,n){"use strict";var r=n(115),i=(n(59),function(t){if(this.instancePool.length){var e=this.instancePool.pop();return this.call(e,t),e}return new this(t)}),o=function(t){t instanceof this||r("25"),t.destructor(),this.instancePool.length<this.poolSize&&this.instancePool.push(t)},a=i,s={addPoolingTo:function(t,e){var n=t;return n.instancePool=[],n.getPooled=e||a,n.poolSize||(n.poolSize=10),n.release=o,n},oneArgumentPooler:i,twoArgumentPooler:function(t,e){if(this.instancePool.length){var n=this.instancePool.pop();return this.call(n,t,e),n}return new this(t,e)},threeArgumentPooler:function(t,e,n){if(this.instancePool.length){var r=this.instancePool.pop();return this.call(r,t,e,n),r}return new this(t,e,n)},fourArgumentPooler:function(t,e,n,r){if(this.instancePool.length){var i=this.instancePool.pop();return this.call(i,t,e,n,r),i}return new this(t,e,n,r)}};t.exports=s},function(t,e,n){"use strict";var r=n(115),i=(n(258),n(259)),o=n(482),a=(n(59),n(483)),s=(n(116),"."),u=":";function l(t,e){return t&&"object"==typeof t&&null!=t.key?a.escape(t.key):e.toString(36)}t.exports=function(t,e,n){return null==t?0:function t(e,n,c,h){var p,f=typeof e;if("undefined"!==f&&"boolean"!==f||(e=null),null===e||"string"===f||"number"===f||"object"===f&&e.$$typeof===i)return c(h,e,""===n?s+l(e,0):n),1;var d=0,m=""===n?s:n+u;if(Array.isArray(e))for(var g=0;g<e.length;g++)d+=t(p=e[g],m+l(p,g),c,h);else{var v=o(e);if(v){var y,b=v.call(e);if(v!==e.entries)for(var _=0;!(y=b.next()).done;)d+=t(p=y.value,m+l(p,_++),c,h);else for(;!(y=b.next()).done;){var x=y.value;x&&(d+=t(p=x[1],m+a.escape(x[0])+u+l(p,0),c,h))}}else if("object"===f){var w="",E=String(e);r("31","[object Object]"===E?"object with keys {"+Object.keys(e).join(", ")+"}":E,w)}}return d}(t,"",e,n)}},function(t,e,n){"use strict";var r="function"==typeof Symbol&&Symbol.iterator,i="@@iterator";t.exports=function(t){var e=t&&(r&&t[r]||t[i]);if("function"==typeof e)return e}},function(t,e,n){"use strict";var r={escape:function(t){var e={"=":"=0",":":"=2"};return"$"+(""+t).replace(/[=:]/g,function(t){return e[t]})},unescape:function(t){var e={"=0":"=","=2":":"};return(""+("."===t[0]&&"$"===t[1]?t.substring(2):t.substring(1))).replace(/(=0|=2)/g,function(t){return e[t]})}};t.exports=r},function(t,e,n){"use strict";var r=n(79).createFactory,i={a:r("a"),abbr:r("abbr"),address:r("address"),area:r("area"),article:r("article"),aside:r("aside"),audio:r("audio"),b:r("b"),base:r("base"),bdi:r("bdi"),bdo:r("bdo"),big:r("big"),blockquote:r("blockquote"),body:r("body"),br:r("br"),button:r("button"),canvas:r("canvas"),caption:r("caption"),cite:r("cite"),code:r("code"),col:r("col"),colgroup:r("colgroup"),data:r("data"),datalist:r("datalist"),dd:r("dd"),del:r("del"),details:r("details"),dfn:r("dfn"),dialog:r("dialog"),div:r("div"),dl:r("dl"),dt:r("dt"),em:r("em"),embed:r("embed"),fieldset:r("fieldset"),figcaption:r("figcaption"),figure:r("figure"),footer:r("footer"),form:r("form"),h1:r("h1"),h2:r("h2"),h3:r("h3"),h4:r("h4"),h5:r("h5"),h6:r("h6"),head:r("head"),header:r("header"),hgroup:r("hgroup"),hr:r("hr"),html:r("html"),i:r("i"),iframe:r("iframe"),img:r("img"),input:r("input"),ins:r("ins"),kbd:r("kbd"),keygen:r("keygen"),label:r("label"),legend:r("legend"),li:r("li"),link:r("link"),main:r("main"),map:r("map"),mark:r("mark"),menu:r("menu"),menuitem:r("menuitem"),meta:r("meta"),meter:r("meter"),nav:r("nav"),noscript:r("noscript"),object:r("object"),ol:r("ol"),optgroup:r("optgroup"),option:r("option"),output:r("output"),p:r("p"),param:r("param"),picture:r("picture"),pre:r("pre"),progress:r("progress"),q:r("q"),rp:r("rp"),rt:r("rt"),ruby:r("ruby"),s:r("s"),samp:r("samp"),script:r("script"),section:r("section"),select:r("select"),small:r("small"),source:r("source"),span:r("span"),strong:r("strong"),style:r("style"),sub:r("sub"),summary:r("summary"),sup:r("sup"),table:r("table"),tbody:r("tbody"),td:r("td"),textarea:r("textarea"),tfoot:r("tfoot"),th:r("th"),thead:r("thead"),time:r("time"),title:r("title"),tr:r("tr"),track:r("track"),u:r("u"),ul:r("ul"),var:r("var"),video:r("video"),wbr:r("wbr"),circle:r("circle"),clipPath:r("clipPath"),defs:r("defs"),ellipse:r("ellipse"),g:r("g"),image:r("image"),line:r("line"),linearGradient:r("linearGradient"),mask:r("mask"),path:r("path"),pattern:r("pattern"),polygon:r("polygon"),polyline:r("polyline"),radialGradient:r("radialGradient"),rect:r("rect"),stop:r("stop"),svg:r("svg"),text:r("text"),tspan:r("tspan")};t.exports=i},function(t,e,n){"use strict";var r=n(79).isValidElement,i=n(486);t.exports=i(r)},function(t,e,n){"use strict";var r=n(487);t.exports=function(t){return r(t,!1)}},function(t,e,n){"use strict";var r=n(58),i=n(59),o=n(116),a=n(57),s=n(243),u=n(488);t.exports=function(t,e){var n="function"==typeof Symbol&&Symbol.iterator,l="@@iterator";var c="<<anonymous>>",h={array:m("array"),bool:m("boolean"),func:m("function"),number:m("number"),object:m("object"),string:m("string"),symbol:m("symbol"),any:d(r.thatReturnsNull),arrayOf:function(t){return d(function(e,n,r,i,o){if("function"!=typeof t)return new f("Property `"+o+"` of component `"+r+"` has invalid PropType notation inside arrayOf.");var a=e[n];if(!Array.isArray(a)){var u=v(a);return new f("Invalid "+i+" `"+o+"` of type `"+u+"` supplied to `"+r+"`, expected an array.")}for(var l=0;l<a.length;l++){var c=t(a,l,r,i,o+"["+l+"]",s);if(c instanceof Error)return c}return null})},element:function(){return d(function(e,n,r,i,o){var a=e[n];if(!t(a)){var s=v(a);return new f("Invalid "+i+" `"+o+"` of type `"+s+"` supplied to `"+r+"`, expected a single ReactElement.")}return null})}(),instanceOf:function(t){return d(function(e,n,r,i,o){if(!(e[n]instanceof t)){var a=t.name||c,s=function(t){if(!t.constructor||!t.constructor.name)return c;return t.constructor.name}(e[n]);return new f("Invalid "+i+" `"+o+"` of type `"+s+"` supplied to `"+r+"`, expected instance of `"+a+"`.")}return null})},node:function(){return d(function(t,e,n,r,i){if(!g(t[e]))return new f("Invalid "+r+" `"+i+"` supplied to `"+n+"`, expected a ReactNode.");return null})}(),objectOf:function(t){return d(function(e,n,r,i,o){if("function"!=typeof t)return new f("Property `"+o+"` of component `"+r+"` has invalid PropType notation inside objectOf.");var a=e[n],u=v(a);if("object"!==u)return new f("Invalid "+i+" `"+o+"` of type `"+u+"` supplied to `"+r+"`, expected an object.");for(var l in a)if(a.hasOwnProperty(l)){var c=t(a,l,r,i,o+"."+l,s);if(c instanceof Error)return c}return null})},oneOf:function(t){if(!Array.isArray(t))return r.thatReturnsNull;return d(function(e,n,r,i,o){for(var a=e[n],s=0;s<t.length;s++)if(p(a,t[s]))return null;var u=JSON.stringify(t);return new f("Invalid "+i+" `"+o+"` of value `"+a+"` supplied to `"+r+"`, expected one of "+u+".")})},oneOfType:function(t){if(!Array.isArray(t))return r.thatReturnsNull;for(var e=0;e<t.length;e++){var n=t[e];if("function"!=typeof n)return o(!1,"Invalid argument supplied to oneOfType. Expected an array of check functions, but received %s at index %s.",b(n),e),r.thatReturnsNull}return d(function(e,n,r,i,o){for(var a=0;a<t.length;a++){var u=t[a];if(null==u(e,n,r,i,o,s))return null}return new f("Invalid "+i+" `"+o+"` supplied to `"+r+"`.")})},shape:function(t){return d(function(e,n,r,i,o){var a=e[n],u=v(a);if("object"!==u)return new f("Invalid "+i+" `"+o+"` of type `"+u+"` supplied to `"+r+"`, expected `object`.");for(var l in t){var c=t[l];if(c){var h=c(a,l,r,i,o+"."+l,s);if(h)return h}}return null})},exact:function(t){return d(function(e,n,r,i,o){var u=e[n],l=v(u);if("object"!==l)return new f("Invalid "+i+" `"+o+"` of type `"+l+"` supplied to `"+r+"`, expected `object`.");var c=a({},e[n],t);for(var h in c){var p=t[h];if(!p)return new f("Invalid "+i+" `"+o+"` key `"+h+"` supplied to `"+r+"`.\nBad object: "+JSON.stringify(e[n],null,"  ")+"\nValid keys: "+JSON.stringify(Object.keys(t),null,"  "));var d=p(u,h,r,i,o+"."+h,s);if(d)return d}return null})}};function p(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}function f(t){this.message=t,this.stack=""}function d(t){function n(n,r,o,a,u,l,h){(a=a||c,l=l||o,h!==s)&&(e&&i(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types"));return null==r[o]?n?null===r[o]?new f("The "+u+" `"+l+"` is marked as required in `"+a+"`, but its value is `null`."):new f("The "+u+" `"+l+"` is marked as required in `"+a+"`, but its value is `undefined`."):null:t(r,o,a,u,l)}var r=n.bind(null,!1);return r.isRequired=n.bind(null,!0),r}function m(t){return d(function(e,n,r,i,o,a){var s=e[n];return v(s)!==t?new f("Invalid "+i+" `"+o+"` of type `"+y(s)+"` supplied to `"+r+"`, expected `"+t+"`."):null})}function g(e){switch(typeof e){case"number":case"string":case"undefined":return!0;case"boolean":return!e;case"object":if(Array.isArray(e))return e.every(g);if(null===e||t(e))return!0;var r=function(t){var e=t&&(n&&t[n]||t[l]);if("function"==typeof e)return e}(e);if(!r)return!1;var i,o=r.call(e);if(r!==e.entries){for(;!(i=o.next()).done;)if(!g(i.value))return!1}else for(;!(i=o.next()).done;){var a=i.value;if(a&&!g(a[1]))return!1}return!0;default:return!1}}function v(t){var e,n=typeof t;return Array.isArray(t)?"array":t instanceof RegExp?"object":(e=t,"symbol"===n||"Symbol"===e["@@toStringTag"]||"function"==typeof Symbol&&e instanceof Symbol?"symbol":n)}function y(t){if(void 0===t||null===t)return""+t;var e=v(t);if("object"===e){if(t instanceof Date)return"date";if(t instanceof RegExp)return"regexp"}return e}function b(t){var e=y(t);switch(e){case"array":case"object":return"an "+e;case"boolean":case"date":case"regexp":return"a "+e;default:return e}}return f.prototype=Error.prototype,h.checkPropTypes=u,h.PropTypes=h,h}},function(t,e,n){"use strict";t.exports=function(t,e,n,r,i){}},function(t,e,n){"use strict";t.exports="15.6.2"},function(t,e,n){"use strict";var r=n(255).Component,i=n(79).isValidElement,o=n(256),a=n(260);t.exports=a(r,i,o)},function(t,e,n){"use strict";var r=n(115),i=n(79);n(59);t.exports=function(t){return i.isValidElement(t)||r("143"),t}},function(t,e,n){"use strict";var r=n(493),i=n(497),o=n(508),a=n(511),s=n(514),u=n(523),l=n(266),c=n(270),h=n(268);t.exports=function(t){function e(e,n,l){var c=function(e){(t=t||{}).decodeEntities=!0;var n=new u;return new s(n,t).parseComplete(e),n.dom.filter(function(t){return"directive"!==t.type})}(e).map(function(t,e){return function t(e,n,s,u){if(n(e)){var l=r(function(t){return t.shouldProcessNode(e)},s);if(null!=l){var c=i(function(t){return null==t||!1===t},o(a)(function(e,r){return t(e,n,s,r)},e.children||[]));return l.replaceChildren?h.createElement(e,u,e.data,[l.processNode(e,c,u)]):l.processNode(e,c,u)}return!1}return!1}(t,n,l,e)});return c.length<=1?c[0]:c}return{parse:function(t){var n=new l;return e(t,c.alwaysValid,n.defaultProcessingInstructions)},parseWithInstructions:e}}},function(t,e,n){var r=n(37)(n(170)(["find"],n(495),function(t,e){for(var n=0,r=e.length;n<r;){if(t(e[n]))return e[n];n+=1}}));t.exports=r},function(t,e){t.exports=function(t){return"function"==typeof t["@@transducer/step"]}},function(t,e,n){var r=n(37),i=n(496),o=n(171),a=function(){function t(t,e){this.xf=e,this.f=t,this.found=!1}return t.prototype["@@transducer/init"]=o.init,t.prototype["@@transducer/result"]=function(t){return this.found||(t=this.xf["@@transducer/step"](t,void 0)),this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,e){return this.f(e)&&(this.found=!0,t=i(this.xf["@@transducer/step"](t,e))),t},t}(),s=r(function(t,e){return new a(t,e)});t.exports=s},function(t,e){t.exports=function(t){return t&&t["@@transducer/reduced"]?t:{"@@transducer/value":t,"@@transducer/reduced":!0}}},function(t,e,n){var r=n(498),i=n(37),o=n(499),a=i(function(t,e){return o(r(t),e)});t.exports=a},function(t,e){t.exports=function(t){return function(){return!t.apply(this,arguments)}}},function(t,e,n){var r=n(37),i=n(170),o=n(500),a=n(501),s=n(172),u=n(506),l=n(263),c=r(i(["filter"],u,function(t,e){return a(e)?s(function(n,r){return t(e[r])&&(n[r]=e[r]),n},{},l(e)):o(t,e)}));t.exports=c},function(t,e){t.exports=function(t,e){for(var n=0,r=e.length,i=[];n<r;)t(e[n])&&(i[i.length]=e[n]),n+=1;return i}},function(t,e){t.exports=function(t){return"[object Object]"===Object.prototype.toString.call(t)}},function(t,e,n){var r=n(60),i=n(262),o=n(503),a=r(function(t){return!!i(t)||!!t&&("object"==typeof t&&(!o(t)&&(1===t.nodeType?!!t.length:0===t.length||t.length>0&&(t.hasOwnProperty(0)&&t.hasOwnProperty(t.length-1)))))});t.exports=a},function(t,e){t.exports=function(t){return"[object String]"===Object.prototype.toString.call(t)}},function(t,e){var n=function(){function t(t){this.f=t}return t.prototype["@@transducer/init"]=function(){throw new Error("init not implemented on XWrap")},t.prototype["@@transducer/result"]=function(t){return t},t.prototype["@@transducer/step"]=function(t,e){return this.f(t,e)},t}();t.exports=function(t){return new n(t)}},function(t,e,n){var r=n(173),i=n(37)(function(t,e){return r(t.length,function(){return t.apply(e,arguments)})});t.exports=i},function(t,e,n){var r=n(37),i=n(171),o=function(){function t(t,e){this.xf=e,this.f=t}return t.prototype["@@transducer/init"]=i.init,t.prototype["@@transducer/result"]=i.result,t.prototype["@@transducer/step"]=function(t,e){return this.f(e)?this.xf["@@transducer/step"](t,e):t},t}(),a=r(function(t,e){return new o(t,e)});t.exports=a},function(t,e,n){var r=n(174),i=Object.prototype.toString;t.exports=function(){return"[object Arguments]"===i.call(arguments)?function(t){return"[object Arguments]"===i.call(t)}:function(t){return r("callee",t)}}},function(t,e,n){var r=n(509),i=n(60),o=n(264),a=i(function(t){return o(t.length,function(){var e=0,n=arguments[0],i=arguments[arguments.length-1],o=Array.prototype.slice.call(arguments,0);return o[0]=function(){var t=n.apply(this,r(arguments,[e,i]));return e+=1,t},t.apply(this,o)})});t.exports=a},function(t,e){t.exports=function(t,e){var n;t=t||[],e=e||[];var r=t.length,i=e.length,o=[];for(n=0;n<r;)o[o.length]=t[n],n+=1;for(n=0;n<i;)o[o.length]=e[n],n+=1;return o}},function(t,e,n){var r=n(173),i=n(117);t.exports=function t(e,n,o){return function(){for(var a=[],s=0,u=e,l=0;l<n.length||s<arguments.length;){var c;l<n.length&&(!i(n[l])||s>=arguments.length)?c=n[l]:(c=arguments[s],s+=1),a[l]=c,i(c)||(u-=1),l+=1}return u<=0?o.apply(this,a):r(u,t(e,a,o))}}},function(t,e,n){var r=n(37),i=n(170),o=n(512),a=n(172),s=n(513),u=n(264),l=n(263),c=r(i(["fantasy-land/map","map"],s,function(t,e){switch(Object.prototype.toString.call(e)){case"[object Function]":return u(e.length,function(){return t.call(this,e.apply(this,arguments))});case"[object Object]":return a(function(n,r){return n[r]=t(e[r]),n},{},l(e));default:return o(t,e)}}));t.exports=c},function(t,e){t.exports=function(t,e){for(var n=0,r=e.length,i=Array(r);n<r;)i[n]=t(e[n]),n+=1;return i}},function(t,e,n){var r=n(37),i=n(171),o=function(){function t(t,e){this.xf=e,this.f=t}return t.prototype["@@transducer/init"]=i.init,t.prototype["@@transducer/result"]=i.result,t.prototype["@@transducer/step"]=function(t,e){return this.xf["@@transducer/step"](t,this.f(e))},t}(),a=r(function(t,e){return new o(t,e)});t.exports=a},function(t,e,n){var r=n(515),i={input:!0,option:!0,optgroup:!0,select:!0,button:!0,datalist:!0,textarea:!0},o={tr:{tr:!0,th:!0,td:!0},th:{th:!0},td:{thead:!0,th:!0,td:!0},body:{head:!0,link:!0,script:!0},li:{li:!0},p:{p:!0},h1:{p:!0},h2:{p:!0},h3:{p:!0},h4:{p:!0},h5:{p:!0},h6:{p:!0},select:i,input:i,output:i,button:i,datalist:i,textarea:i,option:{option:!0},optgroup:{optgroup:!0}},a={__proto__:null,area:!0,base:!0,basefont:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,isindex:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,path:!0,circle:!0,ellipse:!0,line:!0,rect:!0,use:!0,stop:!0,polyline:!0,polygon:!0},s=/\s|\//;function u(t,e){this._options=e||{},this._cbs=t||{},this._tagname="",this._attribname="",this._attribvalue="",this._attribs=null,this._stack=[],this.startIndex=0,this.endIndex=null,this._lowerCaseTagNames="lowerCaseTags"in this._options?!!this._options.lowerCaseTags:!this._options.xmlMode,this._lowerCaseAttributeNames="lowerCaseAttributeNames"in this._options?!!this._options.lowerCaseAttributeNames:!this._options.xmlMode,this._options.Tokenizer&&(r=this._options.Tokenizer),this._tokenizer=new r(this._options,this),this._cbs.onparserinit&&this._cbs.onparserinit(this)}n(521)(u,n(522).EventEmitter),u.prototype._updatePosition=function(t){null===this.endIndex?this._tokenizer._sectionStart<=t?this.startIndex=0:this.startIndex=this._tokenizer._sectionStart-t:this.startIndex=this.endIndex+1,this.endIndex=this._tokenizer.getAbsoluteIndex()},u.prototype.ontext=function(t){this._updatePosition(1),this.endIndex--,this._cbs.ontext&&this._cbs.ontext(t)},u.prototype.onopentagname=function(t){if(this._lowerCaseTagNames&&(t=t.toLowerCase()),this._tagname=t,!this._options.xmlMode&&t in o)for(var e;(e=this._stack[this._stack.length-1])in o[t];this.onclosetag(e));!this._options.xmlMode&&t in a||this._stack.push(t),this._cbs.onopentagname&&this._cbs.onopentagname(t),this._cbs.onopentag&&(this._attribs={})},u.prototype.onopentagend=function(){this._updatePosition(1),this._attribs&&(this._cbs.onopentag&&this._cbs.onopentag(this._tagname,this._attribs),this._attribs=null),!this._options.xmlMode&&this._cbs.onclosetag&&this._tagname in a&&this._cbs.onclosetag(this._tagname),this._tagname=""},u.prototype.onclosetag=function(t){if(this._updatePosition(1),this._lowerCaseTagNames&&(t=t.toLowerCase()),!this._stack.length||t in a&&!this._options.xmlMode)this._options.xmlMode||"br"!==t&&"p"!==t||(this.onopentagname(t),this._closeCurrentTag());else{var e=this._stack.lastIndexOf(t);if(-1!==e)if(this._cbs.onclosetag)for(e=this._stack.length-e;e--;)this._cbs.onclosetag(this._stack.pop());else this._stack.length=e;else"p"!==t||this._options.xmlMode||(this.onopentagname(t),this._closeCurrentTag())}},u.prototype.onselfclosingtag=function(){this._options.xmlMode||this._options.recognizeSelfClosing?this._closeCurrentTag():this.onopentagend()},u.prototype._closeCurrentTag=function(){var t=this._tagname;this.onopentagend(),this._stack[this._stack.length-1]===t&&(this._cbs.onclosetag&&this._cbs.onclosetag(t),this._stack.pop())},u.prototype.onattribname=function(t){this._lowerCaseAttributeNames&&(t=t.toLowerCase()),this._attribname=t},u.prototype.onattribdata=function(t){this._attribvalue+=t},u.prototype.onattribend=function(){this._cbs.onattribute&&this._cbs.onattribute(this._attribname,this._attribvalue),this._attribs&&!Object.prototype.hasOwnProperty.call(this._attribs,this._attribname)&&(this._attribs[this._attribname]=this._attribvalue),this._attribname="",this._attribvalue=""},u.prototype._getInstructionName=function(t){var e=t.search(s),n=e<0?t:t.substr(0,e);return this._lowerCaseTagNames&&(n=n.toLowerCase()),n},u.prototype.ondeclaration=function(t){if(this._cbs.onprocessinginstruction){var e=this._getInstructionName(t);this._cbs.onprocessinginstruction("!"+e,"!"+t)}},u.prototype.onprocessinginstruction=function(t){if(this._cbs.onprocessinginstruction){var e=this._getInstructionName(t);this._cbs.onprocessinginstruction("?"+e,"?"+t)}},u.prototype.oncomment=function(t){this._updatePosition(4),this._cbs.oncomment&&this._cbs.oncomment(t),this._cbs.oncommentend&&this._cbs.oncommentend()},u.prototype.oncdata=function(t){this._updatePosition(1),this._options.xmlMode||this._options.recognizeCDATA?(this._cbs.oncdatastart&&this._cbs.oncdatastart(),this._cbs.ontext&&this._cbs.ontext(t),this._cbs.oncdataend&&this._cbs.oncdataend()):this.oncomment("[CDATA["+t+"]]")},u.prototype.onerror=function(t){this._cbs.onerror&&this._cbs.onerror(t)},u.prototype.onend=function(){if(this._cbs.onclosetag)for(var t=this._stack.length;t>0;this._cbs.onclosetag(this._stack[--t]));this._cbs.onend&&this._cbs.onend()},u.prototype.reset=function(){this._cbs.onreset&&this._cbs.onreset(),this._tokenizer.reset(),this._tagname="",this._attribname="",this._attribs=null,this._stack=[],this._cbs.onparserinit&&this._cbs.onparserinit(this)},u.prototype.parseComplete=function(t){this.reset(),this.end(t)},u.prototype.write=function(t){this._tokenizer.write(t)},u.prototype.end=function(t){this._tokenizer.end(t)},u.prototype.pause=function(){this._tokenizer.pause()},u.prototype.resume=function(){this._tokenizer.resume()},u.prototype.parseChunk=u.prototype.write,u.prototype.done=u.prototype.end,t.exports=u},function(t,e,n){t.exports=yt;var r,i,o=n(516),a=n(518),s=n(519),u=n(520),l=0,c=l++,h=l++,p=l++,f=l++,d=l++,m=l++,g=l++,v=l++,y=l++,b=l++,_=l++,x=l++,w=l++,E=l++,S=l++,T=l++,O=l++,A=l++,M=l++,C=l++,k=l++,P=l++,R=l++,L=l++,I=l++,D=l++,N=l++,j=l++,U=l++,F=l++,B=l++,z=l++,G=l++,H=l++,V=l++,W=l++,q=l++,X=l++,Y=l++,$=l++,Z=l++,J=l++,K=l++,Q=l++,tt=l++,et=l++,nt=l++,rt=l++,it=l++,ot=l++,at=l++,st=l++,ut=l++,lt=l++,ct=l++,ht=0,pt=ht++,ft=ht++,dt=ht++;function mt(t){return" "===t||"\n"===t||"\t"===t||"\f"===t||"\r"===t}function gt(t,e,n){var r=t.toLowerCase();return t===r?function(t){t===r?this._state=e:(this._state=n,this._index--)}:function(i){i===r||i===t?this._state=e:(this._state=n,this._index--)}}function vt(t,e){var n=t.toLowerCase();return function(r){r===n||r===t?this._state=e:(this._state=p,this._index--)}}function yt(t,e){this._state=c,this._buffer="",this._sectionStart=0,this._index=0,this._bufferOffset=0,this._baseState=c,this._special=pt,this._cbs=e,this._running=!0,this._ended=!1,this._xmlMode=!(!t||!t.xmlMode),this._decodeEntities=!(!t||!t.decodeEntities)}yt.prototype._stateText=function(t){"<"===t?(this._index>this._sectionStart&&this._cbs.ontext(this._getSection()),this._state=h,this._sectionStart=this._index):this._decodeEntities&&this._special===pt&&"&"===t&&(this._index>this._sectionStart&&this._cbs.ontext(this._getSection()),this._baseState=c,this._state=at,this._sectionStart=this._index)},yt.prototype._stateBeforeTagName=function(t){"/"===t?this._state=d:"<"===t?(this._cbs.ontext(this._getSection()),this._sectionStart=this._index):">"===t||this._special!==pt||mt(t)?this._state=c:"!"===t?(this._state=S,this._sectionStart=this._index+1):"?"===t?(this._state=O,this._sectionStart=this._index+1):(this._state=this._xmlMode||"s"!==t&&"S"!==t?p:B,this._sectionStart=this._index)},yt.prototype._stateInTagName=function(t){("/"===t||">"===t||mt(t))&&(this._emitToken("onopentagname"),this._state=v,this._index--)},yt.prototype._stateBeforeCloseingTagName=function(t){mt(t)||(">"===t?this._state=c:this._special!==pt?"s"===t||"S"===t?this._state=z:(this._state=c,this._index--):(this._state=m,this._sectionStart=this._index))},yt.prototype._stateInCloseingTagName=function(t){(">"===t||mt(t))&&(this._emitToken("onclosetag"),this._state=g,this._index--)},yt.prototype._stateAfterCloseingTagName=function(t){">"===t&&(this._state=c,this._sectionStart=this._index+1)},yt.prototype._stateBeforeAttributeName=function(t){">"===t?(this._cbs.onopentagend(),this._state=c,this._sectionStart=this._index+1):"/"===t?this._state=f:mt(t)||(this._state=y,this._sectionStart=this._index)},yt.prototype._stateInSelfClosingTag=function(t){">"===t?(this._cbs.onselfclosingtag(),this._state=c,this._sectionStart=this._index+1):mt(t)||(this._state=v,this._index--)},yt.prototype._stateInAttributeName=function(t){("="===t||"/"===t||">"===t||mt(t))&&(this._cbs.onattribname(this._getSection()),this._sectionStart=-1,this._state=b,this._index--)},yt.prototype._stateAfterAttributeName=function(t){"="===t?this._state=_:"/"===t||">"===t?(this._cbs.onattribend(),this._state=v,this._index--):mt(t)||(this._cbs.onattribend(),this._state=y,this._sectionStart=this._index)},yt.prototype._stateBeforeAttributeValue=function(t){'"'===t?(this._state=x,this._sectionStart=this._index+1):"'"===t?(this._state=w,this._sectionStart=this._index+1):mt(t)||(this._state=E,this._sectionStart=this._index,this._index--)},yt.prototype._stateInAttributeValueDoubleQuotes=function(t){'"'===t?(this._emitToken("onattribdata"),this._cbs.onattribend(),this._state=v):this._decodeEntities&&"&"===t&&(this._emitToken("onattribdata"),this._baseState=this._state,this._state=at,this._sectionStart=this._index)},yt.prototype._stateInAttributeValueSingleQuotes=function(t){"'"===t?(this._emitToken("onattribdata"),this._cbs.onattribend(),this._state=v):this._decodeEntities&&"&"===t&&(this._emitToken("onattribdata"),this._baseState=this._state,this._state=at,this._sectionStart=this._index)},yt.prototype._stateInAttributeValueNoQuotes=function(t){mt(t)||">"===t?(this._emitToken("onattribdata"),this._cbs.onattribend(),this._state=v,this._index--):this._decodeEntities&&"&"===t&&(this._emitToken("onattribdata"),this._baseState=this._state,this._state=at,this._sectionStart=this._index)},yt.prototype._stateBeforeDeclaration=function(t){this._state="["===t?P:"-"===t?A:T},yt.prototype._stateInDeclaration=function(t){">"===t&&(this._cbs.ondeclaration(this._getSection()),this._state=c,this._sectionStart=this._index+1)},yt.prototype._stateInProcessingInstruction=function(t){">"===t&&(this._cbs.onprocessinginstruction(this._getSection()),this._state=c,this._sectionStart=this._index+1)},yt.prototype._stateBeforeComment=function(t){"-"===t?(this._state=M,this._sectionStart=this._index+1):this._state=T},yt.prototype._stateInComment=function(t){"-"===t&&(this._state=C)},yt.prototype._stateAfterComment1=function(t){this._state="-"===t?k:M},yt.prototype._stateAfterComment2=function(t){">"===t?(this._cbs.oncomment(this._buffer.substring(this._sectionStart,this._index-2)),this._state=c,this._sectionStart=this._index+1):"-"!==t&&(this._state=M)},yt.prototype._stateBeforeCdata1=gt("C",R,T),yt.prototype._stateBeforeCdata2=gt("D",L,T),yt.prototype._stateBeforeCdata3=gt("A",I,T),yt.prototype._stateBeforeCdata4=gt("T",D,T),yt.prototype._stateBeforeCdata5=gt("A",N,T),yt.prototype._stateBeforeCdata6=function(t){"["===t?(this._state=j,this._sectionStart=this._index+1):(this._state=T,this._index--)},yt.prototype._stateInCdata=function(t){"]"===t&&(this._state=U)},yt.prototype._stateAfterCdata1=(r="]",i=F,function(t){t===r&&(this._state=i)}),yt.prototype._stateAfterCdata2=function(t){">"===t?(this._cbs.oncdata(this._buffer.substring(this._sectionStart,this._index-2)),this._state=c,this._sectionStart=this._index+1):"]"!==t&&(this._state=j)},yt.prototype._stateBeforeSpecial=function(t){"c"===t||"C"===t?this._state=G:"t"===t||"T"===t?this._state=K:(this._state=p,this._index--)},yt.prototype._stateBeforeSpecialEnd=function(t){this._special!==ft||"c"!==t&&"C"!==t?this._special!==dt||"t"!==t&&"T"!==t?this._state=c:this._state=nt:this._state=X},yt.prototype._stateBeforeScript1=vt("R",H),yt.prototype._stateBeforeScript2=vt("I",V),yt.prototype._stateBeforeScript3=vt("P",W),yt.prototype._stateBeforeScript4=vt("T",q),yt.prototype._stateBeforeScript5=function(t){("/"===t||">"===t||mt(t))&&(this._special=ft),this._state=p,this._index--},yt.prototype._stateAfterScript1=gt("R",Y,c),yt.prototype._stateAfterScript2=gt("I",$,c),yt.prototype._stateAfterScript3=gt("P",Z,c),yt.prototype._stateAfterScript4=gt("T",J,c),yt.prototype._stateAfterScript5=function(t){">"===t||mt(t)?(this._special=pt,this._state=m,this._sectionStart=this._index-6,this._index--):this._state=c},yt.prototype._stateBeforeStyle1=vt("Y",Q),yt.prototype._stateBeforeStyle2=vt("L",tt),yt.prototype._stateBeforeStyle3=vt("E",et),yt.prototype._stateBeforeStyle4=function(t){("/"===t||">"===t||mt(t))&&(this._special=dt),this._state=p,this._index--},yt.prototype._stateAfterStyle1=gt("Y",rt,c),yt.prototype._stateAfterStyle2=gt("L",it,c),yt.prototype._stateAfterStyle3=gt("E",ot,c),yt.prototype._stateAfterStyle4=function(t){">"===t||mt(t)?(this._special=pt,this._state=m,this._sectionStart=this._index-5,this._index--):this._state=c},yt.prototype._stateBeforeEntity=gt("#",st,ut),yt.prototype._stateBeforeNumericEntity=gt("X",ct,lt),yt.prototype._parseNamedEntityStrict=function(){if(this._sectionStart+1<this._index){var t=this._buffer.substring(this._sectionStart+1,this._index),e=this._xmlMode?u:a;e.hasOwnProperty(t)&&(this._emitPartial(e[t]),this._sectionStart=this._index+1)}},yt.prototype._parseLegacyEntity=function(){var t=this._sectionStart+1,e=this._index-t;for(e>6&&(e=6);e>=2;){var n=this._buffer.substr(t,e);if(s.hasOwnProperty(n))return this._emitPartial(s[n]),void(this._sectionStart+=e+1);e--}},yt.prototype._stateInNamedEntity=function(t){";"===t?(this._parseNamedEntityStrict(),this._sectionStart+1<this._index&&!this._xmlMode&&this._parseLegacyEntity(),this._state=this._baseState):(t<"a"||t>"z")&&(t<"A"||t>"Z")&&(t<"0"||t>"9")&&(this._xmlMode||this._sectionStart+1===this._index||(this._baseState!==c?"="!==t&&this._parseNamedEntityStrict():this._parseLegacyEntity()),this._state=this._baseState,this._index--)},yt.prototype._decodeNumericEntity=function(t,e){var n=this._sectionStart+t;if(n!==this._index){var r=this._buffer.substring(n,this._index),i=parseInt(r,e);this._emitPartial(o(i)),this._sectionStart=this._index}else this._sectionStart--;this._state=this._baseState},yt.prototype._stateInNumericEntity=function(t){";"===t?(this._decodeNumericEntity(2,10),this._sectionStart++):(t<"0"||t>"9")&&(this._xmlMode?this._state=this._baseState:this._decodeNumericEntity(2,10),this._index--)},yt.prototype._stateInHexEntity=function(t){";"===t?(this._decodeNumericEntity(3,16),this._sectionStart++):(t<"a"||t>"f")&&(t<"A"||t>"F")&&(t<"0"||t>"9")&&(this._xmlMode?this._state=this._baseState:this._decodeNumericEntity(3,16),this._index--)},yt.prototype._cleanup=function(){this._sectionStart<0?(this._buffer="",this._bufferOffset+=this._index,this._index=0):this._running&&(this._state===c?(this._sectionStart!==this._index&&this._cbs.ontext(this._buffer.substr(this._sectionStart)),this._buffer="",this._bufferOffset+=this._index,this._index=0):this._sectionStart===this._index?(this._buffer="",this._bufferOffset+=this._index,this._index=0):(this._buffer=this._buffer.substr(this._sectionStart),this._index-=this._sectionStart,this._bufferOffset+=this._sectionStart),this._sectionStart=0)},yt.prototype.write=function(t){this._ended&&this._cbs.onerror(Error(".write() after done!")),this._buffer+=t,this._parse()},yt.prototype._parse=function(){for(;this._index<this._buffer.length&&this._running;){var t=this._buffer.charAt(this._index);this._state===c?this._stateText(t):this._state===h?this._stateBeforeTagName(t):this._state===p?this._stateInTagName(t):this._state===d?this._stateBeforeCloseingTagName(t):this._state===m?this._stateInCloseingTagName(t):this._state===g?this._stateAfterCloseingTagName(t):this._state===f?this._stateInSelfClosingTag(t):this._state===v?this._stateBeforeAttributeName(t):this._state===y?this._stateInAttributeName(t):this._state===b?this._stateAfterAttributeName(t):this._state===_?this._stateBeforeAttributeValue(t):this._state===x?this._stateInAttributeValueDoubleQuotes(t):this._state===w?this._stateInAttributeValueSingleQuotes(t):this._state===E?this._stateInAttributeValueNoQuotes(t):this._state===S?this._stateBeforeDeclaration(t):this._state===T?this._stateInDeclaration(t):this._state===O?this._stateInProcessingInstruction(t):this._state===A?this._stateBeforeComment(t):this._state===M?this._stateInComment(t):this._state===C?this._stateAfterComment1(t):this._state===k?this._stateAfterComment2(t):this._state===P?this._stateBeforeCdata1(t):this._state===R?this._stateBeforeCdata2(t):this._state===L?this._stateBeforeCdata3(t):this._state===I?this._stateBeforeCdata4(t):this._state===D?this._stateBeforeCdata5(t):this._state===N?this._stateBeforeCdata6(t):this._state===j?this._stateInCdata(t):this._state===U?this._stateAfterCdata1(t):this._state===F?this._stateAfterCdata2(t):this._state===B?this._stateBeforeSpecial(t):this._state===z?this._stateBeforeSpecialEnd(t):this._state===G?this._stateBeforeScript1(t):this._state===H?this._stateBeforeScript2(t):this._state===V?this._stateBeforeScript3(t):this._state===W?this._stateBeforeScript4(t):this._state===q?this._stateBeforeScript5(t):this._state===X?this._stateAfterScript1(t):this._state===Y?this._stateAfterScript2(t):this._state===$?this._stateAfterScript3(t):this._state===Z?this._stateAfterScript4(t):this._state===J?this._stateAfterScript5(t):this._state===K?this._stateBeforeStyle1(t):this._state===Q?this._stateBeforeStyle2(t):this._state===tt?this._stateBeforeStyle3(t):this._state===et?this._stateBeforeStyle4(t):this._state===nt?this._stateAfterStyle1(t):this._state===rt?this._stateAfterStyle2(t):this._state===it?this._stateAfterStyle3(t):this._state===ot?this._stateAfterStyle4(t):this._state===at?this._stateBeforeEntity(t):this._state===st?this._stateBeforeNumericEntity(t):this._state===ut?this._stateInNamedEntity(t):this._state===lt?this._stateInNumericEntity(t):this._state===ct?this._stateInHexEntity(t):this._cbs.onerror(Error("unknown _state"),this._state),this._index++}this._cleanup()},yt.prototype.pause=function(){this._running=!1},yt.prototype.resume=function(){this._running=!0,this._index<this._buffer.length&&this._parse(),this._ended&&this._finish()},yt.prototype.end=function(t){this._ended&&this._cbs.onerror(Error(".end() after done!")),t&&this.write(t),this._ended=!0,this._running&&this._finish()},yt.prototype._finish=function(){this._sectionStart<this._index&&this._handleTrailingData(),this._cbs.onend()},yt.prototype._handleTrailingData=function(){var t=this._buffer.substr(this._sectionStart);this._state===j||this._state===U||this._state===F?this._cbs.oncdata(t):this._state===M||this._state===C||this._state===k?this._cbs.oncomment(t):this._state!==ut||this._xmlMode?this._state!==lt||this._xmlMode?this._state!==ct||this._xmlMode?this._state!==p&&this._state!==v&&this._state!==_&&this._state!==b&&this._state!==y&&this._state!==w&&this._state!==x&&this._state!==E&&this._state!==m&&this._cbs.ontext(t):(this._decodeNumericEntity(3,16),this._sectionStart<this._index&&(this._state=this._baseState,this._handleTrailingData())):(this._decodeNumericEntity(2,10),this._sectionStart<this._index&&(this._state=this._baseState,this._handleTrailingData())):(this._parseLegacyEntity(),this._sectionStart<this._index&&(this._state=this._baseState,this._handleTrailingData()))},yt.prototype.reset=function(){yt.call(this,{xmlMode:this._xmlMode,decodeEntities:this._decodeEntities},this._cbs)},yt.prototype.getAbsoluteIndex=function(){return this._bufferOffset+this._index},yt.prototype._getSection=function(){return this._buffer.substring(this._sectionStart,this._index)},yt.prototype._emitToken=function(t){this._cbs[t](this._getSection()),this._sectionStart=-1},yt.prototype._emitPartial=function(t){this._baseState!==c?this._cbs.onattribdata(t):this._cbs.ontext(t)}},function(t,e,n){var r=n(517);t.exports=function(t){if(t>=55296&&t<=57343||t>1114111)return"�";t in r&&(t=r[t]);var e="";t>65535&&(t-=65536,e+=String.fromCharCode(t>>>10&1023|55296),t=56320|1023&t);return e+=String.fromCharCode(t)}},function(t,e){t.exports={0:65533,128:8364,130:8218,131:402,132:8222,133:8230,134:8224,135:8225,136:710,137:8240,138:352,139:8249,140:338,142:381,145:8216,146:8217,147:8220,148:8221,149:8226,150:8211,151:8212,152:732,153:8482,154:353,155:8250,156:339,158:382,159:376}},function(t,e){t.exports={Aacute:"Á",aacute:"á",Abreve:"Ă",abreve:"ă",ac:"∾",acd:"∿",acE:"∾̳",Acirc:"Â",acirc:"â",acute:"´",Acy:"А",acy:"а",AElig:"Æ",aelig:"æ",af:"⁡",Afr:"𝔄",afr:"𝔞",Agrave:"À",agrave:"à",alefsym:"ℵ",aleph:"ℵ",Alpha:"Α",alpha:"α",Amacr:"Ā",amacr:"ā",amalg:"⨿",amp:"&",AMP:"&",andand:"⩕",And:"⩓",and:"∧",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",angmsdag:"⦮",angmsdah:"⦯",angmsd:"∡",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"Å",angzarr:"⍼",Aogon:"Ą",aogon:"ą",Aopf:"𝔸",aopf:"𝕒",apacir:"⩯",ap:"≈",apE:"⩰",ape:"≊",apid:"≋",apos:"'",ApplyFunction:"⁡",approx:"≈",approxeq:"≊",Aring:"Å",aring:"å",Ascr:"𝒜",ascr:"𝒶",Assign:"≔",ast:"*",asymp:"≈",asympeq:"≍",Atilde:"Ã",atilde:"ã",Auml:"Ä",auml:"ä",awconint:"∳",awint:"⨑",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",Backslash:"∖",Barv:"⫧",barvee:"⊽",barwed:"⌅",Barwed:"⌆",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",Bcy:"Б",bcy:"б",bdquo:"„",becaus:"∵",because:"∵",Because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",Bernoullis:"ℬ",Beta:"Β",beta:"β",beth:"ℶ",between:"≬",Bfr:"𝔅",bfr:"𝔟",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"=⃥",bnequiv:"≡⃥",bNot:"⫭",bnot:"⌐",Bopf:"𝔹",bopf:"𝕓",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxbox:"⧉",boxdl:"┐",boxdL:"╕",boxDl:"╖",boxDL:"╗",boxdr:"┌",boxdR:"╒",boxDr:"╓",boxDR:"╔",boxh:"─",boxH:"═",boxhd:"┬",boxHd:"╤",boxhD:"╥",boxHD:"╦",boxhu:"┴",boxHu:"╧",boxhU:"╨",boxHU:"╩",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxul:"┘",boxuL:"╛",boxUl:"╜",boxUL:"╝",boxur:"└",boxuR:"╘",boxUr:"╙",boxUR:"╚",boxv:"│",boxV:"║",boxvh:"┼",boxvH:"╪",boxVh:"╫",boxVH:"╬",boxvl:"┤",boxvL:"╡",boxVl:"╢",boxVL:"╣",boxvr:"├",boxvR:"╞",boxVr:"╟",boxVR:"╠",bprime:"‵",breve:"˘",Breve:"˘",brvbar:"¦",bscr:"𝒷",Bscr:"ℬ",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsolb:"⧅",bsol:"\\",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpE:"⪮",bumpe:"≏",Bumpeq:"≎",bumpeq:"≏",Cacute:"Ć",cacute:"ć",capand:"⩄",capbrcup:"⩉",capcap:"⩋",cap:"∩",Cap:"⋒",capcup:"⩇",capdot:"⩀",CapitalDifferentialD:"ⅅ",caps:"∩︀",caret:"⁁",caron:"ˇ",Cayleys:"ℭ",ccaps:"⩍",Ccaron:"Č",ccaron:"č",Ccedil:"Ç",ccedil:"ç",Ccirc:"Ĉ",ccirc:"ĉ",Cconint:"∰",ccups:"⩌",ccupssm:"⩐",Cdot:"Ċ",cdot:"ċ",cedil:"¸",Cedilla:"¸",cemptyv:"⦲",cent:"¢",centerdot:"·",CenterDot:"·",cfr:"𝔠",Cfr:"ℭ",CHcy:"Ч",chcy:"ч",check:"✓",checkmark:"✓",Chi:"Χ",chi:"χ",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",CircleDot:"⊙",circledR:"®",circledS:"Ⓢ",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",cir:"○",cirE:"⧃",cire:"≗",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",clubs:"♣",clubsuit:"♣",colon:":",Colon:"∷",Colone:"⩴",colone:"≔",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",Congruent:"≡",conint:"∮",Conint:"∯",ContourIntegral:"∮",copf:"𝕔",Copf:"ℂ",coprod:"∐",Coproduct:"∐",copy:"©",COPY:"©",copysr:"℗",CounterClockwiseContourIntegral:"∳",crarr:"↵",cross:"✗",Cross:"⨯",Cscr:"𝒞",cscr:"𝒸",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",cupbrcap:"⩈",cupcap:"⩆",CupCap:"≍",cup:"∪",Cup:"⋓",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"¤",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",dagger:"†",Dagger:"‡",daleth:"ℸ",darr:"↓",Darr:"↡",dArr:"⇓",dash:"‐",Dashv:"⫤",dashv:"⊣",dbkarow:"⤏",dblac:"˝",Dcaron:"Ď",dcaron:"ď",Dcy:"Д",dcy:"д",ddagger:"‡",ddarr:"⇊",DD:"ⅅ",dd:"ⅆ",DDotrahd:"⤑",ddotseq:"⩷",deg:"°",Del:"∇",Delta:"Δ",delta:"δ",demptyv:"⦱",dfisht:"⥿",Dfr:"𝔇",dfr:"𝔡",dHar:"⥥",dharl:"⇃",dharr:"⇂",DiacriticalAcute:"´",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",diam:"⋄",diamond:"⋄",Diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"¨",DifferentialD:"ⅆ",digamma:"ϝ",disin:"⋲",div:"÷",divide:"÷",divideontimes:"⋇",divonx:"⋇",DJcy:"Ђ",djcy:"ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",Dopf:"𝔻",dopf:"𝕕",Dot:"¨",dot:"˙",DotDot:"⃜",doteq:"≐",doteqdot:"≑",DotEqual:"≐",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",DoubleContourIntegral:"∯",DoubleDot:"¨",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",DoubleVerticalBar:"∥",DownArrowBar:"⤓",downarrow:"↓",DownArrow:"↓",Downarrow:"⇓",DownArrowUpArrow:"⇵",DownBreve:"̑",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVectorBar:"⥖",DownLeftVector:"↽",DownRightTeeVector:"⥟",DownRightVectorBar:"⥗",DownRightVector:"⇁",DownTeeArrow:"↧",DownTee:"⊤",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",Dscr:"𝒟",dscr:"𝒹",DScy:"Ѕ",dscy:"ѕ",dsol:"⧶",Dstrok:"Đ",dstrok:"đ",dtdot:"⋱",dtri:"▿",dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",DZcy:"Џ",dzcy:"џ",dzigrarr:"⟿",Eacute:"É",eacute:"é",easter:"⩮",Ecaron:"Ě",ecaron:"ě",Ecirc:"Ê",ecirc:"ê",ecir:"≖",ecolon:"≕",Ecy:"Э",ecy:"э",eDDot:"⩷",Edot:"Ė",edot:"ė",eDot:"≑",ee:"ⅇ",efDot:"≒",Efr:"𝔈",efr:"𝔢",eg:"⪚",Egrave:"È",egrave:"è",egs:"⪖",egsdot:"⪘",el:"⪙",Element:"∈",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",Emacr:"Ē",emacr:"ē",empty:"∅",emptyset:"∅",EmptySmallSquare:"◻",emptyv:"∅",EmptyVerySmallSquare:"▫",emsp13:" ",emsp14:" ",emsp:" ",ENG:"Ŋ",eng:"ŋ",ensp:" ",Eogon:"Ę",eogon:"ę",Eopf:"𝔼",eopf:"𝕖",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",Epsilon:"Ε",epsilon:"ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",Equal:"⩵",equals:"=",EqualTilde:"≂",equest:"≟",Equilibrium:"⇌",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erarr:"⥱",erDot:"≓",escr:"ℯ",Escr:"ℰ",esdot:"≐",Esim:"⩳",esim:"≂",Eta:"Η",eta:"η",ETH:"Ð",eth:"ð",Euml:"Ë",euml:"ë",euro:"€",excl:"!",exist:"∃",Exists:"∃",expectation:"ℰ",exponentiale:"ⅇ",ExponentialE:"ⅇ",fallingdotseq:"≒",Fcy:"Ф",fcy:"ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",Ffr:"𝔉",ffr:"𝔣",filig:"ﬁ",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",Fopf:"𝔽",fopf:"𝕗",forall:"∀",ForAll:"∀",fork:"⋔",forkv:"⫙",Fouriertrf:"ℱ",fpartint:"⨍",frac12:"½",frac13:"⅓",frac14:"¼",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"¾",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",fscr:"𝒻",Fscr:"ℱ",gacute:"ǵ",Gamma:"Γ",gamma:"γ",Gammad:"Ϝ",gammad:"ϝ",gap:"⪆",Gbreve:"Ğ",gbreve:"ğ",Gcedil:"Ģ",Gcirc:"Ĝ",gcirc:"ĝ",Gcy:"Г",gcy:"г",Gdot:"Ġ",gdot:"ġ",ge:"≥",gE:"≧",gEl:"⪌",gel:"⋛",geq:"≥",geqq:"≧",geqslant:"⩾",gescc:"⪩",ges:"⩾",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",Gfr:"𝔊",gfr:"𝔤",gg:"≫",Gg:"⋙",ggg:"⋙",gimel:"ℷ",GJcy:"Ѓ",gjcy:"ѓ",gla:"⪥",gl:"≷",glE:"⪒",glj:"⪤",gnap:"⪊",gnapprox:"⪊",gne:"⪈",gnE:"≩",gneq:"⪈",gneqq:"≩",gnsim:"⋧",Gopf:"𝔾",gopf:"𝕘",grave:"`",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",Gscr:"𝒢",gscr:"ℊ",gsim:"≳",gsime:"⪎",gsiml:"⪐",gtcc:"⪧",gtcir:"⩺",gt:">",GT:">",Gt:"≫",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",Hacek:"ˇ",hairsp:" ",half:"½",hamilt:"ℋ",HARDcy:"Ъ",hardcy:"ъ",harrcir:"⥈",harr:"↔",hArr:"⇔",harrw:"↭",Hat:"^",hbar:"ℏ",Hcirc:"Ĥ",hcirc:"ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",hfr:"𝔥",Hfr:"ℌ",HilbertSpace:"ℋ",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",hopf:"𝕙",Hopf:"ℍ",horbar:"―",HorizontalLine:"─",hscr:"𝒽",Hscr:"ℋ",hslash:"ℏ",Hstrok:"Ħ",hstrok:"ħ",HumpDownHump:"≎",HumpEqual:"≏",hybull:"⁃",hyphen:"‐",Iacute:"Í",iacute:"í",ic:"⁣",Icirc:"Î",icirc:"î",Icy:"И",icy:"и",Idot:"İ",IEcy:"Е",iecy:"е",iexcl:"¡",iff:"⇔",ifr:"𝔦",Ifr:"ℑ",Igrave:"Ì",igrave:"ì",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",IJlig:"Ĳ",ijlig:"ĳ",Imacr:"Ī",imacr:"ī",image:"ℑ",ImaginaryI:"ⅈ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",Im:"ℑ",imof:"⊷",imped:"Ƶ",Implies:"⇒",incare:"℅",in:"∈",infin:"∞",infintie:"⧝",inodot:"ı",intcal:"⊺",int:"∫",Int:"∬",integers:"ℤ",Integral:"∫",intercal:"⊺",Intersection:"⋂",intlarhk:"⨗",intprod:"⨼",InvisibleComma:"⁣",InvisibleTimes:"⁢",IOcy:"Ё",iocy:"ё",Iogon:"Į",iogon:"į",Iopf:"𝕀",iopf:"𝕚",Iota:"Ι",iota:"ι",iprod:"⨼",iquest:"¿",iscr:"𝒾",Iscr:"ℐ",isin:"∈",isindot:"⋵",isinE:"⋹",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",Itilde:"Ĩ",itilde:"ĩ",Iukcy:"І",iukcy:"і",Iuml:"Ï",iuml:"ï",Jcirc:"Ĵ",jcirc:"ĵ",Jcy:"Й",jcy:"й",Jfr:"𝔍",jfr:"𝔧",jmath:"ȷ",Jopf:"𝕁",jopf:"𝕛",Jscr:"𝒥",jscr:"𝒿",Jsercy:"Ј",jsercy:"ј",Jukcy:"Є",jukcy:"є",Kappa:"Κ",kappa:"κ",kappav:"ϰ",Kcedil:"Ķ",kcedil:"ķ",Kcy:"К",kcy:"к",Kfr:"𝔎",kfr:"𝔨",kgreen:"ĸ",KHcy:"Х",khcy:"х",KJcy:"Ќ",kjcy:"ќ",Kopf:"𝕂",kopf:"𝕜",Kscr:"𝒦",kscr:"𝓀",lAarr:"⇚",Lacute:"Ĺ",lacute:"ĺ",laemptyv:"⦴",lagran:"ℒ",Lambda:"Λ",lambda:"λ",lang:"⟨",Lang:"⟪",langd:"⦑",langle:"⟨",lap:"⪅",Laplacetrf:"ℒ",laquo:"«",larrb:"⇤",larrbfs:"⤟",larr:"←",Larr:"↞",lArr:"⇐",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",latail:"⤙",lAtail:"⤛",lat:"⪫",late:"⪭",lates:"⪭︀",lbarr:"⤌",lBarr:"⤎",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",Lcaron:"Ľ",lcaron:"ľ",Lcedil:"Ļ",lcedil:"ļ",lceil:"⌈",lcub:"{",Lcy:"Л",lcy:"л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",le:"≤",lE:"≦",LeftAngleBracket:"⟨",LeftArrowBar:"⇤",leftarrow:"←",LeftArrow:"←",Leftarrow:"⇐",LeftArrowRightArrow:"⇆",leftarrowtail:"↢",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVectorBar:"⥙",LeftDownVector:"⇃",LeftFloor:"⌊",leftharpoondown:"↽",leftharpoonup:"↼",leftleftarrows:"⇇",leftrightarrow:"↔",LeftRightArrow:"↔",Leftrightarrow:"⇔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",LeftRightVector:"⥎",LeftTeeArrow:"↤",LeftTee:"⊣",LeftTeeVector:"⥚",leftthreetimes:"⋋",LeftTriangleBar:"⧏",LeftTriangle:"⊲",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVectorBar:"⥘",LeftUpVector:"↿",LeftVectorBar:"⥒",LeftVector:"↼",lEg:"⪋",leg:"⋚",leq:"≤",leqq:"≦",leqslant:"⩽",lescc:"⪨",les:"⩽",lesdot:"⩿",lesdoto:"⪁",lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",lessgtr:"≶",LessLess:"⪡",lesssim:"≲",LessSlantEqual:"⩽",LessTilde:"≲",lfisht:"⥼",lfloor:"⌊",Lfr:"𝔏",lfr:"𝔩",lg:"≶",lgE:"⪑",lHar:"⥢",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",LJcy:"Љ",ljcy:"љ",llarr:"⇇",ll:"≪",Ll:"⋘",llcorner:"⌞",Lleftarrow:"⇚",llhard:"⥫",lltri:"◺",Lmidot:"Ŀ",lmidot:"ŀ",lmoustache:"⎰",lmoust:"⎰",lnap:"⪉",lnapprox:"⪉",lne:"⪇",lnE:"≨",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",longleftarrow:"⟵",LongLeftArrow:"⟵",Longleftarrow:"⟸",longleftrightarrow:"⟷",LongLeftRightArrow:"⟷",Longleftrightarrow:"⟺",longmapsto:"⟼",longrightarrow:"⟶",LongRightArrow:"⟶",Longrightarrow:"⟹",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",Lopf:"𝕃",lopf:"𝕝",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",LowerLeftArrow:"↙",LowerRightArrow:"↘",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",lscr:"𝓁",Lscr:"ℒ",lsh:"↰",Lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",Lstrok:"Ł",lstrok:"ł",ltcc:"⪦",ltcir:"⩹",lt:"<",LT:"<",Lt:"≪",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltri:"◃",ltrie:"⊴",ltrif:"◂",ltrPar:"⦖",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",macr:"¯",male:"♂",malt:"✠",maltese:"✠",Map:"⤅",map:"↦",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",Mcy:"М",mcy:"м",mdash:"—",mDDot:"∺",measuredangle:"∡",MediumSpace:" ",Mellintrf:"ℳ",Mfr:"𝔐",mfr:"𝔪",mho:"℧",micro:"µ",midast:"*",midcir:"⫰",mid:"∣",middot:"·",minusb:"⊟",minus:"−",minusd:"∸",minusdu:"⨪",MinusPlus:"∓",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",Mopf:"𝕄",mopf:"𝕞",mp:"∓",mscr:"𝓂",Mscr:"ℳ",mstpos:"∾",Mu:"Μ",mu:"μ",multimap:"⊸",mumap:"⊸",nabla:"∇",Nacute:"Ń",nacute:"ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natural:"♮",naturals:"ℕ",natur:"♮",nbsp:" ",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",Ncaron:"Ň",ncaron:"ň",Ncedil:"Ņ",ncedil:"ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",Ncy:"Н",ncy:"н",ndash:"–",nearhk:"⤤",nearr:"↗",neArr:"⇗",nearrow:"↗",ne:"≠",nedot:"≐̸",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",nequiv:"≢",nesear:"⤨",nesim:"≂̸",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:"\n",nexist:"∄",nexists:"∄",Nfr:"𝔑",nfr:"𝔫",ngE:"≧̸",nge:"≱",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",nges:"⩾̸",nGg:"⋙̸",ngsim:"≵",nGt:"≫⃒",ngt:"≯",ngtr:"≯",nGtv:"≫̸",nharr:"↮",nhArr:"⇎",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",NJcy:"Њ",njcy:"њ",nlarr:"↚",nlArr:"⇍",nldr:"‥",nlE:"≦̸",nle:"≰",nleftarrow:"↚",nLeftarrow:"⇍",nleftrightarrow:"↮",nLeftrightarrow:"⇎",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nLl:"⋘̸",nlsim:"≴",nLt:"≪⃒",nlt:"≮",nltri:"⋪",nltrie:"⋬",nLtv:"≪̸",nmid:"∤",NoBreak:"⁠",NonBreakingSpace:" ",nopf:"𝕟",Nopf:"ℕ",Not:"⫬",not:"¬",NotCongruent:"≢",NotCupCap:"≭",NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",notin:"∉",notindot:"⋵̸",notinE:"⋹̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",NotLeftTriangleBar:"⧏̸",NotLeftTriangle:"⋪",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangleBar:"⧐̸",NotRightTriangle:"⋫",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",nparallel:"∦",npar:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",nprec:"⊀",npreceq:"⪯̸",npre:"⪯̸",nrarrc:"⤳̸",nrarr:"↛",nrArr:"⇏",nrarrw:"↝̸",nrightarrow:"↛",nRightarrow:"⇏",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",Nscr:"𝒩",nscr:"𝓃",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",nsubE:"⫅̸",nsube:"⊈",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupE:"⫆̸",nsupe:"⊉",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",Ntilde:"Ñ",ntilde:"ñ",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",Nu:"Ν",nu:"ν",num:"#",numero:"№",numsp:" ",nvap:"≍⃒",nvdash:"⊬",nvDash:"⊭",nVdash:"⊮",nVDash:"⊯",nvge:"≥⃒",nvgt:">⃒",nvHarr:"⤄",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"<⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",nwarhk:"⤣",nwarr:"↖",nwArr:"⇖",nwarrow:"↖",nwnear:"⤧",Oacute:"Ó",oacute:"ó",oast:"⊛",Ocirc:"Ô",ocirc:"ô",ocir:"⊚",Ocy:"О",ocy:"о",odash:"⊝",Odblac:"Ő",odblac:"ő",odiv:"⨸",odot:"⊙",odsold:"⦼",OElig:"Œ",oelig:"œ",ofcir:"⦿",Ofr:"𝔒",ofr:"𝔬",ogon:"˛",Ograve:"Ò",ograve:"ò",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",Omacr:"Ō",omacr:"ō",Omega:"Ω",omega:"ω",Omicron:"Ο",omicron:"ο",omid:"⦶",ominus:"⊖",Oopf:"𝕆",oopf:"𝕠",opar:"⦷",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",operp:"⦹",oplus:"⊕",orarr:"↻",Or:"⩔",or:"∨",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"ª",ordm:"º",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oS:"Ⓢ",Oscr:"𝒪",oscr:"ℴ",Oslash:"Ø",oslash:"ø",osol:"⊘",Otilde:"Õ",otilde:"õ",otimesas:"⨶",Otimes:"⨷",otimes:"⊗",Ouml:"Ö",ouml:"ö",ovbar:"⌽",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",para:"¶",parallel:"∥",par:"∥",parsim:"⫳",parsl:"⫽",part:"∂",PartialD:"∂",Pcy:"П",pcy:"п",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"‱",Pfr:"𝔓",pfr:"𝔭",Phi:"Φ",phi:"φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",Pi:"Π",pi:"π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plus:"+",plusdo:"∔",plusdu:"⨥",pluse:"⩲",PlusMinus:"±",plusmn:"±",plussim:"⨦",plustwo:"⨧",pm:"±",Poincareplane:"ℌ",pointint:"⨕",popf:"𝕡",Popf:"ℙ",pound:"£",prap:"⪷",Pr:"⪻",pr:"≺",prcue:"≼",precapprox:"⪷",prec:"≺",preccurlyeq:"≼",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",PrecedesTilde:"≾",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",pre:"⪯",prE:"⪳",precsim:"≾",prime:"′",Prime:"″",primes:"ℙ",prnap:"⪹",prnE:"⪵",prnsim:"⋨",prod:"∏",Product:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",Proportional:"∝",Proportion:"∷",propto:"∝",prsim:"≾",prurel:"⊰",Pscr:"𝒫",pscr:"𝓅",Psi:"Ψ",psi:"ψ",puncsp:" ",Qfr:"𝔔",qfr:"𝔮",qint:"⨌",qopf:"𝕢",Qopf:"ℚ",qprime:"⁗",Qscr:"𝒬",qscr:"𝓆",quaternions:"ℍ",quatint:"⨖",quest:"?",questeq:"≟",quot:'"',QUOT:'"',rAarr:"⇛",race:"∽̱",Racute:"Ŕ",racute:"ŕ",radic:"√",raemptyv:"⦳",rang:"⟩",Rang:"⟫",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"»",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarr:"→",Rarr:"↠",rArr:"⇒",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",Rarrtl:"⤖",rarrtl:"↣",rarrw:"↝",ratail:"⤚",rAtail:"⤜",ratio:"∶",rationals:"ℚ",rbarr:"⤍",rBarr:"⤏",RBarr:"⤐",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",Rcaron:"Ř",rcaron:"ř",Rcedil:"Ŗ",rcedil:"ŗ",rceil:"⌉",rcub:"}",Rcy:"Р",rcy:"р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",Re:"ℜ",rect:"▭",reg:"®",REG:"®",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",rfisht:"⥽",rfloor:"⌋",rfr:"𝔯",Rfr:"ℜ",rHar:"⥤",rhard:"⇁",rharu:"⇀",rharul:"⥬",Rho:"Ρ",rho:"ρ",rhov:"ϱ",RightAngleBracket:"⟩",RightArrowBar:"⇥",rightarrow:"→",RightArrow:"→",Rightarrow:"⇒",RightArrowLeftArrow:"⇄",rightarrowtail:"↣",RightCeiling:"⌉",RightDoubleBracket:"⟧",RightDownTeeVector:"⥝",RightDownVectorBar:"⥕",RightDownVector:"⇂",RightFloor:"⌋",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",RightTeeArrow:"↦",RightTee:"⊢",RightTeeVector:"⥛",rightthreetimes:"⋌",RightTriangleBar:"⧐",RightTriangle:"⊳",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVectorBar:"⥔",RightUpVector:"↾",RightVectorBar:"⥓",RightVector:"⇀",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",rmoustache:"⎱",rmoust:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",ropf:"𝕣",Ropf:"ℝ",roplus:"⨮",rotimes:"⨵",RoundImplies:"⥰",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",Rrightarrow:"⇛",rsaquo:"›",rscr:"𝓇",Rscr:"ℛ",rsh:"↱",Rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",RuleDelayed:"⧴",ruluhar:"⥨",rx:"℞",Sacute:"Ś",sacute:"ś",sbquo:"‚",scap:"⪸",Scaron:"Š",scaron:"š",Sc:"⪼",sc:"≻",sccue:"≽",sce:"⪰",scE:"⪴",Scedil:"Ş",scedil:"ş",Scirc:"Ŝ",scirc:"ŝ",scnap:"⪺",scnE:"⪶",scnsim:"⋩",scpolint:"⨓",scsim:"≿",Scy:"С",scy:"с",sdotb:"⊡",sdot:"⋅",sdote:"⩦",searhk:"⤥",searr:"↘",seArr:"⇘",searrow:"↘",sect:"§",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",Sfr:"𝔖",sfr:"𝔰",sfrown:"⌢",sharp:"♯",SHCHcy:"Щ",shchcy:"щ",SHcy:"Ш",shcy:"ш",ShortDownArrow:"↓",ShortLeftArrow:"←",shortmid:"∣",shortparallel:"∥",ShortRightArrow:"→",ShortUpArrow:"↑",shy:"­",Sigma:"Σ",sigma:"σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",SmallCircle:"∘",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",SOFTcy:"Ь",softcy:"ь",solbar:"⌿",solb:"⧄",sol:"/",Sopf:"𝕊",sopf:"𝕤",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",Sqrt:"√",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",square:"□",Square:"□",SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",squarf:"▪",squ:"□",squf:"▪",srarr:"→",Sscr:"𝒮",sscr:"𝓈",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",Star:"⋆",star:"☆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"¯",sub:"⊂",Sub:"⋐",subdot:"⪽",subE:"⫅",sube:"⊆",subedot:"⫃",submult:"⫁",subnE:"⫋",subne:"⊊",subplus:"⪿",subrarr:"⥹",subset:"⊂",Subset:"⋐",subseteq:"⊆",subseteqq:"⫅",SubsetEqual:"⊆",subsetneq:"⊊",subsetneqq:"⫋",subsim:"⫇",subsub:"⫕",subsup:"⫓",succapprox:"⪸",succ:"≻",succcurlyeq:"≽",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",SuchThat:"∋",sum:"∑",Sum:"∑",sung:"♪",sup1:"¹",sup2:"²",sup3:"³",sup:"⊃",Sup:"⋑",supdot:"⪾",supdsub:"⫘",supE:"⫆",supe:"⊇",supedot:"⫄",Superset:"⊃",SupersetEqual:"⊇",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supnE:"⫌",supne:"⊋",supplus:"⫀",supset:"⊃",Supset:"⋑",supseteq:"⊇",supseteqq:"⫆",supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swarhk:"⤦",swarr:"↙",swArr:"⇙",swarrow:"↙",swnwar:"⤪",szlig:"ß",Tab:"\t",target:"⌖",Tau:"Τ",tau:"τ",tbrk:"⎴",Tcaron:"Ť",tcaron:"ť",Tcedil:"Ţ",tcedil:"ţ",Tcy:"Т",tcy:"т",tdot:"⃛",telrec:"⌕",Tfr:"𝔗",tfr:"𝔱",there4:"∴",therefore:"∴",Therefore:"∴",Theta:"Θ",theta:"θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",ThickSpace:"  ",ThinSpace:" ",thinsp:" ",thkap:"≈",thksim:"∼",THORN:"Þ",thorn:"þ",tilde:"˜",Tilde:"∼",TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",timesbar:"⨱",timesb:"⊠",times:"×",timesd:"⨰",tint:"∭",toea:"⤨",topbot:"⌶",topcir:"⫱",top:"⊤",Topf:"𝕋",topf:"𝕥",topfork:"⫚",tosa:"⤩",tprime:"‴",trade:"™",TRADE:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",TripleDot:"⃛",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",Tscr:"𝒯",tscr:"𝓉",TScy:"Ц",tscy:"ц",TSHcy:"Ћ",tshcy:"ћ",Tstrok:"Ŧ",tstrok:"ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",Uacute:"Ú",uacute:"ú",uarr:"↑",Uarr:"↟",uArr:"⇑",Uarrocir:"⥉",Ubrcy:"Ў",ubrcy:"ў",Ubreve:"Ŭ",ubreve:"ŭ",Ucirc:"Û",ucirc:"û",Ucy:"У",ucy:"у",udarr:"⇅",Udblac:"Ű",udblac:"ű",udhar:"⥮",ufisht:"⥾",Ufr:"𝔘",ufr:"𝔲",Ugrave:"Ù",ugrave:"ù",uHar:"⥣",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",Umacr:"Ū",umacr:"ū",uml:"¨",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",Uogon:"Ų",uogon:"ų",Uopf:"𝕌",uopf:"𝕦",UpArrowBar:"⤒",uparrow:"↑",UpArrow:"↑",Uparrow:"⇑",UpArrowDownArrow:"⇅",updownarrow:"↕",UpDownArrow:"↕",Updownarrow:"⇕",UpEquilibrium:"⥮",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",UpperLeftArrow:"↖",UpperRightArrow:"↗",upsi:"υ",Upsi:"ϒ",upsih:"ϒ",Upsilon:"Υ",upsilon:"υ",UpTeeArrow:"↥",UpTee:"⊥",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",Uring:"Ů",uring:"ů",urtri:"◹",Uscr:"𝒰",uscr:"𝓊",utdot:"⋰",Utilde:"Ũ",utilde:"ũ",utri:"▵",utrif:"▴",uuarr:"⇈",Uuml:"Ü",uuml:"ü",uwangle:"⦧",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",varr:"↕",vArr:"⇕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",vBar:"⫨",Vbar:"⫫",vBarv:"⫩",Vcy:"В",vcy:"в",vdash:"⊢",vDash:"⊨",Vdash:"⊩",VDash:"⊫",Vdashl:"⫦",veebar:"⊻",vee:"∨",Vee:"⋁",veeeq:"≚",vellip:"⋮",verbar:"|",Verbar:"‖",vert:"|",Vert:"‖",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",Vfr:"𝔙",vfr:"𝔳",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",Vopf:"𝕍",vopf:"𝕧",vprop:"∝",vrtri:"⊳",Vscr:"𝒱",vscr:"𝓋",vsubnE:"⫋︀",vsubne:"⊊︀",vsupnE:"⫌︀",vsupne:"⊋︀",Vvdash:"⊪",vzigzag:"⦚",Wcirc:"Ŵ",wcirc:"ŵ",wedbar:"⩟",wedge:"∧",Wedge:"⋀",wedgeq:"≙",weierp:"℘",Wfr:"𝔚",wfr:"𝔴",Wopf:"𝕎",wopf:"𝕨",wp:"℘",wr:"≀",wreath:"≀",Wscr:"𝒲",wscr:"𝓌",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",Xfr:"𝔛",xfr:"𝔵",xharr:"⟷",xhArr:"⟺",Xi:"Ξ",xi:"ξ",xlarr:"⟵",xlArr:"⟸",xmap:"⟼",xnis:"⋻",xodot:"⨀",Xopf:"𝕏",xopf:"𝕩",xoplus:"⨁",xotime:"⨂",xrarr:"⟶",xrArr:"⟹",Xscr:"𝒳",xscr:"𝓍",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",Yacute:"Ý",yacute:"ý",YAcy:"Я",yacy:"я",Ycirc:"Ŷ",ycirc:"ŷ",Ycy:"Ы",ycy:"ы",yen:"¥",Yfr:"𝔜",yfr:"𝔶",YIcy:"Ї",yicy:"ї",Yopf:"𝕐",yopf:"𝕪",Yscr:"𝒴",yscr:"𝓎",YUcy:"Ю",yucy:"ю",yuml:"ÿ",Yuml:"Ÿ",Zacute:"Ź",zacute:"ź",Zcaron:"Ž",zcaron:"ž",Zcy:"З",zcy:"з",Zdot:"Ż",zdot:"ż",zeetrf:"ℨ",ZeroWidthSpace:"​",Zeta:"Ζ",zeta:"ζ",zfr:"𝔷",Zfr:"ℨ",ZHcy:"Ж",zhcy:"ж",zigrarr:"⇝",zopf:"𝕫",Zopf:"ℤ",Zscr:"𝒵",zscr:"𝓏",zwj:"‍",zwnj:"‌"}},function(t,e){t.exports={Aacute:"Á",aacute:"á",Acirc:"Â",acirc:"â",acute:"´",AElig:"Æ",aelig:"æ",Agrave:"À",agrave:"à",amp:"&",AMP:"&",Aring:"Å",aring:"å",Atilde:"Ã",atilde:"ã",Auml:"Ä",auml:"ä",brvbar:"¦",Ccedil:"Ç",ccedil:"ç",cedil:"¸",cent:"¢",copy:"©",COPY:"©",curren:"¤",deg:"°",divide:"÷",Eacute:"É",eacute:"é",Ecirc:"Ê",ecirc:"ê",Egrave:"È",egrave:"è",ETH:"Ð",eth:"ð",Euml:"Ë",euml:"ë",frac12:"½",frac14:"¼",frac34:"¾",gt:">",GT:">",Iacute:"Í",iacute:"í",Icirc:"Î",icirc:"î",iexcl:"¡",Igrave:"Ì",igrave:"ì",iquest:"¿",Iuml:"Ï",iuml:"ï",laquo:"«",lt:"<",LT:"<",macr:"¯",micro:"µ",middot:"·",nbsp:" ",not:"¬",Ntilde:"Ñ",ntilde:"ñ",Oacute:"Ó",oacute:"ó",Ocirc:"Ô",ocirc:"ô",Ograve:"Ò",ograve:"ò",ordf:"ª",ordm:"º",Oslash:"Ø",oslash:"ø",Otilde:"Õ",otilde:"õ",Ouml:"Ö",ouml:"ö",para:"¶",plusmn:"±",pound:"£",quot:'"',QUOT:'"',raquo:"»",reg:"®",REG:"®",sect:"§",shy:"­",sup1:"¹",sup2:"²",sup3:"³",szlig:"ß",THORN:"Þ",thorn:"þ",times:"×",Uacute:"Ú",uacute:"ú",Ucirc:"Û",ucirc:"û",Ugrave:"Ù",ugrave:"ù",uml:"¨",Uuml:"Ü",uuml:"ü",Yacute:"Ý",yacute:"ý",yen:"¥",yuml:"ÿ"}},function(t,e){t.exports={amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(t){return"function"==typeof t}function i(t){return"object"==typeof t&&null!==t}function o(t){return void 0===t}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var e,n,a,s,u,l;if(this._events||(this._events={}),"error"===t&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var c=new Error('Uncaught, unspecified "error" event. ('+e+")");throw c.context=e,c}if(o(n=this._events[t]))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(i(n))for(s=Array.prototype.slice.call(arguments,1),a=(l=n.slice()).length,u=0;u<a;u++)l[u].apply(this,s);return!0},n.prototype.addListener=function(t,e){var a;if(!r(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,r(e.listener)?e.listener:e),this._events[t]?i(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,i(this._events[t])&&!this._events[t].warned&&(a=o(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&a>0&&this._events[t].length>a&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,e){if(!r(e))throw TypeError("listener must be a function");var n=!1;function i(){this.removeListener(t,i),n||(n=!0,e.apply(this,arguments))}return i.listener=e,this.on(t,i),this},n.prototype.removeListener=function(t,e){var n,o,a,s;if(!r(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(a=(n=this._events[t]).length,o=-1,n===e||r(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(i(n)){for(s=a;s-- >0;)if(n[s]===e||n[s].listener&&n[s].listener===e){o=s;break}if(o<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},n.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r(n=this._events[t]))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){return this._events&&this._events[t]?r(this._events[t])?[this._events[t]]:this._events[t].slice():[]},n.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(r(e))return 1;if(e)return e.length}return 0},n.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e,n){var r=n(524),i=/\s+/g,o=n(265),a=n(525);function s(t,e,n){"object"==typeof t?(n=e,e=t,t=null):"function"==typeof e&&(n=e,e=u),this._callback=t,this._options=e||u,this._elementCB=n,this.dom=[],this._done=!1,this._tagStack=[],this._parser=this._parser||null}var u={normalizeWhitespace:!1,withStartIndices:!1,withEndIndices:!1};s.prototype.onparserinit=function(t){this._parser=t},s.prototype.onreset=function(){s.call(this,this._callback,this._options,this._elementCB)},s.prototype.onend=function(){this._done||(this._done=!0,this._parser=null,this._handleCallback(null))},s.prototype._handleCallback=s.prototype.onerror=function(t){if("function"==typeof this._callback)this._callback(t,this.dom);else if(t)throw t},s.prototype.onclosetag=function(){var t=this._tagStack.pop();this._options.withEndIndices&&(t.endIndex=this._parser.endIndex),this._elementCB&&this._elementCB(t)},s.prototype._createDomElement=function(t){if(!this._options.withDomLvl1)return t;var e;e="tag"===t.type?Object.create(a):Object.create(o);for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},s.prototype._addDomElement=function(t){var e=this._tagStack[this._tagStack.length-1],n=e?e.children:this.dom,r=n[n.length-1];t.next=null,this._options.withStartIndices&&(t.startIndex=this._parser.startIndex),this._options.withEndIndices&&(t.endIndex=this._parser.endIndex),r?(t.prev=r,r.next=t):t.prev=null,n.push(t),t.parent=e||null},s.prototype.onopentag=function(t,e){var n={type:"script"===t?r.Script:"style"===t?r.Style:r.Tag,name:t,attribs:e,children:[]},i=this._createDomElement(n);this._addDomElement(i),this._tagStack.push(i)},s.prototype.ontext=function(t){var e,n=this._options.normalizeWhitespace||this._options.ignoreWhitespace;if(!this._tagStack.length&&this.dom.length&&(e=this.dom[this.dom.length-1]).type===r.Text)n?e.data=(e.data+t).replace(i," "):e.data+=t;else if(this._tagStack.length&&(e=this._tagStack[this._tagStack.length-1])&&(e=e.children[e.children.length-1])&&e.type===r.Text)n?e.data=(e.data+t).replace(i," "):e.data+=t;else{n&&(t=t.replace(i," "));var o=this._createDomElement({data:t,type:r.Text});this._addDomElement(o)}},s.prototype.oncomment=function(t){var e=this._tagStack[this._tagStack.length-1];if(e&&e.type===r.Comment)e.data+=t;else{var n={data:t,type:r.Comment},i=this._createDomElement(n);this._addDomElement(i),this._tagStack.push(i)}},s.prototype.oncdatastart=function(){var t={children:[{data:"",type:r.Text}],type:r.CDATA},e=this._createDomElement(t);this._addDomElement(e),this._tagStack.push(e)},s.prototype.oncommentend=s.prototype.oncdataend=function(){this._tagStack.pop()},s.prototype.onprocessinginstruction=function(t,e){var n=this._createDomElement({name:t,data:e,type:r.Directive});this._addDomElement(n)},t.exports=s},function(t,e){t.exports={Text:"text",Directive:"directive",Comment:"comment",Script:"script",Style:"style",Tag:"tag",CDATA:"cdata",Doctype:"doctype",isTag:function(t){return"tag"===t.type||"script"===t.type||"style"===t.type}}},function(t,e,n){var r=n(265),i=t.exports=Object.create(r),o={tagName:"name"};Object.keys(o).forEach(function(t){var e=o[t];Object.defineProperty(i,t,{get:function(){return this[e]||null},set:function(t){return this[e]=t,t}})})},function(t,e,n){"use strict";t.exports={shouldProcessEveryNode:function(t){return!0}}},function(t,e,n){var r=n(528),i=n(533);t.exports=i(function(t){return r(t,!0)})},function(t,e,n){var r=n(529),i=n(532);t.exports=function(t,e){return t=r(t).replace(/[-_\s]+(.)?/g,function(t,e){return e?e.toUpperCase():""}),!0===e?i(t):t}},function(t,e,n){var r=n(175),i=n(530),o=String.prototype.trim;t.exports=function(t,e){return t=r(t),!e&&o?o.call(t):(e=i(e),t.replace(new RegExp("^"+e+"+|"+e+"+$","g"),""))}},function(t,e,n){var r=n(531);t.exports=function(t){return null==t?"\\s":t.source?t.source:"["+r(t)+"]"}},function(t,e,n){var r=n(175);t.exports=function(t){return r(t).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}},function(t,e,n){var r=n(175);t.exports=function(t){return(t=r(t)).charAt(0).toLowerCase()+t.slice(1)}},function(t,e,n){var r=n(534),i=n(536),o=Array.prototype.slice;function a(t,e,n){return function(){var s=o.call(arguments),u=n.concat(s),l=[];return e<=i(u)?(l=r(s,n),t.apply(null,l)):e>=u.length?a(t,e,u):a(t,e,r(s,n))}}t.exports=function(t){var e=o.call(arguments,1);return a(t,t.length,e)},t.exports.n=function(t,e){return a(t,e,o.call(arguments,2))},t.exports.__=void 0},function(t,e,n){var r=n(535);t.exports=function(t,e){return r(e,function(e,n){return void 0===n?t.shift():n}).concat(t)}},function(t,e,n){var r=n(269);t.exports=function(t,e){var n=[];return r(t,function(t,r){n.push(e(t,r))}),n}},function(t,e,n){var r=n(269);t.exports=function(t){var e=0;return r(t,function(t,n){void 0!==n&&(e+=1)}),e}},function(t,e,n){var r=n(60),i=n(174),o=r(function(t){var e=[];for(var n in t)i(n,t)&&(e[e.length]=[n,t[n]]);return e});t.exports=o},function(t,e,n){var r=n(539)(n(172));t.exports=r},function(t,e,n){var r=n(60),i=n(37),o=n(117);t.exports=function(t){return function e(n,a,s){switch(arguments.length){case 0:return e;case 1:return o(n)?e:i(function(e,r){return t(n,e,r)});case 2:return o(n)&&o(a)?e:o(n)?i(function(e,n){return t(e,a,n)}):o(a)?i(function(e,r){return t(n,e,r)}):r(function(e){return t(n,a,e)});default:return o(n)&&o(a)&&o(s)?e:o(n)&&o(a)?i(function(e,n){return t(e,n,s)}):o(n)&&o(s)?i(function(e,n){return t(e,a,n)}):o(a)&&o(s)?i(function(e,r){return t(n,e,r)}):o(n)?r(function(e){return t(e,a,s)}):o(a)?r(function(e){return t(n,e,s)}):o(s)?r(function(e){return t(n,a,e)}):t(n,a,s)}}}},function(t,e,n){"use strict";var r=["accept","acceptCharset","accessKey","action","allowFullScreen","allowTransparency","alt","async","autoComplete","autoFocus","autoPlay","capture","cellPadding","cellSpacing","challenge","charSet","checked","cite","classID","className","colSpan","cols","content","contentEditable","contextMenu","controls","coords","crossOrigin","data","dateTime","default","defer","dir","disabled","download","draggable","encType","form","formAction","formEncType","formMethod","formNoValidate","formTarget","frameBorder","headers","height","hidden","high","href","hrefLang","htmlFor","httpEquiv","icon","id","inputMode","integrity","is","keyParams","keyType","kind","label","lang","list","loop","low","manifest","marginHeight","marginWidth","max","maxLength","media","mediaGroup","method","min","minLength","multiple","muted","name","noValidate","nonce","open","optimum","pattern","placeholder","poster","preload","profile","radioGroup","readOnly","rel","required","reversed","role","rowSpan","rows","sandbox","scope","scoped","scrolling","seamless","selected","shape","size","sizes","span","spellCheck","src","srcDoc","srcLang","srcSet","start","step","style","summary","tabIndex","target","title","type","useMap","value","width","wmode","wrap"].concat(["autoCapitalize","autoCorrect","color","itemProp","itemScope","itemType","itemRef","itemID","security","unselectable","results","autoSave"]).concat(["accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baseProfile","baselineShift","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","ideographic","imageRendering","in","in2","intercept","k","k1","k2","k3","k4","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","points","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","scale","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","vHanging","vIdeographic","vMathematical","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","viewBox","viewTarget","visibility","widths","wordSpacing","writingMode","x","x1","x2","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlns","xmlnsXlink","xmlBase","xmlLang","xmlSpace","y","y1","y2","yChannelSelector","z","zoomAndPan"]).reduce(function(t,e){var n=e.toLowerCase();return n!==e&&(t[n]=e),t},{});t.exports=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=f(n(94)),i=f(n(114)),o=f(n(19)),a=f(n(9)),s=f(n(10)),u=f(n(20)),l=f(n(21)),c=n(254),h=f(c),p=f(n(2));function f(t){return t&&t.__esModule?t:{default:t}}var d=n(95),m=new(0,n(261).Parser),g=function(t){function e(t){(0,a.default)(this,e);var n=(0,u.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t)),s={retrieveLocale:function(){return n.props.locale},retrieveItem:function(t){return n.props.items[t]},variableWrapper:function(t,e,n,r){return"title"===t.variableNames[0]&&t.itemData.URL&&"bibliography"===t.context?e+'<a href="'+t.itemData.URL+'" target="blank">'+n+"</a>"+r:"URL"===t.variableNames[0]?e+'<a href="'+n+'" target="blank">'+n+"</a>"+r:e+n+r}};n.makeReactBibliography=function(t,e){t.updateItems((0,i.default)(e));var n=t.makeBibliography()[1].join("\n");return m.parse(n)},n.makeReactCitations=function(t,e){return e.reduce(function(e,n){var i=(0,r.default)({},e),o=n[0],a=n[1],s=n[2],u=t.processCitationCluster(o,a,s);return(u=u[1]).forEach(function(t){var e=t[0],n=t[1],r=m.parse(t[1]),o=t[2];i[o]={order:e,html:n,Component:r}}),i},{})};var l=new d.Engine(s,t.style);return n.state={sys:s,bibliography:t.items&&t.style&&t.locale?n.makeReactBibliography(l,t.items):void 0,citations:t.citations&&t.style&&t.locale?n.makeReactCitations(l,t.citations):void 0,citationStyle:t.citations&&t.style,citationLocale:t.citations&&t.locale},n}return(0,l.default)(e,t),(0,s.default)(e,[{key:"getChildContext",value:function(){return{bibliography:this.state.bibliography,citations:this.state.citations,citationStyle:this.props.style,citationLocale:this.props.locale}}},{key:"componentDidMount",value:function(){if(this.props.locale&&this.props.style){var t=new d.Engine(this.state.sys,this.props.style);this.setState({processor:t,citations:this.props.citations&&this.props.citations.length?this.makeReactCitations(t,this.props.citations):void 0,bibliography:this.props.items&&this.props.items.length?this.makeReactBibliography(t,this.props.items):void 0})}}},{key:"componentWillReceiveProps",value:function(t){if(!this.state.processor&&this.props.locale&&this.props.style){var e=new d.Engine(this.state.sys,t.style);this.setState({processor:e})}}},{key:"componentDidUpdate",value:function(t){var e=this;if(this.props.items&&(0,i.default)(this.props.items).length){if((this.state.processor&&this.props.items!==t.items||this.props.citations!==t.citations||!this.state.bibliography)&&this.setState({citations:this.props.citations&&this.makeReactCitations(this.state.processor,this.props.citations),bibliography:this.makeReactBibliography(this.state.processor,this.props.items)}),this.props.locale!==t.locale){var n={retrieveLocale:function(){return e.props.locale},retrieveItem:function(t){return e.props.items[t]},variableWrapper:function(t,e,n,r){return"title"===t.variableNames[0]&&t.itemData.URL&&"bibliography"===t.context?e+'<a href="'+t.itemData.URL+'" target="blank">'+n+"</a>"+r:"URL"===t.variableNames[0]?e+'<a href="'+n+'" target="blank">'+n+"</a>"+r:e+n+r}},r=new d.Engine(n,this.props.style);this.setState({processor:r,citations:this.props.citations&&this.makeReactCitations(r,this.props.citations),bibliography:this.makeReactBibliography(r,this.props.items),sys:n})}if(this.props.style!==t.style){var o=new d.Engine(this.state.sys,this.props.style);this.setState({processor:o,citations:this.props.citations&&this.makeReactCitations(o,this.props.citations),bibliography:this.makeReactBibliography(o,this.props.items)})}}}},{key:"render",value:function(){var t=this.props,e=t.componentClass,n=t.children;return h.default.createElement("div",{className:e},n)}}]),e}(c.Component);g.propTypes={componentClass:p.default.string,style:p.default.string,locale:p.default.string,items:p.default.object,citations:p.default.array},g.childContextTypes={bibliography:p.default.array,citations:p.default.object,citationLocale:p.default.string,citationStyle:p.default.string},e.default=g,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(114),o=(r=i)&&r.__esModule?r:{default:r};e.default=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!e||!n)return;var i={retrieveLocale:function(){return n},retrieveItem:function(e){return t[e]},variableWrapper:function(t,e,n,r){return"title"===t.variableNames[0]&&t.itemData.URL&&"bibliography"===t.context?e+'<a href="'+t.itemData.URL+'" target="blank">'+n+"</a>"+r:"URL"===t.variableNames[0]?e+'<a href="'+n+'" target="blank">'+n+"</a>"+r:e+n+r}},s=new a.Engine(i,e);return s.updateItems((0,o.default)(t)),s.makeBibliography(r)};var a=n(95);t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=u(n(1)),i=u(n(2)),o=u(n(176)),a=u(n(702)),s=n(169);function u(t){return t&&t.__esModule?t:{default:t}}var l=function(t,e){var n=t.composition,i=t.renderingMode,u=t.assets,l=t.resources,c=e.NoteContentPointer,h=e.citationStyle,p=e.citationLocale,f=e.citationItems,d=e.t;return r.default.createElement("div",{className:"metis-DynamicArticleTemplate"},r.default.createElement("h2",{className:"composition-title"},n.metadata.title),n.metadata.subtitle&&r.default.createElement("h3",{className:"composition-subtitle"},n.metadata.subtitle),n.metadata.creators.length?r.default.createElement("div",{className:"composition-creators"},n.metadata.creators.map(function(t,e){return r.default.createElement("span",{className:"creator",key:e},!!e&&", ",t.given," ",t.family)})):null,r.default.createElement("section",null,r.default.createElement(o.default,{raw:n.contents,renderingMode:i,contextualizations:n.contextualizations,contextualizers:n.contextualizers,resources:l,assets:u,notes:n.notes,NoteContentPointer:c})),n.notesOrder.length?r.default.createElement("section",{className:"notes-container"},r.default.createElement("h3",null,d("Notes")),r.default.createElement("section",null,r.default.createElement("ul",{className:"notes-wrapper"},n.notesOrder.map(function(t){var e=n.notes[t];return r.default.createElement("li",{key:t,className:"note-wrapper"},r.default.createElement(a.default,{note:e,noteId:t,composition:n,resources:l,renderingMode:i,assets:u}))})))):null,Object.keys(f).length?r.default.createElement("section",{className:"bibliography-container"},r.default.createElement("h3",null,d("Références")),r.default.createElement(s.Bibliography,{style:h,locale:p,items:f})):null,n.metadata.creators.length?r.default.createElement("div",{className:"creators-info-container"},r.default.createElement("h3",null,n.metadata.creators.length>1?d("Auteur.e.s"):d("Auteur.e")),n.metadata.creators.map(function(t,e){return r.default.createElement("div",{className:"creator-info",key:e},r.default.createElement("h4",null,t.given," ",t.family),t.role&&r.default.createElement("h5",null,t.role),t.presentation&&r.default.createElement("p",null,t.presentation))})):null)};e.default=l,l.contextTypes={NoteContentPointer:i.default.oneOfType([i.default.func,i.default.element]),citationStyle:i.default.string,citationLocale:i.default.string,citationItems:i.default.object,t:i.default.func}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.renderNode=e.RawParser=e.createStylesRenderer=void 0;var r=a(n(271)),i=a(n(547)),o=n(548);function a(t){return t&&t.__esModule?t:{default:t}}e.createStylesRenderer=i.default,e.RawParser=r.default,e.renderNode=o.renderNode,e.default=o.render},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(546),a=(r=o)&&r.__esModule?r:{default:r};var s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.content=e.content||[],this.start=void 0!==e.start?e.start:null,this.end=void 0!==e.end?e.end:null,this.entity=void 0!==e.entity?e.entity:null,this.decorator=void 0!==e.decorator?e.decorator:null,this.decoratorProps=e.decoratorProps||null,this.decoratedText=void 0!==e.decoratedText?e.decoratedText:null,this.contentState=e.contentState,this.style=e.style||null,this.styles=e.styles||null,this.block=e.block||{}}return i(t,[{key:"getCurrentContent",value:function(){return this.content[this.content.length-1]}},{key:"addToCurrentContent",value:function(t){this.content[this.content.length-1]=this.content[this.content.length-1]+t}},{key:"handleFlatPush",value:function(e,n){var r=this.getCurrentContent();if(r instanceof t&&(0,a.default)(n,r.styles))r.addToCurrentContent(e);else{var i=new t({styles:[].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(n)),content:[e]});this.content.push(i)}}},{key:"pushContent",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!n||n.length<1)return"string"==typeof e&&"string"==typeof this.getCurrentContent()?this.addToCurrentContent(e):this.content.push(e),this;if(r)return this.handleFlatPush(e,n),this;var i,o=(i=n,Array.isArray(i)?i:Array.from(i)),a=o[0],s=o.slice(1),u=this.getCurrentContent();if(u instanceof t&&u.style===a)u.pushContent(e,s,r);else{var l=new t({style:a});l.pushContent(e,s,r),this.content.push(l)}return this}}]),t}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t,e){if(t.length!==e.length)return!1;for(var n=0;n++;n<t.length)if(t[n]!==e[n])return!1;return!0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t,e){return function(n,r,i){var o,a=(o=e,r.map(function(t){return o[t]}).reduce(function(t,e){var n={};if(void 0!==e){var r="text-decoration"in e?"text-decoration":"textDecoration";e[r]!==t[r]&&(n[r]=[t[r],e[r]].join(" ").trim())}return Object.assign(t,e,n)},{}));return t(Object.assign({},{children:n},i,{style:a}))}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.render=e.renderNode=void 0;var r=h(n(271)),i=h(n(549)),o=h(n(550)),a=h(n(551)),s=h(n(552)),u=h(n(553)),l=h(n(554)),c=h(n(555));function h(t){return t&&t.__esModule?t:{default:t}}var p=e.renderNode=function t(e,n,r,i,o,a,l){if(e.styles&&i)return i((0,s.default)(e.content,a),e.styles,{key:l()});var c=[],h=0;if(e.content.forEach(function(e){"string"==typeof e?c=(0,u.default)(e,c,h):(c[h+=1]=t(e,n,r,i,o,a,l),h+=1)}),e.style&&n[e.style])return n[e.style]((0,s.default)(c,a),{key:l()});if(null!==e.entity){var p=o[e.entity];if(p&&r[p.type])return r[p.type]((0,s.default)(c,a),p.data,{key:e.entity})}if(null!==e.decorator){var f=[e.block.key,e.start,0].join(".");return e.decorator(Object.assign({children:(0,s.default)(c,a),decoratedText:e.decoratedText,contentState:e.contentState,entityKey:e.entity,offsetKey:f,key:f},e.decoratorProps))}return c},f=function(t,e,n,r){var i=r.prevType,o=r.prevDepth,a=r.prevKeys,s=r.prevData;0!==t.length&&(e[i]?n.push(e[i](t,{depth:o,keys:a,data:s})):n.push(t))};e.render=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t||!Array.isArray(t.blocks))return(0,i.default)("invalid raw object"),null;if(!t.blocks.length)return null;var u,h,d,m,g=e.inline,v=e.blocks,y=e.entities,b=e.styles,_=e.decorators,x=_||n.Decorator?(0,c.default)(t,_,n):t.blocks;return function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=arguments[4],h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},d=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},m=Object.assign({},l.default,d),g=[],v=[],y=null,b=0,_=[],x=[],w=!1,E=new r.default({flat:!!c});return e.forEach(function(e){if((0,o.default)(e,y,m))!0===m.cleanup.split&&(w=!0);else{var r=E.parse(e),s=p(r,n,u,c,h,m,(0,a.default)());if((y&&y!==e.type||w)&&(f(v,i,g,{prevType:y,prevDepth:b,prevKeys:_,prevData:x}),x=[],_=[],v=[],w=!1),e.children){var l=t(e.children,n,i,u,c,h,m);s.push(l)}v.push(s),y=e.type,b=e.depth,_.push(e.key),x.push(e.data)}}),f(v,i,g,{prevType:y,prevDepth:b,prevKeys:_,prevData:x}),(0,s.default)(g,m)}((u=[],h=[],d=0,m=function(t){var e=d-t;for(h.length<e&&(e=h.length);e>0;e-=1){var n=u;(u=h.pop())[u.length-1].children=n}},x.forEach(function(t){d<t.depth?(h.push(u),u=[]):d>t.depth&&m(t.depth),d=t.depth,u.push(t)}),0!==d&&m(0),u),g,v,y,b,t.entityMap,n)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t){}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t,e,n){var r,i,o,a=n.cleanup;return!(!a||(r=t,i=a,o=r.text,!(i.trim?!o.trim():!o)||r.data&&Object.keys(r.data).length||r.entityRanges&&r.entityRanges.length)||a.after&&"all"!==a.after&&-1===a.after.indexOf(e)||(!a.except||-1!==a.except.indexOf(t.type))&&(!a.types||"all"!==a.types&&-1===a.types.indexOf(t.type)))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(){var t=0;return function(){var e=t;return t+=1,e}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t,e){return Array.isArray(t)&&e.joinOutput?t.join(""):t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t,e,n){var r=e;return e[n]?r[n]+=t:r[n]=t,r}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default={joinOutput:!1,cleanup:{after:["atomic"],types:["unstyled"],trim:!1,split:!0}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=o(n(556)),i=o(n(557));function o(t){return t&&t.__esModule?t:{default:t}}e.default=function(t,e,n){var o=n.convertFromRaw&&n.convertFromRaw(t);return t.blocks.map(function(t){return a=t,s=e,u=o,c=(l=n||{}).createContentBlock,h=l.Decorator,p=[],f=new(void 0===h?r.default:h)(s),d=c?c(a):(0,i.default)(a),m=f.getDecorations(d,u).toArray(),g=0,m.forEach(function(t,e){if(t){var n=e+1,r=m[n];r&&r===t||(p.push({offset:g,length:n-g,component:f.getComponentForKey(t),decoratorProps:f.getPropsForKey(t)||{},contentState:u}),g=n)}else g+=1}),Object.assign({},a,{decoratorRanges:p});var a,s,u,l,c,h,p,f,d,m,g})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.decorators=e.slice()}return r(t,[{key:"getDecorations",value:function(t,e){var n,r=Array(t.getText().length).fill(null);return this.decorators.forEach(function(n,i){var o=0;(0,n.strategy)(t,function(t,e){(function(t,e,n){for(var r=e;r<n;r++)if(null!=t[r])return!1;return!0})(r,t,e)&&(function(t,e,n,r){for(var i=e;i<n;i++)t[i]=r}(r,t,e,i+"."+o),o++)},e)}),n=r,{toArray:function(){return n}}}},{key:"getComponentForKey",value:function(t){var e=parseInt(t.split(".")[0],10);return this.decorators[e].component}},{key:"getPropsForKey",value:function(t){var e=parseInt(t.split(".")[0],10);return this.decorators[e].props}}]),t}();e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object.assign(this,e)}return r(t,[{key:"get",value:function(t){return this[t]}},{key:"getText",value:function(){return this.text}},{key:"getType",value:function(){return this.type}},{key:"getKey",value:function(){return this.key}},{key:"getLength",value:function(){return this.text.length}},{key:"getDepth",value:function(){return this.depth}},{key:"getData",value:function(){return this.data}}]),t}();e.default=function(t){return new i(t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=o(n(1)),i=o(n(2));function o(t){return t&&t.__esModule?t:{default:t}}var a=function(t){var e=t.to,n=t.children;return r.default.createElement("a",{href:e,target:"blank"},n)};a.propTypes={to:i.default.string,children:i.default.array},e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(1),o=u(i),a=u(n(2)),s=u(n(273));function u(t){return t&&t.__esModule?t:{default:t}}var l=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i.Component),r(e,[{key:"shouldComponentUpdate",value:function(){return!0}},{key:"render",value:function(){var t=this.props.data,e=this.context,n=e.bindBlockContextualization,r=e.renderingMode,i=e.contextualizations,a=e.contextualizers,u=e.resources,l=t.asset.id,c=i[l];if(!c)return null;var h=a[c.contextualizerId],p=u[c.resourceId];if(!h||!p)return null;var f=s.default[h.type],d=f&&f.Block;return c&&d?o.default.createElement("figure",{ref:function(t){"function"==typeof n&&n(l,t)},className:"BlockAssetWrapper "+h.type,style:{position:"relative"},id:l},o.default.createElement(d,{resource:p,contextualizer:h,contextualization:c,renderingMode:r}),o.default.createElement("figcaption",null,o.default.createElement("h4",{className:"figure-title"},c.title||p.metadata.name),c.legend||p.metadata.description.length?o.default.createElement("p",null,c.legend||p.metadata.description):null,p.metadata.creators&&p.metadata.creators.length?o.default.createElement("p",{className:"creator-container"},p.metadata.creators.map(function(t,e){return o.default.createElement("i",{key:e,className:"creator"},t.given," ",t.family)})):null)):null}}]),e}();l.propTypes={data:a.default.shape({asset:a.default.shape({id:a.default.string})})},l.contextTypes={dimensions:a.default.object,bindBlockContextualization:a.default.func,renderingMode:a.default.string,contextualizations:a.default.object,contextualizers:a.default.object,resources:a.default.object,assets:a.default.object},e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.meta=e.Inline=e.Block=void 0;var r=a(n(561)),i=a(n(572)),o=a(n(274));function a(t){return t&&t.__esModule?t:{default:t}}e.Block=r.default,e.Inline=i.default,e.meta=o.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=u(n(1)),i=u(n(2)),o=u(n(274)),a=n(50),s=u(n(562));function u(t){return t&&t.__esModule?t:{default:t}}var l=function(t,e){var n=t.resource,i=t.renderingMode,u=e.assetsData,l=e.getAssetUri,c=(0,a.pickAsset)(n,o.default.assetPickingRules.image[i],u);if(c){var h=l(c.asset);switch(i){case"web":return r.default.createElement(s.default,{assetUri:h,resource:n});case"pdf":case"epub-reflowable":case"epub-fixed":case"micro":return r.default.createElement("img",{src:h});default:return null}}return null};l.contextTypes={assetsData:i.default.object,getAssetUri:i.default.func},e.default=l},function(t,e,n){"use strict";var r,i;Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(1),s=c(a),u=c(n(563)),l=c(n(177));function c(t){return t&&t.__esModule?t:{default:t}}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function f(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var d=null,m=new Function("try {return this===window;}catch(e){ return false;}")();m&&(d=n(571).default);var g=function(t){function e(){return h(this,e),p(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return f(e,a.Component),o(e,[{key:"shouldComponentUpdate",value:function(){return!0}},{key:"render",value:function(){var t,e,n,r=this.props,i=r.src,o=r.title,a=void 0===o?"":o,u=r.imageDimensions,l=r.containerWidth,c=r.containerHeight,h=r.className,p=r.onClose,f=(e={width:l,height:c},n={width:0,height:0},(t=u).width>t.height?(n.width=e.width,n.height=e.width*t.height/t.width):(n.height=e.height,n.width=e.height*t.width/t.height),{dimensions:n,ratio:t.width*t.height/(e.width*e.height)}),m=f.dimensions,g=f.ratio;return u.width*u.height>l*c?s.default.createElement("div",{className:"zoomable-wrapper"},s.default.createElement(d,{className:h,baseImage:{alt:a,src:i,width:m.width,height:m.height},largeImage:{alt:a,src:i,width:m.width*g,height:m.height*g},thumbnailImage:{alt:a,src:i}}),s.default.createElement("button",{onClick:p,className:"button close-zoomable"},"✕")):s.default.createElement("img",{src:i,alt:a,style:{width:m.width,height:m.height}})}}]),e}(),v=(0,l.default)()(g),y=(r=function(t){function e(t){h(this,e);var n=p(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.call(n),n.state={modalIsOpen:!1},n}return f(e,a.Component),o(e,[{key:"componentWillMount",value:function(){this.updateImageDimensions(this.props)}},{key:"componentWillReceiveProps",value:function(t){this.props.resource!==t.resource&&this.updateImageDimensions(t)}},{key:"render",value:function(){var t=this.props,e=t.assetUri,n=t.resource,r=this.state,i=r.modalIsOpen,o=r.imageHeight,a=r.imageWidth,l=this.toggleModal;return e?s.default.createElement("figure",{className:"peritext-contextualization peritext-contextualization-block peritext-contextualization-web peritext-contextualizer-image"},s.default.createElement("img",{src:e,onClick:l}),m?s.default.createElement(u.default,{isOpen:i,ariaHideApp:!1,onRequestClose:l,className:"zoomable-image-container",style:{content:{background:"rgba(0,0,0,0)",border:"none"}}},s.default.createElement(v,{src:e,title:n.metadata.title,className:"image-detail",onClose:l,imageDimensions:{width:a,height:o}})):s.default.createElement("img",{src:e})):null}}]),e}(),i=function(){var t=this;this.toggleModal=function(e){e&&"function"==typeof e.stopPropagation&&e.stopPropagation(),t.setState({modalIsOpen:!t.state.modalIsOpen})},this.updateImageDimensions=function(e){var n=t.props.assetUri,r=e.resource;if(m&&n&&r&&r.data){var i=new Image;i.onload=function(){var e=i.height,n=i.width;t.setState({imageHeight:e,imageWidth:n})},i.src=n}}},r);e.default=y},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(564),o=(r=i)&&r.__esModule?r:{default:r};e.default=o.default,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.bodyOpenClassName=e.portalClassName=void 0;var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(1),a=f(o),s=f(n(49)),u=f(n(2)),l=f(n(565)),c=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(276)),h=n(279),p=f(h);function f(t){return t&&t.__esModule?t:{default:t}}function d(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var m=e.portalClassName="ReactModalPortal",g=e.bodyOpenClassName="ReactModal__Body--open",v=void 0!==s.default.createPortal,y=v?s.default.createPortal:s.default.unstable_renderSubtreeIntoContainer;function b(t){return t()}var _=function(t){function e(){var t,n,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var o=arguments.length,u=Array(o),c=0;c<o;c++)u[c]=arguments[c];return n=i=d(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(u))),i.removePortal=function(){!v&&s.default.unmountComponentAtNode(i.node),b(i.props.parentSelector).removeChild(i.node)},i.portalRef=function(t){i.portal=t},i.renderPortal=function(t){var n=y(i,a.default.createElement(l.default,r({defaultStyles:e.defaultStyles},t)),i.node);i.portalRef(n)},d(i,n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Component),i(e,[{key:"componentDidMount",value:function(){h.canUseDOM&&(v||(this.node=document.createElement("div")),this.node.className=this.props.portalClassName,b(this.props.parentSelector).appendChild(this.node),!v&&this.renderPortal(this.props))}},{key:"componentWillReceiveProps",value:function(t){if(h.canUseDOM){var e=t.isOpen;if(this.props.isOpen||e){var n=b(this.props.parentSelector),r=b(t.parentSelector);r!==n&&(n.removeChild(this.node),r.appendChild(this.node)),!v&&this.renderPortal(t)}}}},{key:"componentWillUpdate",value:function(t){h.canUseDOM&&t.portalClassName!==this.props.portalClassName&&(this.node.className=t.portalClassName)}},{key:"componentWillUnmount",value:function(){if(h.canUseDOM&&this.node&&this.portal){var t=this.portal.state,e=Date.now(),n=t.isOpen&&this.props.closeTimeoutMS&&(t.closesAt||e+this.props.closeTimeoutMS);n?(t.beforeClose||this.portal.closeWithTimeout(),setTimeout(this.removePortal,n-e)):this.removePortal()}}},{key:"render",value:function(){return h.canUseDOM&&v?(!this.node&&v&&(this.node=document.createElement("div")),y(a.default.createElement(l.default,r({ref:this.portalRef,defaultStyles:e.defaultStyles},this.props)),this.node)):null}}],[{key:"setAppElement",value:function(t){c.setElement(t)}}]),e}();_.propTypes={isOpen:u.default.bool.isRequired,style:u.default.shape({content:u.default.object,overlay:u.default.object}),portalClassName:u.default.string,bodyOpenClassName:u.default.string,className:u.default.oneOfType([u.default.string,u.default.shape({base:u.default.string.isRequired,afterOpen:u.default.string.isRequired,beforeClose:u.default.string.isRequired})]),overlayClassName:u.default.oneOfType([u.default.string,u.default.shape({base:u.default.string.isRequired,afterOpen:u.default.string.isRequired,beforeClose:u.default.string.isRequired})]),appElement:u.default.instanceOf(p.default),onAfterOpen:u.default.func,onRequestClose:u.default.func,closeTimeoutMS:u.default.number,ariaHideApp:u.default.bool,shouldFocusAfterRender:u.default.bool,shouldCloseOnOverlayClick:u.default.bool,shouldReturnFocusAfterClose:u.default.bool,parentSelector:u.default.func,aria:u.default.object,role:u.default.string,contentLabel:u.default.string,shouldCloseOnEsc:u.default.bool},_.defaultProps={isOpen:!1,portalClassName:m,bodyOpenClassName:g,ariaHideApp:!0,closeTimeoutMS:0,shouldFocusAfterRender:!0,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,shouldReturnFocusAfterClose:!0,parentSelector:function(){return document.body}},_.defaultStyles={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.75)"},content:{position:"absolute",top:"40px",left:"40px",right:"40px",bottom:"40px",border:"1px solid #ccc",background:"#fff",overflow:"auto",WebkitOverflowScrolling:"touch",borderRadius:"4px",outline:"none",padding:"20px"}},e.default=_},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(1),s=g(a),u=g(n(2)),l=m(n(566)),c=g(n(567)),h=m(n(276)),p=m(n(278)),f=m(n(568)),d=g(n(279));function m(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function g(t){return t&&t.__esModule?t:{default:t}}var v={overlay:"ReactModal__Overlay",content:"ReactModal__Content"},y=9,b=27,_=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.setFocusAfterRender=function(t){n.focusAfterRender=n.props.shouldFocusAfterRender&&t},n.setOverlayRef=function(t){n.overlay=t},n.setContentRef=function(t){n.content=t},n.afterClose=function(){var t=n.props,e=t.appElement,r=t.ariaHideApp;f.remove(n.props.bodyOpenClassName),r&&p.totalCount()<1&&h.show(e),n.props.shouldFocusAfterRender&&(n.props.shouldReturnFocusAfterClose?(l.returnFocus(),l.teardownScopedFocus()):l.popWithoutFocus())},n.open=function(){n.beforeOpen(),n.state.afterOpen&&n.state.beforeClose?(clearTimeout(n.closeTimer),n.setState({beforeClose:!1})):(n.props.shouldFocusAfterRender&&(l.setupScopedFocus(n.node),l.markForFocusLater()),n.setState({isOpen:!0},function(){n.setState({afterOpen:!0}),n.props.isOpen&&n.props.onAfterOpen&&n.props.onAfterOpen()}))},n.close=function(){n.props.closeTimeoutMS>0?n.closeWithTimeout():n.closeWithoutTimeout()},n.focusContent=function(){return n.content&&!n.contentHasFocus()&&n.content.focus()},n.closeWithTimeout=function(){var t=Date.now()+n.props.closeTimeoutMS;n.setState({beforeClose:!0,closesAt:t},function(){n.closeTimer=setTimeout(n.closeWithoutTimeout,n.state.closesAt-Date.now())})},n.closeWithoutTimeout=function(){n.setState({beforeClose:!1,isOpen:!1,afterOpen:!1,closesAt:null},n.afterClose)},n.handleKeyDown=function(t){t.keyCode===y&&(0,c.default)(n.content,t),n.props.shouldCloseOnEsc&&t.keyCode===b&&(t.stopPropagation(),n.requestClose(t))},n.handleOverlayOnClick=function(t){null===n.shouldClose&&(n.shouldClose=!0),n.shouldClose&&n.props.shouldCloseOnOverlayClick&&(n.ownerHandlesClose()?n.requestClose(t):n.focusContent()),n.shouldClose=null,n.moveFromContentToOverlay=null},n.handleOverlayOnMouseUp=function(){null===n.moveFromContentToOverlay&&(n.shouldClose=!1),n.props.shouldCloseOnOverlayClick&&(n.shouldClose=!0)},n.handleContentOnMouseUp=function(){n.shouldClose=!1},n.handleOverlayOnMouseDown=function(t){n.props.shouldCloseOnOverlayClick||t.target!=n.overlay||t.preventDefault(),n.moveFromContentToOverlay=!1},n.handleContentOnClick=function(){n.shouldClose=!1},n.handleContentOnMouseDown=function(){n.shouldClose=!1,n.moveFromContentToOverlay=!1},n.requestClose=function(t){return n.ownerHandlesClose()&&n.props.onRequestClose(t)},n.ownerHandlesClose=function(){return n.props.onRequestClose},n.shouldBeClosed=function(){return!n.state.isOpen&&!n.state.beforeClose},n.contentHasFocus=function(){return document.activeElement===n.content||n.content.contains(document.activeElement)},n.buildClassName=function(t,e){var r="object"===(void 0===e?"undefined":i(e))?e:{base:v[t],afterOpen:v[t]+"--after-open",beforeClose:v[t]+"--before-close"},o=r.base;return n.state.afterOpen&&(o=o+" "+r.afterOpen),n.state.beforeClose&&(o=o+" "+r.beforeClose),"string"==typeof e&&e?o+" "+e:o},n.ariaAttributes=function(t){return Object.keys(t).reduce(function(e,n){return e["aria-"+n]=t[n],e},{})},n.state={afterOpen:!1,beforeClose:!1},n.shouldClose=null,n.moveFromContentToOverlay=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.Component),o(e,[{key:"componentDidMount",value:function(){this.props.isOpen&&(this.setFocusAfterRender(!0),this.open())}},{key:"componentWillReceiveProps",value:function(t){!this.props.isOpen&&t.isOpen?(this.setFocusAfterRender(!0),this.open()):this.props.isOpen&&!t.isOpen&&this.close()}},{key:"componentDidUpdate",value:function(){this.focusAfterRender&&(this.focusContent(),this.setFocusAfterRender(!1))}},{key:"componentWillUnmount",value:function(){this.afterClose(),clearTimeout(this.closeTimer)}},{key:"beforeOpen",value:function(){var t=this.props,e=t.appElement,n=t.ariaHideApp,r=t.bodyOpenClassName;f.add(r),n&&h.hide(e)}},{key:"render",value:function(){var t=this.props,e=t.className,n=t.overlayClassName,i=t.defaultStyles,o=e?{}:i.content,a=n?{}:i.overlay;return this.shouldBeClosed()?null:s.default.createElement("div",{ref:this.setOverlayRef,className:this.buildClassName("overlay",n),style:r({},a,this.props.style.overlay),onClick:this.handleOverlayOnClick,onMouseDown:this.handleOverlayOnMouseDown,onMouseUp:this.handleOverlayOnMouseUp,"aria-modal":"true"},s.default.createElement("div",r({ref:this.setContentRef,style:r({},o,this.props.style.content),className:this.buildClassName("content",e),tabIndex:"-1",onKeyDown:this.handleKeyDown,onMouseDown:this.handleContentOnMouseDown,onMouseUp:this.handleContentOnMouseUp,onClick:this.handleContentOnClick,role:this.props.role,"aria-label":this.props.contentLabel},this.ariaAttributes(this.props.aria||{})),this.props.children))}}]),e}();_.defaultProps={style:{overlay:{},content:{}}},_.propTypes={isOpen:u.default.bool.isRequired,defaultStyles:u.default.shape({content:u.default.object,overlay:u.default.object}),style:u.default.shape({content:u.default.object,overlay:u.default.object}),className:u.default.oneOfType([u.default.string,u.default.object]),overlayClassName:u.default.oneOfType([u.default.string,u.default.object]),bodyOpenClassName:u.default.string,ariaHideApp:u.default.bool,appElement:u.default.instanceOf(d.default),onAfterOpen:u.default.func,onRequestClose:u.default.func,closeTimeoutMS:u.default.number,shouldFocusAfterRender:u.default.bool,shouldCloseOnOverlayClick:u.default.bool,shouldReturnFocusAfterClose:u.default.bool,role:u.default.string,contentLabel:u.default.string,aria:u.default.object,children:u.default.node,shouldCloseOnEsc:u.default.bool},e.default=_,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.handleBlur=l,e.handleFocus=c,e.markForFocusLater=function(){a.push(document.activeElement)},e.returnFocus=function(){var t=null;try{return void(0!==a.length&&(t=a.pop()).focus())}catch(e){console.warn(["You tried to return focus to",t,"but it is not in the DOM anymore"].join(" "))}},e.popWithoutFocus=function(){a.length>0&&a.pop()},e.setupScopedFocus=function(t){s=t,window.addEventListener?(window.addEventListener("blur",l,!1),document.addEventListener("focus",c,!0)):(window.attachEvent("onBlur",l),document.attachEvent("onFocus",c))},e.teardownScopedFocus=function(){s=null,window.addEventListener?(window.removeEventListener("blur",l),document.removeEventListener("focus",c)):(window.detachEvent("onBlur",l),document.detachEvent("onFocus",c))};var r,i=n(275),o=(r=i)&&r.__esModule?r:{default:r};var a=[],s=null,u=!1;function l(){u=!0}function c(){if(u){if(u=!1,!s)return;setTimeout(function(){s.contains(document.activeElement)||((0,o.default)(s)[0]||s).focus()},0)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n=(0,o.default)(t);if(!n.length)return void e.preventDefault();var r,i=e.shiftKey,a=n[0],s=n[n.length-1];if(t===document.activeElement)return;s!==document.activeElement||i||(r=a);a===document.activeElement&&i&&(r=s);if(r)return e.preventDefault(),void r.focus();var u=/(\bChrome\b|\bSafari\b)\//.exec(navigator.userAgent);if(null==u||"Chrome"==u[1]||null!=/\biPod\b|\biPad\b/g.exec(navigator.userAgent))return;var l=n.indexOf(document.activeElement);l>-1&&(l+=i?-1:1);e.preventDefault(),n[l].focus()};var r,i=n(275),o=(r=i)&&r.__esModule?r:{default:r};t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.add=function(t){t.split(" ").map(r.add).forEach(function(t){return document.body.classList.add(t)})},e.remove=function(t){var e=r.get();t.split(" ").map(r.remove).filter(function(t){return 0===e[t]}).forEach(function(t){return document.body.classList.remove(t)})};var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(278))},function(t,e,n){var r;!function(){"use strict";var i=!("undefined"==typeof window||!window.document||!window.document.createElement),o={canUseDOM:i,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:i&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:i&&!!window.screen};void 0===(r=function(){return o}.call(e,n,e,t))||(t.exports=r)}()},function(t,e){var n=function(){var t=this,e=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||function(e){return t.setTimeout(e,20)};return function(t){return e(t)}}(),r=function(){var t=this.cancelAnimationFrame||this.mozCancelAnimationFrame||this.webkitCancelAnimationFrame||this.clearTimeout;return function(e){return t(e)}}();function i(t){var e=t.target||t.srcElement;e.__resizeRAF__&&r(e.__resizeRAF__),e.__resizeRAF__=n(function(){var n=e.__resizeTrigger__;n.__resizeListeners__.forEach(function(e){e.call(n,t)})})}e=function(t,e){var n,r=this.document,o=r.attachEvent;if("undefined"!=typeof navigator&&(n=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/)),!t.__resizeListeners__)if(t.__resizeListeners__=[],o)t.__resizeTrigger__=t,t.attachEvent("onresize",i);else{"static"===getComputedStyle(t).position&&(t.style.position="relative");var a=t.__resizeTrigger__=r.createElement("object");a.setAttribute("style","display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; pointer-events: none; z-index: -1; opacity: 0;"),a.setAttribute("class","resize-sensor"),a.__resizeElement__=t,a.onload=function(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",i)},a.type="text/html",n&&t.appendChild(a),a.data="about:blank",n||t.appendChild(a)}t.__resizeListeners__.push(e)};t.exports="undefined"==typeof window?e:e.bind(window),t.exports.unbind=function(t,e){var n=document.attachEvent;e?t.__resizeListeners__.splice(t.__resizeListeners__.indexOf(e),1):t.__resizeListeners__=[],t.__resizeListeners__.length||(n?t.detachEvent("onresize",i):(t.__resizeTrigger__.contentDocument.defaultView.removeEventListener("resize",i),delete t.__resizeTrigger__.contentDocument.defaultView.__resizeTrigger__,t.__resizeTrigger__=!t.removeChild(t.__resizeTrigger__)),delete t.__resizeListeners__)}},function(t,e,n){t.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=12)}([function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var u,l=[],c=!1,h=-1;function p(){c&&u&&(c=!1,u.length?l=u.concat(l):h=-1,l.length&&f())}function f(){if(!c){var t=s(p);c=!0;for(var e=l.length;e;){for(u=l,l=[];++h<e;)u&&u[h].run();h=-1,e=l.length}u=null,c=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function m(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new d(t,e)),1!==l.length||c||s(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){"use strict";function r(t){return function(){return t}}var i=function(){};i.thatReturns=r,i.thatReturnsFalse=r(!1),i.thatReturnsTrue=r(!0),i.thatReturnsNull=r(null),i.thatReturnsThis=function(){return this},i.thatReturnsArgument=function(t){return t},t.exports=i},function(t,e,n){"use strict";(function(e){var n=function(t){};"production"!==e.env.NODE_ENV&&(n=function(t){if(void 0===t)throw new Error("invariant requires an error message argument")}),t.exports=function(t,e,r,i,o,a,s,u){if(n(e),!t){var l;if(void 0===e)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[r,i,o,a,s,u],h=0;(l=new Error(e.replace(/%s/g,function(){return c[h++]}))).name="Invariant Violation"}throw l.framesToPop=1,l}}}).call(e,n(0))},function(t,e,n){"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(t,e,n){"use strict";(function(e){var r=n(1);if("production"!==e.env.NODE_ENV){r=function(t,e){if(void 0===e)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");if(0!==e.indexOf("Failed Composite propType: ")&&!t){for(var n=arguments.length,r=Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];(function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i=0,o="Warning: "+t.replace(/%s/g,function(){return n[i++]});"undefined"!=typeof console&&console.error(o);try{throw new Error(o)}catch(t){}}).apply(void 0,[e].concat(r))}}}t.exports=r}).call(e,n(0))},function(t,e){t.exports=function(t){return t}},function(t,e){t.exports=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}},function(t,e,n){var r=n(28),i=n(10),o="[object AsyncFunction]",a="[object Function]",s="[object GeneratorFunction]",u="[object Proxy]";t.exports=function(t){if(!i(t))return!1;var e=r(t);return e==a||e==s||e==o||e==u}},function(t,e,n){var r=n(9).Symbol;t.exports=r},function(t,e,n){var r=n(29),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();t.exports=o},function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=c(n(13)),a=n(18),s=c(a),u=c(n(19)),l=n(47);function c(t){return t&&t.__esModule?t:{default:t}}function h(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var p=n(48),f=n(49),d=function(t,e){for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0},m={wrapper:{position:"relative",zIndex:1},image:{position:"relative",transitionProperty:"z-index",width:"100%",height:"100%"},zoomContainer:{position:"absolute",top:0},innerMap:{position:"absolute",top:10,left:10,pointerEvents:"none"},innerMapImage:{width:"101%",height:"auto"},innerMapHighlightBox:{position:"absolute",backgroundColor:"rgba(140, 137, 131, 0.6)"},zoomedImage:{position:"absolute",top:0,backgroundColor:"transparent",backgroundRepeat:"no-repeat"}},g=function(t,e){var n=!0;return t.forEach(function(t,r){(t<=0||t>=e[r])&&(n=!1)}),n},v=function(t,e){return t.map(function(t,n){return Math.min(t,e[n])})},y=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.startZoom=function(t,e){if(e&&n.setState({calcMovementFromDrag:!0}),!d(n.state.viewWindowPosition,t)){var r=n.props,i=r.baseImage.width,o=r.largeImage,a=o.width,s=o.height,u=[a,s],l=e?t.map(function(t){return t*(a/i)}):t;e&&!g(l,u)&&(l=v(l,u)),n.setState({viewWindowPosition:l,lastClickToZoomPosition:t,calcMovementFromDrag:e})}n.setState({zoomed:1,zoomLevel:n.state.defaultZoomLevel,pageClickHandlersAreAdded:!0,isStartingZoom:!0}),setTimeout(function(){n.addBodyClickHandlers(),n.setState({transitionZoomBackground:!1,isStartingZoom:!1})},n.props.zoomTransitionTime)},n.endZoom=function(t){t.preventDefault(),t.stopPropagation();var e=n.props.baseImage.width/n.props.largeImage.width;n.removeBodyClickHandlers(),n.setState({zoomed:0,zoomLevel:e,pageClickHandlersAreAdded:!1,transitionZoomBackground:!0,isEndingZoom:!0}),setTimeout(function(){n.setState({isEndingZoom:!1})},n.props.zoomTransitionTime)},n.onZoomWindowTouchStart=function(t){t.preventDefault(),t.stopPropagation(),t.targetTouches&&n.setState({isDragging:!0,previousDragPosition:[t.targetTouches[0].clientX,t.targetTouches[0].clientY]}),n.checkForTap()},n.onTouchEnd=function(t){n.state.listeningForSingleClick?n.endZoom(t):(t.stopPropagation(),t.preventDefault()),n.setState({isDragging:!1})},n.addBodyClickHandlers=function(){document&&document.querySelector&&(n.bodyElement||(n.bodyElement=document.querySelector("body")),n.bodyClickHandlers.forEach(function(t){var e;(e=n.bodyElement).addEventListener.apply(e,h(t))}))},n.removeBodyClickHandlers=function(){document&&document.querySelector&&n.bodyClickHandlers&&n.bodyElement&&n.bodyClickHandlers.forEach(function(t){var e;(e=n.bodyElement).removeEventListener.apply(e,h(t))})},n.calcBackgroundOffsetFromMouse=function(t){if(!n.state.isDragging&&t.nativeEvent){n.state.calcMovementFromDrag&&n.setState({calcMovementFromDrag:!1});var e=t.nativeEvent,r=[e.offsetX,e.offsetY];window.requestAnimationFrame(function(){n.setState({viewWindowPosition:r})})}},n.calcBackgroundOffsetFromDrag=function(t){t.preventDefault(),t.stopPropagation(),n.state.calcMovementFromDrag||n.setState({calcMovementFromDrag:!0});var e=n.state,r=e.zoomLevel,i=e.previousDragPosition,o=e.viewWindowPosition,a=n.props.largeImage,s=[a.width,a.height];if(t.targetTouches){var l=[t.targetTouches[0].clientX,t.targetTouches[0].clientY],c=3/(r*r),h=(0,u.default)(o,l,i,function(t,e,n){return t+(n-e)*c});g(h,s)&&window.requestAnimationFrame(function(){n.setState({viewWindowPosition:h,previousDragPosition:l})})}},n.checkForTap=function(){n.setState({listeningForSingleClick:!0}),setTimeout(function(){return n.setState({listeningForSingleClick:!1})},200)},n.pauseZoom=function(){return n.setState({isCalculatingZoom:!0})},n.resumeZoom=function(){return n.setState({isCalculatingZoom:!1})},n.handleZoom=function(t){t.preventDefault();var e=n.state.zoomLevel;!n.state.isCalculatingZoom&&e<=2&&e>=0&&(("pinchout"===t.type||t.deltaY<0)&&e<2?n.zoom(.05):("pinchin"===t.type||t.deltaY>0)&&e>1&&n.zoom(-.05))},n.zoom=function(t){n.pauseZoom();var e=Math.round(100*(n.state.zoomLevel+t))/100;n.setState({zoomLevel:e},n.resumeZoom)},n.state={zoomed:0,zoomLevel:t.baseImage.width/t.largeImage.width,defaultZoomLevel:1.2,viewWindowPosition:[0,0],dragFocalPoint:[0,0],lastClickToZoomPosition:[-1,-1],isCalculatingZoom:!1,isDragging:!1,calcMovementFromDrag:!1,pageClickHandlersAreAdded:!1,transitionZoomBackground:!0,isStartingZoom:!1,isEndingZoom:!1},n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.Component),i(e,[{key:"componentDidMount",value:function(){this.bodyClickHandlers=[["click",this.endZoom],["touchstart",this.checkForTap],["touchend",this.onTouchEnd]];var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});document.querySelector("body").addEventListener("test",null,e)}catch(e){t=!1}var n=!!t&&{passive:!1};this.zoomContainer&&(this.zoomContainer.addEventListener("touchmove",this.calcBackgroundOffsetFromDrag,n),this.zoomContainer.addEventListener("touchstart",this.onZoomWindowTouchStart,n),this.zoomContainer.addEventListener("touchend",this.onTouchEnd,n),this.mc=new l.Manager(this.zoomContainer),this.mc.add(new l.Pinch),this.mc.on("pinchin",this.handleZoom),this.mc.on("pinchout",this.handleZoom))}},{key:"componentWillUnmount",value:function(){this.removeBodyClickHandlers()}},{key:"render",value:function(){var t=this,e=this.props,n=e.baseImage,i=e.largeImage,o=e.thumbnailImage,a=e.displayMap,u=e.zoomTransitionTime,l=e.mapBorderColor,c=e.mapScaleFactor,h=this.state,d=h.zoomed,g=h.viewWindowPosition,v=h.zoomLevel,y=h.calcMovementFromDrag,b=h.transitionZoomBackground,_=h.isStartingZoom,x=h.listeningForSingleClick,w=h.isEndingZoom,E=h.isTouch,S=n.width,T=n.height,O=i.width,A=i.height,M=S/(O*v),C=y?[O,A]:[S,T],k=g.map(function(t,e){return Math.round(t/C[e]*1e3)/10});return s.default.createElement("div",{"data-name":"wrapper",style:r({},m.wrapper,{width:S,height:T,cursor:"url("+(d?f:p)+"), pointer"}),onMouseDown:function(e){d||E||t.startZoom([e.nativeEvent.offsetX,e.nativeEvent.offsetY],!1)},onTouchStart:function(e){d||(e.preventDefault(),e.stopPropagation(),t.setState({listeningForSingleClick:!0,isTouch:!0}),setTimeout(function(){t.setState({listeningForSingleClick:!1})},200),setTimeout(function(){t.setState({isTouch:!1})},2e3))},onTouchEnd:function(e){if(e.preventDefault(),e.stopPropagation(),!d&&x&&!w){var n=e.target.getBoundingClientRect(),r=n.x,i=n.y;t.startZoom([e.changedTouches[0].clientX-(r||0),e.changedTouches[0].clientY-(i||0)],!0)}}},s.default.createElement("img",{src:n.src,alt:n.alt,style:r({},m.image,{zIndex:d?-1:1,transitionDelay:u+"ms"})}),s.default.createElement("div",{"data-name":"zoom-wrapper",ref:function(e){t.zoomContainer=e},onMouseMove:this.calcBackgroundOffsetFromMouse,onWheel:this.handleZoom,style:r({},m.zoomContainer,{width:S,height:T,zIndex:100*d})},a&&s.default.createElement("div",{style:r({},m.innerMap,{width:S*c,height:T*c,zIndex:200*d,border:"2px solid "+l})},s.default.createElement("img",{style:m.innerMapImage,src:o.src,alt:o.alt||"thumbnail"}),s.default.createElement("div",{"data-name":"map-highlight",style:r({},m.innerMapHighlightBox,{width:100*M+"%",height:100*M+"%",left:k[0]*(1-M)+"%",top:k[1]*(1-M)+"%"})})),s.default.createElement("div",{"data-name":"zoom-image",onClick:function(e){d&&!_&&t.endZoom(e)},style:r({},m.zoomedImage,{width:S,height:T,zIndex:110*d,backgroundPosition:k.map(function(t){return t+"%"}).join(" "),backgroundSize:Math.round(O*v)+"px "+Math.round(A*v)+"px",backgroundImage:"url("+i.src+")",transition:b?"background-size "+u+"ms ease-in-out":"none"})})))}}]),e}(),b={alt:o.default.string.isRequired,src:o.default.string.isRequired},_=r({},b,{width:o.default.number.isRequired,height:o.default.number.isRequired});y.propTypes={baseImage:o.default.shape(_).isRequired,displayMap:o.default.bool,largeImage:o.default.shape(_).isRequired,mapBorderColor:o.default.string,mapScaleFactor:o.default.number,thumbnailImage:o.default.shape(b),zoomTransitionTime:o.default.number},y.defaultProps={zoomTransitionTime:300,displayMap:!0,mapBorderColor:"grey",mapScaleFactor:.2,thumbnailImage:{alt:"",src:""}},e.default=y},function(t,e,n){(function(e){if("production"!==e.env.NODE_ENV){var r="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103;t.exports=n(14)(function(t){return"object"==typeof t&&null!==t&&t.$$typeof===r},!0)}else t.exports=n(17)()}).call(e,n(0))},function(t,e,n){"use strict";(function(e){var r=n(1),i=n(2),o=n(4),a=n(15),s=n(3),u=n(16);t.exports=function(t,n){var l="function"==typeof Symbol&&Symbol.iterator,c="@@iterator";var h="<<anonymous>>",p={array:g("array"),bool:g("boolean"),func:g("function"),number:g("number"),object:g("object"),string:g("string"),symbol:g("symbol"),any:m(r.thatReturnsNull),arrayOf:function(t){return m(function(e,n,r,i,o){if("function"!=typeof t)return new d("Property `"+o+"` of component `"+r+"` has invalid PropType notation inside arrayOf.");var a=e[n];if(!Array.isArray(a)){var u=y(a);return new d("Invalid "+i+" `"+o+"` of type `"+u+"` supplied to `"+r+"`, expected an array.")}for(var l=0;l<a.length;l++){var c=t(a,l,r,i,o+"["+l+"]",s);if(c instanceof Error)return c}return null})},element:function(){return m(function(e,n,r,i,o){var a=e[n];if(!t(a)){var s=y(a);return new d("Invalid "+i+" `"+o+"` of type `"+s+"` supplied to `"+r+"`, expected a single ReactElement.")}return null})}(),instanceOf:function(t){return m(function(e,n,r,i,o){if(!(e[n]instanceof t)){var a=t.name||h,s=function(t){if(!t.constructor||!t.constructor.name)return h;return t.constructor.name}(e[n]);return new d("Invalid "+i+" `"+o+"` of type `"+s+"` supplied to `"+r+"`, expected instance of `"+a+"`.")}return null})},node:function(){return m(function(t,e,n,r,i){if(!v(t[e]))return new d("Invalid "+r+" `"+i+"` supplied to `"+n+"`, expected a ReactNode.");return null})}(),objectOf:function(t){return m(function(e,n,r,i,o){if("function"!=typeof t)return new d("Property `"+o+"` of component `"+r+"` has invalid PropType notation inside objectOf.");var a=e[n],u=y(a);if("object"!==u)return new d("Invalid "+i+" `"+o+"` of type `"+u+"` supplied to `"+r+"`, expected an object.");for(var l in a)if(a.hasOwnProperty(l)){var c=t(a,l,r,i,o+"."+l,s);if(c instanceof Error)return c}return null})},oneOf:function(t){if(!Array.isArray(t))return"production"!==e.env.NODE_ENV&&o(!1,"Invalid argument supplied to oneOf, expected an instance of array."),r.thatReturnsNull;return m(function(e,n,r,i,o){for(var a=e[n],s=0;s<t.length;s++)if(f(a,t[s]))return null;var u=JSON.stringify(t);return new d("Invalid "+i+" `"+o+"` of value `"+a+"` supplied to `"+r+"`, expected one of "+u+".")})},oneOfType:function(t){if(!Array.isArray(t))return"production"!==e.env.NODE_ENV&&o(!1,"Invalid argument supplied to oneOfType, expected an instance of array."),r.thatReturnsNull;for(var n=0;n<t.length;n++){var i=t[n];if("function"!=typeof i)return o(!1,"Invalid argument supplied to oneOfType. Expected an array of check functions, but received %s at index %s.",_(i),n),r.thatReturnsNull}return m(function(e,n,r,i,o){for(var a=0;a<t.length;a++){var u=t[a];if(null==u(e,n,r,i,o,s))return null}return new d("Invalid "+i+" `"+o+"` supplied to `"+r+"`.")})},shape:function(t){return m(function(e,n,r,i,o){var a=e[n],u=y(a);if("object"!==u)return new d("Invalid "+i+" `"+o+"` of type `"+u+"` supplied to `"+r+"`, expected `object`.");for(var l in t){var c=t[l];if(c){var h=c(a,l,r,i,o+"."+l,s);if(h)return h}}return null})},exact:function(t){return m(function(e,n,r,i,o){var u=e[n],l=y(u);if("object"!==l)return new d("Invalid "+i+" `"+o+"` of type `"+l+"` supplied to `"+r+"`, expected `object`.");var c=a({},e[n],t);for(var h in c){var p=t[h];if(!p)return new d("Invalid "+i+" `"+o+"` key `"+h+"` supplied to `"+r+"`.\nBad object: "+JSON.stringify(e[n],null,"  ")+"\nValid keys: "+JSON.stringify(Object.keys(t),null,"  "));var f=p(u,h,r,i,o+"."+h,s);if(f)return f}return null})}};function f(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}function d(t){this.message=t,this.stack=""}function m(t){if("production"!==e.env.NODE_ENV)var r={},a=0;function u(u,l,c,p,f,m,g){if(p=p||h,m=m||c,g!==s)if(n)i(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");else if("production"!==e.env.NODE_ENV&&"undefined"!=typeof console){var v=p+":"+c;!r[v]&&a<3&&(o(!1,"You are manually calling a React.PropTypes validation function for the `%s` prop on `%s`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details.",m,p),r[v]=!0,a++)}return null==l[c]?u?null===l[c]?new d("The "+f+" `"+m+"` is marked as required in `"+p+"`, but its value is `null`."):new d("The "+f+" `"+m+"` is marked as required in `"+p+"`, but its value is `undefined`."):null:t(l,c,p,f,m)}var l=u.bind(null,!1);return l.isRequired=u.bind(null,!0),l}function g(t){return m(function(e,n,r,i,o,a){var s=e[n];return y(s)!==t?new d("Invalid "+i+" `"+o+"` of type `"+b(s)+"` supplied to `"+r+"`, expected `"+t+"`."):null})}function v(e){switch(typeof e){case"number":case"string":case"undefined":return!0;case"boolean":return!e;case"object":if(Array.isArray(e))return e.every(v);if(null===e||t(e))return!0;var n=function(t){var e=t&&(l&&t[l]||t[c]);if("function"==typeof e)return e}(e);if(!n)return!1;var r,i=n.call(e);if(n!==e.entries){for(;!(r=i.next()).done;)if(!v(r.value))return!1}else for(;!(r=i.next()).done;){var o=r.value;if(o&&!v(o[1]))return!1}return!0;default:return!1}}function y(t){var e,n=typeof t;return Array.isArray(t)?"array":t instanceof RegExp?"object":(e=t,"symbol"===n||"Symbol"===e["@@toStringTag"]||"function"==typeof Symbol&&e instanceof Symbol?"symbol":n)}function b(t){if(void 0===t||null===t)return""+t;var e=y(t);if("object"===e){if(t instanceof Date)return"date";if(t instanceof RegExp)return"regexp"}return e}function _(t){var e=b(t);switch(e){case"array":case"object":return"an "+e;case"boolean":case"date":case"regexp":return"a "+e;default:return e}}return d.prototype=Error.prototype,p.checkPropTypes=u,p.PropTypes=p,p}}).call(e,n(0))},function(t,e,n){"use strict";var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(t){r[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,a,s=function(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),u=1;u<arguments.length;u++){n=Object(arguments[u]);for(var l in n)i.call(n,l)&&(s[l]=n[l]);if(r){a=r(n);for(var c=0;c<a.length;c++)o.call(n,a[c])&&(s[a[c]]=n[a[c]])}}return s}},function(t,e,n){"use strict";(function(e){if("production"!==e.env.NODE_ENV)var r=n(2),i=n(4),o=n(3),a={};t.exports=function(t,n,s,u,l){if("production"!==e.env.NODE_ENV)for(var c in t)if(t.hasOwnProperty(c)){var h;try{r("function"==typeof t[c],"%s: %s type `%s` is invalid; it must be a function, usually from the `prop-types` package, but received `%s`.",u||"React class",s,c,typeof t[c]),h=t[c](n,c,u,s,null,o)}catch(t){h=t}if(i(!h||h instanceof Error,"%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",u||"React class",s,c,typeof h),h instanceof Error&&!(h.message in a)){a[h.message]=!0;var p=l?l():"";i(!1,"Failed %s type: %s%s",s,h.message,null!=p?p:"")}}}}).call(e,n(0))},function(t,e,n){"use strict";var r=n(1),i=n(2),o=n(3);t.exports=function(){function t(t,e,n,r,a,s){s!==o&&i(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function e(){return t}t.isRequired=t;var n={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e};return n.checkPropTypes=r,n.PropTypes=n,n}},function(t,e){t.exports=n(1)},function(t,e,n){var r=n(20),i=n(38),o=r(function(t){var e=t.length,n=e>1?t[e-1]:void 0;return n="function"==typeof n?(t.pop(),n):void 0,i(t,n)});t.exports=o},function(t,e,n){var r=n(5),i=n(21),o=n(22);t.exports=function(t,e){return o(i(t,e,r),t+"")}},function(t,e,n){var r=n(6),i=Math.max;t.exports=function(t,e,n){return e=i(void 0===e?t.length-1:e,0),function(){for(var o=arguments,a=-1,s=i(o.length-e,0),u=Array(s);++a<s;)u[a]=o[e+a];a=-1;for(var l=Array(e+1);++a<e;)l[a]=o[a];return l[e]=n(u),r(t,this,l)}}},function(t,e,n){var r=n(23),i=n(37)(r);t.exports=i},function(t,e,n){var r=n(24),i=n(25),o=n(5),a=i?function(t,e){return i(t,"toString",{configurable:!0,enumerable:!1,value:r(e),writable:!0})}:o;t.exports=a},function(t,e){t.exports=function(t){return function(){return t}}},function(t,e,n){var r=n(26),i=function(){try{var t=r(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=i},function(t,e,n){var r=n(27),i=n(36);t.exports=function(t,e){var n=i(t,e);return r(n)?n:void 0}},function(t,e,n){var r=n(7),i=n(33),o=n(10),a=n(35),s=/^\[object .+?Constructor\]$/,u=Function.prototype,l=Object.prototype,c=u.toString,h=l.hasOwnProperty,p=RegExp("^"+c.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!o(t)||i(t))&&(r(t)?p:s).test(a(t))}},function(t,e,n){var r=n(8),i=n(31),o=n(32),a="[object Null]",s="[object Undefined]",u=r?r.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?s:a:u&&u in Object(t)?i(t):o(t)}},function(t,e,n){(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.exports=n}).call(e,n(30))},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var r=n(8),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,s=r?r.toStringTag:void 0;t.exports=function(t){var e=o.call(t,s),n=t[s];try{t[s]=void 0;var r=!0}catch(t){}var i=a.call(t);return r&&(e?t[s]=n:delete t[s]),i}},function(t,e){var n=Object.prototype.toString;t.exports=function(t){return n.call(t)}},function(t,e,n){var r,i=n(34),o=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";t.exports=function(t){return!!o&&o in t}},function(t,e,n){var r=n(9)["__core-js_shared__"];t.exports=r},function(t,e){var n=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return n.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},function(t,e){t.exports=function(t,e){return null==t?void 0:t[e]}},function(t,e){var n=800,r=16,i=Date.now;t.exports=function(t){var e=0,o=0;return function(){var a=i(),s=r-(a-o);if(o=a,s>0){if(++e>=n)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}},function(t,e,n){var r=n(6),i=n(11),o=n(39);t.exports=function(t,e){if(!t||!t.length)return[];var n=o(t);return null==e?n:i(n,function(t){return r(e,void 0,t)})}},function(t,e,n){var r=n(40),i=n(11),o=n(41),a=n(42),s=n(43),u=Math.max;t.exports=function(t){if(!t||!t.length)return[];var e=0;return t=r(t,function(t){if(s(t))return e=u(t.length,e),!0}),a(e,function(e){return i(t,o(e))})}},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var a=t[n];e(a,n,t)&&(o[i++]=a)}return o}},function(t,e){t.exports=function(t){return function(e){return null==e?void 0:e[t]}}},function(t,e){t.exports=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}},function(t,e,n){var r=n(44),i=n(46);t.exports=function(t){return i(t)&&r(t)}},function(t,e,n){var r=n(7),i=n(45);t.exports=function(t){return null!=t&&i(t.length)&&!r(t)}},function(t,e){var n=9007199254740991;t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=n}},function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,e,n){var r;!function(i,o,a,s){"use strict";var u,l=["","webkit","Moz","MS","ms","o"],c=o.createElement("div"),h="function",p=Math.round,f=Math.abs,d=Date.now;function m(t,e,n){return setTimeout(w(t,n),e)}function g(t,e,n){return!!Array.isArray(t)&&(v(t,n[e],n),!0)}function v(t,e,n){var r;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==s)for(r=0;r<t.length;)e.call(n,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}function y(t,e,n){var r="DEPRECATED METHOD: "+e+"\n"+n+" AT \n";return function(){var e=new Error("get-stack-trace"),n=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=i.console&&(i.console.warn||i.console.log);return o&&o.call(i.console,r,n),t.apply(this,arguments)}}u="function"!=typeof Object.assign?function(t){if(t===s||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==s&&null!==r)for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])}return e}:Object.assign;var b=y(function(t,e,n){for(var r=Object.keys(e),i=0;i<r.length;)(!n||n&&t[r[i]]===s)&&(t[r[i]]=e[r[i]]),i++;return t},"extend","Use `assign`."),_=y(function(t,e){return b(t,e,!0)},"merge","Use `assign`.");function x(t,e,n){var r,i=e.prototype;(r=t.prototype=Object.create(i)).constructor=t,r._super=i,n&&u(r,n)}function w(t,e){return function(){return t.apply(e,arguments)}}function E(t,e){return typeof t==h?t.apply(e?e[0]||s:s,e):t}function S(t,e){return t===s?e:t}function T(t,e,n){v(C(e),function(e){t.addEventListener(e,n,!1)})}function O(t,e,n){v(C(e),function(e){t.removeEventListener(e,n,!1)})}function A(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function M(t,e){return t.indexOf(e)>-1}function C(t){return t.trim().split(/\s+/g)}function k(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var r=0;r<t.length;){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return-1}function P(t){return Array.prototype.slice.call(t,0)}function R(t,e,n){for(var r=[],i=[],o=0;o<t.length;){var a=e?t[o][e]:t[o];k(i,a)<0&&r.push(t[o]),i[o]=a,o++}return n&&(r=e?r.sort(function(t,n){return t[e]>n[e]}):r.sort()),r}function L(t,e){for(var n,r,i=e[0].toUpperCase()+e.slice(1),o=0;o<l.length;){if((r=(n=l[o])?n+i:e)in t)return r;o++}return s}var I=1;function D(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||i}var N="ontouchstart"in i,j=L(i,"PointerEvent")!==s,U=N&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),F=25,B=1,z=2,G=4,H=8,V=1,W=2,q=4,X=8,Y=16,$=W|q,Z=X|Y,J=$|Z,K=["x","y"],Q=["clientX","clientY"];function tt(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){E(t.options.enable,[t])&&n.handler(e)},this.init()}function et(t,e,n){var r=n.pointers.length,i=n.changedPointers.length,o=e&B&&r-i==0,a=e&(G|H)&&r-i==0;n.isFirst=!!o,n.isFinal=!!a,o&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,r=e.pointers,i=r.length;n.firstInput||(n.firstInput=nt(e));i>1&&!n.firstMultiple?n.firstMultiple=nt(e):1===i&&(n.firstMultiple=!1);var o=n.firstInput,a=n.firstMultiple,u=a?a.center:o.center,l=e.center=rt(r);e.timeStamp=d(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=st(u,l),e.distance=at(u,l),function(t,e){var n=e.center,r=t.offsetDelta||{},i=t.prevDelta||{},o=t.prevInput||{};e.eventType!==B&&o.eventType!==G||(i=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y});e.deltaX=i.x+(n.x-r.x),e.deltaY=i.y+(n.y-r.y)}(n,e),e.offsetDirection=ot(e.deltaX,e.deltaY);var c=it(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=c.x,e.overallVelocityY=c.y,e.overallVelocity=f(c.x)>f(c.y)?c.x:c.y,e.scale=a?(m=a.pointers,g=r,at(g[0],g[1],Q)/at(m[0],m[1],Q)):1,e.rotation=a?(h=a.pointers,p=r,st(p[1],p[0],Q)+st(h[1],h[0],Q)):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,r,i,o,a=t.lastInterval||e,u=e.timeStamp-a.timeStamp;if(e.eventType!=H&&(u>F||a.velocity===s)){var l=e.deltaX-a.deltaX,c=e.deltaY-a.deltaY,h=it(u,l,c);r=h.x,i=h.y,n=f(h.x)>f(h.y)?h.x:h.y,o=ot(l,c),t.lastInterval=e}else n=a.velocity,r=a.velocityX,i=a.velocityY,o=a.direction;e.velocity=n,e.velocityX=r,e.velocityY=i,e.direction=o}(n,e);var h,p;var m,g;var v=t.element;A(e.srcEvent.target,v)&&(v=e.srcEvent.target);e.target=v}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function nt(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:p(t.pointers[n].clientX),clientY:p(t.pointers[n].clientY)},n++;return{timeStamp:d(),pointers:e,center:rt(e),deltaX:t.deltaX,deltaY:t.deltaY}}function rt(t){var e=t.length;if(1===e)return{x:p(t[0].clientX),y:p(t[0].clientY)};for(var n=0,r=0,i=0;i<e;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:p(n/e),y:p(r/e)}}function it(t,e,n){return{x:e/t||0,y:n/t||0}}function ot(t,e){return t===e?V:f(t)>=f(e)?t<0?W:q:e<0?X:Y}function at(t,e,n){n||(n=K);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return Math.sqrt(r*r+i*i)}function st(t,e,n){n||(n=K);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return 180*Math.atan2(i,r)/Math.PI}tt.prototype={handler:function(){},init:function(){this.evEl&&T(this.element,this.evEl,this.domHandler),this.evTarget&&T(this.target,this.evTarget,this.domHandler),this.evWin&&T(D(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&O(this.element,this.evEl,this.domHandler),this.evTarget&&O(this.target,this.evTarget,this.domHandler),this.evWin&&O(D(this.element),this.evWin,this.domHandler)}};var ut={mousedown:B,mousemove:z,mouseup:G},lt="mousedown",ct="mousemove mouseup";function ht(){this.evEl=lt,this.evWin=ct,this.pressed=!1,tt.apply(this,arguments)}x(ht,tt,{handler:function(t){var e=ut[t.type];e&B&&0===t.button&&(this.pressed=!0),e&z&&1!==t.which&&(e=G),this.pressed&&(e&G&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}});var pt={pointerdown:B,pointermove:z,pointerup:G,pointercancel:H,pointerout:H},ft={2:"touch",3:"pen",4:"mouse",5:"kinect"},dt="pointerdown",mt="pointermove pointerup pointercancel";function gt(){this.evEl=dt,this.evWin=mt,tt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&!i.PointerEvent&&(dt="MSPointerDown",mt="MSPointerMove MSPointerUp MSPointerCancel"),x(gt,tt,{handler:function(t){var e=this.store,n=!1,r=t.type.toLowerCase().replace("ms",""),i=pt[r],o=ft[t.pointerType]||t.pointerType,a="touch"==o,s=k(e,t.pointerId,"pointerId");i&B&&(0===t.button||a)?s<0&&(e.push(t),s=e.length-1):i&(G|H)&&(n=!0),s<0||(e[s]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(s,1))}});var vt={touchstart:B,touchmove:z,touchend:G,touchcancel:H},yt="touchstart",bt="touchstart touchmove touchend touchcancel";function _t(){this.evTarget=yt,this.evWin=bt,this.started=!1,tt.apply(this,arguments)}x(_t,tt,{handler:function(t){var e=vt[t.type];if(e===B&&(this.started=!0),this.started){var n=function(t,e){var n=P(t.touches),r=P(t.changedTouches);e&(G|H)&&(n=R(n.concat(r),"identifier",!0));return[n,r]}.call(this,t,e);e&(G|H)&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}}});var xt={touchstart:B,touchmove:z,touchend:G,touchcancel:H},wt="touchstart touchmove touchend touchcancel";function Et(){this.evTarget=wt,this.targetIds={},tt.apply(this,arguments)}x(Et,tt,{handler:function(t){var e=xt[t.type],n=function(t,e){var n=P(t.touches),r=this.targetIds;if(e&(B|z)&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,a=P(t.changedTouches),s=[],u=this.target;if(o=n.filter(function(t){return A(t.target,u)}),e===B)for(i=0;i<o.length;)r[o[i].identifier]=!0,i++;i=0;for(;i<a.length;)r[a[i].identifier]&&s.push(a[i]),e&(G|H)&&delete r[a[i].identifier],i++;if(!s.length)return;return[R(o.concat(s),"identifier",!0),s]}.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}});var St=2500,Tt=25;function Ot(){tt.apply(this,arguments);var t=w(this.handler,this);this.touch=new Et(this.manager,t),this.mouse=new ht(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function At(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout(function(){var t=r.indexOf(n);t>-1&&r.splice(t,1)},St)}}x(Ot,tt,{handler:function(t,e,n){var r="touch"==n.pointerType,i="mouse"==n.pointerType;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)(function(t,e){t&B?(this.primaryTouch=e.changedPointers[0].identifier,At.call(this,e)):t&(G|H)&&At.call(this,e)}).call(this,e,n);else if(i&&function(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],o=Math.abs(e-i.x),a=Math.abs(n-i.y);if(o<=Tt&&a<=Tt)return!0}return!1}.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Mt=L(c.style,"touchAction"),Ct=Mt!==s,kt="auto",Pt="manipulation",Rt="none",Lt="pan-x",It="pan-y",Dt=function(){if(!Ct)return!1;var t={},e=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(n){t[n]=!e||i.CSS.supports("touch-action",n)}),t}();function Nt(t,e){this.manager=t,this.set(e)}Nt.prototype={set:function(t){"compute"==t&&(t=this.compute()),Ct&&this.manager.element.style&&Dt[t]&&(this.manager.element.style[Mt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return v(this.manager.recognizers,function(e){E(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),function(t){if(M(t,Rt))return Rt;var e=M(t,Lt),n=M(t,It);if(e&&n)return Rt;if(e||n)return e?Lt:It;if(M(t,Pt))return Pt;return kt}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var r=this.actions,i=M(r,Rt)&&!Dt[Rt],o=M(r,It)&&!Dt[It],a=M(r,Lt)&&!Dt[Lt];if(i){var s=1===t.pointers.length,u=t.distance<2,l=t.deltaTime<250;if(s&&u&&l)return}if(!a||!o)return i||o&&n&$||a&&n&Z?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var jt=1,Ut=2,Ft=4,Bt=8,zt=Bt,Gt=16;function Ht(t){this.options=u({},this.defaults,t||{}),this.id=I++,this.manager=null,this.options.enable=S(this.options.enable,!0),this.state=jt,this.simultaneous={},this.requireFail=[]}function Vt(t){return t&Gt?"cancel":t&Bt?"end":t&Ft?"move":t&Ut?"start":""}function Wt(t){return t==Y?"down":t==X?"up":t==W?"left":t==q?"right":""}function qt(t,e){var n=e.manager;return n?n.get(t):t}function Xt(){Ht.apply(this,arguments)}function Yt(){Xt.apply(this,arguments),this.pX=null,this.pY=null}function $t(){Xt.apply(this,arguments)}function Zt(){Ht.apply(this,arguments),this._timer=null,this._input=null}function Jt(){Xt.apply(this,arguments)}function Kt(){Xt.apply(this,arguments)}function Qt(){Ht.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function te(t,e){return(e=e||{}).recognizers=S(e.recognizers,te.defaults.preset),new ee(t,e)}Ht.prototype={defaults:{},set:function(t){return u(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(g(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=qt(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return g(t,"dropRecognizeWith",this)?this:(t=qt(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(g(t,"requireFailure",this))return this;var e=this.requireFail;return-1===k(e,t=qt(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(g(t,"dropRequireFailure",this))return this;t=qt(t,this);var e=k(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function r(n){e.manager.emit(n,t)}n<Bt&&r(e.options.event+Vt(n)),r(e.options.event),t.additionalEvent&&r(t.additionalEvent),n>=Bt&&r(e.options.event+Vt(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=32},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(32|jt)))return!1;t++}return!0},recognize:function(t){var e=u({},t);if(!E(this.options.enable,[this,e]))return this.reset(),void(this.state=32);this.state&(zt|Gt|32)&&(this.state=jt),this.state=this.process(e),this.state&(Ut|Ft|Bt|Gt)&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},x(Xt,Ht,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,r=e&(Ut|Ft),i=this.attrTest(t);return r&&(n&H||!i)?e|Gt:r||i?n&G?e|Bt:e&Ut?e|Ft:Ut:32}}),x(Yt,Xt,{defaults:{event:"pan",threshold:10,pointers:1,direction:J},getTouchAction:function(){var t=this.options.direction,e=[];return t&$&&e.push(It),t&Z&&e.push(Lt),e},directionTest:function(t){var e=this.options,n=!0,r=t.distance,i=t.direction,o=t.deltaX,a=t.deltaY;return i&e.direction||(e.direction&$?(i=0===o?V:o<0?W:q,n=o!=this.pX,r=Math.abs(t.deltaX)):(i=0===a?V:a<0?X:Y,n=a!=this.pY,r=Math.abs(t.deltaY))),t.direction=i,n&&r>e.threshold&&i&e.direction},attrTest:function(t){return Xt.prototype.attrTest.call(this,t)&&(this.state&Ut||!(this.state&Ut)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Wt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),x($t,Xt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Rt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&Ut)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),x(Zt,Ht,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[kt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime>e.time;if(this._input=t,!r||!n||t.eventType&(G|H)&&!i)this.reset();else if(t.eventType&B)this.reset(),this._timer=m(function(){this.state=zt,this.tryEmit()},e.time,this);else if(t.eventType&G)return zt;return 32},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===zt&&(t&&t.eventType&G?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=d(),this.manager.emit(this.options.event,this._input)))}}),x(Jt,Xt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Rt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&Ut)}}),x(Kt,Xt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:$|Z,pointers:1},getTouchAction:function(){return Yt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return n&($|Z)?e=t.overallVelocity:n&$?e=t.overallVelocityX:n&Z&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&f(e)>this.options.velocity&&t.eventType&G},emit:function(t){var e=Wt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),x(Qt,Ht,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Pt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime<e.time;if(this.reset(),t.eventType&B&&0===this.count)return this.failTimeout();if(r&&i&&n){if(t.eventType!=G)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,a=!this.pCenter||at(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,a&&o?this.count+=1:this.count=1,this._input=t,0===this.count%e.taps)return this.hasRequireFailures()?(this._timer=m(function(){this.state=zt,this.tryEmit()},e.interval,this),Ut):zt}return 32},failTimeout:function(){return this._timer=m(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==zt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),te.VERSION="2.0.7",te.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[Jt,{enable:!1}],[$t,{enable:!1},["rotate"]],[Kt,{direction:$}],[Yt,{direction:$},["swipe"]],[Qt],[Qt,{event:"doubletap",taps:2},["tap"]],[Zt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function ee(t,e){var n;this.options=u({},te.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new((n=this).options.inputClass||(j?gt:U?Et:N?Ot:ht))(n,et),this.touchAction=new Nt(this,this.options.touchAction),ne(this,!0),v(this.options.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function ne(t,e){var n,r=t.element;r.style&&(v(t.options.cssProps,function(i,o){n=L(r.style,o),e?(t.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=t.oldCssProps[n]||""}),e||(t.oldCssProps={}))}ee.prototype={set:function(t){return u(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var r=this.recognizers,i=e.curRecognizer;(!i||i&&i.state&zt)&&(i=e.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],2===e.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(t),!i&&n.state&(Ut|Ft|Bt)&&(i=e.curRecognizer=n),o++}},get:function(t){if(t instanceof Ht)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(g(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(g(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=k(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(t!==s&&e!==s){var n=this.handlers;return v(C(t),function(t){n[t]=n[t]||[],n[t].push(e)}),this}},off:function(t,e){if(t!==s){var n=this.handlers;return v(C(t),function(t){e?n[t]&&n[t].splice(k(n[t],e),1):delete n[t]}),this}},emit:function(t,e){var n,r,i;this.options.domEvents&&(n=t,r=e,(i=o.createEvent("Event")).initEvent(n,!0,!0),i.gesture=r,r.target.dispatchEvent(i));var a=this.handlers[t]&&this.handlers[t].slice();if(a&&a.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var s=0;s<a.length;)a[s](e),s++}},destroy:function(){this.element&&ne(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},u(te,{INPUT_START:B,INPUT_MOVE:z,INPUT_END:G,INPUT_CANCEL:H,STATE_POSSIBLE:jt,STATE_BEGAN:Ut,STATE_CHANGED:Ft,STATE_ENDED:Bt,STATE_RECOGNIZED:zt,STATE_CANCELLED:Gt,STATE_FAILED:32,DIRECTION_NONE:V,DIRECTION_LEFT:W,DIRECTION_RIGHT:q,DIRECTION_UP:X,DIRECTION_DOWN:Y,DIRECTION_HORIZONTAL:$,DIRECTION_VERTICAL:Z,DIRECTION_ALL:J,Manager:ee,Input:tt,TouchAction:Nt,TouchInput:Et,MouseInput:ht,PointerEventInput:gt,TouchMouseInput:Ot,SingleTouchInput:_t,Recognizer:Ht,AttrRecognizer:Xt,Tap:Qt,Pan:Yt,Swipe:Kt,Pinch:$t,Rotate:Jt,Press:Zt,on:T,off:O,each:v,merge:_,extend:b,assign:u,inherit:x,bindFn:w,prefixed:L}),(void 0!==i?i:"undefined"!=typeof self?self:{}).Hammer=te,(r=function(){return te}.call(e,n,e,t))===s||(t.exports=r)}(window,document)},function(t,e){t.exports="\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='28' viewBox='0 0 302.62219 263.65625'%3E%3Cg transform='translate(-163.588 -156.305)' stroke='%23000' fill='none'%3E%3Ccircle cx='271.429' cy='263.791' r='95.714' stroke-width='20'/%3E%3Cpath d='M345.714 329.505l107.143 77.143' stroke-width='25' stroke-linecap='round'/%3E%3Cpath d='M271.143 197.79v134.286M338.857 265.79H204.571' stroke-width='15' stroke-linecap='round'/%3E%3C/g%3E%3C/svg%3E\""},function(t,e){t.exports="\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='44.8' height='39.2' viewBox='0 0 302.62219 263.65625'%3E%3Cg transform='translate(-163.588 -156.305)' stroke='%23000' fill='none'%3E%3Ccircle cx='271.429' cy='263.791' r='95.714' stroke-width='20'/%3E%3Cpath d='M345.714 329.505l107.143 77.143' stroke-width='25' stroke-linecap='round'/%3E%3Cpath d='M338.857 265.79H204.571' stroke-width='15' stroke-linecap='round'/%3E%3C/g%3E%3C/svg%3E\""}])},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(1),o=(r=i)&&r.__esModule?r:{default:r};e.default=function(t){switch(t.renderingMode){case"web":return o.default.createElement("span",null,"inline web");case"pdf":return o.default.createElement("span",null,"inline pdf");case"epub-reflowable":return o.default.createElement("span",null,"inline epub reflowable");case"epub-fixed":return o.default.createElement("span",null,"inline epub fixed");case"micro":return o.default.createElement("span",null,"inline micro");default:return null}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.meta=e.Inline=e.Block=void 0;var r=a(n(574)),i=a(n(620)),o=a(n(280));function a(t){return t&&t.__esModule?t:{default:t}}e.Block=r.default,e.Inline=i.default,e.meta=o.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=u(n(1)),i=u(n(2)),o=u(n(280)),a=n(50),s=u(n(575));function u(t){return t&&t.__esModule?t:{default:t}}var l=function(t,e){var n=t.resource,i=t.renderingMode,u=e.assetsData,l=e.getAssetUri;switch(i){case"web":return r.default.createElement(s.default,{getAppropriateAssetUri:function(t){var e=(0,a.pickSubAsset)(t,o.default.assetPickingRules.image[i],u);if(e)return l(e.asset)},resource:n});case"pdf":case"epub-reflowable":case"epub-fixed":case"micro":default:return r.default.createElement("div",null,n.data.map(function(t,e){var n=(0,a.pickSubAsset)(t,o.default.assetPickingRules.image[i],u);if(n){var s=l(n.asset);return r.default.createElement("img",{src:s,key:e})}return null}))}};l.contextTypes={assetsData:i.default.object,getAssetUri:i.default.func},e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(1),o=s(i),a=s(n(576));function s(t){return t&&t.__esModule?t:{default:t}}var u=new Function("try {return this===window;}catch(e){ return false;}")(),l=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.setCurrentImage=function(t){n.setState({currentImage:t})},n.nextImage=function(){var t=n.state.currentImage,e=t+1>n.props.resource.data.length-1?0:t+1;n.setState({currentImage:e})},n.previousImage=function(){var t=n.state.currentImage,e=t-1<0?n.props.resource.data.length-1:t-1;n.setState({currentImage:e})},n.onOpenLightBox=function(){n.setState({currentImage:0,lightBoxOpen:!0})},n.onCloseLightBox=function(){n.setState({lightBoxOpen:!1})},n.state={currentImage:0,lightBoxOpen:!1},n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i.Component),r(e,[{key:"render",value:function(){var t=this.props,e=t.resource,n=t.getAppropriateAssetUri,r=this.state,i=r.currentImage,s=void 0===i?0:i,l=r.lightBoxOpen,c=this.nextImage,h=this.previousImage,p=this.onOpenLightBox,f=this.onCloseLightBox,d=this.setCurrentImage,m=e.data&&e.data.map(function(t){return{src:n(t)}});return u?o.default.createElement("figure",null,o.default.createElement("img",{src:m[s].src,onClick:p}),o.default.createElement("ul",null,m.map(function(t,e){var n=e===s;return o.default.createElement("li",{key:e},o.default.createElement("button",{onClick:function(){return d(e)},className:"imageButton "+(n?"active":"")},e+1))})),o.default.createElement(a.default,{images:m,isOpen:l,currentImage:s,onClickPrev:h,onClickNext:c,onClose:f})):o.default.createElement("div",null,o.default.createElement("img",{src:m[s].src}))}}]),e}();e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=b(n(2)),o=n(1),a=b(o),s=n(281),u=b(n(594)),l=b(n(61)),c=b(n(285)),h=b(n(601)),p=b(n(602)),f=b(n(603)),d=b(n(604)),m=b(n(606)),g=b(n(618)),v=b(n(619)),y=b(n(81));function b(t){return t&&t.__esModule?t:{default:t}}var _=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.theme=(0,y.default)(l.default,t.theme),n.classes=s.StyleSheet.create((0,y.default)(x,n.theme)),g.default.call(n,["gotoNext","gotoPrev","closeBackdrop","handleKeyboardInput"]),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Component),r(e,[{key:"getChildContext",value:function(){return{theme:this.theme}}},{key:"componentDidMount",value:function(){this.props.isOpen&&this.props.enableKeyboardInput&&window.addEventListener("keydown",this.handleKeyboardInput)}},{key:"componentWillReceiveProps",value:function(t){if(v.default){if(t.preloadNextImage){var e=this.props.currentImage,n=t.currentImage+1,r=t.currentImage-1,i=void 0;e&&t.currentImage>e?i=n:e&&t.currentImage<e&&(i=r),i?this.preloadImage(i):(this.preloadImage(r),this.preloadImage(n))}!this.props.isOpen&&t.isOpen&&t.enableKeyboardInput&&window.addEventListener("keydown",this.handleKeyboardInput),!t.isOpen&&t.enableKeyboardInput&&window.removeEventListener("keydown",this.handleKeyboardInput)}}},{key:"componentWillUnmount",value:function(){this.props.enableKeyboardInput&&window.removeEventListener("keydown",this.handleKeyboardInput)}},{key:"preloadImage",value:function(t){var e=this.props.images[t];if(e){var n=new Image;n.src=e.src,n.srcSet=e.srcSet||e.srcset}}},{key:"gotoNext",value:function(t){this.props.currentImage!==this.props.images.length-1&&(t&&(t.preventDefault(),t.stopPropagation()),this.props.onClickNext())}},{key:"gotoPrev",value:function(t){0!==this.props.currentImage&&(t&&(t.preventDefault(),t.stopPropagation()),this.props.onClickPrev())}},{key:"closeBackdrop",value:function(t){"lightboxBackdrop"!==t.target.id&&"FIGURE"!==t.target.tagName||this.props.onClose()}},{key:"handleKeyboardInput",value:function(t){return 37===t.keyCode?(this.gotoPrev(t),!0):39===t.keyCode?(this.gotoNext(t),!0):27===t.keyCode&&(this.props.onClose(),!0)}},{key:"renderArrowPrev",value:function(){return 0===this.props.currentImage?null:a.default.createElement(c.default,{direction:"left",icon:"arrowLeft",onClick:this.gotoPrev,title:this.props.leftArrowTitle,type:"button"})}},{key:"renderArrowNext",value:function(){return this.props.currentImage===this.props.images.length-1?null:a.default.createElement(c.default,{direction:"right",icon:"arrowRight",onClick:this.gotoNext,title:this.props.rightArrowTitle,type:"button"})}},{key:"renderDialog",value:function(){var t=this.props,e=t.backdropClosesModal,n=t.customControls,r=t.isOpen,i=t.onClose,o=t.showCloseButton,l=t.showThumbnails,c=t.width;if(!r)return a.default.createElement("span",{key:"closed"});var p=0;return l&&(p=this.theme.thumbnail.size+this.theme.container.gutter.vertical),a.default.createElement(h.default,{key:"open",onClick:e&&this.closeBackdrop,onTouchEnd:e&&this.closeBackdrop},a.default.createElement("div",{className:(0,s.css)(this.classes.content),style:{marginBottom:p,maxWidth:c}},a.default.createElement(f.default,{customControls:n,onClose:i,showCloseButton:o,closeButtonTitle:this.props.closeButtonTitle}),this.renderImages()),this.renderThumbnails(),this.renderArrowPrev(),this.renderArrowNext(),a.default.createElement(u.default,null))}},{key:"renderImages",value:function(){var t=this.props,e=t.currentImage,n=t.images,r=t.imageCountSeparator,i=t.onClickImage,o=t.showImageCount,u=t.showThumbnails;if(!n||!n.length)return null;var l=n[e];l.srcSet=l.srcSet||l.srcset;var c=void 0,h=void 0;l.srcSet&&(c=l.srcSet.join(),h="100vw");var f=u?this.theme.thumbnail.size:0,d=this.theme.header.height+this.theme.footer.height+f+this.theme.container.gutter.vertical+"px";return a.default.createElement("figure",{className:(0,s.css)(this.classes.figure)},a.default.createElement("img",{className:(0,s.css)(this.classes.image),onClick:i,sizes:h,alt:l.alt,src:l.src,srcSet:c,style:{cursor:i?"pointer":"auto",maxHeight:"calc(100vh - "+d+")"}}),a.default.createElement(p.default,{caption:n[e].caption,countCurrent:e+1,countSeparator:r,countTotal:n.length,showCount:o}))}},{key:"renderThumbnails",value:function(){var t=this.props,e=t.images,n=t.currentImage,r=t.onClickThumbnail,i=t.showThumbnails,o=t.thumbnailOffset;if(i)return a.default.createElement(d.default,{currentImage:n,images:e,offset:o,onClickThumbnail:r})}},{key:"render",value:function(){return a.default.createElement(m.default,null,this.renderDialog())}}]),e}();_.propTypes={backdropClosesModal:i.default.bool,closeButtonTitle:i.default.string,currentImage:i.default.number,customControls:i.default.arrayOf(i.default.node),enableKeyboardInput:i.default.bool,imageCountSeparator:i.default.string,images:i.default.arrayOf(i.default.shape({src:i.default.string.isRequired,srcSet:i.default.array,caption:i.default.oneOfType([i.default.string,i.default.element]),thumbnail:i.default.string})).isRequired,isOpen:i.default.bool,leftArrowTitle:i.default.string,onClickImage:i.default.func,onClickNext:i.default.func,onClickPrev:i.default.func,onClose:i.default.func.isRequired,preloadNextImage:i.default.bool,rightArrowTitle:i.default.string,showCloseButton:i.default.bool,showImageCount:i.default.bool,showThumbnails:i.default.bool,theme:i.default.object,thumbnailOffset:i.default.number,width:i.default.number},_.defaultProps={closeButtonTitle:"Close (Esc)",currentImage:0,enableKeyboardInput:!0,imageCountSeparator:" of ",leftArrowTitle:"Previous (Left arrow key)",onClickShowNextImage:!0,preloadNextImage:!0,rightArrowTitle:"Next (Right arrow key)",showCloseButton:!0,showImageCount:!0,theme:{},thumbnailOffset:2,width:1024},_.childContextTypes={theme:i.default.object.isRequired};var x={content:{position:"relative"},figure:{margin:0},image:{display:"block",height:"auto",margin:"0 auto",maxWidth:"100%",WebkitTouchCallout:"none",userSelect:"none"}};e.default=_},function(t,e,n){"use strict";var r=n(578),i=[],o=[],a=r.makeRequestCallFromTimer(function(){if(o.length)throw o.shift()});function s(t){var e;(e=i.length?i.pop():new u).task=t,r(e)}function u(){this.task=null}t.exports=s,u.prototype.call=function(){try{this.task.call()}catch(t){s.onerror?s.onerror(t):(o.push(t),a())}finally{this.task=null,i[i.length]=this}}},function(t,e,n){"use strict";(function(e){function n(t){i.length||(r(),!0),i[i.length]=t}t.exports=n;var r,i=[],o=0,a=1024;function s(){for(;o<i.length;){var t=o;if(o+=1,i[t].call(),o>a){for(var e=0,n=i.length-o;e<n;e++)i[e]=i[e+o];i.length-=o,o=0}}i.length=0,o=0,!1}var u,l,c,h=void 0!==e?e:self,p=h.MutationObserver||h.WebKitMutationObserver;function f(t){return function(){var e=setTimeout(r,0),n=setInterval(r,50);function r(){clearTimeout(e),clearInterval(n),t()}}}"function"==typeof p?(u=1,l=new p(s),c=document.createTextNode(""),l.observe(c,{characterData:!0}),r=function(){u=-u,c.data=u}):r=f(s),n.requestFlush=r,n.makeRequestCallFromTimer=f}).call(e,n(78))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();var i,o=n(580),a=(i=o)&&i.__esModule?i:{default:i},s=n(178);e.generateCSS=function t(e,n,r,i){var o=n.reduce(s.recursiveMerge),a={},l={},c={};return Object.keys(o).forEach(function(t){":"===t[0]?c[t]=o[t]:"@"===t[0]?l[t]=o[t]:a[t]=o[t]}),u(e,a,r,i)+Object.keys(c).map(function(t){return u(e+t,c[t],r,i)}).join("")+Object.keys(l).map(function(n){return n+"{"+t(e,[l[n]],r,i)+"}"}).join("")};var u=function(t,e,n,i){var o,u,l,c=(o=e,u=n,l={},Object.keys(o).forEach(function(t){u&&u.hasOwnProperty(t)?l[t]=u[t](o[t]):l[t]=o[t]}),l),h=(0,a.default)(c),p=(0,s.flatten)((0,s.objectToPairs)(h).map(function(t){var e,n,i=r(t,2),o=i[0],a=i[1];if(Array.isArray(a)){var s=(e=[],n=[],a.forEach(function(t){0===t.indexOf("-")?e.push(t):n.push(t)}),e.sort(),n.sort(),{v:e.concat(n).map(function(t){return[o,t]})});if("object"==typeof s)return s.v}return[[o,a]]})).map(function(t){var e=r(t,2),n=e[0],o=e[1],a=(0,s.stringifyValue)(n,o),u=(0,s.kebabifyStyleName)(n)+":"+a+";";return!1===i?u:(0,s.importantify)(u)}).join("");return p?t+"{"+p+"}":""};e.generateCSSRuleset=u},function(t,e,n){t.exports=n(581)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function t(e){Object.keys(e).forEach(function(n){var o=e[n];o instanceof Object&&!Array.isArray(o)?e[n]=t(o):Object.keys(r.default).forEach(function(t){var a=r.default[t];a[n]&&(e[t+(0,i.default)(n)]=o)})});Object.keys(e).forEach(function(t){[].concat(e[t]).forEach(function(n,r){g.forEach(function(r){return function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];Object.keys(e).forEach(function(n){var r=t[n];Array.isArray(r)?[].concat(e[n]).forEach(function(e){var i=r.indexOf(e);i>-1&&t[n].splice(i,1),t[n].push(e)}):t[n]=e[n]})}(e,r(t,n))})})});return(0,o.default)(e)};var r=m(n(283)),i=m(n(284)),o=m(n(582)),a=m(n(584)),s=m(n(585)),u=m(n(586)),l=m(n(587)),c=m(n(588)),h=m(n(589)),p=m(n(590)),f=m(n(592)),d=m(n(593));function m(t){return t&&t.__esModule?t:{default:t}}var g=[a.default,s.default,u.default,c.default,h.default,p.default,f.default,d.default,l.default];t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return Object.keys(t).sort(function(t,e){return(0,o.default)(t)&&!(0,o.default)(e)?-1:!(0,o.default)(t)&&(0,o.default)(e)?1:0}).reduce(function(e,n){return e[n]=t[n],e},{})};var r,i=n(583),o=(r=i)&&r.__esModule?r:{default:r};t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return null!==t.match(/^(Webkit|Moz|O|ms)/)},t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("position"===t&&"sticky"===e)return{position:["-webkit-sticky","sticky"]}},t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("string"==typeof e&&!(0,i.default)(e)&&e.indexOf("calc(")>-1)return(0,r.default)(t,e,function(t,e){return e.replace(/calc\(/g,t+"calc(")})};var r=o(n(118)),i=o(n(179));function o(t){return t&&t.__esModule?t:{default:t}}t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("cursor"===t&&a[e])return(0,o.default)(t,e)};var r,i=n(118),o=(r=i)&&r.__esModule?r:{default:r};var a={"zoom-in":!0,"zoom-out":!0,grab:!0,grabbing:!0};t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("display"===t&&r[e])return{display:["-webkit-box","-moz-box","-ms-"+e+"box","-webkit-"+e,e]}};var r={flex:!0,"inline-flex":!0};t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if(a[t]&&s[e])return(0,o.default)(t,e)};var r,i=n(118),o=(r=i)&&r.__esModule?r:{default:r};var a={maxHeight:!0,maxWidth:!0,width:!0,height:!0,columnWidth:!0,minWidth:!0,minHeight:!0},s={"min-content":!0,"max-content":!0,"fill-available":!0,"fit-content":!0,"contain-floats":!0};t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("string"==typeof e&&!(0,i.default)(e)&&null!==e.match(a))return(0,r.default)(t,e)};var r=o(n(118)),i=o(n(179));function o(t){return t&&t.__esModule?t:{default:t}}var a=/linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/;t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("string"==typeof e&&l[t]){var n,s=function(t){if((0,o.default)(t))return t;var e=t.split(/,(?![^()]*(?:\([^()]*\))?\))/g);return e.forEach(function(t,n){e[n]=Object.keys(a.default).reduce(function(e,n){var i="-"+n.toLowerCase()+"-";return Object.keys(a.default[n]).forEach(function(n){var o=(0,r.default)(n);t.indexOf(o)>-1&&"order"!==o&&(e=t.replace(o,i+o)+","+e)}),e},t)}),e.join(",")}(e),c=s.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(t){return null===t.match(/-moz-|-ms-/)}).join(",");return t.indexOf("Webkit")>-1?u({},t,c):(u(n={},"Webkit"+(0,i.default)(t),c),u(n,t,s),n)}};var r=s(n(591)),i=s(n(284)),o=s(n(179)),a=s(n(283));function s(t){return t&&t.__esModule?t:{default:t}}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var l={transition:!0,transitionProperty:!0,WebkitTransition:!0,WebkitTransitionProperty:!0};t.exports=e.default},function(t,e,n){"use strict";var r=/[A-Z]/g,i=/^ms-/,o={};t.exports=function(t){return t in o?o[t]:o[t]=t.replace(r,"-$&").toLowerCase().replace(i,"-ms-")}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if(i[t])return function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n;return t}({},i[t],r[e]||e)};var r={"space-around":"distribute","space-between":"justify","flex-start":"start","flex-end":"end"},i={alignContent:"msFlexLinePack",alignSelf:"msFlexItemAlign",alignItems:"msFlexAlign",justifyContent:"msFlexPack",order:"msFlexOrder",flexGrow:"msFlexPositive",flexShrink:"msFlexNegative",flexBasis:"msPreferredSize"};t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("flexDirection"===t&&"string"==typeof e)return{WebkitBoxOrient:e.indexOf("column")>-1?"vertical":"horizontal",WebkitBoxDirection:e.indexOf("reverse")>-1?"reverse":"normal"};if(i[t])return function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n;return t}({},i[t],r[e]||e)};var r={"space-around":"justify","space-between":"justify","flex-start":"start","flex-end":"end","wrap-reverse":"multiple",wrap:"multiple"},i={alignItems:"WebkitBoxAlign",justifyContent:"WebkitBoxPack",flexWrap:"WebkitBoxLines"};t.exports=e.default},function(t,e,n){t.exports=n(595)},function(t,e,n){n(1);var r=n(2),i={capture:!1,passive:!1},o=n(596)({propTypes:{scrollTarget:r.object,preventContentJumping:r.bool},componentDidMount:function(){if(l()){var t=this.props.scrollTarget,e=document.body;if(this.props.preventContentJumping){var n=window.innerWidth-document.body.clientWidth;e.style.paddingRight=n+"px"}e.style.overflowY="hidden",e.addEventListener("touchmove",a,i),t&&(t.addEventListener("touchstart",u,i),t.addEventListener("touchmove",s,i))}},componentWillUnmount:function(){if(l()){var t=this.props.scrollTarget,e=document.body;this.props.preventContentJumping&&(e.style.paddingRight=""),e.style.overflowY="",e.removeEventListener("touchmove",a,i),t&&(t.removeEventListener("touchstart",u,i),t.removeEventListener("touchmove",s,i))}},render:function(){return null}});function a(t){t.preventDefault()}function s(t){t.stopPropagation()}function u(){var t=this.scrollTop,e=this.scrollHeight,n=t+this.offsetHeight;0===t?this.scrollTop=1:n===e&&(this.scrollTop=t-1)}function l(){return!("undefined"==typeof window||!window.document||!window.document.createElement)}o.defaultProps={preventContentJumping:!0},t.exports=o},function(t,e,n){"use strict";var r=n(1),i=n(260);if(void 0===r)throw Error("create-react-class could not find the React object. If you are using script tags, make sure that React is being loaded before create-react-class.");var o=(new r.Component).updater;t.exports=i(r.Component,r.isValidElement,o)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(282),i=n(281);e.StyleSheet=i.StyleSheet,e.StyleSheetServer=i.StyleSheetServer,e.StyleSheetTestUtils=i.StyleSheetTestUtils,e.css=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return(0,r.injectAndGetClassName)(!1,e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return'<svg fill="'+t+'" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="100%" height="100%" viewBox="0 0 512 512" xml:space="preserve">\n\t\t<path d="M213.7,256L213.7,256L213.7,256L380.9,81.9c4.2-4.3,4.1-11.4-0.2-15.8l-29.9-30.6c-4.3-4.4-11.3-4.5-15.5-0.2L131.1,247.9 c-2.2,2.2-3.2,5.2-3,8.1c-0.1,3,0.9,5.9,3,8.1l204.2,212.7c4.2,4.3,11.2,4.2,15.5-0.2l29.9-30.6c4.3-4.4,4.4-11.5,0.2-15.8 L213.7,256z"/>\n\t</svg>'}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return'<svg fill="'+t+'" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="100%" height="100%" viewBox="0 0 512 512" xml:space="preserve">\n\t\t<path d="M298.3,256L298.3,256L298.3,256L131.1,81.9c-4.2-4.3-4.1-11.4,0.2-15.8l29.9-30.6c4.3-4.4,11.3-4.5,15.5-0.2l204.2,212.7 c2.2,2.2,3.2,5.2,3,8.1c0.1,3-0.9,5.9-3,8.1L176.7,476.8c-4.2,4.3-11.2,4.2-15.5-0.2L131.3,446c-4.3-4.4-4.4-11.5-0.2-15.8 L298.3,256z"/>\n\t</svg>'}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return'<svg fill="'+t+'" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="100%" height="100%" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512;" xml:space="preserve">\n\t\t<path d="M443.6,387.1L312.4,255.4l131.5-130c5.4-5.4,5.4-14.2,0-19.6l-37.4-37.6c-2.6-2.6-6.1-4-9.8-4c-3.7,0-7.2,1.5-9.8,4 L256,197.8L124.9,68.3c-2.6-2.6-6.1-4-9.8-4c-3.7,0-7.2,1.5-9.8,4L68,105.9c-5.4,5.4-5.4,14.2,0,19.6l131.5,130L68.4,387.1 c-2.6,2.6-4.1,6.1-4.1,9.8c0,3.7,1.4,7.2,4.1,9.8l37.4,37.6c2.7,2.7,6.2,4.1,9.8,4.1c3.5,0,7.1-1.3,9.8-4.1L256,313.1l130.7,131.1 c2.7,2.7,6.2,4.1,9.8,4.1c3.5,0,7.1-1.3,9.8-4.1l37.4-37.6c2.6-2.6,4.1-6.1,4.1-9.8C447.7,393.2,446.2,389.7,443.6,387.1z"/>\n\t</svg>'}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=l(n(2)),o=l(n(1)),a=n(80),s=l(n(61)),u=l(n(81));function l(t){return t&&t.__esModule?t:{default:t}}function c(t,e){var n=e.theme,i=function(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}(t,[]),s=a.StyleSheet.create((0,u.default)(h,n));return o.default.createElement("div",r({id:"lightboxBackdrop",className:(0,a.css)(s.container)},i))}c.contextTypes={theme:i.default.object.isRequired};var h={container:{alignItems:"center",backgroundColor:s.default.container.background,boxSizing:"border-box",display:"flex",height:"100%",justifyContent:"center",left:0,paddingBottom:s.default.container.gutter.vertical,paddingLeft:s.default.container.gutter.horizontal,paddingRight:s.default.container.gutter.horizontal,paddingTop:s.default.container.gutter.vertical,position:"fixed",top:0,width:"100%",zIndex:s.default.container.zIndex}};e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=l(n(2)),o=l(n(1)),a=n(80),s=l(n(61)),u=l(n(81));function l(t){return t&&t.__esModule?t:{default:t}}function c(t,e){var n=e.theme,i=t.caption,s=t.countCurrent,l=t.countSeparator,c=t.countTotal,p=t.showCount,f=function(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}(t,["caption","countCurrent","countSeparator","countTotal","showCount"]);if(!i&&!p)return null;var d=a.StyleSheet.create((0,u.default)(h,n)),m=p?o.default.createElement("div",{className:(0,a.css)(d.footerCount)},s,l,c):o.default.createElement("span",null);return o.default.createElement("div",r({className:(0,a.css)(d.footer)},f),i?o.default.createElement("figcaption",{className:(0,a.css)(d.footerCaption)},i):o.default.createElement("span",null),m)}c.propTypes={caption:i.default.oneOfType([i.default.string,i.default.element]),countCurrent:i.default.number,countSeparator:i.default.string,countTotal:i.default.number,showCount:i.default.bool},c.contextTypes={theme:i.default.object.isRequired};var h={footer:{boxSizing:"border-box",color:s.default.footer.color,cursor:"auto",display:"flex",justifyContent:"space-between",left:0,lineHeight:1.3,paddingBottom:s.default.footer.gutter.vertical,paddingLeft:s.default.footer.gutter.horizontal,paddingRight:s.default.footer.gutter.horizontal,paddingTop:s.default.footer.gutter.vertical},footerCount:{color:s.default.footer.count.color,fontSize:s.default.footer.count.fontSize,paddingLeft:"1em"},footerCaption:{flex:"1 1 0"}};e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=c(n(2)),o=c(n(1)),a=n(80),s=c(n(61)),u=c(n(81)),l=c(n(286));function c(t){return t&&t.__esModule?t:{default:t}}function h(t,e){var n=e.theme,i=t.customControls,c=t.onClose,h=t.showCloseButton,f=t.closeButtonTitle,d=function(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}(t,["customControls","onClose","showCloseButton","closeButtonTitle"]),m=a.StyleSheet.create((0,u.default)(p,n));return o.default.createElement("div",r({className:(0,a.css)(m.header)},d),i||o.default.createElement("span",null),!!h&&o.default.createElement("button",{title:f,className:(0,a.css)(m.close),onClick:c},o.default.createElement(l.default,{fill:!!n.close&&n.close.fill||s.default.close.fill,type:"close"})))}h.propTypes={customControls:i.default.array,onClose:i.default.func.isRequired,showCloseButton:i.default.bool},h.contextTypes={theme:i.default.object.isRequired};var p={header:{display:"flex",justifyContent:"space-between",height:s.default.header.height},close:{background:"none",border:"none",cursor:"pointer",outline:"none",position:"relative",top:0,verticalAlign:"bottom",height:40,marginRight:-10,padding:10,width:40}};e.default=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=p(n(2)),a=n(1),s=p(a),u=n(80),l=p(n(605)),c=p(n(285)),h=p(n(61));function p(t){return t&&t.__esModule?t:{default:t}}var f=u.StyleSheet.create({paginatedThumbnails:{bottom:h.default.container.gutter.vertical,height:h.default.thumbnail.size,padding:"0 50px",position:"absolute",textAlign:"center",whiteSpace:"nowrap",left:"50%",transform:"translateX(-50%)"}}),d={height:h.default.thumbnail.size+2*h.default.thumbnail.gutter,width:40},m=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.state={hasCustomPage:!1},n.gotoPrev=n.gotoPrev.bind(n),n.gotoNext=n.gotoNext.bind(n),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.Component),i(e,[{key:"componentWillReceiveProps",value:function(t){t.currentImage!==this.props.currentImage&&this.setState({hasCustomPage:!1})}},{key:"getFirst",value:function(){var t=this.props,e=t.currentImage,n=t.offset;return this.state.hasCustomPage?this.clampFirst(this.state.first):this.clampFirst(e-n)}},{key:"setFirst",value:function(t,e){var n=this.state.first;t&&(t.preventDefault(),t.stopPropagation()),n!==e&&this.setState({hasCustomPage:!0,first:e})}},{key:"gotoPrev",value:function(t){this.setFirst(t,this.getFirst()-this.props.offset)}},{key:"gotoNext",value:function(t){this.setFirst(t,this.getFirst()+this.props.offset)}},{key:"clampFirst",value:function(t){var e=this.props,n=e.images,r=2*e.offset+1;return t<0?0:t+r>n.length?n.length-r:t}},{key:"renderArrowPrev",value:function(){return this.getFirst()<=0?null:s.default.createElement(c.default,{direction:"left",size:"small",icon:"arrowLeft",onClick:this.gotoPrev,style:d,title:"Previous (Left arrow key)",type:"button"})}},{key:"renderArrowNext",value:function(){var t=this.props,e=t.offset,n=t.images,r=2*e+1;return this.getFirst()+r>=n.length?null:s.default.createElement(c.default,{direction:"right",size:"small",icon:"arrowRight",onClick:this.gotoNext,style:d,title:"Next (Right arrow key)",type:"button"})}},{key:"render",value:function(){var t=this.props,e=t.images,n=t.currentImage,i=t.onClickThumbnail,o=2*t.offset+1,a=[],c=0;return e.length<=o?a=e:(c=this.getFirst(),a=e.slice(c,c+o)),s.default.createElement("div",{className:(0,u.css)(f.paginatedThumbnails)},this.renderArrowPrev(),a.map(function(t,e){return s.default.createElement(l.default,r({key:c+e},t,{index:c+e,onClick:i,active:c+e===n}))}),this.renderArrowNext())}}]),e}();e.default=m,m.propTypes={currentImage:o.default.number,images:o.default.array,offset:o.default.number,onClickThumbnail:o.default.func.isRequired}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=u(n(2)),i=u(n(1)),o=n(80),a=u(n(61)),s=u(n(81));function u(t){return t&&t.__esModule?t:{default:t}}function l(t,e){var n=t.index,r=t.src,a=t.thumbnail,u=t.active,l=t.onClick,h=e.theme,p=a||r,f=o.StyleSheet.create((0,s.default)(c,h));return i.default.createElement("div",{className:(0,o.css)(f.thumbnail,u&&f.thumbnail__active),onClick:function(t){t.preventDefault(),t.stopPropagation(),l(n)},style:{backgroundImage:'url("'+p+'")'}})}l.propTypes={active:r.default.bool,index:r.default.number,onClick:r.default.func.isRequired,src:r.default.string,thumbnail:r.default.string},l.contextTypes={theme:r.default.object.isRequired};var c={thumbnail:{backgroundPosition:"center",backgroundSize:"cover",borderRadius:2,boxShadow:"inset 0 0 0 1px hsla(0,0%,100%,.2)",cursor:"pointer",display:"inline-block",height:a.default.thumbnail.size,margin:a.default.thumbnail.gutter,overflow:"hidden",width:a.default.thumbnail.size},thumbnail__active:{boxShadow:"inset 0 0 0 2px "+a.default.thumbnail.activeBorderColor}};e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=h(n(2)),a=n(1),s=h(a),u=n(607),l=n(49),c=h(n(617));function h(t){return t&&t.__esModule?t:{default:t}}var p=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.portalElement=null,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.Component),i(e,[{key:"componentDidMount",value:function(){var t=document.createElement("div");document.body.appendChild(t),this.portalElement=t,this.componentDidUpdate()}},{key:"componentDidUpdate",value:function(){(0,l.render)(s.default.createElement(c.default,{context:this.context},s.default.createElement("div",null,s.default.createElement("style",null,"\n\t\t\t\t.fade-enter { opacity: 0.01; }\n\t\t\t\t.fade-enter.fade-enter-active { opacity: 1; transition: opacity 200ms; }\n\t\t\t\t.fade-leave { opacity: 1; }\n\t\t\t\t.fade-leave.fade-leave-active { opacity: 0.01; transition: opacity 200ms; }\n\t\t"),s.default.createElement(u.CSSTransitionGroup,r({component:"div",transitionName:"fade",transitionEnterTimeout:200,transitionLeaveTimeout:200},this.props)))),this.portalElement)}},{key:"componentWillUnmount",value:function(){document.body.removeChild(this.portalElement)}},{key:"render",value:function(){return null}}]),e}();e.default=p,p.contextTypes={theme:o.default.object.isRequired}},function(t,e,n){"use strict";var r=o(n(608)),i=o(n(287));function o(t){return t&&t.__esModule?t:{default:t}}t.exports={TransitionGroup:i.default,CSSTransitionGroup:r.default}},function(t,e,n){"use strict";e.__esModule=!0;var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=l(n(1)),o=l(n(2)),a=l(n(287)),s=l(n(611)),u=n(289);function l(t){return t&&t.__esModule?t:{default:t}}function c(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}u.nameShape.isRequired,o.default.bool,o.default.bool,o.default.bool,(0,u.transitionTimeout)("Appear"),(0,u.transitionTimeout)("Enter"),(0,u.transitionTimeout)("Leave");var h=function(t){function e(){var n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var o=arguments.length,a=Array(o),u=0;u<o;u++)a[u]=arguments[u];return n=r=c(this,t.call.apply(t,[this].concat(a))),r._wrapChild=function(t){return i.default.createElement(s.default,{name:r.props.transitionName,appear:r.props.transitionAppear,enter:r.props.transitionEnter,leave:r.props.transitionLeave,appearTimeout:r.props.transitionAppearTimeout,enterTimeout:r.props.transitionEnterTimeout,leaveTimeout:r.props.transitionLeaveTimeout},t)},c(r,n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.render=function(){return i.default.createElement(a.default,r({},this.props,{childFactory:this._wrapChild}))},e}(i.default.Component);h.displayName="CSSTransitionGroup",h.propTypes={},h.defaultProps={transitionAppear:!1,transitionEnter:!0,transitionLeave:!0},e.default=h,t.exports=e.default},function(t,e){t.exports=function(){for(var t=arguments.length,e=[],n=0;n<t;n++)e[n]=arguments[n];if(0!==(e=e.filter(function(t){return null!=t})).length)return 1===e.length?e[0]:e.reduce(function(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}})}},function(t,e,n){"use strict";e.__esModule=!0,e.getChildMapping=function(t){if(!t)return t;var e={};return r.Children.map(t,function(t){return t}).forEach(function(t){e[t.key]=t}),e},e.mergeChildMappings=function(t,e){function n(n){return e.hasOwnProperty(n)?e[n]:t[n]}t=t||{},e=e||{};var r={},i=[];for(var o in t)e.hasOwnProperty(o)?i.length&&(r[o]=i,i=[]):i.push(o);var a=void 0,s={};for(var u in e){if(r.hasOwnProperty(u))for(a=0;a<r[u].length;a++){var l=r[u][a];s[r[u][a]]=n(l)}s[u]=n(u)}for(a=0;a<i.length;a++)s[i[a]]=n(i[a]);return s};var r=n(1)},function(t,e,n){"use strict";e.__esModule=!0;var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=p(n(612)),o=p(n(614)),a=p(n(615)),s=n(616),u=p(n(1)),l=p(n(2)),c=n(49),h=n(289);function p(t){return t&&t.__esModule?t:{default:t}}function f(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var d=[];s.transitionEnd&&d.push(s.transitionEnd),s.animationEnd&&d.push(s.animationEnd);l.default.node,h.nameShape.isRequired,l.default.bool,l.default.bool,l.default.bool,l.default.number,l.default.number,l.default.number;var m=function(t){function e(){var n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=r=f(this,t.call.apply(t,[this].concat(o))),r.componentWillAppear=function(t){r.props.appear?r.transition("appear",t,r.props.appearTimeout):t()},r.componentWillEnter=function(t){r.props.enter?r.transition("enter",t,r.props.enterTimeout):t()},r.componentWillLeave=function(t){r.props.leave?r.transition("leave",t,r.props.leaveTimeout):t()},f(r,n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.componentWillMount=function(){this.classNameAndNodeQueue=[],this.transitionTimeouts=[]},e.prototype.componentWillUnmount=function(){this.unmounted=!0,this.timeout&&clearTimeout(this.timeout),this.transitionTimeouts.forEach(function(t){clearTimeout(t)}),this.classNameAndNodeQueue.length=0},e.prototype.transition=function(t,e,n){var r=(0,c.findDOMNode)(this);if(r){var a=this.props.name[t]||this.props.name+"-"+t,u=this.props.name[t+"Active"]||a+"-active",l=null,h=void 0;(0,i.default)(r,a),this.queueClassAndNode(u,r);var p,f,m=function(t){t&&t.target!==r||(clearTimeout(l),h&&h(),(0,o.default)(r,a),(0,o.default)(r,u),h&&h(),e&&e())};n?(l=setTimeout(m,n),this.transitionTimeouts.push(l)):s.transitionEnd&&(p=r,f=m,d.length?d.forEach(function(t){return p.addEventListener(t,f,!1)}):setTimeout(f,0),h=function(){d.length&&d.forEach(function(t){return p.removeEventListener(t,f,!1)})})}else e&&e()},e.prototype.queueClassAndNode=function(t,e){var n=this;this.classNameAndNodeQueue.push({className:t,node:e}),this.rafHandle||(this.rafHandle=(0,a.default)(function(){return n.flushClassNameAndNodeQueue()}))},e.prototype.flushClassNameAndNodeQueue=function(){this.unmounted||this.classNameAndNodeQueue.forEach(function(t){t.node.scrollTop,(0,i.default)(t.node,t.className)}),this.classNameAndNodeQueue.length=0,this.rafHandle=null},e.prototype.render=function(){var t=r({},this.props);return delete t.name,delete t.appear,delete t.enter,delete t.leave,delete t.appearTimeout,delete t.enterTimeout,delete t.leaveTimeout,delete t.children,u.default.cloneElement(u.default.Children.only(this.props.children),t)},e}(u.default.Component);m.displayName="CSSTransitionGroupChild",m.propTypes={},e.default=m,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){t.classList?t.classList.add(e):(0,o.default)(t,e)||("string"==typeof t.className?t.className=t.className+" "+e:t.setAttribute("class",(t.className&&t.className.baseVal||"")+" "+e))};var r,i=n(613),o=(r=i)&&r.__esModule?r:{default:r};t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){return t.classList?!!e&&t.classList.contains(e):-1!==(" "+(t.className.baseVal||t.className)+" ").indexOf(" "+e+" ")},t.exports=e.default},function(t,e,n){"use strict";function r(t,e){return t.replace(new RegExp("(^|\\s)"+e+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}t.exports=function(t,e){t.classList?t.classList.remove(e):"string"==typeof t.className?t.className=r(t.className,e):t.setAttribute("class",r(t.className&&t.className.baseVal||"",e))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(288);var o,a="clearTimeout",s=function(t){var e=(new Date).getTime(),n=Math.max(0,16-(e-l)),r=setTimeout(t,n);return l=e,r},u=function(t,e){return t+(t?e[0].toUpperCase()+e.substr(1):e)+"AnimationFrame"};((r=i)&&r.__esModule?r:{default:r}).default&&["","webkit","moz","o","ms"].some(function(t){var e=u(t,"request");if(e in window)return a=u(t,"cancel"),s=function(t){return window[e](t)}});var l=(new Date).getTime();(o=function(t){return s(t)}).cancel=function(t){window[a]&&"function"==typeof window[a]&&window[a](t)},e.default=o,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.animationEnd=e.animationDelay=e.animationTiming=e.animationDuration=e.animationName=e.transitionEnd=e.transitionDuration=e.transitionDelay=e.transitionTiming=e.transitionProperty=e.transform=void 0;var r,i=n(288);var o="transform",a=void 0,s=void 0,u=void 0,l=void 0,c=void 0,h=void 0,p=void 0,f=void 0,d=void 0,m=void 0,g=void 0;if(((r=i)&&r.__esModule?r:{default:r}).default){var v=function(){for(var t=document.createElement("div").style,e={O:function(t){return"o"+t.toLowerCase()},Moz:function(t){return t.toLowerCase()},Webkit:function(t){return"webkit"+t},ms:function(t){return"MS"+t}},n=Object.keys(e),r=void 0,i=void 0,o="",a=0;a<n.length;a++){var s=n[a];if(s+"TransitionProperty"in t){o="-"+s.toLowerCase(),r=e[s]("TransitionEnd"),i=e[s]("AnimationEnd");break}}!r&&"transitionProperty"in t&&(r="transitionend");!i&&"animationName"in t&&(i="animationend");return t=null,{animationEnd:i,transitionEnd:r,prefix:o}}();a=v.prefix,e.transitionEnd=s=v.transitionEnd,e.animationEnd=u=v.animationEnd,e.transform=o=a+"-"+o,e.transitionProperty=l=a+"-transition-property",e.transitionDuration=c=a+"-transition-duration",e.transitionDelay=p=a+"-transition-delay",e.transitionTiming=h=a+"-transition-timing-function",e.animationName=f=a+"-animation-name",e.animationDuration=d=a+"-animation-duration",e.animationTiming=m=a+"-animation-delay",e.animationDelay=g=a+"-animation-timing-function"}e.transform=o,e.transitionProperty=l,e.transitionTiming=h,e.transitionDelay=p,e.transitionDuration=c,e.transitionEnd=s,e.animationName=f,e.animationDuration=d,e.animationTiming=m,e.animationDelay=g,e.animationEnd=u,e.default={transform:o,end:s,property:l,timing:h,delay:p,duration:c}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(2),a=(r=o)&&r.__esModule?r:{default:r},s=n(1);var u=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.Component),i(e,[{key:"getChildContext",value:function(){return this.props.context}},{key:"render",value:function(){return s.Children.only(this.props.children)}}]),e}();u.propTypes={context:a.default.object.isRequired},u.childContextTypes={theme:a.default.object},e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=this;t.forEach(function(t){return e[t]=e[t].bind(e)})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=!("undefined"==typeof window||!window.document||!window.document.createElement)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(1),o=(r=i)&&r.__esModule?r:{default:r};e.default=function(t){switch(t.renderingMode){case"web":return o.default.createElement("span",null,"inline web");case"pdf":return o.default.createElement("span",null,"inline pdf");case"epub-reflowable":return o.default.createElement("span",null,"inline epub reflowable");case"epub-fixed":return o.default.createElement("span",null,"inline epub fixed");case"micro":return o.default.createElement("span",null,"inline micro");default:return null}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.meta=e.Inline=e.Block=void 0;var r=a(n(622)),i=a(n(647)),o=a(n(290));function a(t){return t&&t.__esModule?t:{default:t}}e.Block=r.default,e.Inline=i.default,e.meta=o.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(n(1)),i=s(n(2)),o=s(n(290)),a=n(50);function s(t){return t&&t.__esModule?t:{default:t}}var u=new Function("try {return this===window;}catch(e){ return false;}")(),l=u?n(119):{},c=l.Media,h=l.Player,p=l.controls,f=function(t,e){var n=t.resource,i=t.renderingMode,s=e.assetsData,l=e.getAssetUri,f=(0,a.pickAsset)(n,o.default.assetPickingRules.element[i],s),d=void 0;switch(f.resourceDataField){case"url":return r.default.createElement("iframe",{src:n.data.url});case"screencast_video_asset_id":if(u){d=l(f.asset);var m=p.PlayPause,g=p.MuteUnmute;return r.default.createElement(c,null,r.default.createElement("div",{className:"media"},r.default.createElement(h,{src:d}),r.default.createElement("div",{className:"media-controls"},r.default.createElement(m,null),r.default.createElement(g,null))))}return d?r.default.createElement("video",{controls:!0},r.default.createElement("source",{src:d,type:"video/"+d.split(".").pop()})):null;default:return d=l(f.asset),r.default.createElement("img",{src:d})}};f.contextTypes={assetsData:i.default.object,getAssetUri:i.default.func},e.default=f},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(1),a=(h(o),h(n(2))),s=(h(n(49)),h(n(180))),u=h(n(624)),l=h(n(625)),c=h(n(626));function h(t){return t&&t.__esModule?t:{default:t}}function p(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var f={onPlay:"isPlaying",onPause:"isPlaying",onDuration:"duration",onProgress:"progress",onTimeUpdate:"currentTime",onMute:"isMuted",onVolumeChange:"volume",onError:null},d=Object.keys(f),m=function(t){function e(){var t,n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=r=p(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(o))),r.state={currentTime:0,progress:0,duration:.1,volume:1,isLoading:!0,isPlaying:!1,isMuted:!1,isFullscreen:!1},r._playerProps={},r._lastVolume=0,r._setPlayer=function(t){r._player=t},r._setPlayerProps=function(t){r._playerProps=t},r._setPlayerState=function(t){r.setState(t)},r.play=function(){return r._player.play()},r.pause=function(){r._player.pause()},r.playPause=function(){r.state.isPlaying?r._player.pause():r._player.play()},r.stop=function(){r._player.stop()},r.seekTo=function(t){r._player.seekTo(t),r.setState({currentTime:t})},r.skipTime=function(t){var e=r.state,n=e.currentTime,i=e.duration,o=n+t;o<0?o=0:o>i&&(o=i),r.seekTo(o)},r.mute=function(t){if(t)r._lastVolume=r.state.volume,r._player.setVolume(0);else{var e=r._lastVolume>0?r._lastVolume:.1;r._player.setVolume(e)}r._player.mute(t)},r.muteUnmute=function(){r.mute(!r.state.isMuted)},r.setVolume=function(t){var e=t<=0;e!==r.state.isMuted?r.mute(e):r._lastVolume=t,r._player.setVolume(t)},r.addVolume=function(t){var e=r.state.volume+.01*t;e<0?e=0:e>1&&(e=1),r.setVolume(e)},r.fullscreen=function(){r.state.isFullscreen?document[l.default]():r._player.node[u.default]()},r._handleFullscreenChange=function(t){t.target===r._player.node&&r.setState({isFullscreen:!r.state.isFullscreen})},p(r,n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Component),i(e,[{key:"getChildContext",value:function(){return{media:this._getPublicMediaProps(),_mediaSetters:{setPlayer:this._setPlayer,setPlayerProps:this._setPlayerProps,setPlayerState:this._setPlayerState},_mediaGetters:{getPlayerEvents:this._getPlayerEvents()}}}},{key:"componentDidMount",value:function(){(0,c.default)("add",this._handleFullscreenChange)}},{key:"componentWillUnmount",value:function(){(0,c.default)("remove",this._handleFullscreenChange)}},{key:"_getPublicMediaProps",value:function(){return r({},this.state,{play:this.play,pause:this.pause,playPause:this.playPause,stop:this.stop,seekTo:this.seekTo,skipTime:this.skipTime,mute:this.mute,muteUnmute:this.muteUnmute,setVolume:this.setVolume,addVolume:this.addVolume,fullscreen:this.fullscreen})}},{key:"_getPlayerEvents",value:function(){var t=this,e={};return d.forEach(function(n){var r=f[n],i=t._playerProps[n];e[n]=function(e){var n,o,a;r&&t.setState((a=e,(o=r)in(n={})?Object.defineProperty(n,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[o]=a,n)),"function"==typeof i&&i(t.state)}}),e}},{key:"render",value:function(){var t=this.props.children;return"function"==typeof t?t(this._getPublicMediaProps()):o.Children.only(t)}}]),e}();m.propTypes={children:a.default.oneOfType([a.default.func,a.default.node]).isRequired},m.childContextTypes=s.default,e.default=m,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){if("undefined"==typeof document)return function(){};return["requestFullscreen","mozRequestFullScreen","msRequestFullscreen","webkitRequestFullscreen"].reduce(function(t,e){return document.documentElement[e]?e:t})}(),t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){if("undefined"==typeof document)return function(){};return["exitFullscreen","mozCancelFullScreen","msExitFullscreen","webkitExitFullscreen"].reduce(function(t,e){return document[e]?e:t})}(),t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){["fullscreenchange","mozfullscreenchange","MSFullscreenChange","webkitfullscreenchange"].forEach(function(n){return document[t+"EventListener"](n,e)})},t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(1),a=(l(o),l(n(2))),s=l(n(180)),u=l(n(628));function l(t){return t&&t.__esModule?t:{default:t}}function c(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var h=function(t){function e(){var t,n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=r=c(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(o))),r._defaultsSet=!1,r._setPlayer=function(t){r.context._mediaSetters.setPlayer(t),r._component=t},r._setLoading=function(t){r.context._mediaSetters.setPlayerState({isLoading:t})},r._handleOnReady=function(){var t=r.context,e=t.media,n=(t._mediaSetters,r.props),i=n.autoPlay,o=n.onReady;e.setVolume(e.volume),e.mute(e.isMuted),r._defaultsSet||r._setDefaults(),i&&e.play(),r._setLoading(!1),"function"==typeof o&&o(e)},r._handleOnEnded=function(){var t=r.context,e=t.media,n=t._mediaSetters,i=r.props,o=i.loop,a=i.onEnded;o?(e.seekTo(0),e.play()):n.setPlayerState({isPlaying:!1}),"function"==typeof a&&a(e)},c(r,n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Component),i(e,[{key:"componentWillMount",value:function(){this._setPlayerProps(this.props),this.props.src||this._setLoading(!1)}},{key:"componentWillUpdate",value:function(t){this._setPlayerProps(t),this.props.src!==t.src&&this.context._mediaSetters.setPlayerState({currentTime:0,progress:0,duration:0,isLoading:!0,isPlaying:!1})}},{key:"_setPlayerProps",value:function(t){this.context._mediaSetters.setPlayerProps(t)}},{key:"_setDefaults",value:function(){var t=this.context.media,e=this.props,n=e.defaultCurrentTime,r=e.defaultVolume,i=e.defaultMuted;n>-1&&t.seekTo(n),t.setVolume(r),t.mute(i),this._defaultsSet=!0}},{key:"render",value:function(){var t=this.props,e=t.src,n=t.vendor,i=t.autoPlay,a=(t.onReady,t.onEnded,t.defaultCurrentTime,t.defaultVolume,t.defaultMuted,function(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}(t,["src","vendor","autoPlay","onReady","onEnded","defaultCurrentTime","defaultVolume","defaultMuted"])),s=(0,u.default)(e,n,!!a.useAudioObject),l=s.vendor,c=s.component;return(0,o.createElement)(c,r({ref:this._setPlayer,src:e,vendor:l,autoPlay:i,isLoading:this._setLoading,onReady:this._handleOnReady,onEnded:this._handleOnEnded,extraProps:a},this.context._mediaGetters.getPlayerEvents))}},{key:"instance",get:function(){return this._component&&this._component.instance}}]),e}();h.propTypes={vendor:a.default.oneOf(["video","audio","youtube","vimeo"]),defaultCurrentTime:a.default.number,defaultVolume:a.default.number,defaultMuted:a.default.bool},h.defaultProps={defaultCurrentTime:-1,defaultVolume:1,defaultMuted:!1},h.contextTypes=s.default,e.default=h,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n){if(t=t||"","youtube"===e||/youtube.com|youtu.be/.test(t))return{vendor:"youtube",component:a.default};if("vimeo"===e||/vimeo.com/.test(t))return{vendor:"vimeo",component:o.default};var s="audio"===e||/\.(mp3|wav|m4a)($|\?)/i.test(t);return{vendor:s?"audio":"video",component:s&&n?i.default:r.default}};var r=s(n(291)),i=s(n(629)),o=s(n(630)),a=s(n(632));function s(t){return t&&t.__esModule?t:{default:t}}t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=(u(n(1)),u(n(2))),a=(n(49),u(n(120))),s=u(n(291));function u(t){return t&&t.__esModule?t:{default:t}}var l=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.default),i(e,[{key:"componentWillMount",value:function(){var t=this.props.src;this._createAudioObject(t),this._bindAudioObjectEvents(this.props)}},{key:"componentWillReceiveProps",value:function(t){var e=t.src;this.props.src!==e&&(this._destroyAudioObject(),this._createAudioObject(e)),this._bindAudioObjectEvents(t)}},{key:"componentWillUnmount",value:function(){this._destroyAudioObject()}},{key:"_createAudioObject",value:function(t){this._player=new Audio(t)}},{key:"_destroyAudioObject",value:function(){this.stop(),this._player.src="about:blank",this._player.load(),this._player=null}},{key:"_bindAudioObjectEvents",value:function(t){var e=this,n=t.extraProps,r=this._playerEvents;Object.keys(n).forEach(function(t){e._player[t]=n[t]}),Object.keys(r).forEach(function(t){e._player[t.toLowerCase()]=r[t]})}},{key:"render",value:function(){return null}}]),e}();l.propTypes=r({},a.default,{useAudioObject:o.default.bool}),e.default=l,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(1),a=c(o),s=n(49),u=c(n(631)),l=c(n(120));function c(t){return t&&t.__esModule?t:{default:t}}function h(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var p=function(t){function e(){var t,n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=r=h(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(o))),r._vimeoId=(0,u.default)(r.props.src),r._origin="*",r._onMessage=function(t){var e=void 0;if(!/^https?:\/\/player.vimeo.com/.test(t.origin))return!1;"*"===r._origin&&(r._origin=t.origin);try{e=JSON.parse(t.data)}catch(t){r.props.onError(t)}switch(e.event){case"ready":r.props.onReady(),r._postMessages();break;case"loadProgress":r.props.onProgress(e.data.percent);break;case"playProgress":r.props.onTimeUpdate(e.data.seconds);break;case"play":r.props.onPlay(!0);break;case"pause":r.props.onPause(!1);break;case"finish":r.props.onEnded(!1)}"getDuration"===e.method?r.props.onDuration(e.value):"getVolume"===e.method&&r.setVolume(e.value)},h(r,n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Component),i(e,[{key:"componentDidMount",value:function(){window.addEventListener("message",this._onMessage)}},{key:"componentWillReceiveProps",value:function(t){t.src!==this.props.src&&(this._vimeoId=(0,u.default)(t.src))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("message",this._onMessage)}},{key:"_postMessage",value:function(t,e){var n={method:t};e&&(n.value=e),this._iframe.contentWindow.postMessage(JSON.stringify(n),this._origin)}},{key:"_postMessages",value:function(){var t=this;["loadProgress","playProgress","play","pause","finish"].forEach(function(e){return t._postMessage("addEventListener",e)}),this._postMessage("getDuration"),this._postMessage("getVolume")}},{key:"play",value:function(){this._postMessage("play")}},{key:"pause",value:function(){this._postMessage("pause")}},{key:"stop",value:function(){this._postMessage("unload")}},{key:"seekTo",value:function(t){this._postMessage("seekTo",t)}},{key:"mute",value:function(t){this._postMessage("setVolume",t?"0":"1"),this.props.onMute(t)}},{key:"setVolume",value:function(t){this._postMessage("setVolume",t),this.props.onVolumeChange(+t)}},{key:"render",value:function(){var t=this;return a.default.createElement("iframe",r({ref:function(e){return t._iframe=e},src:"https://player.vimeo.com/video/"+this._vimeoId+"?api=1"},this.props.extraProps))}},{key:"instance",get:function(){return this._iframe}},{key:"node",get:function(){return(0,s.findDOMNode)(this._iframe)}}]),e}();p.propTypes=l.default,e.default=p,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=t.match(/https?:\/\/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|video\/|)(\d+)(?:$|\/|\?)/);if(e)return e[3];throw"Invalid Vimeo ID provided"},t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(1),a=c(o),s=c(n(633)),u=c(n(635)),l=c(n(120));function c(t){return t&&t.__esModule?t:{default:t}}function h(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var p=function(t){function e(){var t,n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=r=h(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(o))),r._videoId=(0,u.default)(r.props.src),r._lastVideoId=r._videoId,r._isReady=!1,r._isMounted=!1,r._progressId=null,r._timeUpdateId=null,r._handleProgress=function(){if(r._isMounted){var t=r._player.getVideoLoadedFraction()||0;r.props.onProgress(t),r._progressId&&t<1&&(r._progressId=requestAnimationFrame(r._handleProgress))}},r._handleTimeUpdate=function(){r._isMounted&&(r.props.onTimeUpdate(r._player.getCurrentTime()||0),r._timeUpdateId&&(r._timeUpdateId=requestAnimationFrame(r._handleTimeUpdate)))},h(r,n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Component),i(e,[{key:"componentDidMount",value:function(){this._isMounted=!0,s.default.load(this)}},{key:"componentWillReceiveProps",value:function(t){t.src!==this.props.src&&(this._lastVideoId=this._videoId,this._videoId=(0,u.default)(t.src),this._isReady&&(t.autoPlay?this._player.loadVideoById(this._videoId):this._player.cueVideoById(this._videoId),this.props.onReady()))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,this._progressId&&cancelAnimationFrame(this._progressId),this._timeUpdateId&&cancelAnimationFrame(this._timeUpdateId),this._player&&this._player.destroy()}},{key:"_createPlayer",value:function(){this._player=new YT.Player(this._node,{videoId:this._videoId,events:this._events(),playerVars:{controls:0,showinfo:0,modestbranding:1}})}},{key:"_events",value:function(){var t=this;return{onReady:function(){t._videoId!==t._lastVideoId&&t._player.loadVideoById(t._videoId),t._isReady=!0,t.props.onDuration(t._player.getDuration()),t.props.onReady()},onStateChange:function(e){var n=e.data,r=window.YT.PlayerState,i=r.PLAYING,o=r.PAUSED,a=r.ENDED,s=r.BUFFERING,u=r.CUED,l=n===i;l?(t.props.onPlay(!0),t.props.onDuration(t._player.getDuration()),t._timeUpdateId=requestAnimationFrame(t._handleTimeUpdate)):(cancelAnimationFrame(t._timeUpdateId),t._timeUpdateId=null,cancelAnimationFrame(t._progressId),t._progressId=null),n===o&&t.props.onPause(!1),n===a&&t.props.onEnded(!1),(l||n===s)&&(t._progressId=requestAnimationFrame(t._handleProgress)),n===u&&t.props.onDuration(.1)},onError:function(e){t.props.onError(e.data)}}}},{key:"play",value:function(){this._player.playVideo()}},{key:"pause",value:function(){this._player.pauseVideo()}},{key:"stop",value:function(){this._player.stopVideo()}},{key:"seekTo",value:function(t){this._player.seekTo(t)}},{key:"mute",value:function(t){t?this._player.mute():this._player.unMute(),this.props.onMute(t)}},{key:"setVolume",value:function(t){this._player.setVolume(100*+t),this.props.onVolumeChange(+t)}},{key:"render",value:function(){var t=this;return a.default.createElement("div",r({ref:function(e){return t._node=e}},this.props.extraProps))}},{key:"instance",get:function(){return this._player}},{key:"node",get:function(){return this._player.getIframe()}}]),e}();p.propTypes=l.default,e.default=p,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(634),o=(r=i)&&r.__esModule?r:{default:r};e.default={_queue:[],_isLoaded:!1,load:function(t){this._isLoaded?t._createPlayer():(this._queue.push(t),1===this._queue.length&&this._loadAPI())},_loadAPI:function(){var t=this;(0,o.default)("//youtube.com/player_api"),window.onYouTubeIframeAPIReady=function(){t._isLoaded=!0;for(var e=t._queue.length;e--;)t._queue[e]._createPlayer();t._queue=[]}}},t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n=document.createElement("script");n.async=!0,n.src=t,n.onload=function(){return"function"==typeof e&&e()},document.head.appendChild(n)},t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=t.match(/.*(?:youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=)([^#\&\?]*).*/);if(e&&11===e[1].length)return e[1];throw"Invalid Youtube ID provided"},t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Fullscreen=e.Volume=e.MuteUnmute=e.Duration=e.SeekBar=e.Progress=e.CurrentTime=e.PlayPause=void 0;var r=h(n(637)),i=h(n(638)),o=h(n(639)),a=h(n(640)),s=h(n(641)),u=h(n(642)),l=h(n(643)),c=h(n(644));function h(t){return t&&t.__esModule?t:{default:t}}e.PlayPause=r.default,e.CurrentTime=i.default,e.Progress=o.default,e.SeekBar=a.default,e.Duration=s.default,e.MuteUnmute=u.default,e.Volume=l.default,e.Fullscreen=c.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(1),o=s(i),a=(s(n(2)),s(n(45)));function s(t){return t&&t.__esModule?t:{default:t}}function u(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var l=function(t){function e(){var t,n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=r=u(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(o))),r._handlePlayPause=function(){r.props.media.playPause()},u(r,n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i.Component),r(e,[{key:"shouldComponentUpdate",value:function(t){var e=t.media;return this.props.media.isPlaying!==e.isPlaying}},{key:"render",value:function(){var t=this.props,e=t.className,n=t.style,r=t.media;return o.default.createElement("button",{type:"button",className:e,style:n,onClick:this._handlePlayPause},r.isPlaying?"Pause":"Play")}}]),e}();e.default=(0,a.default)(l),t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(1),o=u(i),a=(u(n(2)),u(n(45))),s=u(n(181));function u(t){return t&&t.__esModule?t:{default:t}}var l=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i.Component),r(e,[{key:"shouldComponentUpdate",value:function(t){var e=t.media;return this.props.media.currentTime!==e.currentTime}},{key:"render",value:function(){var t=this.props,e=t.className,n=t.style,r=t.media;return o.default.createElement("time",{className:e,style:n},(0,s.default)(r.currentTime))}}]),e}();e.default=(0,a.default)(l),t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(1),o=s(i),a=(s(n(2)),s(n(45)));function s(t){return t&&t.__esModule?t:{default:t}}var u=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i.Component),r(e,[{key:"shouldComponentUpdate",value:function(t){var e=t.media;return this.props.media.progress!==e.progress}},{key:"render",value:function(){var t=this.props,e=t.className,n=t.style,r=t.media;return o.default.createElement("progress",{className:e,style:n,max:100,value:100*r.progress})}}]),e}();e.default=(0,a.default)(u),t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(1),a=u(o),s=(u(n(2)),u(n(45)));function u(t){return t&&t.__esModule?t:{default:t}}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var c=function(t){function e(){var t,n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=r=l(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(o))),r._isPlayingOnMouseDown=!1,r._onChangeUsed=!1,r._handleMouseDown=function(){r._isPlayingOnMouseDown=r.props.media.isPlaying,r.props.media.pause()},r._handleMouseUp=function(t){var e=t.target.value;r._onChangeUsed||r.props.media.seekTo(+e),r._isPlayingOnMouseDown&&r.props.media.play()},r._handleChange=function(t){var e=t.target.value;r.props.media.seekTo(+e),r._onChangeUsed=!0},l(r,n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Component),i(e,[{key:"shouldComponentUpdate",value:function(t){var e=t.media;return this.props.media.currentTime!==e.currentTime||this.props.media.duration!==e.duration}},{key:"render",value:function(){var t=this.props,e=t.className,n=t.style,i=t.media,o=i.duration,s=i.currentTime;return a.default.createElement("input",{type:"range",step:"any",max:o.toFixed(4),value:s,onMouseDown:this._handleMouseDown,onMouseUp:this._handleMouseUp,onChange:this._handleChange,className:e,style:r({backgroundSize:100*s/o+"% 100%"},n)})}}]),e}();e.default=(0,s.default)(c),t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(1),o=u(i),a=(u(n(2)),u(n(45))),s=u(n(181));function u(t){return t&&t.__esModule?t:{default:t}}var l=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i.Component),r(e,[{key:"shouldComponentUpdate",value:function(t){var e=t.media;return this.props.media.duration!==e.duration}},{key:"render",value:function(){var t=this.props,e=t.className,n=t.style,r=t.media;return o.default.createElement("time",{className:e,style:n},(0,s.default)(r.duration))}}]),e}();e.default=(0,a.default)(l),t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(1),o=s(i),a=(s(n(2)),s(n(45)));function s(t){return t&&t.__esModule?t:{default:t}}function u(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var l=function(t){function e(){var t,n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=r=u(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(o))),r._handleMuteUnmute=function(){r.props.media.muteUnmute()},u(r,n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i.Component),r(e,[{key:"shouldComponentUpdate",value:function(t){var e=t.media;return this.props.media.isMuted!==e.isMuted}},{key:"render",value:function(){var t=this.props,e=t.className,n=t.style,r=t.media;return o.default.createElement("button",{type:"button",className:e,style:n,onClick:this._handleMuteUnmute},r.isMuted?"Unmute":"Mute")}}]),e}();e.default=(0,a.default)(l),t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(1),a=u(o),s=(u(n(2)),u(n(45)));function u(t){return t&&t.__esModule?t:{default:t}}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var c=function(t){function e(){var t,n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=r=l(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(o))),r._onChangeUsed=!1,r._handleMouseUp=function(t){var e=t.target.value;r._onChangeUsed||r.props.media.setVolume((+e).toFixed(4))},r._handleChange=function(t){var e=t.target.value;r.props.media.setVolume((+e).toFixed(4)),r._onChangeUsed=!0},l(r,n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Component),i(e,[{key:"shouldComponentUpdate",value:function(t){var e=t.media;return this.props.media.volume!==e.volume}},{key:"render",value:function(){var t=this.props,e=t.className,n=t.style,i=t.media.volume;return a.default.createElement("input",{type:"range",step:"any",min:0,max:1,value:i,onMouseUp:this._handleMouseUp,onChange:this._handleChange,className:e,style:r({backgroundSize:100*i/1+"% 100%"},n)})}}]),e}();e.default=(0,s.default)(c),t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(1),o=s(i),a=(s(n(2)),s(n(45)));function s(t){return t&&t.__esModule?t:{default:t}}function u(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var l=function(t){function e(){var t,n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=r=u(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(o))),r._handleFullscreen=function(){r.props.media.fullscreen()},u(r,n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i.Component),r(e,[{key:"shouldComponentUpdate",value:function(t){var e=t.media;return this.props.media.isFullscreen!==e.isFullscreen}},{key:"render",value:function(){var t=this.props,e=t.className,n=t.style,r=t.media;return o.default.createElement("button",{type:"button",className:e,style:n,onClick:this._handleFullscreen},r.isFullscreen?"Exit Fullscreen":"Fullscreen")}}]),e}();e.default=(0,a.default)(l),t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.formatTime=e.keyboardControls=void 0;var r=o(n(646)),i=o(n(181));function o(t){return t&&t.__esModule?t:{default:t}}e.keyboardControls=r.default,e.formatTime=i.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n=t.duration,i=t.playPause,o=t.seekTo,a=t.skipTime,s=t.addVolume,u=t.fullscreen,l=e.key,c=e.shiftKey;switch(r.some(function(t){return t===l&&e.preventDefault()}),l){case" ":case"k":i();break;case"ArrowLeft":case"j":a(c?-10:-5);break;case",":a(-1);break;case"ArrowRight":case"l":a(c?10:5);break;case".":a(1);break;case 0:case"Home":o(0);break;case"End":o(n);break;case"ArrowUp":s(c?10:5);break;case"ArrowDown":s(c?-10:-5);break;case"f":u()}};var r=[0,"f","j","k","l",",","."," ","Home","End","ArrowLeft","ArrowTop","ArrowRight","ArrowDown"];t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(1),o=(r=i)&&r.__esModule?r:{default:r};e.default=function(t){var e=t.resource,n=t.contextualizer,r=t.renderingMode,i=void 0,a=e.data.url;switch(r){case"web":case"epub-fixed":return i=n.content||"*",o.default.createElement("a",{target:"blank",href:a},i);case"micro":return i=n.content||"",o.default.createElement("span",null,i," (",a,")");case"epub-reflowable":case"pdf":return i=n.content||"",o.default.createElement("a",{target:"blank",href:a},i," (",a,")");default:return null}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.meta=e.Inline=e.Block=void 0;var r=a(n(649)),i=a(n(650)),o=a(n(292));function a(t){return t&&t.__esModule?t:{default:t}}e.Block=r.default,e.Inline=i.default,e.meta=o.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(n(1)),i=s(n(2)),o=s(n(292)),a=n(50);function s(t){return t&&t.__esModule?t:{default:t}}var u=new Function("try {return this===window;}catch(e){ return false;}")(),l=u?n(119):{},c=l.Media,h=l.Player,p=l.controls,f=function(t,e){var n=t.resource,i=t.renderingMode,s=e.assetsData,l=e.getAssetUri,f=(0,a.pickAsset)(n,o.default.assetPickingRules.element[i],s),d=void 0;switch(f.resourceDataField){case"hd_video_asset_id":case"sd_video_asset_id":if(u){d=l(f.asset);var m=p.PlayPause,g=p.CurrentTime,v=p.SeekBar,y=p.Duration,b=p.MuteUnmute,_=p.Volume,x=p.Fullscreen;return r.default.createElement(c,null,r.default.createElement("div",{className:"media"},r.default.createElement(h,{src:d}),r.default.createElement("div",{className:"media-controls"},r.default.createElement(m,{className:"button play-pause"}),r.default.createElement(g,{className:"current-time tag"}),r.default.createElement(v,{className:"seek-bar"}),r.default.createElement(y,{className:"tag duration"}),r.default.createElement(b,{className:"button mute"}),r.default.createElement(_,{className:"volume"}),r.default.createElement(x,{className:"fullscreen"}))))}return d?r.default.createElement("video",{controls:!0},r.default.createElement("source",{src:d,type:"video/"+d.split(".").pop()})):null;default:return d=l(f.asset),r.default.createElement("img",{src:d})}};f.contextTypes={assetsData:i.default.object,getAssetUri:i.default.func},e.default=f},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(1),o=(r=i)&&r.__esModule?r:{default:r};e.default=function(t){switch(t.renderingMode){case"web":return o.default.createElement("span",null,"inline web");case"pdf":return o.default.createElement("span",null,"inline pdf");case"epub-reflowable":return o.default.createElement("span",null,"inline epub reflowable");case"epub-fixed":return o.default.createElement("span",null,"inline epub fixed");case"micro":return o.default.createElement("span",null,"inline micro");default:return null}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.meta=e.Inline=e.Block=void 0;var r=a(n(652)),i=a(n(653)),o=a(n(293));function a(t){return t&&t.__esModule?t:{default:t}}e.Block=r.default,e.Inline=i.default,e.meta=o.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(n(1)),i=s(n(2)),o=s(n(293)),a=n(50);function s(t){return t&&t.__esModule?t:{default:t}}var u=new Function("try {return this===window;}catch(e){ return false;}")(),l=u?n(119):{},c=l.Media,h=l.Player,p=l.controls,f=function(t,e){var n=t.resource,i=t.renderingMode,s=e.assetsData,l=e.getAssetUri,f=(0,a.pickAsset)(n,o.default.assetPickingRules.track[i],s);switch(i){case"web":case"epub-fixed":if(u&&f){var d=p.PlayPause,m=p.CurrentTime,g=p.SeekBar,v=p.Duration,y=p.MuteUnmute,b=p.Volume;return r.default.createElement("div",null,r.default.createElement(c,null,r.default.createElement("div",{className:"media"},r.default.createElement(h,{src:l(f.asset)}),r.default.createElement("div",{className:"media-controls"},r.default.createElement(d,{className:"button play-pause"}),r.default.createElement(m,{className:"current-time tag"}),r.default.createElement(g,{className:"seek-bar"}),r.default.createElement(v,{className:"tag duration"}),r.default.createElement(y,{className:"button mute"}),r.default.createElement(b,{className:"volume"})))),n.data.transcription&&r.default.createElement("blockquote",{className:"transcription"},n.data.transcription))}case"pdf":case"epub-reflowable":case"micro":return n.data.transcription?r.default.createElement("blockquote",{className:"transcription"},n.data.transcription):null;default:return null}};f.contextTypes={assetsData:i.default.object,getAssetUri:i.default.func},e.default=f},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(1),o=(r=i)&&r.__esModule?r:{default:r};e.default=function(t){switch(t.renderingMode){case"web":return o.default.createElement("span",null,"inline web");case"pdf":return o.default.createElement("span",null,"inline pdf");case"epub-reflowable":return o.default.createElement("span",null,"inline epub reflowable");case"epub-fixed":return o.default.createElement("span",null,"inline epub fixed");case"micro":return o.default.createElement("span",null,"inline micro");default:return null}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.meta=e.Inline=e.Block=void 0;var r=a(n(655)),i=a(n(683)),o=a(n(294));function a(t){return t&&t.__esModule?t:{default:t}}e.Block=r.default,e.Inline=i.default,e.meta=o.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=l(n(1)),i=l(n(2)),o=l(n(294)),a=n(50),s=l(n(656)),u=l(n(682));function l(t){return t&&t.__esModule?t:{default:t}}var c=function(t,e){var n=t.resource,i=t.contextualizer,l=t.renderingMode,c=e.assetsData,h=e.getAssetUri,p=(0,a.pickAsset)(n,o.default.assetPickingRules.data[l],c);if(p){var f=h(p.asset);switch(l){case"web":return r.default.createElement(s.default,{src:f});case"pdf":case"epub-reflowable":case"epub-fixed":case"micro":return r.default.createElement(u.default,{src:f,contextualizer:i,asset:p});default:return null}}return null};c.contextTypes={assetsData:i.default.object,getAssetUri:i.default.func},e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(1),o=l(i),a=l(n(657)),s=n(183),u=n(300);function l(t){return t&&t.__esModule?t:{default:t}}var c=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.updateData=function(t){n.setState({loading:!0,error:void 0}),(0,s.get)(t).then(function(e){var r=(0,u.formatData)(e.data,t);n.setState({data:r,columns:(0,u.computeColumns)(r),loading:!1})}).catch(function(t){n.setState({error:t})})},n.state={loading:!0,data:void 0},n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i.Component),r(e,[{key:"componentWillMount",value:function(){this.updateData(this.props.src)}},{key:"componentWillReceiveProps",value:function(t){this.props.src!==t.src&&this.updateData(t.src)}},{key:"render",value:function(){var t=this.state,e=t.columns,n=void 0===e?[]:e,r=t.data,i=void 0===r?[]:r,s=t.loading,u=void 0!==s&&s;return o.default.createElement(a.default,{data:i,columns:n,loading:u})}}]),e}();e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ReactTableDefaults=void 0;var r=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(1),s=d(a),u=d(n(121)),l=d(n(182)),c=d(n(658)),h=d(n(659)),p=d(n(660)),f=d(n(662));function d(t){return t&&t.__esModule?t:{default:t}}e.ReactTableDefaults=p.default;var m=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.getResolvedState=n.getResolvedState.bind(n),n.getDataModel=n.getDataModel.bind(n),n.getSortedData=n.getSortedData.bind(n),n.fireFetchData=n.fireFetchData.bind(n),n.getPropOrState=n.getPropOrState.bind(n),n.getStateOrProp=n.getStateOrProp.bind(n),n.filterData=n.filterData.bind(n),n.sortData=n.sortData.bind(n),n.getMinRows=n.getMinRows.bind(n),n.onPageChange=n.onPageChange.bind(n),n.onPageSizeChange=n.onPageSizeChange.bind(n),n.sortColumn=n.sortColumn.bind(n),n.filterColumn=n.filterColumn.bind(n),n.resizeColumnStart=n.resizeColumnStart.bind(n),n.resizeColumnEnd=n.resizeColumnEnd.bind(n),n.resizeColumnMoving=n.resizeColumnMoving.bind(n),n.state={page:0,pageSize:t.defaultPageSize,sorted:t.defaultSorted,expanded:t.defaultExpanded,filtered:t.defaultFiltered,resized:t.defaultResized,currentlyResizing:!1,skipNextSort:!1},n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,(0,h.default)((0,c.default)(a.Component))),o(e,[{key:"render",value:function(){var t=this,e=this.getResolvedState(),n=e.children,o=e.className,a=e.style,c=e.getProps,h=e.getTableProps,f=e.getTheadGroupProps,d=e.getTheadGroupTrProps,m=e.getTheadGroupThProps,g=e.getTheadProps,v=e.getTheadTrProps,y=e.getTheadThProps,b=e.getTheadFilterProps,_=e.getTheadFilterTrProps,x=e.getTheadFilterThProps,w=e.getTbodyProps,E=e.getTrGroupProps,S=e.getTrProps,T=e.getTdProps,O=e.getTfootProps,A=e.getTfootTrProps,M=e.getTfootTdProps,C=e.getPaginationProps,k=e.getLoadingProps,P=e.getNoDataProps,R=e.getResizerProps,L=e.showPagination,I=e.showPaginationTop,D=e.showPaginationBottom,N=e.manual,j=e.loadingText,U=e.noDataText,F=e.sortable,B=e.multiSort,z=e.resizable,G=e.filterable,H=e.pivotIDKey,V=e.pivotValKey,W=e.pivotBy,q=e.subRowsKey,X=e.aggregatedKey,Y=e.originalKey,$=e.indexKey,Z=e.groupedByPivotKey,J=e.loading,K=e.pageSize,Q=e.page,tt=e.sorted,et=e.filtered,nt=e.resized,rt=e.expanded,it=e.pages,ot=e.onExpandedChange,at=e.TableComponent,st=e.TheadComponent,ut=e.TbodyComponent,lt=e.TrGroupComponent,ct=e.TrComponent,ht=e.ThComponent,pt=e.TdComponent,ft=e.TfootComponent,dt=e.PaginationComponent,mt=e.LoadingComponent,gt=e.SubComponent,vt=e.NoDataComponent,yt=e.ResizerComponent,bt=e.ExpanderComponent,_t=e.PivotValueComponent,xt=e.PivotComponent,wt=e.AggregatedComponent,Et=e.FilterComponent,St=e.PadRowComponent,Tt=e.resolvedData,Ot=e.allVisibleColumns,At=e.headerGroups,Mt=e.hasHeaderGroups,Ct=e.sortedData,kt=e.currentlyResizing,Pt=K*Q,Rt=Pt+K,Lt=N?Tt:Ct.slice(Pt,Rt),It=this.getMinRows(),Dt=l.default.range(Math.max(It-Lt.length,0)),Nt=Ot.some(function(t){return t.Footer}),jt=G||Ot.some(function(t){return t.filterable}),Ut=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;return[e.map(function(e,a){var s=i({},e,{_viewIndex:o+=1}),u=n.concat([a]);if(s[q]&&l.default.get(rt,u)){var c=t(s[q],u,o),h=r(c,2);s[q]=h[0],o=h[1]}return s}),o]}(Lt),Ft=r(Ut,1);Lt=Ft[0];var Bt=Q>0,zt=Q+1<it,Gt=l.default.sum(Ot.map(function(t){var e=nt.find(function(e){return e.id===t.id})||{};return l.default.getFirstDefined(e.value,t.width,t.minWidth)})),Ht=-1,Vt=i({},e,{startRow:Pt,endRow:Rt,pageRows:Lt,minRows:It,padRows:Dt,hasColumnFooter:Nt,canPrevious:Bt,canNext:zt,rowMinWidth:Gt}),Wt=l.default.splitProps(c(Vt,void 0,void 0,this)),qt=l.default.splitProps(h(Vt,void 0,void 0,this)),Xt=l.default.splitProps(w(Vt,void 0,void 0,this)),Yt=k(Vt,void 0,void 0,this),$t=P(Vt,void 0,void 0,this),Zt=function(e,n){var r=function(t){return(nt.find(function(e){return e.id===t.id})||{}).value},o=l.default.sum(e.columns.map(function(t){return t.width||r(t)?0:t.minWidth})),a=l.default.sum(e.columns.map(function(t){return l.default.getFirstDefined(r(t),t.width,t.minWidth)})),c=l.default.sum(e.columns.map(function(t){return l.default.getFirstDefined(r(t),t.width,t.maxWidth)})),h=l.default.splitProps(m(Vt,void 0,e,t)),p=l.default.splitProps(e.getHeaderProps(Vt,void 0,e,t)),f=[e.headerClassName,h.className,p.className],d=i({},e.headerStyle,h.style,p.style),g=i({},h.rest,p.rest),v={flex:o+" 0 auto",width:l.default.asPx(a),maxWidth:l.default.asPx(c)};return s.default.createElement(ht,i({key:n+"-"+e.id,className:(0,u.default)(f),style:i({},d,v)},g),l.default.normalizeComponent(e.Header,{data:Ct,column:e}))},Jt=function(e,n){var r=nt.find(function(t){return t.id===e.id})||{},o=tt.find(function(t){return t.id===e.id}),a="function"==typeof e.show?e.show():e.show,c=l.default.getFirstDefined(r.value,e.width,e.minWidth),h=l.default.getFirstDefined(r.value,e.width,e.maxWidth),p=l.default.splitProps(y(Vt,void 0,e,t)),f=l.default.splitProps(e.getHeaderProps(Vt,void 0,e,t)),d=[e.headerClassName,p.className,f.className],m=i({},e.headerStyle,p.style,f.style),g=i({},p.rest,f.rest),v=l.default.getFirstDefined(e.resizable,z,!1),b=v?s.default.createElement(yt,i({onMouseDown:function(n){return t.resizeColumnStart(n,e,!1)},onTouchStart:function(n){return t.resizeColumnStart(n,e,!0)}},R("finalState",void 0,e,t))):null,_=l.default.getFirstDefined(e.sortable,F,!1);return s.default.createElement(ht,i({key:n+"-"+e.id,className:(0,u.default)(d,v&&"rt-resizable-header",o?o.desc?"-sort-desc":"-sort-asc":"",_&&"-cursor-pointer",!a&&"-hidden",W&&W.slice(0,-1).includes(e.id)&&"rt-header-pivot"),style:i({},m,{flex:c+" 0 auto",width:l.default.asPx(c),maxWidth:l.default.asPx(h)}),toggleSort:function(n){_&&t.sortColumn(e,!!B&&n.shiftKey)}},g),s.default.createElement("div",{className:(0,u.default)(v&&"rt-resizable-header-content")},l.default.normalizeComponent(e.Header,{data:Ct,column:e})),b)},Kt=function(e,n){var r=nt.find(function(t){return t.id===e.id})||{},o=l.default.getFirstDefined(r.value,e.width,e.minWidth),a=l.default.getFirstDefined(r.value,e.width,e.maxWidth),c=l.default.splitProps(x(Vt,void 0,e,t)),h=l.default.splitProps(e.getHeaderProps(Vt,void 0,e,t)),f=[e.headerClassName,c.className,h.className],d=i({},e.headerStyle,c.style,h.style),m=i({},c.rest,h.rest),g=et.find(function(t){return t.id===e.id}),v=e.Filter||Et,y=l.default.getFirstDefined(e.filterable,G,!1);return s.default.createElement(ht,i({key:n+"-"+e.id,className:(0,u.default)(f),style:i({},d,{flex:o+" 0 auto",width:l.default.asPx(o),maxWidth:l.default.asPx(a)})},m),y?l.default.normalizeComponent(v,{column:e,filter:g,onChange:function(n){return t.filterColumn(e,n)}},p.default.column.Filter):null)},Qt=function(e,n){var r=nt.find(function(t){return t.id===e.id})||{},o="function"==typeof e.show?e.show():e.show,a=l.default.getFirstDefined(r.value,e.width,e.minWidth),c=a,h=l.default.getFirstDefined(r.value,e.width,e.maxWidth),p=l.default.splitProps(T(Vt,void 0,e,t)),f=l.default.splitProps(e.getProps(Vt,void 0,e,t)),d=[p.className,e.className,f.className],m=i({},p.style,e.style,f.style);return s.default.createElement(pt,i({key:n+"-"+e.id,className:(0,u.default)(d,!o&&"hidden"),style:i({},m,{flex:c+" 0 auto",width:l.default.asPx(a),maxWidth:l.default.asPx(h)})},p.rest),l.default.normalizeComponent(St))},te=function(e,n){var r=E(Vt,void 0,void 0,t),o=l.default.splitProps(S(Vt,void 0,void 0,t));return s.default.createElement(lt,i({key:n},r),s.default.createElement(ct,{className:(0,u.default)("-padRow",(Lt.length+n)%2?"-even":"-odd",o.className),style:o.style||{}},Ot.map(Qt)))},ee=function(e,n){var r=nt.find(function(t){return t.id===e.id})||{},o="function"==typeof e.show?e.show():e.show,a=l.default.getFirstDefined(r.value,e.width,e.minWidth),c=l.default.getFirstDefined(r.value,e.width,e.maxWidth),h=l.default.splitProps(M(Vt,void 0,void 0,t)),p=l.default.splitProps(e.getProps(Vt,void 0,e,t)),f=l.default.splitProps(e.getFooterProps(Vt,void 0,e,t)),d=[h.className,e.className,p.className,f.className],m=i({},h.style,e.style,p.style,f.style);return s.default.createElement(pt,i({key:n+"-"+e.id,className:(0,u.default)(d,!o&&"hidden"),style:i({},m,{flex:a+" 0 auto",width:l.default.asPx(a),maxWidth:l.default.asPx(c)})},p.rest,h.rest,f.rest),l.default.normalizeComponent(e.Footer,{data:Ct,column:e}))},ne=function(){var n,r,c,h,p,m,y,x,w,M=(n=l.default.splitProps(C(Vt,void 0,void 0,t)),s.default.createElement(dt,i({},e,{pages:it,canPrevious:Bt,canNext:zt,onPageChange:t.onPageChange,onPageSizeChange:t.onPageSizeChange,className:n.className,style:n.style},n.rest)));return s.default.createElement("div",i({className:(0,u.default)("ReactTable",o,Wt.className),style:i({},a,Wt.style)},Wt.rest),L&&I?s.default.createElement("div",{className:"pagination-top"},M):null,s.default.createElement(at,i({className:(0,u.default)(qt.className,kt?"rt-resizing":""),style:qt.style},qt.rest),Mt?(x=l.default.splitProps(f(Vt,void 0,void 0,t)),w=l.default.splitProps(d(Vt,void 0,void 0,t)),s.default.createElement(st,i({className:(0,u.default)("-headerGroups",x.className),style:i({},x.style,{minWidth:Gt+"px"})},x.rest),s.default.createElement(ct,i({className:w.className,style:w.style},w.rest),At.map(Zt)))):null,(m=l.default.splitProps(g(Vt,void 0,void 0,t)),y=l.default.splitProps(v(Vt,void 0,void 0,t)),s.default.createElement(st,i({className:(0,u.default)("-header",m.className),style:i({},m.style,{minWidth:Gt+"px"})},m.rest),s.default.createElement(ct,i({className:y.className,style:y.style},y.rest),Ot.map(Jt)))),jt?(h=l.default.splitProps(b(Vt,void 0,void 0,t)),p=l.default.splitProps(_(Vt,void 0,void 0,t)),s.default.createElement(st,i({className:(0,u.default)("-filters",h.className),style:i({},h.style,{minWidth:Gt+"px"})},h.rest),s.default.createElement(ct,i({className:p.className,style:p.style},p.rest),Ot.map(Kt)))):null,s.default.createElement(ut,i({className:(0,u.default)(Xt.className),style:i({},Xt.style,{minWidth:Gt+"px"})},Xt.rest),Lt.map(function(e,n){return function e(n,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a={original:n[Y],row:n,index:n[$],viewIndex:Ht+=1,pageSize:K,page:Q,level:o.length,nestingPath:o.concat([r]),aggregated:n[X],groupedByPivot:n[Z],subRows:n[q]},c=l.default.get(rt,a.nestingPath),h=E(Vt,a,void 0,t),p=l.default.splitProps(S(Vt,a,void 0,t));return s.default.createElement(lt,i({key:a.nestingPath.join("_")},h),s.default.createElement(ct,i({className:(0,u.default)(p.className,n._viewIndex%2?"-even":"-odd"),style:p.style},p.rest),Ot.map(function(e,r){var o=nt.find(function(t){return t.id===e.id})||{},h="function"==typeof e.show?e.show():e.show,p=l.default.getFirstDefined(o.value,e.width,e.minWidth),f=l.default.getFirstDefined(o.value,e.width,e.maxWidth),d=l.default.splitProps(T(Vt,a,e,t)),m=l.default.splitProps(e.getProps(Vt,a,e,t)),g=[d.className,e.className,m.className],v=i({},d.style,e.style,m.style),y=i({},a,{isExpanded:c,column:i({},e),value:a.row[e.id],pivoted:e.pivoted,expander:e.expander,resized:nt,show:h,width:p,maxWidth:f,tdProps:d,columnProps:m,classes:g,styles:v}),b=y.value,_=void 0,x=void 0,w=void 0,E=l.default.normalizeComponent(e.Cell,y,b),S=e.Aggregated||(e.aggregate?e.Cell:wt),O=e.Expander||bt,A=e.PivotValue||_t,M=xt||function(t){return s.default.createElement("div",null,s.default.createElement(O,t),s.default.createElement(A,t))},C=e.Pivot||M;(y.pivoted||y.expander)&&(y.expandable=!0,_=!0,!y.pivoted||y.subRows||gt||(y.expandable=!1)),y.pivoted?(x=a.row[H]===e.id&&y.subRows,w=W.indexOf(e.id)>W.indexOf(a.row[H])&&y.subRows,E=x?l.default.normalizeComponent(C,i({},y,{value:n[V]}),n[V]):w?l.default.normalizeComponent(S,y,b):null):y.aggregated&&(E=l.default.normalizeComponent(S,y,b)),y.expander&&(E=l.default.normalizeComponent(O,y,n[V]),W&&(y.groupedByPivot&&(E=null),y.subRows||gt||(E=null)));var k=_?function(e){var n=l.default.clone(rt);return n=c?l.default.set(n,y.nestingPath,!1):l.default.set(n,y.nestingPath,{}),t.setStateWithData({expanded:n},function(){return ot&&ot(n,y.nestingPath,e)})}:function(){},P={onClick:k};return d.rest.onClick&&(P.onClick=function(t){d.rest.onClick(t,function(){return k(t)})}),m.rest.onClick&&(P.onClick=function(t){m.rest.onClick(t,function(){return k(t)})}),s.default.createElement(pt,i({key:r+"-"+e.id,className:(0,u.default)(g,!h&&"hidden",y.expandable&&"rt-expandable",(x||w)&&"rt-pivot"),style:i({},v,{flex:p+" 0 auto",width:l.default.asPx(p),maxWidth:l.default.asPx(f)})},d.rest,m.rest,P),E)})),a.subRows&&c&&a.subRows.map(function(t,n){return e(t,n,a.nestingPath)}),gt&&!a.subRows&&c&&gt(a))}(e,n)}),Dt.map(te)),Nt?(r=O(Vt,void 0,void 0,t),c=l.default.splitProps(A(Vt,void 0,void 0,t)),s.default.createElement(ft,i({className:r.className,style:i({},r.style,{minWidth:Gt+"px"})},r.rest),s.default.createElement(ct,i({className:(0,u.default)(c.className),style:c.style},c.rest),Ot.map(ee)))):null),L&&D?s.default.createElement("div",{className:"pagination-bottom"},M):null,!Lt.length&&s.default.createElement(vt,$t,l.default.normalizeComponent(U)),s.default.createElement(mt,i({loading:J,loadingText:j},Yt)))};return n?n(Vt,ne,this):ne()}}]),e}();m.propTypes=f.default,m.defaultProps=p.default,e.default=m},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();e.default=function(t){return function(e){function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,t),r(n,[{key:"componentWillMount",value:function(){this.setStateWithData(this.getDataModel(this.getResolvedState()))}},{key:"componentDidMount",value:function(){this.fireFetchData()}},{key:"componentWillReceiveProps",value:function(t,e){var n=this.getResolvedState(),r=this.getResolvedState(t,e);["sorted","filtered","resized","expanded"].forEach(function(t){var e="default"+(t.charAt(0).toUpperCase()+t.slice(1));JSON.stringify(n[e])!==JSON.stringify(r[e])&&(r[t]=r[e])});["sortable","filterable","resizable"].forEach(function(t){if(n[t]!==r[t]){var e=t.replace("able","")+"ed",i="default"+(e.charAt(0).toUpperCase()+e.slice(1));r[e]=r[i]}}),n.data===r.data&&n.columns===r.columns&&n.pivotBy===r.pivotBy&&n.sorted===r.sorted&&n.filtered===r.filtered||this.setStateWithData(this.getDataModel(r))}},{key:"setStateWithData",value:function(t,e){var n=this,r=this.getResolvedState(),i=this.getResolvedState({},t),o=i.freezeWhenExpanded;if(i.frozen=!1,o)for(var a=Object.keys(i.expanded),s=0;s<a.length;s+=1)if(i.expanded[a[s]]){i.frozen=!0;break}return(r.frozen&&!i.frozen||r.sorted!==i.sorted||r.filtered!==i.filtered||r.showFilters!==i.showFilters||!i.frozen&&r.resolvedData!==i.resolvedData)&&((r.sorted!==i.sorted&&this.props.collapseOnSortingChange||r.filtered!==i.filtered||r.showFilters!==i.showFilters||r.sortedData&&!i.frozen&&r.resolvedData!==i.resolvedData&&this.props.collapseOnDataChange)&&(i.expanded={}),Object.assign(i,this.getSortedData(i))),r.filtered!==i.filtered&&(i.page=0),i.sortedData&&(i.pages=i.manual?i.pages:Math.ceil(i.sortedData.length/i.pageSize),i.page=Math.max(i.page>=i.pages?i.pages-1:i.page,0)),this.setState(i,function(){e&&e(),r.page===i.page&&r.pageSize===i.pageSize&&r.sorted===i.sorted&&r.filtered===i.filtered||n.fireFetchData()})}}]),n}()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=l(n(1)),u=l(n(182));function l(t){return t&&t.__esModule?t:{default:t}}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}e.default=function(t){return function(e){function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,t),a(n,[{key:"getResolvedState",value:function(t,e){return o({},u.default.compactObject(this.state),u.default.compactObject(this.props),u.default.compactObject(e),u.default.compactObject(t))}},{key:"getDataModel",value:function(t){var e=this,n=t.columns,a=t.pivotBy,l=void 0===a?[]:a,p=t.data,f=t.pivotIDKey,d=t.pivotValKey,m=t.subRowsKey,g=t.aggregatedKey,v=t.nestingLevelKey,y=t.originalKey,b=t.indexKey,_=t.groupedByPivotKey,x=t.SubComponent,w=!1;n.forEach(function(t){t.columns&&(w=!0)});var E=[].concat(h(n)),S=n.find(function(t){return t.expander||t.columns&&t.columns.some(function(t){return t.expander})});S&&!S.expander&&(S=S.columns.find(function(t){return t.expander})),x&&!S&&(E=[S={expander:!0}].concat(h(E)));var T=[],O=function(t,n){var r=function(t,n){var r=void 0;if((r=t.expander?o({},e.props.column,e.props.expanderDefaults,t):o({},e.props.column,t)).maxWidth<r.minWidth&&(r.minWidth=r.maxWidth),n&&(r.parentColumn=n),"string"==typeof r.accessor){var a=function(){r.id=r.id||r.accessor;var t=r.accessor;return r.accessor=function(e){return u.default.get(e,t)},{v:r}}();if("object"===(void 0===a?"undefined":i(a)))return a.v}if(r.accessor&&!r.id)throw console.warn(r),new Error("A column id is required if using a non-string accessor for column above.");return r.accessor||(r.accessor=function(){}),r}(t,n);return T.push(r),r},A=E.map(function(t){return t.columns?o({},t,{columns:t.columns.map(function(e){return O(e,t)})}):O(t)}).slice(),M=[],C=(A=(A=A.map(function(t){if(t.columns){var e=t.columns.filter(function(t){return!(l.indexOf(t.id)>-1)&&u.default.getFirstDefined(t.show,!0)});return o({},t,{columns:e})}return t})).filter(function(t){return t.columns?t.columns.length:!(l.indexOf(t.id)>-1)&&u.default.getFirstDefined(t.show,!0)})).findIndex(function(t){return t.pivot});l.length&&function(){var t=[];l.forEach(function(e){var n=T.find(function(t){return t.id===e});n&&t.push(n)});var n=t.reduce(function(t,e){return t&&t===e.parentColumn&&e.parentColumn},t[0].parentColumn),r=w&&n.Header,i={Header:r=r||function(){return s.default.createElement("strong",null,"Pivoted")},columns:t.map(function(t){return o({},e.props.pivotDefaults,t,{pivoted:!0})})};C>=0?(i=o({},A[C],i),A.splice(C,1,i)):A.unshift(i)}();var k=[],P=[],R=function(t,n){k.push(o({},e.props.column,n,{columns:t})),P=[]};A.forEach(function(t){if(t.columns)return M=M.concat(t.columns),P.length>0&&R(P),void R(t.columns,t);M.push(t),P.push(t)}),w&&P.length>0&&R(P);var L=p.map(function(t,e){return function t(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=(c(r={},y,e),c(r,b,n),c(r,m,e[m]),c(r,v,i),r);return T.forEach(function(t){t.expander||(o[t.id]=t.accessor(e))}),o[m]&&(o[m]=o[m].map(function(e,n){return t(e,n,i+1)})),o}(t,e)}),I=M.filter(function(t){return!t.expander&&t.aggregate});return l.length&&(L=function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(i===n.length)return e;var a=Object.entries(u.default.groupBy(e,n[i])).map(function(t){var e,o=r(t,2),a=o[0],s=o[1];return c(e={},f,n[i]),c(e,d,a),c(e,n[i],a),c(e,m,s),c(e,v,i),c(e,_,!0),e});return a=a.map(function(e){var r,a,s,u=t(e[m],n,i+1);return o({},e,(c(r={},m,u),c(r,g,!0),r),(a=u,s={},I.forEach(function(t){var e=a.map(function(e){return e[t.id]});s[t.id]=t.aggregate(e,a)}),s))})}(L,l)),o({},t,{resolvedData:L,allVisibleColumns:M,headerGroups:k,allDecoratedColumns:T,hasHeaderGroups:w})}},{key:"getSortedData",value:function(t){var e=t.manual,n=t.sorted,r=t.filtered,i=t.defaultFilterMethod,o=t.resolvedData,a=t.allVisibleColumns,s={};return t.allDecoratedColumns.filter(function(t){return t.sortMethod}).forEach(function(t){s[t.id]=t.sortMethod}),{sortedData:e?o:this.sortData(this.filterData(o,r,i,a),n,s)}}},{key:"fireFetchData",value:function(){this.props.onFetchData(this.getResolvedState(),this)}},{key:"getPropOrState",value:function(t){return u.default.getFirstDefined(this.props[t],this.state[t])}},{key:"getStateOrProp",value:function(t){return u.default.getFirstDefined(this.state[t],this.props[t])}},{key:"filterData",value:function(t,e,n,r){var i=this,a=t;return e.length&&(a=(a=e.reduce(function(t,e){var i=r.find(function(t){return t.id===e.id});if(!i||!1===i.filterable)return t;var o=i.filterMethod||n;return i.filterAll?o(e,t,i):t.filter(function(t){return o(e,t,i)})},a)).map(function(t){return t[i.props.subRowsKey]?o({},t,c({},i.props.subRowsKey,i.filterData(t[i.props.subRowsKey],e,n,r))):t}).filter(function(t){return!t[i.props.subRowsKey]||t[i.props.subRowsKey].length>0})),a}},{key:"sortData",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.length)return t;var i=(this.props.orderByMethod||u.default.orderBy)(t,e.map(function(t){return r[t.id]?function(e,n){return r[t.id](e[t.id],n[t.id],t.desc)}:function(e,r){return n.props.defaultSortMethod(e[t.id],r[t.id],t.desc)}}),e.map(function(t){return!t.desc}),this.props.indexKey);return i.forEach(function(t){t[n.props.subRowsKey]&&(t[n.props.subRowsKey]=n.sortData(t[n.props.subRowsKey],e,r))}),i}},{key:"getMinRows",value:function(){return u.default.getFirstDefined(this.props.minRows,this.getStateOrProp("pageSize"))}},{key:"onPageChange",value:function(t){var e=this.props,n=e.onPageChange,r=e.collapseOnPageChange,i={page:t};r&&(i.expanded={}),this.setStateWithData(i,function(){return n&&n(t)})}},{key:"onPageSizeChange",value:function(t){var e=this.props.onPageSizeChange,n=this.getResolvedState(),r=n.pageSize*n.page,i=Math.floor(r/t);this.setStateWithData({pageSize:t,page:i},function(){return e&&e(t,i)})}},{key:"sortColumn",value:function(t,e){var n=this.getResolvedState(),r=n.sorted,i=n.skipNextSort,o=n.defaultSortDesc,a=Object.prototype.hasOwnProperty.call(t,"defaultSortDesc")?t.defaultSortDesc:o,s=!a;if(i)this.setStateWithData({skipNextSort:!1});else{var l,c=this.props.onSortedChange,h=u.default.clone(r||[]).map(function(t){return t.desc=u.default.isSortingDesc(t),t});if(u.default.isArray(t))(l=h.findIndex(function(e){return e.id===t[0].id}))>-1?(h[l].desc===s?e?h.splice(l,t.length):t.forEach(function(t,e){h[l+e].desc=a}):t.forEach(function(t,e){h[l+e].desc=s}),e||(h=h.slice(l,t.length))):h=e?h.concat(t.map(function(t){return{id:t.id,desc:a}})):t.map(function(t){return{id:t.id,desc:a}});else{var p=h.findIndex(function(e){return e.id===t.id});if(p>-1){var f=h[p];f.desc===s?e?h.splice(p,1):(f.desc=a,h=[f]):(f.desc=s,e||(h=[f]))}else e?h.push({id:t.id,desc:a}):h=[{id:t.id,desc:a}]}this.setStateWithData({page:!r.length&&h.length||!e?0:this.state.page,sorted:h},function(){return c&&c(h,t,e)})}}},{key:"filterColumn",value:function(t,e){var n=this.getResolvedState().filtered,r=this.props.onFilteredChange,i=(n||[]).filter(function(e){return e.id!==t.id});""!==e&&i.push({id:t.id,value:e}),this.setStateWithData({filtered:i},function(){return r&&r(i,t,e)})}},{key:"resizeColumnStart",value:function(t,e,n){var r=this;t.stopPropagation();var i=t.target.parentElement.getBoundingClientRect().width,o=void 0;o=n?t.changedTouches[0].pageX:t.pageX,this.trapEvents=!0,this.setStateWithData({currentlyResizing:{id:e.id,startX:o,parentWidth:i}},function(){n?(document.addEventListener("touchmove",r.resizeColumnMoving),document.addEventListener("touchcancel",r.resizeColumnEnd),document.addEventListener("touchend",r.resizeColumnEnd)):(document.addEventListener("mousemove",r.resizeColumnMoving),document.addEventListener("mouseup",r.resizeColumnEnd),document.addEventListener("mouseleave",r.resizeColumnEnd))})}},{key:"resizeColumnMoving",value:function(t){t.stopPropagation();var e=this.props.onResizedChange,n=this.getResolvedState(),r=n.resized,i=n.currentlyResizing,o=r.filter(function(t){return t.id!==i.id}),a=void 0;"touchmove"===t.type?a=t.changedTouches[0].pageX:"mousemove"===t.type&&(a=t.pageX);var s=Math.max(i.parentWidth+a-i.startX,11);o.push({id:i.id,value:s}),this.setStateWithData({resized:o},function(){return e&&e(o,t)})}},{key:"resizeColumnEnd",value:function(t){t.stopPropagation();var e="touchend"===t.type||"touchcancel"===t.type;e&&(document.removeEventListener("touchmove",this.resizeColumnMoving),document.removeEventListener("touchcancel",this.resizeColumnEnd),document.removeEventListener("touchend",this.resizeColumnEnd)),document.removeEventListener("mousemove",this.resizeColumnMoving),document.removeEventListener("mouseup",this.resizeColumnEnd),document.removeEventListener("mouseleave",this.resizeColumnEnd),e||this.setStateWithData({skipNextSort:!0,currentlyResizing:!1})}}]),n}()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=u(n(1)),o=u(n(121)),a=u(n(182)),s=u(n(661));function u(t){return t&&t.__esModule?t:{default:t}}function l(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}var c=function(){return{}};e.default={data:[],loading:!1,showPagination:!0,showPaginationTop:!1,showPaginationBottom:!0,showPageSizeOptions:!0,pageSizeOptions:[5,10,20,25,50,100],defaultPageSize:20,showPageJump:!0,collapseOnSortingChange:!0,collapseOnPageChange:!0,collapseOnDataChange:!0,freezeWhenExpanded:!1,sortable:!0,multiSort:!0,resizable:!0,filterable:!1,defaultSortDesc:!1,defaultSorted:[],defaultFiltered:[],defaultResized:[],defaultExpanded:{},defaultFilterMethod:function(t,e,n){var r=t.pivotId||t.id;return void 0===e[r]||String(e[r]).startsWith(t.value)},defaultSortMethod:function(t,e,n){return t=null===t||void 0===t?"":t,e=null===e||void 0===e?"":e,(t="string"==typeof t?t.toLowerCase():t)>(e="string"==typeof e?e.toLowerCase():e)?1:t<e?-1:0},onPageChange:void 0,onPageSizeChange:void 0,onSortedChange:void 0,onFilteredChange:void 0,onResizedChange:void 0,onExpandedChange:void 0,pivotBy:void 0,pivotValKey:"_pivotVal",pivotIDKey:"_pivotID",subRowsKey:"_subRows",aggregatedKey:"_aggregated",nestingLevelKey:"_nestingLevel",originalKey:"_original",indexKey:"_index",groupedByPivotKey:"_groupedByPivot",onFetchData:function(){return null},className:"",style:{},getProps:c,getTableProps:c,getTheadGroupProps:c,getTheadGroupTrProps:c,getTheadGroupThProps:c,getTheadProps:c,getTheadTrProps:c,getTheadThProps:c,getTheadFilterProps:c,getTheadFilterTrProps:c,getTheadFilterThProps:c,getTbodyProps:c,getTrGroupProps:c,getTrProps:c,getTdProps:c,getTfootProps:c,getTfootTrProps:c,getTfootTdProps:c,getPaginationProps:c,getLoadingProps:c,getNoDataProps:c,getResizerProps:c,column:{Cell:void 0,Header:void 0,Footer:void 0,Aggregated:void 0,Pivot:void 0,PivotValue:void 0,Expander:void 0,Filter:void 0,sortable:void 0,resizable:void 0,filterable:void 0,show:!0,minWidth:100,className:"",style:{},getProps:c,aggregate:void 0,headerClassName:"",headerStyle:{},getHeaderProps:c,footerClassName:"",footerStyle:{},getFooterProps:c,filterMethod:void 0,filterAll:!1,sortMethod:void 0},expanderDefaults:{sortable:!1,resizable:!1,filterable:!1,width:35},pivotDefaults:{},previousText:"Previous",nextText:"Next",loadingText:"Loading...",noDataText:"No rows found",pageText:"Page",ofText:"of",rowsText:"rows",TableComponent:a.default.makeTemplateComponent("rt-table","Table"),TheadComponent:a.default.makeTemplateComponent("rt-thead","Thead"),TbodyComponent:a.default.makeTemplateComponent("rt-tbody","Tbody"),TrGroupComponent:a.default.makeTemplateComponent("rt-tr-group","TrGroup"),TrComponent:a.default.makeTemplateComponent("rt-tr","Tr"),ThComponent:function(t){var e=t.toggleSort,n=t.className,a=t.children,s=l(t,["toggleSort","className","children"]);return i.default.createElement("div",r({className:(0,o.default)("rt-th",n),onClick:function(t){return e&&e(t)},role:"heading"},s),a)},TdComponent:a.default.makeTemplateComponent("rt-td","Td"),TfootComponent:a.default.makeTemplateComponent("rt-tfoot","Tfoot"),FilterComponent:function(t){var e=t.filter,n=t.onChange;return i.default.createElement("input",{type:"text",style:{width:"100%"},value:e?e.value:"",onChange:function(t){return n(t.target.value)}})},ExpanderComponent:function(t){var e=t.isExpanded;return i.default.createElement("div",{className:(0,o.default)("rt-expander",e&&"-open")},"•")},PivotValueComponent:function(t){var e=t.subRows,n=t.value;return i.default.createElement("span",null,n," ",e&&"("+e.length+")")},AggregatedComponent:function(t){var e=t.subRows,n=t.column,r=e.filter(function(t){return void 0!==t[n.id]}).map(function(t,r){return i.default.createElement("span",{key:r},t[n.id],r<e.length-1?", ":"")});return i.default.createElement("span",null,r)},PivotComponent:void 0,PaginationComponent:s.default,PreviousComponent:void 0,NextComponent:void 0,LoadingComponent:function(t){var e=t.className,n=t.loading,a=t.loadingText,s=l(t,["className","loading","loadingText"]);return i.default.createElement("div",r({className:(0,o.default)("-loading",{"-active":n},e)},s),i.default.createElement("div",{className:"-loading-inner"},a))},NoDataComponent:a.default.makeTemplateComponent("rt-noData","NoData"),ResizerComponent:a.default.makeTemplateComponent("rt-resizer","Resizer"),PadRowComponent:function(){return i.default.createElement("span",null," ")}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},o=n(1),a=u(o),s=u(n(121));function u(t){return t&&t.__esModule?t:{default:t}}var l=function(t){return a.default.createElement("button",i({type:"button"},t,{className:"-btn"}),t.children)},c=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.getSafePage=n.getSafePage.bind(n),n.changePage=n.changePage.bind(n),n.applyPage=n.applyPage.bind(n),n.state={page:t.page},n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Component),r(e,[{key:"componentWillReceiveProps",value:function(t){this.setState({page:t.page})}},{key:"getSafePage",value:function(t){return isNaN(t)&&(t=this.props.page),Math.min(Math.max(t,0),this.props.pages-1)}},{key:"changePage",value:function(t){t=this.getSafePage(t),this.setState({page:t}),this.props.page!==t&&this.props.onPageChange(t)}},{key:"applyPage",value:function(t){t&&t.preventDefault();var e=this.state.page;this.changePage(""===e?this.props.page:e)}},{key:"render",value:function(){var t=this,e=this.props,n=e.pages,r=e.page,i=e.showPageSizeOptions,o=e.pageSizeOptions,u=e.pageSize,c=e.showPageJump,h=e.canPrevious,p=e.canNext,f=e.onPageSizeChange,d=e.className,m=e.PreviousComponent,g=void 0===m?l:m,v=e.NextComponent,y=void 0===v?l:v;return a.default.createElement("div",{className:(0,s.default)(d,"-pagination"),style:this.props.paginationStyle},a.default.createElement("div",{className:"-previous"},a.default.createElement(g,{onClick:function(){h&&t.changePage(r-1)},disabled:!h},this.props.previousText)),a.default.createElement("div",{className:"-center"},a.default.createElement("span",{className:"-pageInfo"},this.props.pageText," ",c?a.default.createElement("div",{className:"-pageJump"},a.default.createElement("input",{type:""===this.state.page?"text":"number",onChange:function(e){var n=e.target.value,r=n-1;if(""===n)return t.setState({page:n});t.setState({page:t.getSafePage(r)})},value:""===this.state.page?"":this.state.page+1,onBlur:this.applyPage,onKeyPress:function(e){13!==e.which&&13!==e.keyCode||t.applyPage()}})):a.default.createElement("span",{className:"-currentPage"},r+1)," ",this.props.ofText," ",a.default.createElement("span",{className:"-totalPages"},n||1)),i&&a.default.createElement("span",{className:"select-wrap -pageSizeOptions"},a.default.createElement("select",{onChange:function(t){return f(Number(t.target.value))},value:u},o.map(function(e,n){return a.default.createElement("option",{key:n,value:e},e," ",t.props.rowsText)})))),a.default.createElement("div",{className:"-next"},a.default.createElement(y,{onClick:function(){p&&t.changePage(r+1)},disabled:!p},this.props.nextText)))}}]),e}();e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(2),o=(r=i)&&r.__esModule?r:{default:r};e.default={data:o.default.array,loading:o.default.bool,showPagination:o.default.bool,showPaginationTop:o.default.bool,showPaginationBottom:o.default.bool,showPageSizeOptions:o.default.bool,pageSizeOptions:o.default.array,defaultPageSize:o.default.number,showPageJump:o.default.bool,collapseOnSortingChange:o.default.bool,collapseOnPageChange:o.default.bool,collapseOnDataChange:o.default.bool,freezeWhenExpanded:o.default.bool,sortable:o.default.bool,resizable:o.default.bool,filterable:o.default.bool,defaultSortDesc:o.default.bool,defaultSorted:o.default.array,defaultFiltered:o.default.array,defaultResized:o.default.array,defaultExpanded:o.default.object,defaultFilterMethod:o.default.func,defaultSortMethod:o.default.func,onPageChange:o.default.func,onPageSizeChange:o.default.func,onSortedChange:o.default.func,onFilteredChange:o.default.func,onResizedChange:o.default.func,onExpandedChange:o.default.func,pivotBy:o.default.array,pivotValKey:o.default.string,pivotIDKey:o.default.string,subRowsKey:o.default.string,aggregatedKey:o.default.string,nestingLevelKey:o.default.string,originalKey:o.default.string,indexKey:o.default.string,groupedByPivotKey:o.default.string,onFetchData:o.default.func,className:o.default.string,style:o.default.object,getProps:o.default.func,getTableProps:o.default.func,getTheadGroupProps:o.default.func,getTheadGroupTrProps:o.default.func,getTheadGroupThProps:o.default.func,getTheadProps:o.default.func,getTheadTrProps:o.default.func,getTheadThProps:o.default.func,getTheadFilterProps:o.default.func,getTheadFilterTrProps:o.default.func,getTheadFilterThProps:o.default.func,getTbodyProps:o.default.func,getTrGroupProps:o.default.func,getTrProps:o.default.func,getTdProps:o.default.func,getTfootProps:o.default.func,getTfootTrProps:o.default.func,getTfootTdProps:o.default.func,getPaginationProps:o.default.func,getLoadingProps:o.default.func,getNoDataProps:o.default.func,getResizerProps:o.default.func,columns:o.default.arrayOf(o.default.shape({Cell:o.default.oneOfType([o.default.element,o.default.string,o.default.func]),Header:o.default.oneOfType([o.default.element,o.default.string,o.default.func]),Footer:o.default.oneOfType([o.default.element,o.default.string,o.default.func]),Aggregated:o.default.oneOfType([o.default.element,o.default.string,o.default.func]),Pivot:o.default.oneOfType([o.default.element,o.default.string,o.default.func]),PivotValue:o.default.oneOfType([o.default.element,o.default.string,o.default.func]),Expander:o.default.oneOfType([o.default.element,o.default.string,o.default.func]),Filter:o.default.oneOfType([o.default.element,o.default.func]),sortable:o.default.bool,resizable:o.default.bool,filterable:o.default.bool,show:o.default.bool,minWidth:o.default.number,className:o.default.string,style:o.default.object,getProps:o.default.func,aggregate:o.default.func,headerClassName:o.default.string,headerStyle:o.default.object,getHeaderProps:o.default.func,footerClassName:o.default.string,footerStyle:o.default.object,getFooterProps:o.default.object,filterMethod:o.default.func,filterAll:o.default.bool,sortMethod:o.default.func})),expanderDefaults:o.default.shape({sortable:o.default.bool,resizable:o.default.bool,filterable:o.default.bool,width:o.default.number}),pivotDefaults:o.default.object,previousText:o.default.node,nextText:o.default.node,loadingText:o.default.node,noDataText:o.default.node,pageText:o.default.node,ofText:o.default.node,rowsText:o.default.node,TableComponent:o.default.oneOfType([o.default.func,o.default.element]),TheadComponent:o.default.oneOfType([o.default.func,o.default.element]),TbodyComponent:o.default.oneOfType([o.default.func,o.default.element]),TrGroupComponent:o.default.oneOfType([o.default.func,o.default.element]),TrComponent:o.default.oneOfType([o.default.func,o.default.element]),ThComponent:o.default.oneOfType([o.default.func,o.default.element]),TdComponent:o.default.oneOfType([o.default.func,o.default.element]),TfootComponent:o.default.oneOfType([o.default.func,o.default.element]),FilterComponent:o.default.oneOfType([o.default.func,o.default.element]),ExpanderComponent:o.default.oneOfType([o.default.func,o.default.element]),PivotValueComponent:o.default.oneOfType([o.default.func,o.default.element]),AggregatedComponent:o.default.oneOfType([o.default.func,o.default.element]),PivotComponent:o.default.oneOfType([o.default.func,o.default.element]),PaginationComponent:o.default.oneOfType([o.default.func,o.default.element]),PreviousComponent:o.default.oneOfType([o.default.func,o.default.element]),NextComponent:o.default.oneOfType([o.default.func,o.default.element]),LoadingComponent:o.default.oneOfType([o.default.func,o.default.element]),NoDataComponent:o.default.oneOfType([o.default.func,o.default.element]),ResizerComponent:o.default.oneOfType([o.default.func,o.default.element]),PadRowComponent:o.default.oneOfType([o.default.func,o.default.element])}},function(t,e,n){"use strict";var r=n(26),i=n(295),o=n(665),a=n(184);function s(t){var e=new o(t),n=i(o.prototype.request,e);return r.extend(n,o.prototype,e),r.extend(n,e),n}var u=s(a);u.Axios=o,u.create=function(t){return s(r.merge(a,t))},u.Cancel=n(299),u.CancelToken=n(679),u.isCancel=n(298),u.all=function(t){return Promise.all(t)},u.spread=n(680),t.exports=u,t.exports.default=u},function(t,e){function n(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}t.exports=function(t){return null!=t&&(n(t)||"function"==typeof(e=t).readFloatLE&&"function"==typeof e.slice&&n(e.slice(0,0))||!!t._isBuffer);var e}},function(t,e,n){"use strict";var r=n(184),i=n(26),o=n(674),a=n(675);function s(t){this.defaults=t,this.interceptors={request:new o,response:new o}}s.prototype.request=function(t){"string"==typeof t&&(t=i.merge({url:arguments[0]},arguments[1])),(t=i.merge(r,this.defaults,{method:"get"},t)).method=t.method.toLowerCase();var e=[a,void 0],n=Promise.resolve(t);for(this.interceptors.request.forEach(function(t){e.unshift(t.fulfilled,t.rejected)}),this.interceptors.response.forEach(function(t){e.push(t.fulfilled,t.rejected)});e.length;)n=n.then(e.shift(),e.shift());return n},i.forEach(["delete","get","head","options"],function(t){s.prototype[t]=function(e,n){return this.request(i.merge(n||{},{method:t,url:e}))}}),i.forEach(["post","put","patch"],function(t){s.prototype[t]=function(e,n,r){return this.request(i.merge(r||{},{method:t,url:e,data:n}))}}),t.exports=s},function(t,e,n){"use strict";var r=n(26);t.exports=function(t,e){r.forEach(t,function(n,r){r!==e&&r.toUpperCase()===e.toUpperCase()&&(t[e]=n,delete t[r])})}},function(t,e,n){"use strict";var r=n(297);t.exports=function(t,e,n){var i=n.config.validateStatus;n.status&&i&&!i(n.status)?e(r("Request failed with status code "+n.status,n.config,null,n.request,n)):t(n)}},function(t,e,n){"use strict";t.exports=function(t,e,n,r,i){return t.config=e,n&&(t.code=n),t.request=r,t.response=i,t}},function(t,e,n){"use strict";var r=n(26);function i(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,n){if(!e)return t;var o;if(n)o=n(e);else if(r.isURLSearchParams(e))o=e.toString();else{var a=[];r.forEach(e,function(t,e){null!==t&&void 0!==t&&(r.isArray(t)&&(e+="[]"),r.isArray(t)||(t=[t]),r.forEach(t,function(t){r.isDate(t)?t=t.toISOString():r.isObject(t)&&(t=JSON.stringify(t)),a.push(i(e)+"="+i(t))}))}),o=a.join("&")}return o&&(t+=(-1===t.indexOf("?")?"?":"&")+o),t}},function(t,e,n){"use strict";var r=n(26),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,n,o,a={};return t?(r.forEach(t.split("\n"),function(t){if(o=t.indexOf(":"),e=r.trim(t.substr(0,o)).toLowerCase(),n=r.trim(t.substr(o+1)),e){if(a[e]&&i.indexOf(e)>=0)return;a[e]="set-cookie"===e?(a[e]?a[e]:[]).concat([n]):a[e]?a[e]+", "+n:n}}),a):a}},function(t,e,n){"use strict";var r=n(26);t.exports=r.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function i(t){var r=t;return e&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return t=i(window.location.href),function(e){var n=r.isString(e)?i(e):e;return n.protocol===t.protocol&&n.host===t.host}}():function(){return!0}},function(t,e,n){"use strict";var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function i(){this.message="String contains an invalid character"}i.prototype=new Error,i.prototype.code=5,i.prototype.name="InvalidCharacterError",t.exports=function(t){for(var e,n,o=String(t),a="",s=0,u=r;o.charAt(0|s)||(u="=",s%1);a+=u.charAt(63&e>>8-s%1*8)){if((n=o.charCodeAt(s+=.75))>255)throw new i;e=e<<8|n}return a}},function(t,e,n){"use strict";var r=n(26);t.exports=r.isStandardBrowserEnv()?{write:function(t,e,n,i,o,a){var s=[];s.push(t+"="+encodeURIComponent(e)),r.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),r.isString(i)&&s.push("path="+i),r.isString(o)&&s.push("domain="+o),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(t,e,n){"use strict";var r=n(26);function i(){this.handlers=[]}i.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},i.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},i.prototype.forEach=function(t){r.forEach(this.handlers,function(e){null!==e&&t(e)})},t.exports=i},function(t,e,n){"use strict";var r=n(26),i=n(676),o=n(298),a=n(184),s=n(677),u=n(678);function l(t){t.cancelToken&&t.cancelToken.throwIfRequested()}t.exports=function(t){return l(t),t.baseURL&&!s(t.url)&&(t.url=u(t.baseURL,t.url)),t.headers=t.headers||{},t.data=i(t.data,t.headers,t.transformRequest),t.headers=r.merge(t.headers.common||{},t.headers[t.method]||{},t.headers||{}),r.forEach(["delete","get","head","post","put","patch","common"],function(e){delete t.headers[e]}),(t.adapter||a.adapter)(t).then(function(e){return l(t),e.data=i(e.data,e.headers,t.transformResponse),e},function(e){return o(e)||(l(t),e&&e.response&&(e.response.data=i(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)})}},function(t,e,n){"use strict";var r=n(26);t.exports=function(t,e,n){return r.forEach(n,function(n){t=n(t,e)}),t}},function(t,e,n){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},function(t,e,n){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},function(t,e,n){"use strict";var r=n(299);function i(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise(function(t){e=t});var n=this;t(function(t){n.reason||(n.reason=new r(t),e(n.reason))})}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var t;return{token:new i(function(e){t=e}),cancel:t}},t.exports=i},function(t,e,n){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={},i={},o=34,a=10,s=13;function u(t){return new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}")}var l=function(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function l(t,e){var u,l=[],c=t.length,h=0,p=0,f=c<=0,d=!1;function m(){if(f)return i;if(d)return d=!1,r;var e,u,l=h;if(t.charCodeAt(l)===o){for(;h++<c&&t.charCodeAt(h)!==o||t.charCodeAt(++h)===o;);return(e=h)>=c?f=!0:(u=t.charCodeAt(h++))===a?d=!0:u===s&&(d=!0,t.charCodeAt(h)===a&&++h),t.slice(l+1,e-1).replace(/""/g,'"')}for(;h<c;){if((u=t.charCodeAt(e=h++))===a)d=!0;else if(u===s)d=!0,t.charCodeAt(h)===a&&++h;else if(u!==n)continue;return t.slice(l,e)}return f=!0,t.slice(l,c)}for(t.charCodeAt(c-1)===a&&--c,t.charCodeAt(c-1)===s&&--c;(u=m())!==i;){for(var g=[];u!==r&&u!==i;)g.push(u),u=m();e&&null==(g=e(g,p++))||l.push(g)}return l}function c(e){return e.map(h).join(t)}function h(t){return null==t?"":e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,r,i=l(t,function(t,i){if(n)return n(t,i-1);var o,a,s;r=t,n=e?(a=e,s=u(o=t),function(t,e){return a(s(t),e,o)}):u(t)});return i.columns=r||[],i},parseRows:l,format:function(e,n){var r,i,o;return null==n&&(r=e,i=Object.create(null),o=[],r.forEach(function(t){for(var e in t)e in i||o.push(i[e]=e)}),n=o),[n.map(h).join(t)].concat(e.map(function(e){return n.map(function(t){return h(e[t])}).join(t)})).join("\n")},formatRows:function(t){return t.map(c).join("\n")}}},c=l(","),h=c.parse,p=c.parseRows,f=c.format,d=c.formatRows,m=l("\t"),g=m.parse,v=m.parseRows,y=m.format,b=m.formatRows;n.d(e,"dsvFormat",function(){return l}),n.d(e,"csvParse",function(){return h}),n.d(e,"csvParseRows",function(){return p}),n.d(e,"csvFormat",function(){return f}),n.d(e,"csvFormatRows",function(){return d}),n.d(e,"tsvParse",function(){return g}),n.d(e,"tsvParseRows",function(){return v}),n.d(e,"tsvFormat",function(){return y}),n.d(e,"tsvFormatRows",function(){return b})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i,o,a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(1),u=(o=s)&&o.__esModule?o:{default:o},l=n(183),c=n(300);var h=(r=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.call(n),n.state={loading:!0,data:void 0},n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.Component),a(e,[{key:"componentWillMount",value:function(){this.updateData(this.props)}},{key:"componentWillReceiveProps",value:function(t){this.props.src!==t.src&&this.updateData(t)}},{key:"render",value:function(){var t=this.props.contextualizer,e=this.state,n=e.columns,r=void 0===n?[]:n,i=e.data,o=void 0===i?[]:i,a=t&&t.pageRowsLimit&&"number"==typeof t.pageRowsLimit?t.pageRowsLimit:200,s=o.slice(0,a);return u.default.createElement("table",null,u.default.createElement("thead",null,u.default.createElement("tr",null,r.map(function(t,e){return u.default.createElement("th",{key:e},t.Header)}))),u.default.createElement("tbody",null,s.map(function(t,e){return u.default.createElement("tr",{key:e},r.map(function(e,n){return u.default.createElement("th",{key:n},t[e.accessor])}))})))}}]),e}(),i=function(){var t=this;this.updateData=function(e){if(e.asset&&e.asset.asset&&e.asset.asset.rawData){var n=(0,c.formatData)(e.asset.asset.rawData,e.asset.asset.filename),r=(0,c.computeColumns)(n);t.setState({data:n,columns:r,loading:!1})}else if(e.src){var i=e.src;t.setState({loading:!0,error:void 0}),(0,l.get)(i).then(function(e){var n=(0,c.formatData)(e.data,i);t.setState({data:n,columns:(0,c.computeColumns)(n),loading:!1})}).catch(function(e){t.setState({error:e})})}}},r);e.default=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(1),o=(r=i)&&r.__esModule?r:{default:r};e.default=function(t){switch(t.renderingMode){case"web":return o.default.createElement("span",null,"inline web");case"pdf":return o.default.createElement("span",null,"inline pdf");case"epub-reflowable":return o.default.createElement("span",null,"inline epub reflowable");case"epub-fixed":return o.default.createElement("span",null,"inline epub fixed");case"micro":return o.default.createElement("span",null,"inline micro");default:return null}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.meta=e.Inline=e.Block=void 0;var r=a(n(685)),i=a(n(695)),o=a(n(301));function a(t){return t&&t.__esModule?t:{default:t}}e.Block=r.default,e.Inline=i.default,e.meta=o.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(n(1)),i=s(n(2)),o=s(n(301)),a=n(50);function s(t){return t&&t.__esModule?t:{default:t}}var u=void 0,l=new Function("try {return this===window;}catch(e){ return false;}")();l&&(u=n(686).default);var c=l?n(119):{},h=c.Media,p=c.Player,f=c.controls,d=function(t,e){var n=t.resource,i=t.renderingMode,s=e.assetsData,c=e.getAssetUri,d=(0,a.pickAsset)(n,o.default.assetPickingRules.element[i],s);if(!d)return null;var m=d.resourceDataField,g=void 0,v=void 0;switch(n.data.font_asset_id&&(v=c(s[n.data.font_asset_id])),m){case"content_asset_id":return l?(g=c(d.asset),r.default.createElement(u,{resource:n,assetUri:g,fontUri:v})):null;case"screencast_video_asset_id":if(g=c(d.asset),"epub-fixed"===i)return r.default.createElement("video",{controls:!0},r.default.createElement("source",{src:g,type:"video/"+g.split(".").pop()}));var y=f.PlayPause,b=f.MuteUnmute;return r.default.createElement(h,null,r.default.createElement("div",{className:"media"},r.default.createElement(p,{src:g}),r.default.createElement("div",{className:"media-controls"},r.default.createElement(y,null),r.default.createElement(b,null))));default:return g=c(d.asset),r.default.createElement("img",{src:g})}};d.contextTypes={assetsData:i.default.object,getAssetUri:i.default.func},e.default=d},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(1),a=l(o),s=l(n(177)),u=n(183);function l(t){return t&&t.__esModule?t:{default:t}}t.THREE=n(185),t.opentype=n(687);var c=n(693);t.Mobilizing=c.Mobilizing?c.Mobilizing:c;var h=n(694),p=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.resolveDependencies=function(t,e){return new Promise(function(n,i){"text"===t.content_type?(0,u.get)(e).then(function(e){var i=e.data;n(r({},t,{content:i}))}).catch(i):n(t)})},n.initMobiliscene=function(){var t=n.props,e=t.resource.data,r=t.assetUri,i=t.fontUri;n.resolveDependencies(e,r).then(function(t){n.mobilizing=new Mobilizing.Context;var e=new h(n.canvas,t,r,i);n.mobilizing.addComponent(e),n.runner=new Mobilizing.Runner({context:n.mobilizing})}).catch()},n.unloadMobiliscene=function(){n.runner=null,n.mobilizing._components=[],n.mobilizing=null},n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Component),i(e,[{key:"componentDidMount",value:function(){this.initMobiliscene()}},{key:"componentWillUnmount",value:function(){this.unloadMobiliscene()}},{key:"componentWillReceiveProps",value:function(t){var e=this;this.props.resource._id!==t.resource._id&&(this.unloadMobiliscene(),setTimeout(function(){return e.initMobiliscene()},500))}},{key:"render",value:function(){var t=this,e=this.props,n=e.containerWidth,r=e.containerHeight;return a.default.createElement("div",null,a.default.createElement("canvas",{ref:function(e){t.canvas=e},width:n,height:r,style:{width:n,height:r}}))}}]),e}();e.default=(0,s.default)()(p)}).call(e,n(78))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(688),i=n.n(r);function o(t,e,n,r,i){return Math.pow(1-i,3)*t+3*Math.pow(1-i,2)*i*e+3*(1-i)*Math.pow(i,2)*n+Math.pow(i,3)*r}function a(){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN}a.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)},a.prototype.addPoint=function(t,e){"number"==typeof t&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),"number"==typeof e&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=e,this.y2=e),e<this.y1&&(this.y1=e),e>this.y2&&(this.y2=e))},a.prototype.addX=function(t){this.addPoint(t,null)},a.prototype.addY=function(t){this.addPoint(null,t)},a.prototype.addBezier=function(t,e,n,r,i,a,s,u){const l=[t,e],c=[n,r],h=[i,a],p=[s,u];this.addPoint(t,e),this.addPoint(s,u);for(let t=0;t<=1;t++){const e=6*l[t]-12*c[t]+6*h[t],n=-3*l[t]+9*c[t]-9*h[t]+3*p[t],r=3*c[t]-3*l[t];if(0===n){if(0===e)continue;const n=-r/e;0<n&&n<1&&(0===t&&this.addX(o(l[t],c[t],h[t],p[t],n)),1===t&&this.addY(o(l[t],c[t],h[t],p[t],n)));continue}const i=Math.pow(e,2)-4*r*n;if(i<0)continue;const a=(-e+Math.sqrt(i))/(2*n);0<a&&a<1&&(0===t&&this.addX(o(l[t],c[t],h[t],p[t],a)),1===t&&this.addY(o(l[t],c[t],h[t],p[t],a)));const s=(-e-Math.sqrt(i))/(2*n);0<s&&s<1&&(0===t&&this.addX(o(l[t],c[t],h[t],p[t],s)),1===t&&this.addY(o(l[t],c[t],h[t],p[t],s)))}},a.prototype.addQuad=function(t,e,n,r,i,o){const a=t+2/3*(n-t),s=e+2/3*(r-e),u=a+1/3*(i-t),l=s+1/3*(o-e);this.addBezier(t,e,a,s,u,l,i,o)};var s=a;function u(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}u.prototype.moveTo=function(t,e){this.commands.push({type:"M",x:t,y:e})},u.prototype.lineTo=function(t,e){this.commands.push({type:"L",x:t,y:e})},u.prototype.curveTo=u.prototype.bezierCurveTo=function(t,e,n,r,i,o){this.commands.push({type:"C",x1:t,y1:e,x2:n,y2:r,x:i,y:o})},u.prototype.quadTo=u.prototype.quadraticCurveTo=function(t,e,n,r){this.commands.push({type:"Q",x1:t,y1:e,x:n,y:r})},u.prototype.close=u.prototype.closePath=function(){this.commands.push({type:"Z"})},u.prototype.extend=function(t){if(t.commands)t=t.commands;else if(t instanceof s){const e=t;return this.moveTo(e.x1,e.y1),this.lineTo(e.x2,e.y1),this.lineTo(e.x2,e.y2),this.lineTo(e.x1,e.y2),void this.close()}Array.prototype.push.apply(this.commands,t)},u.prototype.getBoundingBox=function(){const t=new s;let e=0,n=0,r=0,i=0;for(let o=0;o<this.commands.length;o++){const a=this.commands[o];switch(a.type){case"M":t.addPoint(a.x,a.y),e=r=a.x,n=i=a.y;break;case"L":t.addPoint(a.x,a.y),r=a.x,i=a.y;break;case"Q":t.addQuad(r,i,a.x1,a.y1,a.x,a.y),r=a.x,i=a.y;break;case"C":t.addBezier(r,i,a.x1,a.y1,a.x2,a.y2,a.x,a.y),r=a.x,i=a.y;break;case"Z":r=e,i=n;break;default:throw new Error("Unexpected path command "+a.type)}}return t.isEmpty()&&t.addPoint(0,0),t},u.prototype.draw=function(t){t.beginPath();for(let e=0;e<this.commands.length;e+=1){const n=this.commands[e];"M"===n.type?t.moveTo(n.x,n.y):"L"===n.type?t.lineTo(n.x,n.y):"C"===n.type?t.bezierCurveTo(n.x1,n.y1,n.x2,n.y2,n.x,n.y):"Q"===n.type?t.quadraticCurveTo(n.x1,n.y1,n.x,n.y):"Z"===n.type&&t.closePath()}this.fill&&(t.fillStyle=this.fill,t.fill()),this.stroke&&(t.strokeStyle=this.stroke,t.lineWidth=this.strokeWidth,t.stroke())},u.prototype.toPathData=function(t){function e(){let e="";for(let r=0;r<arguments.length;r+=1){const i=arguments[r];i>=0&&r>0&&(e+=" "),e+=(n=i,Math.round(n)===n?""+Math.round(n):n.toFixed(t))}var n;return e}t=void 0!==t?t:2;let n="";for(let t=0;t<this.commands.length;t+=1){const r=this.commands[t];"M"===r.type?n+="M"+e(r.x,r.y):"L"===r.type?n+="L"+e(r.x,r.y):"C"===r.type?n+="C"+e(r.x1,r.y1,r.x2,r.y2,r.x,r.y):"Q"===r.type?n+="Q"+e(r.x1,r.y1,r.x,r.y):"Z"===r.type&&(n+="Z")}return n},u.prototype.toSVG=function(t){let e='<path d="';return e+=this.toPathData(t),e+='"',this.fill&&"black"!==this.fill&&(null===this.fill?e+=' fill="none"':e+=' fill="'+this.fill+'"'),this.stroke&&(e+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),e+="/>"},u.prototype.toDOMElement=function(t){const e=this.toPathData(t),n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttribute("d",e),n};var l=u;function c(t){throw new Error(t)}function h(t,e){t||c(e)}var p={fail:c,argument:h,assert:h};const f={},d={},m={};function g(t){return function(){return t}}d.BYTE=function(t){return p.argument(t>=0&&t<=255,"Byte value should be between 0 and 255."),[t]},m.BYTE=g(1),d.CHAR=function(t){return[t.charCodeAt(0)]},m.CHAR=g(1),d.CHARARRAY=function(t){const e=[];for(let n=0;n<t.length;n+=1)e[n]=t.charCodeAt(n);return e},m.CHARARRAY=function(t){return t.length},d.USHORT=function(t){return[t>>8&255,255&t]},m.USHORT=g(2),d.SHORT=function(t){return t>=32768&&(t=-(65536-t)),[t>>8&255,255&t]},m.SHORT=g(2),d.UINT24=function(t){return[t>>16&255,t>>8&255,255&t]},m.UINT24=g(3),d.ULONG=function(t){return[t>>24&255,t>>16&255,t>>8&255,255&t]},m.ULONG=g(4),d.LONG=function(t){return t>=2147483648&&(t=-(4294967296-t)),[t>>24&255,t>>16&255,t>>8&255,255&t]},m.LONG=g(4),d.FIXED=d.ULONG,m.FIXED=m.ULONG,d.FWORD=d.SHORT,m.FWORD=m.SHORT,d.UFWORD=d.USHORT,m.UFWORD=m.USHORT,d.LONGDATETIME=function(t){return[0,0,0,0,t>>24&255,t>>16&255,t>>8&255,255&t]},m.LONGDATETIME=g(8),d.TAG=function(t){return p.argument(4===t.length,"Tag should be exactly 4 ASCII characters."),[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]},m.TAG=g(4),d.Card8=d.BYTE,m.Card8=m.BYTE,d.Card16=d.USHORT,m.Card16=m.USHORT,d.OffSize=d.BYTE,m.OffSize=m.BYTE,d.SID=d.USHORT,m.SID=m.USHORT,d.NUMBER=function(t){return t>=-107&&t<=107?[t+139]:t>=108&&t<=1131?[247+((t-=108)>>8),255&t]:t>=-1131&&t<=-108?[251+((t=-t-108)>>8),255&t]:t>=-32768&&t<=32767?d.NUMBER16(t):d.NUMBER32(t)},m.NUMBER=function(t){return d.NUMBER(t).length},d.NUMBER16=function(t){return[28,t>>8&255,255&t]},m.NUMBER16=g(3),d.NUMBER32=function(t){return[29,t>>24&255,t>>16&255,t>>8&255,255&t]},m.NUMBER32=g(5),d.REAL=function(t){let e=t.toString();const n=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(e);if(n){const r=parseFloat("1e"+((n[2]?+n[2]:0)+n[1].length));e=(Math.round(t*r)/r).toString()}let r="";for(let t=0,n=e.length;t<n;t+=1){const n=e[t];r+="e"===n?"-"===e[++t]?"c":"b":"."===n?"a":"-"===n?"e":n}const i=[30];for(let t=0,e=(r+=1&r.length?"f":"ff").length;t<e;t+=2)i.push(parseInt(r.substr(t,2),16));return i},m.REAL=function(t){return d.REAL(t).length},d.NAME=d.CHARARRAY,m.NAME=m.CHARARRAY,d.STRING=d.CHARARRAY,m.STRING=m.CHARARRAY,f.UTF8=function(t,e,n){const r=[],i=n;for(let n=0;n<i;n++,e+=1)r[n]=t.getUint8(e);return String.fromCharCode.apply(null,r)},f.UTF16=function(t,e,n){const r=[],i=n/2;for(let n=0;n<i;n++,e+=2)r[n]=t.getUint16(e);return String.fromCharCode.apply(null,r)},d.UTF16=function(t){const e=[];for(let n=0;n<t.length;n+=1){const r=t.charCodeAt(n);e[e.length]=r>>8&255,e[e.length]=255&r}return e},m.UTF16=function(t){return 2*t.length};const v={"x-mac-croatian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®Š™´¨≠ŽØ∞±≤≥∆µ∂∑∏š∫ªºΩžø¿¡¬√ƒ≈Ć«Č… ÀÃÕŒœĐ—“”‘’÷◊©⁄€‹›Æ»–·‚„‰ÂćÁčÈÍÎÏÌÓÔđÒÚÛÙıˆ˜¯πË˚¸Êæˇ","x-mac-cyrillic":"АБВГДЕЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ†°Ґ£§•¶І®©™Ђђ≠Ѓѓ∞±≤≥іµґЈЄєЇїЉљЊњјЅ¬√ƒ≈∆«»… ЋћЌќѕ–—“”‘’÷„ЎўЏџ№Ёёяабвгдежзийклмнопрстуфхцчшщъыьэю","x-mac-gaelic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØḂ±≤≥ḃĊċḊḋḞḟĠġṀæøṁṖṗɼƒſṠ«»… ÀÃÕŒœ–—“”‘’ṡẛÿŸṪ€‹›Ŷŷṫ·Ỳỳ⁊ÂÊÁËÈÍÎÏÌÓÔ♣ÒÚÛÙıÝýŴŵẄẅẀẁẂẃ","x-mac-greek":"Ä¹²É³ÖÜ΅àâä΄¨çéèêë£™îï•½‰ôö¦€ùûü†ΓΔΘΛΞΠß®©ΣΪ§≠°·Α±≤≥¥ΒΕΖΗΙΚΜΦΫΨΩάΝ¬ΟΡ≈Τ«»… ΥΧΆΈœ–―“”‘’÷ΉΊΌΎέήίόΏύαβψδεφγηιξκλμνοπώρστθωςχυζϊϋΐΰ­","x-mac-icelandic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûüÝ°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€ÐðÞþý·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-inuit":"ᐃᐄᐅᐆᐊᐋᐱᐲᐳᐴᐸᐹᑉᑎᑏᑐᑑᑕᑖᑦᑭᑮᑯᑰᑲᑳᒃᒋᒌᒍᒎᒐᒑ°ᒡᒥᒦ•¶ᒧ®©™ᒨᒪᒫᒻᓂᓃᓄᓅᓇᓈᓐᓯᓰᓱᓲᓴᓵᔅᓕᓖᓗᓘᓚᓛᓪᔨᔩᔪᔫᔭ… ᔮᔾᕕᕖᕗ–—“”‘’ᕘᕙᕚᕝᕆᕇᕈᕉᕋᕌᕐᕿᖀᖁᖂᖃᖄᖅᖏᖐᖑᖒᖓᖔᖕᙱᙲᙳᙴᙵᙶᖖᖠᖡᖢᖣᖤᖥᖦᕼŁł","x-mac-ce":"ÄĀāÉĄÖÜáąČäčĆćéŹźĎíďĒēĖóėôöõúĚěü†°Ę£§•¶ß®©™ę¨≠ģĮįĪ≤≥īĶ∂∑łĻļĽľĹĺŅņŃ¬√ńŇ∆«»… ňŐÕőŌ–—“”‘’÷◊ōŔŕŘ‹›řŖŗŠ‚„šŚśÁŤťÍŽžŪÓÔūŮÚůŰűŲųÝýķŻŁżĢˇ",macintosh:"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›ﬁﬂ‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-romanian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ĂȘ∞±≤≥¥µ∂∑∏π∫ªºΩăș¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›Țț‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-turkish":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸĞğİıŞş‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙˆ˜¯˘˙˚¸˝˛ˇ"};f.MACSTRING=function(t,e,n,r){const i=v[r];if(void 0===i)return;let o="";for(let r=0;r<n;r++){const n=t.getUint8(e+r);o+=n<=127?String.fromCharCode(n):i[127&n]}return o};const y="function"==typeof WeakMap&&new WeakMap;let b;function _(t){return t>=-128&&t<=127}function x(t,e,n){let r=0;const i=t.length;for(;e<i&&r<64&&0===t[e];)++e,++r;return n.push(128|r-1),e}function w(t,e,n){let r=0;const i=t.length;let o=e;for(;o<i&&r<64;){const e=t[o];if(!_(e))break;if(0===e&&o+1<i&&0===t[o+1])break;++o,++r}n.push(r-1);for(let r=e;r<o;++r)n.push(t[r]+256&255);return o}function E(t,e,n){let r=0;const i=t.length;let o=e;for(;o<i&&r<64;){const e=t[o];if(0===e)break;if(_(e)&&o+1<i&&_(t[o+1]))break;++o,++r}n.push(64|r-1);for(let r=e;r<o;++r){const e=t[r];n.push(e+65536>>8&255,e+256&255)}return o}d.MACSTRING=function(t,e){const n=function(t){if(!b){b={};for(let t in v)b[t]=new String(t)}const e=b[t];if(void 0===e)return;if(y){const t=y.get(e);if(void 0!==t)return t}const n=v[t];if(void 0===n)return;const r={};for(let t=0;t<n.length;t++)r[n.charCodeAt(t)]=t+128;return y&&y.set(e,r),r}(e);if(void 0===n)return;const r=[];for(let e=0;e<t.length;e++){let i=t.charCodeAt(e);if(i>=128&&void 0===(i=n[i]))return;r[e]=i}return r},m.MACSTRING=function(t,e){const n=d.MACSTRING(t,e);return void 0!==n?n.length:0},d.VARDELTAS=function(t){let e=0;const n=[];for(;e<t.length;){const r=t[e];e=0===r?x(t,e,n):r>=-128&&r<=127?w(t,e,n):E(t,e,n)}return n},d.INDEX=function(t){let e=1;const n=[e],r=[];for(let i=0;i<t.length;i+=1){const o=d.OBJECT(t[i]);Array.prototype.push.apply(r,o),e+=o.length,n.push(e)}if(0===r.length)return[0,0];const i=[],o=1+Math.floor(Math.log(e)/Math.log(2))/8|0,a=[void 0,d.BYTE,d.USHORT,d.UINT24,d.ULONG][o];for(let t=0;t<n.length;t+=1){const e=a(n[t]);Array.prototype.push.apply(i,e)}return Array.prototype.concat(d.Card16(t.length),d.OffSize(o),i,r)},m.INDEX=function(t){return d.INDEX(t).length},d.DICT=function(t){let e=[];const n=Object.keys(t),r=n.length;for(let i=0;i<r;i+=1){const r=parseInt(n[i],0),o=t[r];e=(e=e.concat(d.OPERAND(o.value,o.type))).concat(d.OPERATOR(r))}return e},m.DICT=function(t){return d.DICT(t).length},d.OPERATOR=function(t){return t<1200?[t]:[12,t-1200]},d.OPERAND=function(t,e){let n=[];if(Array.isArray(e))for(let r=0;r<e.length;r+=1)p.argument(t.length===e.length,"Not enough arguments given for type"+e),n=n.concat(d.OPERAND(t[r],e[r]));else if("SID"===e)n=n.concat(d.NUMBER(t));else if("offset"===e)n=n.concat(d.NUMBER32(t));else if("number"===e)n=n.concat(d.NUMBER(t));else{if("real"!==e)throw new Error("Unknown operand type "+e);n=n.concat(d.REAL(t))}return n},d.OP=d.BYTE,m.OP=m.BYTE;const S="function"==typeof WeakMap&&new WeakMap;function T(t,e,n){for(let t=0;t<e.length;t+=1){const n=e[t];this[n.name]=n.value}if(this.tableName=t,this.fields=e,n){const t=Object.keys(n);for(let e=0;e<t.length;e+=1){const r=t[e],i=n[r];void 0!==this[r]&&(this[r]=i)}}}function O(t,e,n){void 0===n&&(n=e.length);const r=new Array(e.length+1);r[0]={name:t+"Count",type:"USHORT",value:n};for(let n=0;n<e.length;n++)r[n+1]={name:t+n,type:"USHORT",value:e[n]};return r}function A(t,e,n){const r=e.length,i=new Array(r+1);i[0]={name:t+"Count",type:"USHORT",value:r};for(let o=0;o<r;o++)i[o+1]={name:t+o,type:"TABLE",value:n(e[o],o)};return i}function M(t,e,n){const r=e.length;let i=[];i[0]={name:t+"Count",type:"USHORT",value:r};for(let t=0;t<r;t++)i=i.concat(n(e[t],t));return i}function C(t){1===t.format?T.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(O("glyph",t.glyphs))):p.assert(!1,"Can't create coverage table format 2 yet.")}function k(t){T.call(this,"scriptListTable",M("scriptRecord",t,function(t,e){const n=t.script;let r=n.defaultLangSys;return p.assert(!!r,"Unable to write GSUB: script "+t.tag+" has no default language system."),[{name:"scriptTag"+e,type:"TAG",value:t.tag},{name:"script"+e,type:"TABLE",value:new T("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new T("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:r.reqFeatureIndex}].concat(O("featureIndex",r.featureIndexes)))}].concat(M("langSys",n.langSysRecords,function(t,e){const n=t.langSys;return[{name:"langSysTag"+e,type:"TAG",value:t.tag},{name:"langSys"+e,type:"TABLE",value:new T("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:n.reqFeatureIndex}].concat(O("featureIndex",n.featureIndexes)))}]})))}]}))}function P(t){T.call(this,"featureListTable",M("featureRecord",t,function(t,e){const n=t.feature;return[{name:"featureTag"+e,type:"TAG",value:t.tag},{name:"feature"+e,type:"TABLE",value:new T("featureTable",[{name:"featureParams",type:"USHORT",value:n.featureParams}].concat(O("lookupListIndex",n.lookupListIndexes)))}]}))}function R(t,e){T.call(this,"lookupListTable",A("lookup",t,function(t){let n=e[t.lookupType];return p.assert(!!n,"Unable to write GSUB lookup type "+t.lookupType+" tables."),new T("lookupTable",[{name:"lookupType",type:"USHORT",value:t.lookupType},{name:"lookupFlag",type:"USHORT",value:t.lookupFlag}].concat(A("subtable",t.subtables,n)))}))}d.CHARSTRING=function(t){if(S){const e=S.get(t);if(void 0!==e)return e}let e=[];const n=t.length;for(let r=0;r<n;r+=1){const n=t[r];e=e.concat(d[n.type](n.value))}return S&&S.set(t,e),e},m.CHARSTRING=function(t){return d.CHARSTRING(t).length},d.OBJECT=function(t){const e=d[t.type];return p.argument(void 0!==e,"No encoding function for type "+t.type),e(t.value)},m.OBJECT=function(t){const e=m[t.type];return p.argument(void 0!==e,"No sizeOf function for type "+t.type),e(t.value)},d.TABLE=function(t){let e=[];const n=t.fields.length,r=[],i=[];for(let o=0;o<n;o+=1){const n=t.fields[o],a=d[n.type];p.argument(void 0!==a,"No encoding function for field type "+n.type+" ("+n.name+")");let s=t[n.name];void 0===s&&(s=n.value);const u=a(s);"TABLE"===n.type?(i.push(e.length),e=e.concat([0,0]),r.push(u)):e=e.concat(u)}for(let n=0;n<r.length;n+=1){const o=i[n],a=e.length;p.argument(a<65536,"Table "+t.tableName+" too big."),e[o]=a>>8,e[o+1]=255&a,e=e.concat(r[n])}return e},m.TABLE=function(t){let e=0;const n=t.fields.length;for(let r=0;r<n;r+=1){const n=t.fields[r],i=m[n.type];p.argument(void 0!==i,"No sizeOf function for field type "+n.type+" ("+n.name+")");let o=t[n.name];void 0===o&&(o=n.value),e+=i(o),"TABLE"===n.type&&(e+=2)}return e},d.RECORD=d.TABLE,m.RECORD=m.TABLE,d.LITERAL=function(t){return t},m.LITERAL=function(t){return t.length},T.prototype.encode=function(){return d.TABLE(this)},T.prototype.sizeOf=function(){return m.TABLE(this)},C.prototype=Object.create(T.prototype),C.prototype.constructor=C,k.prototype=Object.create(T.prototype),k.prototype.constructor=k,P.prototype=Object.create(T.prototype),P.prototype.constructor=P,R.prototype=Object.create(T.prototype),R.prototype.constructor=R;var L={Table:T,Record:T,Coverage:C,ScriptList:k,FeatureList:P,LookupList:R,ushortList:O,tableList:A,recordList:M};function I(t,e){return t.getUint8(e)}function D(t,e){return t.getUint16(e,!1)}function N(t,e){return t.getUint32(e,!1)}function j(t,e){return t.getInt16(e,!1)+t.getUint16(e+2,!1)/65535}const U={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function F(t,e){this.data=t,this.offset=e,this.relativeOffset=0}F.prototype.parseByte=function(){const t=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,t},F.prototype.parseChar=function(){const t=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,t},F.prototype.parseCard8=F.prototype.parseByte,F.prototype.parseUShort=function(){const t=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,t},F.prototype.parseCard16=F.prototype.parseUShort,F.prototype.parseSID=F.prototype.parseUShort,F.prototype.parseOffset16=F.prototype.parseUShort,F.prototype.parseShort=function(){const t=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,t},F.prototype.parseF2Dot14=function(){const t=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,t},F.prototype.parseULong=function(){const t=N(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,t},F.prototype.parseFixed=function(){const t=j(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,t},F.prototype.parseString=function(t){const e=this.data,n=this.offset+this.relativeOffset;let r="";this.relativeOffset+=t;for(let i=0;i<t;i++)r+=String.fromCharCode(e.getUint8(n+i));return r},F.prototype.parseTag=function(){return this.parseString(4)},F.prototype.parseLongDateTime=function(){let t=N(this.data,this.offset+this.relativeOffset+4);return t-=2082844800,this.relativeOffset+=8,t},F.prototype.parseVersion=function(){const t=D(this.data,this.offset+this.relativeOffset),e=D(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,t+e/4096/10},F.prototype.skip=function(t,e){void 0===e&&(e=1),this.relativeOffset+=U[t]*e},F.prototype.parseOffset16List=F.prototype.parseUShortList=function(t){void 0===t&&(t=this.parseUShort());const e=new Array(t),n=this.data;let r=this.offset+this.relativeOffset;for(let i=0;i<t;i++)e[i]=n.getUint16(r),r+=2;return this.relativeOffset+=2*t,e},F.prototype.parseShortList=function(t){const e=new Array(t),n=this.data;let r=this.offset+this.relativeOffset;for(let i=0;i<t;i++)e[i]=n.getInt16(r),r+=2;return this.relativeOffset+=2*t,e},F.prototype.parseByteList=function(t){const e=new Array(t),n=this.data;let r=this.offset+this.relativeOffset;for(let i=0;i<t;i++)e[i]=n.getUint8(r++);return this.relativeOffset+=t,e},F.prototype.parseList=function(t,e){e||(e=t,t=this.parseUShort());const n=new Array(t);for(let r=0;r<t;r++)n[r]=e.call(this);return n},F.prototype.parseRecordList=function(t,e){e||(e=t,t=this.parseUShort());const n=new Array(t),r=Object.keys(e);for(let i=0;i<t;i++){const t={};for(let n=0;n<r.length;n++){const i=r[n],o=e[i];t[i]=o.call(this)}n[i]=t}return n},F.prototype.parseStruct=function(t){if("function"==typeof t)return t.call(this);{const e=Object.keys(t),n={};for(let r=0;r<e.length;r++){const i=e[r],o=t[i];n[i]=o.call(this)}return n}},F.prototype.parsePointer=function(t){const e=this.parseOffset16();if(e>0)return new F(this.data,this.offset+e).parseStruct(t)},F.prototype.parseListOfLists=function(t){const e=this.parseOffset16List(),n=e.length,r=this.relativeOffset,i=new Array(n);for(let r=0;r<n;r++){const n=e[r];if(0!==n)if(this.relativeOffset=n,t){const e=this.parseOffset16List(),o=new Array(e.length);for(let r=0;r<e.length;r++)this.relativeOffset=n+e[r],o[r]=t.call(this);i[r]=o}else i[r]=this.parseUShortList();else i[r]=void 0}return this.relativeOffset=r,i},F.prototype.parseCoverage=function(){const t=this.offset+this.relativeOffset,e=this.parseUShort(),n=this.parseUShort();if(1===e)return{format:1,glyphs:this.parseUShortList(n)};if(2===e){const t=new Array(n);for(let e=0;e<n;e++)t[e]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:t}}throw new Error("0x"+t.toString(16)+": Coverage format must be 1 or 2.")},F.prototype.parseClassDef=function(){const t=this.offset+this.relativeOffset,e=this.parseUShort();if(1===e)return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()};if(2===e)return{format:2,ranges:this.parseRecordList({start:F.uShort,end:F.uShort,classId:F.uShort})};throw new Error("0x"+t.toString(16)+": ClassDef format must be 1 or 2.")},F.list=function(t,e){return function(){return this.parseList(t,e)}},F.recordList=function(t,e){return function(){return this.parseRecordList(t,e)}},F.pointer=function(t){return function(){return this.parsePointer(t)}},F.tag=F.prototype.parseTag,F.byte=F.prototype.parseByte,F.uShort=F.offset16=F.prototype.parseUShort,F.uShortList=F.prototype.parseUShortList,F.struct=F.prototype.parseStruct,F.coverage=F.prototype.parseCoverage,F.classDef=F.prototype.parseClassDef;const B={reserved:F.uShort,reqFeatureIndex:F.uShort,featureIndexes:F.uShortList};F.prototype.parseScriptList=function(){return this.parsePointer(F.recordList({tag:F.tag,script:F.pointer({defaultLangSys:F.pointer(B),langSysRecords:F.recordList({tag:F.tag,langSys:F.pointer(B)})})}))},F.prototype.parseFeatureList=function(){return this.parsePointer(F.recordList({tag:F.tag,feature:F.pointer({featureParams:F.offset16,lookupListIndexes:F.uShortList})}))},F.prototype.parseLookupList=function(t){return this.parsePointer(F.list(F.pointer(function(){const e=this.parseUShort();p.argument(1<=e&&e<=8,"GSUB lookup type "+e+" unknown.");const n=this.parseUShort(),r=16&n;return{lookupType:e,lookupFlag:n,subtables:this.parseList(F.pointer(t[e])),markFilteringSet:r?this.parseUShort():void 0}})))};var z={getByte:I,getCard8:I,getUShort:D,getCard16:D,getShort:function(t,e){return t.getInt16(e,!1)},getULong:N,getFixed:j,getTag:function(t,e){let n="";for(let r=e;r<e+4;r+=1)n+=String.fromCharCode(t.getInt8(r));return n},getOffset:function(t,e,n){let r=0;for(let i=0;i<n;i+=1)r<<=8,r+=t.getUint8(e+i);return r},getBytes:function(t,e,n){const r=[];for(let i=e;i<n;i+=1)r.push(t.getUint8(i));return r},bytesToString:function(t){let e="";for(let n=0;n<t.length;n+=1)e+=String.fromCharCode(t[n]);return e},Parser:F};var G={parse:function(t,e){const n={};n.version=z.getUShort(t,e),p.argument(0===n.version,"cmap table version should be 0."),n.numTables=z.getUShort(t,e+2);let r=-1;for(let i=n.numTables-1;i>=0;i-=1){const n=z.getUShort(t,e+4+8*i),o=z.getUShort(t,e+4+8*i+2);if(3===n&&(0===o||1===o||10===o)){r=z.getULong(t,e+4+8*i+4);break}}if(-1===r)throw new Error("No valid cmap sub-tables found.");const i=new z.Parser(t,e+r);if(n.format=i.parseUShort(),12===n.format)!function(t,e){let n;e.parseUShort(),t.length=e.parseULong(),t.language=e.parseULong(),t.groupCount=n=e.parseULong(),t.glyphIndexMap={};for(let r=0;r<n;r+=1){const n=e.parseULong(),r=e.parseULong();let i=e.parseULong();for(let e=n;e<=r;e+=1)t.glyphIndexMap[e]=i,i++}}(n,i);else{if(4!==n.format)throw new Error("Only format 4 and 12 cmap tables are supported (found format "+n.format+").");!function(t,e,n,r,i){let o;t.length=e.parseUShort(),t.language=e.parseUShort(),t.segCount=o=e.parseUShort()>>1,e.skip("uShort",3),t.glyphIndexMap={};const a=new z.Parser(n,r+i+14),s=new z.Parser(n,r+i+16+2*o),u=new z.Parser(n,r+i+16+4*o),l=new z.Parser(n,r+i+16+6*o);let c=r+i+16+8*o;for(let e=0;e<o-1;e+=1){let e;const r=a.parseUShort(),i=s.parseUShort(),o=u.parseShort(),h=l.parseUShort();for(let a=i;a<=r;a+=1)0!==h?(c=l.offset+l.relativeOffset-2,c+=h,c+=2*(a-i),0!==(e=z.getUShort(n,c))&&(e=e+o&65535)):e=a+o&65535,t.glyphIndexMap[a]=e}}(n,i,t,e,r)}return n},make:function(t){const e=new L.Table("cmap",[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:1},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:12},{name:"format",type:"USHORT",value:4},{name:"length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);e.segments=[];for(let o=0;o<t.length;o+=1){const a=t.get(o);for(let t=0;t<a.unicodes.length;t+=1)n=e,r=a.unicodes[t],i=o,n.segments.push({end:r,start:r,delta:-(r-i),offset:0});e.segments=e.segments.sort(function(t,e){return t.start-e.start})}var n,r,i;let o;e.segments.push({end:65535,start:65535,delta:1,offset:0}),o=e.segments.length,e.segCountX2=2*o,e.searchRange=2*Math.pow(2,Math.floor(Math.log(o)/Math.log(2))),e.entrySelector=Math.log(e.searchRange/2)/Math.log(2),e.rangeShift=e.segCountX2-e.searchRange;let a=[],s=[],u=[],l=[],c=[];for(let t=0;t<o;t+=1){const n=e.segments[t];a=a.concat({name:"end_"+t,type:"USHORT",value:n.end}),s=s.concat({name:"start_"+t,type:"USHORT",value:n.start}),u=u.concat({name:"idDelta_"+t,type:"SHORT",value:n.delta}),l=l.concat({name:"idRangeOffset_"+t,type:"USHORT",value:n.offset}),void 0!==n.glyphId&&(c=c.concat({name:"glyph_"+t,type:"USHORT",value:n.glyphId}))}return e.fields=e.fields.concat(a),e.fields.push({name:"reservedPad",type:"USHORT",value:0}),e.fields=e.fields.concat(s),e.fields=e.fields.concat(u),e.fields=e.fields.concat(l),e.fields=e.fields.concat(c),e.length=14+2*a.length+2+2*s.length+2*u.length+2*l.length+2*c.length,e}};const H=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],V=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],W=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],q=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function X(t){this.font=t}function Y(t){this.cmap=t}function $(t,e){this.encoding=t,this.charset=e}function Z(t){switch(t.version){case 1:this.names=q.slice();break;case 2:this.names=new Array(t.numberOfGlyphs);for(let e=0;e<t.numberOfGlyphs;e++)t.glyphNameIndex[e]<q.length?this.names[e]=q[t.glyphNameIndex[e]]:this.names[e]=t.names[t.glyphNameIndex[e]-q.length];break;case 2.5:this.names=new Array(t.numberOfGlyphs);for(let e=0;e<t.numberOfGlyphs;e++)this.names[e]=q[e+t.glyphNameIndex[e]];break;case 3:default:this.names=[]}}X.prototype.charToGlyphIndex=function(t){const e=t.charCodeAt(0),n=this.font.glyphs;if(n)for(let t=0;t<n.length;t+=1){const r=n.get(t);for(let n=0;n<r.unicodes.length;n+=1)if(r.unicodes[n]===e)return t}return null},Y.prototype.charToGlyphIndex=function(t){return this.cmap.glyphIndexMap[t.charCodeAt(0)]||0},$.prototype.charToGlyphIndex=function(t){const e=t.charCodeAt(0),n=this.encoding[e];return this.charset.indexOf(n)},Z.prototype.nameToGlyphIndex=function(t){return this.names.indexOf(t)},Z.prototype.glyphIndexToName=function(t){return this.names[t]};var J={line:function(t,e,n,r,i){t.beginPath(),t.moveTo(e,n),t.lineTo(r,i),t.stroke()}};function K(t,e,n,r,i){let o;return(e&r)>0?(o=t.parseByte(),0==(e&i)&&(o=-o),o=n+o):o=(e&i)>0?n:n+t.parseShort(),o}function Q(t,e,n){const r=new z.Parser(e,n);let i,o;if(t.numberOfContours=r.parseShort(),t._xMin=r.parseShort(),t._yMin=r.parseShort(),t._xMax=r.parseShort(),t._yMax=r.parseShort(),t.numberOfContours>0){const e=t.endPointIndices=[];for(let n=0;n<t.numberOfContours;n+=1)e.push(r.parseUShort());t.instructionLength=r.parseUShort(),t.instructions=[];for(let e=0;e<t.instructionLength;e+=1)t.instructions.push(r.parseByte());const n=e[e.length-1]+1;i=[];for(let t=0;t<n;t+=1)if(o=r.parseByte(),i.push(o),(8&o)>0){const e=r.parseByte();for(let n=0;n<e;n+=1)i.push(o),t+=1}if(p.argument(i.length===n,"Bad flags."),e.length>0){const a=[];let s;if(n>0){for(let t=0;t<n;t+=1)o=i[t],(s={}).onCurve=!!(1&o),s.lastPointOfContour=e.indexOf(t)>=0,a.push(s);let t=0;for(let e=0;e<n;e+=1)o=i[e],(s=a[e]).x=K(r,o,t,2,16),t=s.x;let u=0;for(let t=0;t<n;t+=1)o=i[t],(s=a[t]).y=K(r,o,u,4,32),u=s.y}t.points=a}else t.points=[]}else if(0===t.numberOfContours)t.points=[];else{t.isComposite=!0,t.points=[],t.components=[];let e=!0;for(;e;){i=r.parseUShort();const n={glyphIndex:r.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(1&i)>0?(2&i)>0?(n.dx=r.parseShort(),n.dy=r.parseShort()):n.matchedPoints=[r.parseUShort(),r.parseUShort()]:(2&i)>0?(n.dx=r.parseChar(),n.dy=r.parseChar()):n.matchedPoints=[r.parseByte(),r.parseByte()],(8&i)>0?n.xScale=n.yScale=r.parseF2Dot14():(64&i)>0?(n.xScale=r.parseF2Dot14(),n.yScale=r.parseF2Dot14()):(128&i)>0&&(n.xScale=r.parseF2Dot14(),n.scale01=r.parseF2Dot14(),n.scale10=r.parseF2Dot14(),n.yScale=r.parseF2Dot14()),t.components.push(n),e=!!(32&i)}if(256&i){t.instructionLength=r.parseUShort(),t.instructions=[];for(let e=0;e<t.instructionLength;e+=1)t.instructions.push(r.parseByte())}}}function tt(t,e){const n=[];for(let r=0;r<t.length;r+=1){const i=t[r],o={x:e.xScale*i.x+e.scale01*i.y+e.dx,y:e.scale10*i.x+e.yScale*i.y+e.dy,onCurve:i.onCurve,lastPointOfContour:i.lastPointOfContour};n.push(o)}return n}function et(t){const e=new l;if(!t)return e;const n=function(t){const e=[];let n=[];for(let r=0;r<t.length;r+=1){const i=t[r];n.push(i),i.lastPointOfContour&&(e.push(n),n=[])}return p.argument(0===n.length,"There are still points left in the current contour."),e}(t);for(let t=0;t<n.length;++t){const r=n[t];let i=null,o=r[r.length-1],a=r[0];if(o.onCurve)e.moveTo(o.x,o.y);else if(a.onCurve)e.moveTo(a.x,a.y);else{const t={x:.5*(o.x+a.x),y:.5*(o.y+a.y)};e.moveTo(t.x,t.y)}for(let t=0;t<r.length;++t)if(i=o,o=a,a=r[(t+1)%r.length],o.onCurve)e.lineTo(o.x,o.y);else{let t=i,n=a;i.onCurve||(t={x:.5*(o.x+i.x),y:.5*(o.y+i.y)},e.lineTo(t.x,t.y)),a.onCurve||(n={x:.5*(o.x+a.x),y:.5*(o.y+a.y)}),e.lineTo(t.x,t.y),e.quadraticCurveTo(o.x,o.y,n.x,n.y)}e.closePath()}return e}function nt(t,e){if(e.isComposite)for(let n=0;n<e.components.length;n+=1){const r=e.components[n],i=t.get(r.glyphIndex);if(i.getPath(),i.points){let t;if(void 0===r.matchedPoints)t=tt(i.points,r);else{if(r.matchedPoints[0]>e.points.length-1||r.matchedPoints[1]>i.points.length-1)throw Error("Matched points out of range in "+e.name);const n=e.points[r.matchedPoints[0]];let o=i.points[r.matchedPoints[1]];const a={xScale:r.xScale,scale01:r.scale01,scale10:r.scale10,yScale:r.yScale,dx:0,dy:0};o=tt([o],a)[0],a.dx=n.x-o.x,a.dy=n.y-o.y,t=tt(i.points,a)}e.points=e.points.concat(t)}}return et(e.points)}var rt={getPath:et,parse:function(t,e,n,r){const i=new ut.GlyphSet(r);for(let o=0;o<n.length-1;o+=1){const a=n[o];a!==n[o+1]?i.push(o,ut.ttfGlyphLoader(r,o,Q,t,e+a,nt)):i.push(o,ut.glyphLoader(r,o))}return i}};function it(t){this.bindConstructorValues(t)}it.prototype.bindConstructorValues=function(t){this.index=t.index||0,this.name=t.name||null,this.unicode=t.unicode||void 0,this.unicodes=t.unicodes||void 0!==t.unicode?[t.unicode]:[],t.xMin&&(this.xMin=t.xMin),t.yMin&&(this.yMin=t.yMin),t.xMax&&(this.xMax=t.xMax),t.yMax&&(this.yMax=t.yMax),t.advanceWidth&&(this.advanceWidth=t.advanceWidth),Object.defineProperty(this,"path",function(t,e){let n=e||{commands:[]};return{configurable:!0,get:function(){return"function"==typeof n&&(n=n()),n},set:function(t){n=t}}}(0,t.path))},it.prototype.addUnicode=function(t){0===this.unicodes.length&&(this.unicode=t),this.unicodes.push(t)},it.prototype.getBoundingBox=function(){return this.path.getBoundingBox()},it.prototype.getPath=function(t,e,n,r,i){let o,a;t=void 0!==t?t:0,e=void 0!==e?e:0,n=void 0!==n?n:72,r||(r={});let s=r.xScale,u=r.yScale;if(r.hinting&&i&&i.hinting&&(a=this.path&&i.hinting.exec(this,n)),a)o=rt.getPath(a).commands,t=Math.round(t),e=Math.round(e),s=u=1;else{o=this.path.commands;const t=1/this.path.unitsPerEm*n;void 0===s&&(s=t),void 0===u&&(u=t)}const c=new l;for(let n=0;n<o.length;n+=1){const r=o[n];"M"===r.type?c.moveTo(t+r.x*s,e+-r.y*u):"L"===r.type?c.lineTo(t+r.x*s,e+-r.y*u):"Q"===r.type?c.quadraticCurveTo(t+r.x1*s,e+-r.y1*u,t+r.x*s,e+-r.y*u):"C"===r.type?c.curveTo(t+r.x1*s,e+-r.y1*u,t+r.x2*s,e+-r.y2*u,t+r.x*s,e+-r.y*u):"Z"===r.type&&c.closePath()}return c},it.prototype.getContours=function(){if(void 0===this.points)return[];const t=[];let e=[];for(let n=0;n<this.points.length;n+=1){const r=this.points[n];e.push(r),r.lastPointOfContour&&(t.push(e),e=[])}return p.argument(0===e.length,"There are still points left in the current contour."),t},it.prototype.getMetrics=function(){const t=this.path.commands,e=[],n=[];for(let r=0;r<t.length;r+=1){const i=t[r];"Z"!==i.type&&(e.push(i.x),n.push(i.y)),"Q"!==i.type&&"C"!==i.type||(e.push(i.x1),n.push(i.y1)),"C"===i.type&&(e.push(i.x2),n.push(i.y2))}const r={xMin:Math.min.apply(null,e),yMin:Math.min.apply(null,n),xMax:Math.max.apply(null,e),yMax:Math.max.apply(null,n),leftSideBearing:this.leftSideBearing};return isFinite(r.xMin)||(r.xMin=0),isFinite(r.xMax)||(r.xMax=this.advanceWidth),isFinite(r.yMin)||(r.yMin=0),isFinite(r.yMax)||(r.yMax=0),r.rightSideBearing=this.advanceWidth-r.leftSideBearing-(r.xMax-r.xMin),r},it.prototype.draw=function(t,e,n,r,i){this.getPath(e,n,r,i).draw(t)},it.prototype.drawPoints=function(t,e,n,r){function i(e,n,r,i){const o=2*Math.PI;t.beginPath();for(let a=0;a<e.length;a+=1)t.moveTo(n+e[a].x*i,r+e[a].y*i),t.arc(n+e[a].x*i,r+e[a].y*i,2,0,o,!1);t.closePath(),t.fill()}e=void 0!==e?e:0,n=void 0!==n?n:0,r=void 0!==r?r:24;const o=1/this.path.unitsPerEm*r,a=[],s=[],u=this.path;for(let t=0;t<u.commands.length;t+=1){const e=u.commands[t];void 0!==e.x&&a.push({x:e.x,y:-e.y}),void 0!==e.x1&&s.push({x:e.x1,y:-e.y1}),void 0!==e.x2&&s.push({x:e.x2,y:-e.y2})}t.fillStyle="blue",i(a,e,n,o),t.fillStyle="red",i(s,e,n,o)},it.prototype.drawMetrics=function(t,e,n,r){let i;e=void 0!==e?e:0,n=void 0!==n?n:0,r=void 0!==r?r:24,i=1/this.path.unitsPerEm*r,t.lineWidth=1,t.strokeStyle="black",J.line(t,e,-1e4,e,1e4),J.line(t,-1e4,n,1e4,n);const o=this.xMin||0;let a=this.yMin||0;const s=this.xMax||0;let u=this.yMax||0;const l=this.advanceWidth||0;t.strokeStyle="blue",J.line(t,e+o*i,-1e4,e+o*i,1e4),J.line(t,e+s*i,-1e4,e+s*i,1e4),J.line(t,-1e4,n+-a*i,1e4,n+-a*i),J.line(t,-1e4,n+-u*i,1e4,n+-u*i),t.strokeStyle="green",J.line(t,e+l*i,-1e4,e+l*i,1e4)};var ot=it;function at(t,e,n){Object.defineProperty(t,e,{get:function(){return t.path,t[n]},set:function(e){t[n]=e},enumerable:!0,configurable:!0})}function st(t,e){if(this.font=t,this.glyphs={},Array.isArray(e))for(let t=0;t<e.length;t++)this.glyphs[t]=e[t];this.length=e&&e.length||0}st.prototype.get=function(t){return"function"==typeof this.glyphs[t]&&(this.glyphs[t]=this.glyphs[t]()),this.glyphs[t]},st.prototype.push=function(t,e){this.glyphs[t]=e,this.length++};var ut={GlyphSet:st,glyphLoader:function(t,e){return new ot({index:e,font:t})},ttfGlyphLoader:function(t,e,n,r,i,o){return function(){const a=new ot({index:e,font:t});return a.path=function(){n(a,r,i);const e=o(t.glyphs,a);return e.unitsPerEm=t.unitsPerEm,e},at(a,"xMin","_xMin"),at(a,"xMax","_xMax"),at(a,"yMin","_yMin"),at(a,"yMax","_yMax"),a}},cffGlyphLoader:function(t,e,n,r){return function(){const i=new ot({index:e,font:t});return i.path=function(){const e=n(t,i,r);return e.unitsPerEm=t.unitsPerEm,e},i}}};function lt(t,e){if(t===e)return!0;if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n+=1)if(!lt(t[n],e[n]))return!1;return!0}return!1}function ct(t){let e;return e=t.length<1240?107:t.length<33900?1131:32768}function ht(t,e,n){const r=[],i=[],o=z.getCard16(t,e);let a,s;if(0!==o){const n=z.getByte(t,e+2);a=e+(o+1)*n+2;let i=e+3;for(let e=0;e<o+1;e+=1)r.push(z.getOffset(t,i,n)),i+=n;s=a+r[o]}else s=e+2;for(let e=0;e<r.length-1;e+=1){let o=z.getBytes(t,a+r[e],a+r[e+1]);n&&(o=n(o)),i.push(o)}return{objects:i,startOffset:e,endOffset:s}}function pt(t,e){let n,r,i,o;if(28===e)return(n=t.parseByte())<<8|(r=t.parseByte());if(29===e)return(n=t.parseByte())<<24|(r=t.parseByte())<<16|(i=t.parseByte())<<8|(o=t.parseByte());if(30===e)return function(t){let e="";const n=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];for(;;){const r=t.parseByte(),i=r>>4,o=15&r;if(15===i)break;if(e+=n[i],15===o)break;e+=n[o]}return parseFloat(e)}(t);if(e>=32&&e<=246)return e-139;if(e>=247&&e<=250)return 256*(e-247)+(n=t.parseByte())+108;if(e>=251&&e<=254)return 256*-(e-251)-(n=t.parseByte())-108;throw new Error("Invalid b0 "+e)}function ft(t,e,n){e=void 0!==e?e:0;const r=new z.Parser(t,e),i=[];let o=[];for(n=void 0!==n?n:t.length;r.relativeOffset<n;){let t=r.parseByte();t<=21?(12===t&&(t=1200+r.parseByte()),i.push([t,o]),o=[]):o.push(pt(r,t))}return function(t){const e={};for(let n=0;n<t.length;n+=1){const r=t[n][0],i=t[n][1];let o;if(o=1===i.length?i[0]:i,e.hasOwnProperty(r)&&!isNaN(e[r]))throw new Error("Object "+e+" already has key "+r);e[r]=o}return e}(i)}function dt(t,e){return e=e<=390?H[e]:t[e-391]}function mt(t,e,n){const r={};let i;for(let o=0;o<e.length;o+=1){const a=e[o];if(Array.isArray(a.type)){const e=[];e.length=a.type.length;for(let r=0;r<a.type.length;r++)void 0===(i=void 0!==t[a.op]?t[a.op][r]:void 0)&&(i=void 0!==a.value&&void 0!==a.value[r]?a.value[r]:null),"SID"===a.type[r]&&(i=dt(n,i)),e[r]=i;r[a.name]=e}else void 0===(i=t[a.op])&&(i=void 0!==a.value?a.value:null),"SID"===a.type&&(i=dt(n,i)),r[a.name]=i}return r}const gt=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}],vt=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];function yt(t,e,n,r){return mt(ft(t,e,n),vt,r)}function bt(t,e,n,r){const i=[];for(let s=0;s<n.length;s+=1){const u=new DataView(new Uint8Array(n[s]).buffer),l=(a=r,mt(ft(o=u,0,o.byteLength),gt,a));l._subrs=[],l._subrsBias=0;const c=l.private[0],h=l.private[1];if(0!==c&&0!==h){const n=yt(t,h+e,c,r);if(l._defaultWidthX=n.defaultWidthX,l._nominalWidthX=n.nominalWidthX,0!==n.subrs){const r=ht(t,h+n.subrs+e);l._subrs=r.objects,l._subrsBias=ct(l._subrs)}l._privateDict=n}i.push(l)}var o,a;return i}function _t(t,e,n){let r,i,o,a;const s=new l,u=[];let c,h,p,f,d=0,m=!1,g=!1,v=0,y=0;if(t.isCIDFont){const n=t.tables.cff.topDict._fdSelect[e.index],r=t.tables.cff.topDict._fdArray[n];c=r._subrs,h=r._subrsBias,p=r._defaultWidthX,f=r._nominalWidthX}else c=t.tables.cff.topDict._subrs,h=t.tables.cff.topDict._subrsBias,p=t.tables.cff.topDict._defaultWidthX,f=t.tables.cff.topDict._nominalWidthX;let b=p;function _(t,e){g&&s.closePath(),s.moveTo(t,e),g=!0}function x(){let t;(t=u.length%2!=0)&&!m&&(b=u.shift()+f),d+=u.length>>1,u.length=0,m=!0}return function n(l){let p,w,E,S,T,O,A,M,C,k,P,R,L=0;for(;L<l.length;){let I=l[L];switch(L+=1,I){case 1:case 3:x();break;case 4:u.length>1&&!m&&(b=u.shift()+f,m=!0),y+=u.pop(),_(v,y);break;case 5:for(;u.length>0;)v+=u.shift(),y+=u.shift(),s.lineTo(v,y);break;case 6:for(;u.length>0&&(v+=u.shift(),s.lineTo(v,y),0!==u.length);)y+=u.shift(),s.lineTo(v,y);break;case 7:for(;u.length>0&&(y+=u.shift(),s.lineTo(v,y),0!==u.length);)v+=u.shift(),s.lineTo(v,y);break;case 8:for(;u.length>0;)r=v+u.shift(),i=y+u.shift(),o=r+u.shift(),a=i+u.shift(),v=o+u.shift(),y=a+u.shift(),s.curveTo(r,i,o,a,v,y);break;case 10:T=u.pop()+h,(O=c[T])&&n(O);break;case 11:return;case 12:switch(I=l[L],L+=1,I){case 35:r=v+u.shift(),i=y+u.shift(),o=r+u.shift(),a=i+u.shift(),A=o+u.shift(),M=a+u.shift(),C=A+u.shift(),k=M+u.shift(),P=C+u.shift(),R=k+u.shift(),v=P+u.shift(),y=R+u.shift(),u.shift(),s.curveTo(r,i,o,a,A,M),s.curveTo(C,k,P,R,v,y);break;case 34:r=v+u.shift(),i=y,o=r+u.shift(),a=i+u.shift(),A=o+u.shift(),M=a,C=A+u.shift(),k=a,P=C+u.shift(),R=y,v=P+u.shift(),s.curveTo(r,i,o,a,A,M),s.curveTo(C,k,P,R,v,y);break;case 36:r=v+u.shift(),i=y+u.shift(),o=r+u.shift(),a=i+u.shift(),A=o+u.shift(),M=a,C=A+u.shift(),k=a,P=C+u.shift(),R=k+u.shift(),v=P+u.shift(),s.curveTo(r,i,o,a,A,M),s.curveTo(C,k,P,R,v,y);break;case 37:r=v+u.shift(),i=y+u.shift(),o=r+u.shift(),a=i+u.shift(),A=o+u.shift(),M=a+u.shift(),C=A+u.shift(),k=M+u.shift(),P=C+u.shift(),R=k+u.shift(),Math.abs(P-v)>Math.abs(R-y)?v=P+u.shift():y=R+u.shift(),s.curveTo(r,i,o,a,A,M),s.curveTo(C,k,P,R,v,y);break;default:console.log("Glyph "+e.index+": unknown operator 1200"+I),u.length=0}break;case 14:u.length>0&&!m&&(b=u.shift()+f,m=!0),g&&(s.closePath(),g=!1);break;case 18:x();break;case 19:case 20:x(),L+=d+7>>3;break;case 21:u.length>2&&!m&&(b=u.shift()+f,m=!0),y+=u.pop(),_(v+=u.pop(),y);break;case 22:u.length>1&&!m&&(b=u.shift()+f,m=!0),_(v+=u.pop(),y);break;case 23:x();break;case 24:for(;u.length>2;)r=v+u.shift(),i=y+u.shift(),o=r+u.shift(),a=i+u.shift(),v=o+u.shift(),y=a+u.shift(),s.curveTo(r,i,o,a,v,y);v+=u.shift(),y+=u.shift(),s.lineTo(v,y);break;case 25:for(;u.length>6;)v+=u.shift(),y+=u.shift(),s.lineTo(v,y);r=v+u.shift(),i=y+u.shift(),o=r+u.shift(),a=i+u.shift(),v=o+u.shift(),y=a+u.shift(),s.curveTo(r,i,o,a,v,y);break;case 26:for(u.length%2&&(v+=u.shift());u.length>0;)r=v,i=y+u.shift(),o=r+u.shift(),a=i+u.shift(),v=o,y=a+u.shift(),s.curveTo(r,i,o,a,v,y);break;case 27:for(u.length%2&&(y+=u.shift());u.length>0;)r=v+u.shift(),i=y,o=r+u.shift(),a=i+u.shift(),v=o+u.shift(),y=a,s.curveTo(r,i,o,a,v,y);break;case 28:p=l[L],w=l[L+1],u.push((p<<24|w<<16)>>16),L+=2;break;case 29:T=u.pop()+t.gsubrsBias,(O=t.gsubrs[T])&&n(O);break;case 30:for(;u.length>0&&(r=v,i=y+u.shift(),o=r+u.shift(),a=i+u.shift(),v=o+u.shift(),y=a+(1===u.length?u.shift():0),s.curveTo(r,i,o,a,v,y),0!==u.length);)r=v+u.shift(),i=y,o=r+u.shift(),a=i+u.shift(),y=a+u.shift(),v=o+(1===u.length?u.shift():0),s.curveTo(r,i,o,a,v,y);break;case 31:for(;u.length>0&&(r=v+u.shift(),i=y,o=r+u.shift(),a=i+u.shift(),y=a+u.shift(),v=o+(1===u.length?u.shift():0),s.curveTo(r,i,o,a,v,y),0!==u.length);)r=v,i=y+u.shift(),o=r+u.shift(),a=i+u.shift(),v=o+u.shift(),y=a+(1===u.length?u.shift():0),s.curveTo(r,i,o,a,v,y);break;default:I<32?console.log("Glyph "+e.index+": unknown operator "+I):I<247?u.push(I-139):I<251?(p=l[L],L+=1,u.push(256*(I-247)+p+108)):I<255?(p=l[L],L+=1,u.push(256*-(I-251)-p-108)):(p=l[L],w=l[L+1],E=l[L+2],S=l[L+3],L+=4,u.push((p<<24|w<<16|E<<8|S)/65536))}}}(n),e.advanceWidth=b,s}function xt(t,e){let n,r=H.indexOf(t);return r>=0&&(n=r),(r=e.indexOf(t))>=0?n=r+H.length:(n=H.length+e.length,e.push(t)),n}function wt(t,e,n){const r={};for(let i=0;i<t.length;i+=1){const o=t[i];let a=e[o.name];void 0===a||lt(a,o.value)||("SID"===o.type&&(a=xt(a,n)),r[o.op]={name:o.name,type:o.type,value:a})}return r}function Et(t,e){const n=new L.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return n.dict=wt(gt,t,e),n}function St(t){const e=new L.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return e.topDicts=[{name:"topDict_0",type:"TABLE",value:t}],e}function Tt(t){const e=[],n=t.path;e.push({name:"width",type:"NUMBER",value:t.advanceWidth});let r=0,i=0;for(let t=0;t<n.commands.length;t+=1){let o,a,s=n.commands[t];if("Q"===s.type){s={type:"C",x:s.x,y:s.y,x1:1/3*r+2/3*s.x1,y1:1/3*i+2/3*s.y1,x2:1/3*s.x+2/3*s.x1,y2:1/3*s.y+2/3*s.y1}}if("M"===s.type)o=Math.round(s.x-r),a=Math.round(s.y-i),e.push({name:"dx",type:"NUMBER",value:o}),e.push({name:"dy",type:"NUMBER",value:a}),e.push({name:"rmoveto",type:"OP",value:21}),r=Math.round(s.x),i=Math.round(s.y);else if("L"===s.type)o=Math.round(s.x-r),a=Math.round(s.y-i),e.push({name:"dx",type:"NUMBER",value:o}),e.push({name:"dy",type:"NUMBER",value:a}),e.push({name:"rlineto",type:"OP",value:5}),r=Math.round(s.x),i=Math.round(s.y);else if("C"===s.type){const t=Math.round(s.x1-r),n=Math.round(s.y1-i),u=Math.round(s.x2-s.x1),l=Math.round(s.y2-s.y1);o=Math.round(s.x-s.x2),a=Math.round(s.y-s.y2),e.push({name:"dx1",type:"NUMBER",value:t}),e.push({name:"dy1",type:"NUMBER",value:n}),e.push({name:"dx2",type:"NUMBER",value:u}),e.push({name:"dy2",type:"NUMBER",value:l}),e.push({name:"dx",type:"NUMBER",value:o}),e.push({name:"dy",type:"NUMBER",value:a}),e.push({name:"rrcurveto",type:"OP",value:8}),r=Math.round(s.x),i=Math.round(s.y)}}return e.push({name:"endchar",type:"OP",value:14}),e}var Ot={parse:function(t,e,n){n.tables.cff={};const r=ht(t,ht(t,function(t,e){const n={};return n.formatMajor=z.getCard8(t,e),n.formatMinor=z.getCard8(t,e+1),n.size=z.getCard8(t,e+2),n.offsetSize=z.getCard8(t,e+3),n.startOffset=e,n.endOffset=e+4,n}(t,e).endOffset,z.bytesToString).endOffset),i=ht(t,r.endOffset,z.bytesToString),o=ht(t,i.endOffset);n.gsubrs=o.objects,n.gsubrsBias=ct(n.gsubrs);const a=bt(t,e,r.objects,i.objects);if(1!==a.length)throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+a.length);const s=a[0];if(n.tables.cff.topDict=s,s._privateDict&&(n.defaultWidthX=s._privateDict.defaultWidthX,n.nominalWidthX=s._privateDict.nominalWidthX),void 0!==s.ros[0]&&void 0!==s.ros[1]&&(n.isCIDFont=!0),n.isCIDFont){let r=s.fdArray,o=s.fdSelect;if(0===r||0===o)throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing");const a=bt(t,e,ht(t,r+=e).objects,i.objects);s._fdArray=a,o+=e,s._fdSelect=function(t,e,n,r){const i=[];let o;const a=new z.Parser(t,e),s=a.parseCard8();if(0===s)for(let t=0;t<n;t++){if((o=a.parseCard8())>=r)throw new Error("CFF table CID Font FDSelect has bad FD index value "+o+" (FD count "+r+")");i.push(o)}else{if(3!==s)throw new Error("CFF Table CID Font FDSelect table has unsupported format "+s);{const t=a.parseCard16();let e,s=a.parseCard16();if(0!==s)throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+s);for(let u=0;u<t;u++){if(o=a.parseCard8(),e=a.parseCard16(),o>=r)throw new Error("CFF table CID Font FDSelect has bad FD index value "+o+" (FD count "+r+")");if(e>n)throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+e);for(;s<e;s++)i.push(o);s=e}if(e!==n)throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+e)}}return i}(t,o,n.numGlyphs,a.length)}const u=e+s.private[1],l=yt(t,u,s.private[0],i.objects);if(n.defaultWidthX=l.defaultWidthX,n.nominalWidthX=l.nominalWidthX,0!==l.subrs){const e=ht(t,u+l.subrs);n.subrs=e.objects,n.subrsBias=ct(n.subrs)}else n.subrs=[],n.subrsBias=0;const c=ht(t,e+s.charStrings);n.nGlyphs=c.objects.length;const h=function(t,e,n,r){let i,o;const a=new z.Parser(t,e);n-=1;const s=[".notdef"],u=a.parseCard8();if(0===u)for(let t=0;t<n;t+=1)i=a.parseSID(),s.push(dt(r,i));else if(1===u)for(;s.length<=n;){i=a.parseSID(),o=a.parseCard8();for(let t=0;t<=o;t+=1)s.push(dt(r,i)),i+=1}else{if(2!==u)throw new Error("Unknown charset format "+u);for(;s.length<=n;){i=a.parseSID(),o=a.parseCard16();for(let t=0;t<=o;t+=1)s.push(dt(r,i)),i+=1}}return s}(t,e+s.charset,n.nGlyphs,i.objects);0===s.encoding?n.cffEncoding=new $(V,h):1===s.encoding?n.cffEncoding=new $(W,h):n.cffEncoding=function(t,e,n){let r;const i={},o=new z.Parser(t,e),a=o.parseCard8();if(0===a){const t=o.parseCard8();for(let e=0;e<t;e+=1)i[r=o.parseCard8()]=e}else{if(1!==a)throw new Error("Unknown encoding format "+a);{const t=o.parseCard8();r=1;for(let e=0;e<t;e+=1){const t=o.parseCard8(),e=o.parseCard8();for(let n=t;n<=t+e;n+=1)i[n]=r,r+=1}}}return new $(i,n)}(t,e+s.encoding,h),n.encoding=n.encoding||n.cffEncoding,n.glyphs=new ut.GlyphSet(n);for(let t=0;t<n.nGlyphs;t+=1){const e=c.objects[t];n.glyphs.push(t,ut.cffGlyphLoader(n,t,_t,e))}},make:function(t,e){const n=new L.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),r=1/e.unitsPerEm,i={version:e.version,fullName:e.fullName,familyName:e.familyName,weight:e.weightName,fontBBox:e.fontBBox||[0,0,0,0],fontMatrix:[r,0,0,r,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},o=[];let a;for(let e=1;e<t.length;e+=1)a=t.get(e),o.push(a.name);const s=[];n.header=new L.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}]),n.nameIndex=function(t){const e=new L.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);e.names=[];for(let n=0;n<t.length;n+=1)e.names.push({name:"name_"+n,type:"NAME",value:t[n]});return e}([e.postScriptName]);let u=Et(i,s);n.topDictIndex=St(u),n.globalSubrIndex=new L.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}]),n.charsets=function(t,e){const n=new L.Record("Charsets",[{name:"format",type:"Card8",value:0}]);for(let r=0;r<t.length;r+=1){const i=xt(t[r],e);n.fields.push({name:"glyph_"+r,type:"SID",value:i})}return n}(o,s),n.charStringsIndex=function(t){const e=new L.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]);for(let n=0;n<t.length;n+=1){const r=t.get(n),i=Tt(r);e.charStrings.push({name:r.name,type:"CHARSTRING",value:i})}return e}(t),n.privateDict=function(t,e){const n=new L.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return n.dict=wt(vt,t,e),n}({},s),n.stringIndex=function(t){const e=new L.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);e.strings=[];for(let n=0;n<t.length;n+=1)e.strings.push({name:"string_"+n,type:"STRING",value:t[n]});return e}(s);const l=n.header.sizeOf()+n.nameIndex.sizeOf()+n.topDictIndex.sizeOf()+n.stringIndex.sizeOf()+n.globalSubrIndex.sizeOf();return i.charset=l,i.encoding=0,i.charStrings=i.charset+n.charsets.sizeOf(),i.private[1]=i.charStrings+n.charStringsIndex.sizeOf(),u=Et(i,s),n.topDictIndex=St(u),n}};var At={parse:function(t,e){const n={},r=new z.Parser(t,e);return n.version=r.parseVersion(),n.fontRevision=Math.round(1e3*r.parseFixed())/1e3,n.checkSumAdjustment=r.parseULong(),n.magicNumber=r.parseULong(),p.argument(1594834165===n.magicNumber,"Font header has wrong magic number."),n.flags=r.parseUShort(),n.unitsPerEm=r.parseUShort(),n.created=r.parseLongDateTime(),n.modified=r.parseLongDateTime(),n.xMin=r.parseShort(),n.yMin=r.parseShort(),n.xMax=r.parseShort(),n.yMax=r.parseShort(),n.macStyle=r.parseUShort(),n.lowestRecPPEM=r.parseUShort(),n.fontDirectionHint=r.parseShort(),n.indexToLocFormat=r.parseShort(),n.glyphDataFormat=r.parseShort(),n},make:function(t){const e=Math.round((new Date).getTime()/1e3)+2082844800;let n=e;return t.createdTimestamp&&(n=t.createdTimestamp+2082844800),new L.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:n},{name:"modified",type:"LONGDATETIME",value:e},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],t)}};var Mt={parse:function(t,e){const n={},r=new z.Parser(t,e);return n.version=r.parseVersion(),n.ascender=r.parseShort(),n.descender=r.parseShort(),n.lineGap=r.parseShort(),n.advanceWidthMax=r.parseUShort(),n.minLeftSideBearing=r.parseShort(),n.minRightSideBearing=r.parseShort(),n.xMaxExtent=r.parseShort(),n.caretSlopeRise=r.parseShort(),n.caretSlopeRun=r.parseShort(),n.caretOffset=r.parseShort(),r.relativeOffset+=8,n.metricDataFormat=r.parseShort(),n.numberOfHMetrics=r.parseUShort(),n},make:function(t){return new L.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],t)}};var Ct={parse:function(t,e,n,r,i){let o,a;const s=new z.Parser(t,e);for(let t=0;t<r;t+=1){t<n&&(o=s.parseUShort(),a=s.parseShort());const e=i.get(t);e.advanceWidth=o,e.leftSideBearing=a}},make:function(t){const e=new L.Table("hmtx",[]);for(let n=0;n<t.length;n+=1){const r=t.get(n),i=r.advanceWidth||0,o=r.leftSideBearing||0;e.fields.push({name:"advanceWidth_"+n,type:"USHORT",value:i}),e.fields.push({name:"leftSideBearing_"+n,type:"SHORT",value:o})}return e}};var kt={make:function(t){const e=new L.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:t.length}]);let n="";const r=12+4*t.length;for(let i=0;i<t.length;++i){let o=n.indexOf(t[i]);o<0&&(o=n.length,n+=t[i]),e.fields.push({name:"offset "+i,type:"USHORT",value:r+o}),e.fields.push({name:"length "+i,type:"USHORT",value:t[i].length})}return e.fields.push({name:"stringPool",type:"CHARARRAY",value:n}),e},parse:function(t,e){const n=new z.Parser(t,e),r=n.parseULong();p.argument(1===r,"Unsupported ltag table version."),n.skip("uLong",1);const i=n.parseULong(),o=[];for(let r=0;r<i;r++){let r="";const i=e+n.parseUShort(),a=n.parseUShort();for(let e=i;e<i+a;++e)r+=String.fromCharCode(t.getInt8(e));o.push(r)}return o}};var Pt={parse:function(t,e){const n={},r=new z.Parser(t,e);return n.version=r.parseVersion(),n.numGlyphs=r.parseUShort(),1===n.version&&(n.maxPoints=r.parseUShort(),n.maxContours=r.parseUShort(),n.maxCompositePoints=r.parseUShort(),n.maxCompositeContours=r.parseUShort(),n.maxZones=r.parseUShort(),n.maxTwilightPoints=r.parseUShort(),n.maxStorage=r.parseUShort(),n.maxFunctionDefs=r.parseUShort(),n.maxInstructionDefs=r.parseUShort(),n.maxStackElements=r.parseUShort(),n.maxSizeOfInstructions=r.parseUShort(),n.maxComponentElements=r.parseUShort(),n.maxComponentDepth=r.parseUShort()),n},make:function(t){return new L.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:t}])}};const Rt=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],Lt={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},It={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},Dt={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"};function Nt(t,e,n){switch(t){case 0:if(65535===e)return"und";if(n)return n[e];break;case 1:return Lt[e];case 3:return Dt[e]}}const jt="utf-16",Ut={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},Ft={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function Bt(t,e,n){switch(t){case 0:return jt;case 1:return Ft[n]||Ut[e];case 3:if(1===e||10===e)return jt}}function zt(t){const e={};for(let n in t)e[t[n]]=parseInt(n);return e}function Gt(t,e,n,r,i,o){return new L.Record("NameRecord",[{name:"platformID",type:"USHORT",value:t},{name:"encodingID",type:"USHORT",value:e},{name:"languageID",type:"USHORT",value:n},{name:"nameID",type:"USHORT",value:r},{name:"length",type:"USHORT",value:i},{name:"offset",type:"USHORT",value:o}])}function Ht(t,e){let n=function(t,e){const n=t.length,r=e.length-n+1;t:for(let i=0;i<r;i++)for(;i<r;i++){for(let r=0;r<n;r++)if(e[i+r]!==t[r])continue t;return i}return-1}(t,e);if(n<0){n=e.length;let r=0;const i=t.length;for(;r<i;++r)e.push(t[r])}return n}var Vt={parse:function(t,e,n){const r={},i=new z.Parser(t,e),o=i.parseUShort(),a=i.parseUShort(),s=i.offset+i.parseUShort();for(let e=0;e<a;e++){const e=i.parseUShort(),o=i.parseUShort(),a=i.parseUShort(),u=i.parseUShort(),l=Rt[u]||u,c=i.parseUShort(),h=i.parseUShort(),p=Nt(e,a,n),d=Bt(e,o,a);let m;if(void 0!==d&&void 0!==p&&(m=d===jt?f.UTF16(t,s+h,c):f.MACSTRING(t,s+h,c,d))){let t=r[l];void 0===t&&(t=r[l]={}),t[p]=m}}let u=0;return 1===o&&(u=i.parseUShort()),r},make:function(t,e){let n;const r=[],i={},o=zt(Rt);for(let e in t){let a=o[e];if(void 0===a&&(a=e),n=parseInt(a),isNaN(n))throw new Error('Name table entry "'+e+'" does not exist, see nameTableNames for complete list.');i[n]=t[e],r.push(n)}const a=zt(Lt),s=zt(Dt),u=[],l=[];for(let t=0;t<r.length;t++){const o=i[n=r[t]];for(let t in o){const r=o[t];let i=1,c=a[t],h=It[c];const p=Bt(i,h,c);let f=d.MACSTRING(r,p);void 0===f&&(i=0,(c=e.indexOf(t))<0&&(c=e.length,e.push(t)),h=4,f=d.UTF16(r));const m=Ht(f,l);u.push(Gt(i,h,c,n,f.length,m));const g=s[t];if(void 0!==g){const t=d.UTF16(r),e=Ht(t,l);u.push(Gt(3,1,g,n,t.length,e))}}}u.sort(function(t,e){return t.platformID-e.platformID||t.encodingID-e.encodingID||t.languageID-e.languageID||t.nameID-e.nameID});const c=new L.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:u.length},{name:"stringOffset",type:"USHORT",value:6+12*u.length}]);for(let t=0;t<u.length;t++)c.fields.push({name:"record_"+t,type:"RECORD",value:u[t]});return c.fields.push({name:"strings",type:"LITERAL",value:l}),c}};const Wt=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];var qt={parse:function(t,e){const n={},r=new z.Parser(t,e);n.version=r.parseUShort(),n.xAvgCharWidth=r.parseShort(),n.usWeightClass=r.parseUShort(),n.usWidthClass=r.parseUShort(),n.fsType=r.parseUShort(),n.ySubscriptXSize=r.parseShort(),n.ySubscriptYSize=r.parseShort(),n.ySubscriptXOffset=r.parseShort(),n.ySubscriptYOffset=r.parseShort(),n.ySuperscriptXSize=r.parseShort(),n.ySuperscriptYSize=r.parseShort(),n.ySuperscriptXOffset=r.parseShort(),n.ySuperscriptYOffset=r.parseShort(),n.yStrikeoutSize=r.parseShort(),n.yStrikeoutPosition=r.parseShort(),n.sFamilyClass=r.parseShort(),n.panose=[];for(let t=0;t<10;t++)n.panose[t]=r.parseByte();return n.ulUnicodeRange1=r.parseULong(),n.ulUnicodeRange2=r.parseULong(),n.ulUnicodeRange3=r.parseULong(),n.ulUnicodeRange4=r.parseULong(),n.achVendID=String.fromCharCode(r.parseByte(),r.parseByte(),r.parseByte(),r.parseByte()),n.fsSelection=r.parseUShort(),n.usFirstCharIndex=r.parseUShort(),n.usLastCharIndex=r.parseUShort(),n.sTypoAscender=r.parseShort(),n.sTypoDescender=r.parseShort(),n.sTypoLineGap=r.parseShort(),n.usWinAscent=r.parseUShort(),n.usWinDescent=r.parseUShort(),n.version>=1&&(n.ulCodePageRange1=r.parseULong(),n.ulCodePageRange2=r.parseULong()),n.version>=2&&(n.sxHeight=r.parseShort(),n.sCapHeight=r.parseShort(),n.usDefaultChar=r.parseUShort(),n.usBreakChar=r.parseUShort(),n.usMaxContent=r.parseUShort()),n},make:function(t){return new L.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],t)},unicodeRanges:Wt,getUnicodeRange:function(t){for(let e=0;e<Wt.length;e+=1){const n=Wt[e];if(t>=n.begin&&t<n.end)return e}return-1}};var Xt={parse:function(t,e){const n={},r=new z.Parser(t,e);switch(n.version=r.parseVersion(),n.italicAngle=r.parseFixed(),n.underlinePosition=r.parseShort(),n.underlineThickness=r.parseShort(),n.isFixedPitch=r.parseULong(),n.minMemType42=r.parseULong(),n.maxMemType42=r.parseULong(),n.minMemType1=r.parseULong(),n.maxMemType1=r.parseULong(),n.version){case 1:n.names=q.slice();break;case 2:n.numberOfGlyphs=r.parseUShort(),n.glyphNameIndex=new Array(n.numberOfGlyphs);for(let t=0;t<n.numberOfGlyphs;t++)n.glyphNameIndex[t]=r.parseUShort();n.names=[];for(let t=0;t<n.numberOfGlyphs;t++)if(n.glyphNameIndex[t]>=q.length){const t=r.parseChar();n.names.push(r.parseString(t))}break;case 2.5:n.numberOfGlyphs=r.parseUShort(),n.offset=new Array(n.numberOfGlyphs);for(let t=0;t<n.numberOfGlyphs;t++)n.offset[t]=r.parseChar()}return n},make:function(){return new L.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}};const Yt=new Array(9);Yt[1]=function(){const t=this.offset+this.relativeOffset,e=this.parseUShort();return 1===e?{substFormat:1,coverage:this.parsePointer(F.coverage),deltaGlyphId:this.parseUShort()}:2===e?{substFormat:2,coverage:this.parsePointer(F.coverage),substitute:this.parseOffset16List()}:void p.assert(!1,"0x"+t.toString(16)+": lookup type 1 format must be 1 or 2.")},Yt[2]=function(){const t=this.parseUShort();return p.argument(1===t,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(F.coverage),sequences:this.parseListOfLists()}},Yt[3]=function(){const t=this.parseUShort();return p.argument(1===t,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(F.coverage),alternateSets:this.parseListOfLists()}},Yt[4]=function(){const t=this.parseUShort();return p.argument(1===t,"GSUB ligature table identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(F.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}};const $t={sequenceIndex:F.uShort,lookupListIndex:F.uShort};Yt[5]=function(){const t=this.offset+this.relativeOffset,e=this.parseUShort();if(1===e)return{substFormat:e,coverage:this.parsePointer(F.coverage),ruleSets:this.parseListOfLists(function(){const t=this.parseUShort(),e=this.parseUShort();return{input:this.parseUShortList(t-1),lookupRecords:this.parseRecordList(e,$t)}})};if(2===e)return{substFormat:e,coverage:this.parsePointer(F.coverage),classDef:this.parsePointer(F.classDef),classSets:this.parseListOfLists(function(){const t=this.parseUShort(),e=this.parseUShort();return{classes:this.parseUShortList(t-1),lookupRecords:this.parseRecordList(e,$t)}})};if(3===e){const t=this.parseUShort(),n=this.parseUShort();return{substFormat:e,coverages:this.parseList(t,F.pointer(F.coverage)),lookupRecords:this.parseRecordList(n,$t)}}p.assert(!1,"0x"+t.toString(16)+": lookup type 5 format must be 1, 2 or 3.")},Yt[6]=function(){const t=this.offset+this.relativeOffset,e=this.parseUShort();return 1===e?{substFormat:1,coverage:this.parsePointer(F.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList($t)}})}:2===e?{substFormat:2,coverage:this.parsePointer(F.coverage),backtrackClassDef:this.parsePointer(F.classDef),inputClassDef:this.parsePointer(F.classDef),lookaheadClassDef:this.parsePointer(F.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList($t)}})}:3===e?{substFormat:3,backtrackCoverage:this.parseList(F.pointer(F.coverage)),inputCoverage:this.parseList(F.pointer(F.coverage)),lookaheadCoverage:this.parseList(F.pointer(F.coverage)),lookupRecords:this.parseRecordList($t)}:void p.assert(!1,"0x"+t.toString(16)+": lookup type 6 format must be 1, 2 or 3.")},Yt[7]=function(){const t=this.parseUShort();p.argument(1===t,"GSUB Extension Substitution subtable identifier-format must be 1");const e=this.parseUShort(),n=new F(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:e,extension:Yt[e].call(n)}},Yt[8]=function(){const t=this.parseUShort();return p.argument(1===t,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(F.coverage),backtrackCoverage:this.parseList(F.pointer(F.coverage)),lookaheadCoverage:this.parseList(F.pointer(F.coverage)),substitutes:this.parseUShortList()}};const Zt=new Array(9);Zt[1]=function(t){return 1===t.substFormat?new L.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new L.Coverage(t.coverage)},{name:"deltaGlyphID",type:"USHORT",value:t.deltaGlyphId}]):new L.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new L.Coverage(t.coverage)}].concat(L.ushortList("substitute",t.substitute)))},Zt[3]=function(t){return p.assert(1===t.substFormat,"Lookup type 3 substFormat must be 1."),new L.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new L.Coverage(t.coverage)}].concat(L.tableList("altSet",t.alternateSets,function(t){return new L.Table("alternateSetTable",L.ushortList("alternate",t))})))},Zt[4]=function(t){return p.assert(1===t.substFormat,"Lookup type 4 substFormat must be 1."),new L.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new L.Coverage(t.coverage)}].concat(L.tableList("ligSet",t.ligatureSets,function(t){return new L.Table("ligatureSetTable",L.tableList("ligature",t,function(t){return new L.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:t.ligGlyph}].concat(L.ushortList("component",t.components,t.components.length+1)))}))})))};var Jt={parse:function(t,e){const n=new F(t,e=e||0),r=n.parseVersion();return p.argument(1===r,"Unsupported GSUB table version."),{version:r,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(Yt)}},make:function(t){return new L.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new L.ScriptList(t.scripts)},{name:"features",type:"TABLE",value:new L.FeatureList(t.features)},{name:"lookups",type:"TABLE",value:new L.LookupList(t.lookups,Zt)}])}};var Kt={parse:function(t,e){const n=new z.Parser(t,e),r=n.parseULong();p.argument(1===r,"Unsupported META table version."),n.parseULong(),n.parseULong();const i=n.parseULong(),o={};for(let r=0;r<i;r++){const r=n.parseTag(),i=n.parseULong(),a=n.parseULong(),s=f.UTF8(t,e+i,a);o[r]=s}return o},make:function(t){const e=Object.keys(t).length;let n="";const r=16+12*e,i=new L.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:r},{name:"numTags",type:"ULONG",value:e}]);for(let e in t){const o=n.length;n+=t[e],i.fields.push({name:"tag "+e,type:"TAG",value:e}),i.fields.push({name:"offset "+e,type:"ULONG",value:r+o}),i.fields.push({name:"length "+e,type:"ULONG",value:t[e].length})}return i.fields.push({name:"stringPool",type:"CHARARRAY",value:n}),i}};function Qt(t){return Math.log(t)/Math.log(2)|0}function te(t){for(;t.length%4!=0;)t.push(0);let e=0;for(let n=0;n<t.length;n+=4)e+=(t[n]<<24)+(t[n+1]<<16)+(t[n+2]<<8)+t[n+3];return e%=Math.pow(2,32)}function ee(t,e,n,r){return new L.Record("Table Record",[{name:"tag",type:"TAG",value:void 0!==t?t:""},{name:"checkSum",type:"ULONG",value:void 0!==e?e:0},{name:"offset",type:"ULONG",value:void 0!==n?n:0},{name:"length",type:"ULONG",value:void 0!==r?r:0}])}function ne(t){const e=new L.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);e.tables=t,e.numTables=t.length;const n=Math.pow(2,Qt(e.numTables));e.searchRange=16*n,e.entrySelector=Qt(n),e.rangeShift=16*e.numTables-e.searchRange;const r=[],i=[];let o=e.sizeOf()+ee().sizeOf()*e.numTables;for(;o%4!=0;)o+=1,i.push({name:"padding",type:"BYTE",value:0});for(let e=0;e<t.length;e+=1){const n=t[e];p.argument(4===n.tableName.length,"Table name"+n.tableName+" is invalid.");const a=n.sizeOf(),s=ee(n.tableName,te(n.encode()),o,a);for(r.push({name:s.tag+" Table Record",type:"RECORD",value:s}),i.push({name:n.tableName+" table",type:"RECORD",value:n}),o+=a,p.argument(!isNaN(o),"Something went wrong calculating the offset.");o%4!=0;)o+=1,i.push({name:"padding",type:"BYTE",value:0})}return r.sort(function(t,e){return t.value.tag>e.value.tag?1:-1}),e.fields=e.fields.concat(r),e.fields=e.fields.concat(i),e}function re(t,e,n){for(let n=0;n<e.length;n+=1){const r=t.charToGlyphIndex(e[n]);if(r>0)return t.glyphs.get(r).getMetrics()}return n}var ie={make:ne,fontToTable:function(t){const e=[],n=[],r=[],i=[],o=[],a=[],s=[];let u,l=0,c=0,h=0,p=0,f=0;for(let d=0;d<t.glyphs.length;d+=1){const m=t.glyphs.get(d),g=0|m.unicode;if(isNaN(m.advanceWidth))throw new Error("Glyph "+m.name+" ("+d+"): advanceWidth is not a number.");(u>g||void 0===u)&&g>0&&(u=g),l<g&&(l=g);const v=qt.getUnicodeRange(g);if(v<32)c|=1<<v;else if(v<64)h|=1<<v-32;else if(v<96)p|=1<<v-64;else{if(!(v<123))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");f|=1<<v-96}if(".notdef"===m.name)continue;const y=m.getMetrics();e.push(y.xMin),n.push(y.yMin),r.push(y.xMax),i.push(y.yMax),a.push(y.leftSideBearing),s.push(y.rightSideBearing),o.push(m.advanceWidth)}const d={xMin:Math.min.apply(null,e),yMin:Math.min.apply(null,n),xMax:Math.max.apply(null,r),yMax:Math.max.apply(null,i),advanceWidthMax:Math.max.apply(null,o),advanceWidthAvg:function(t){let e=0;for(let n=0;n<t.length;n+=1)e+=t[n];return e/t.length}(o),minLeftSideBearing:Math.min.apply(null,a),maxLeftSideBearing:Math.max.apply(null,a),minRightSideBearing:Math.min.apply(null,s)};d.ascender=t.ascender,d.descender=t.descender;const m=At.make({flags:3,unitsPerEm:t.unitsPerEm,xMin:d.xMin,yMin:d.yMin,xMax:d.xMax,yMax:d.yMax,lowestRecPPEM:3,createdTimestamp:t.createdTimestamp}),g=Mt.make({ascender:d.ascender,descender:d.descender,advanceWidthMax:d.advanceWidthMax,minLeftSideBearing:d.minLeftSideBearing,minRightSideBearing:d.minRightSideBearing,xMaxExtent:d.maxLeftSideBearing+(d.xMax-d.xMin),numberOfHMetrics:t.glyphs.length}),v=Pt.make(t.glyphs.length),y=qt.make({xAvgCharWidth:Math.round(d.advanceWidthAvg),usWeightClass:t.tables.os2.usWeightClass,usWidthClass:t.tables.os2.usWidthClass,usFirstCharIndex:u,usLastCharIndex:l,ulUnicodeRange1:c,ulUnicodeRange2:h,ulUnicodeRange3:p,ulUnicodeRange4:f,fsSelection:t.tables.os2.fsSelection,sTypoAscender:d.ascender,sTypoDescender:d.descender,sTypoLineGap:0,usWinAscent:d.yMax,usWinDescent:Math.abs(d.yMin),ulCodePageRange1:1,sxHeight:re(t,"xyvw",{yMax:Math.round(d.ascender/2)}).yMax,sCapHeight:re(t,"HIKLEFJMNTZBDPRAGOQSUVWXY",d).yMax,usDefaultChar:t.hasChar(" ")?32:0,usBreakChar:t.hasChar(" ")?32:0}),b=Ct.make(t.glyphs),_=G.make(t.glyphs),x=t.getEnglishName("fontFamily"),w=t.getEnglishName("fontSubfamily"),E=x+" "+w;let S=t.getEnglishName("postScriptName");S||(S=x.replace(/\s/g,"")+"-"+w);const T={};for(let e in t.names)T[e]=t.names[e];T.uniqueID||(T.uniqueID={en:t.getEnglishName("manufacturer")+":"+E}),T.postScriptName||(T.postScriptName={en:S}),T.preferredFamily||(T.preferredFamily=t.names.fontFamily),T.preferredSubfamily||(T.preferredSubfamily=t.names.fontSubfamily);const O=[],A=Vt.make(T,O),M=O.length>0?kt.make(O):void 0,C=Xt.make(),k=Ot.make(t.glyphs,{version:t.getEnglishName("version"),fullName:E,familyName:x,weightName:w,postScriptName:S,unitsPerEm:t.unitsPerEm,fontBBox:[0,d.yMin,d.ascender,d.advanceWidthMax]}),P=t.metas&&Object.keys(t.metas).length>0?Kt.make(t.metas):void 0,R=[m,g,v,y,A,_,C,k,b];M&&R.push(M),t.tables.gsub&&R.push(Jt.make(t.tables.gsub)),P&&R.push(P);const L=ne(R),I=te(L.encode()),D=L.fields;let N=!1;for(let t=0;t<D.length;t+=1)if("head table"===D[t].name){D[t].value.checkSumAdjustment=2981146554-I,N=!0;break}if(!N)throw new Error("Could not find head table with checkSum to adjust.");return L},computeCheckSum:te};function oe(t,e){let n=0,r=t.length-1;for(;n<=r;){const i=n+r>>>1,o=t[i].tag;if(o===e)return i;o<e?n=i+1:r=i-1}return-n-1}function ae(t,e){this.font=t,this.tableName=e}ae.prototype={searchTag:oe,binSearch:function(t,e){let n=0,r=t.length-1;for(;n<=r;){const i=n+r>>>1,o=t[i];if(o===e)return i;o<e?n=i+1:r=i-1}return-n-1},getTable:function(t){let e=this.font.tables[this.tableName];return!e&&t&&(e=this.font.tables[this.tableName]=this.createDefaultTable()),e},getScriptNames:function(){let t=this.getTable();return t?t.scripts.map(function(t){return t.tag}):[]},getDefaultScriptName:function(){let t=this.getTable();if(!t)return;let e=!1;for(let n=0;n<t.scripts.length;n++){const r=t.scripts[n].tag;if("DFLT"===r)return r;"latn"===r&&(e=!0)}return e?"latn":void 0},getScriptTable:function(t,e){const n=this.getTable(e);if(n){t=t||"DFLT";const r=n.scripts,i=oe(n.scripts,t);if(i>=0)return r[i].script;if(e){const e={tag:t,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return r.splice(-1-i,0,e),e.script}}},getLangSysTable:function(t,e,n){const r=this.getScriptTable(t,n);if(r){if(!e||"dflt"===e||"DFLT"===e)return r.defaultLangSys;const t=oe(r.langSysRecords,e);if(t>=0)return r.langSysRecords[t].langSys;if(n){const n={tag:e,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return r.langSysRecords.splice(-1-t,0,n),n.langSys}}},getFeatureTable:function(t,e,n,r){const i=this.getLangSysTable(t,e,r);if(i){let t;const e=i.featureIndexes,o=this.font.tables[this.tableName].features;for(let r=0;r<e.length;r++)if((t=o[e[r]]).tag===n)return t.feature;if(r){const r=o.length;return p.assert(0===r||n>=o[r-1].tag,"Features must be added in alphabetical order."),t={tag:n,feature:{params:0,lookupListIndexes:[]}},o.push(t),e.push(r),t.feature}}},getLookupTables:function(t,e,n,r,i){const o=this.getFeatureTable(t,e,n,i),a=[];if(o){let t;const e=o.lookupListIndexes,n=this.font.tables[this.tableName].lookups;for(let i=0;i<e.length;i++)(t=n[e[i]]).lookupType===r&&a.push(t);if(0===a.length&&i){t={lookupType:r,lookupFlag:0,subtables:[],markFilteringSet:void 0};const i=n.length;return n.push(t),e.push(i),[t]}}return a},expandCoverage:function(t){if(1===t.format)return t.glyphs;{const e=[],n=t.ranges;for(let t=0;t<n.length;t++){const r=n[t],i=r.start,o=r.end;for(let t=i;t<=o;t++)e.push(t)}return e}}};var se=ae;function ue(t){se.call(this,t,"gsub")}function le(t,e){const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function ce(t,e,n){const r=t.subtables;for(let t=0;t<r.length;t++){const n=r[t];if(n.substFormat===e)return n}if(n)return r.push(n),n}ue.prototype=se.prototype,ue.prototype.createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}},ue.prototype.getSingle=function(t,e,n){const r=[],i=this.getLookupTables(e,n,t,1);for(let t=0;t<i.length;t++){const e=i[t].subtables;for(let t=0;t<e.length;t++){const n=e[t],i=this.expandCoverage(n.coverage);let o;if(1===n.substFormat){const t=n.deltaGlyphId;for(o=0;o<i.length;o++){const e=i[o];r.push({sub:e,by:e+t})}}else{const t=n.substitute;for(o=0;o<i.length;o++)r.push({sub:i[o],by:t[o]})}}}return r},ue.prototype.getAlternates=function(t,e,n){const r=[],i=this.getLookupTables(e,n,t,3);for(let t=0;t<i.length;t++){const e=i[t].subtables;for(let t=0;t<e.length;t++){const n=e[t],i=this.expandCoverage(n.coverage),o=n.alternateSets;for(let t=0;t<i.length;t++)r.push({sub:i[t],by:o[t]})}}return r},ue.prototype.getLigatures=function(t,e,n){const r=[],i=this.getLookupTables(e,n,t,4);for(let t=0;t<i.length;t++){const e=i[t].subtables;for(let t=0;t<e.length;t++){const n=e[t],i=this.expandCoverage(n.coverage),o=n.ligatureSets;for(let t=0;t<i.length;t++){const e=i[t],n=o[t];for(let t=0;t<n.length;t++){const i=n[t];r.push({sub:[e].concat(i.components),by:i.ligGlyph})}}}}return r},ue.prototype.addSingle=function(t,e,n,r){const i=ce(this.getLookupTables(n,r,t,1,!0)[0],2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});p.assert(1===i.coverage.format,"Ligature: unable to modify coverage table format "+i.coverage.format);const o=e.sub;let a=this.binSearch(i.coverage.glyphs,o);a<0&&(a=-1-a,i.coverage.glyphs.splice(a,0,o),i.substitute.splice(a,0,0)),i.substitute[a]=e.by},ue.prototype.addAlternate=function(t,e,n,r){const i=ce(this.getLookupTables(n,r,t,3,!0)[0],1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});p.assert(1===i.coverage.format,"Ligature: unable to modify coverage table format "+i.coverage.format);const o=e.sub;let a=this.binSearch(i.coverage.glyphs,o);a<0&&(a=-1-a,i.coverage.glyphs.splice(a,0,o),i.alternateSets.splice(a,0,0)),i.alternateSets[a]=e.by},ue.prototype.addLigature=function(t,e,n,r){const i=this.getLookupTables(n,r,t,4,!0)[0];let o=i.subtables[0];o||(o={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]},i.subtables[0]=o),p.assert(1===o.coverage.format,"Ligature: unable to modify coverage table format "+o.coverage.format);const a=e.sub[0],s=e.sub.slice(1),u={ligGlyph:e.by,components:s};let l=this.binSearch(o.coverage.glyphs,a);if(l>=0){const t=o.ligatureSets[l];for(let e=0;e<t.length;e++)if(le(t[e].components,s))return;t.push(u)}else l=-1-l,o.coverage.glyphs.splice(l,0,a),o.ligatureSets.splice(l,0,[u])},ue.prototype.getFeature=function(t,e,n){if(/ss\d\d/.test(t))return this.getSingle(t,e,n);switch(t){case"aalt":case"salt":return this.getSingle(t,e,n).concat(this.getAlternates(t,e,n));case"dlig":case"liga":case"rlig":return this.getLigatures(t,e,n)}},ue.prototype.add=function(t,e,n,r){if(/ss\d\d/.test(t))return this.addSingle(t,e,n,r);switch(t){case"aalt":case"salt":return"number"==typeof e.by?this.addSingle(t,e,n,r):this.addAlternate(t,e,n,r);case"dlig":case"liga":case"rlig":return this.addLigature(t,e,n,r)}};var he=ue,pe=n(302);let fe,de,me,ge;function ve(t){this.font=t,this._fpgmState=this._prepState=void 0,this._errorState=0}function ye(t){return t}function be(t){return Math.sign(t)*Math.round(Math.abs(t))}function _e(t){return Math.sign(t)*Math.round(Math.abs(2*t))/2}function xe(t){return Math.sign(t)*(Math.round(Math.abs(t)+.5)-.5)}function we(t){return Math.sign(t)*Math.ceil(Math.abs(t))}function Ee(t){return Math.sign(t)*Math.floor(Math.abs(t))}const Se=function(t){const e=this.srPeriod;let n=this.srPhase;const r=this.srThreshold;let i=1;return t<0&&(t=-t,i=-1),t+=r-n,t=Math.trunc(t/e)*e,t+=n,i>0&&t<0?n:i<0&&t>0?-n:t*i},Te={x:1,y:0,axis:"x",distance:function(t,e,n,r){return(n?t.xo:t.x)-(r?e.xo:e.x)},interpolate:function(t,e,n,r){let i,o,a,s,u,l,c;if(!r||r===this)return i=t.xo-e.xo,o=t.xo-n.xo,u=e.x-e.xo,l=n.x-n.xo,0===(c=(a=Math.abs(i))+(s=Math.abs(o)))?void(t.x=t.xo+(u+l)/2):void(t.x=t.xo+(u*s+l*a)/c);i=r.distance(t,e,!0,!0),o=r.distance(t,n,!0,!0),u=r.distance(e,e,!1,!0),l=r.distance(n,n,!1,!0),0!==(c=(a=Math.abs(i))+(s=Math.abs(o)))?Te.setRelative(t,t,(u*s+l*a)/c,r,!0):Te.setRelative(t,t,(u+l)/2,r,!0)},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(t,e,n,r,i){if(!r||r===this)return void(t.x=(i?e.xo:e.x)+n);const o=i?e.xo:e.x,a=i?e.yo:e.y,s=o+n*r.x,u=a+n*r.y;t.x=s+(t.y-u)/r.normalSlope},slope:0,touch:function(t){t.xTouched=!0},touched:function(t){return t.xTouched},untouch:function(t){t.xTouched=!1}},Oe={x:0,y:1,axis:"y",distance:function(t,e,n,r){return(n?t.yo:t.y)-(r?e.yo:e.y)},interpolate:function(t,e,n,r){let i,o,a,s,u,l,c;if(!r||r===this)return i=t.yo-e.yo,o=t.yo-n.yo,u=e.y-e.yo,l=n.y-n.yo,0===(c=(a=Math.abs(i))+(s=Math.abs(o)))?void(t.y=t.yo+(u+l)/2):void(t.y=t.yo+(u*s+l*a)/c);i=r.distance(t,e,!0,!0),o=r.distance(t,n,!0,!0),u=r.distance(e,e,!1,!0),l=r.distance(n,n,!1,!0),0!==(c=(a=Math.abs(i))+(s=Math.abs(o)))?Oe.setRelative(t,t,(u*s+l*a)/c,r,!0):Oe.setRelative(t,t,(u+l)/2,r,!0)},normalSlope:0,setRelative:function(t,e,n,r,i){if(!r||r===this)return void(t.y=(i?e.yo:e.y)+n);const o=i?e.xo:e.x,a=i?e.yo:e.y,s=o+n*r.x,u=a+n*r.y;t.y=u+r.normalSlope*(t.x-s)},slope:Number.POSITIVE_INFINITY,touch:function(t){t.yTouched=!0},touched:function(t){return t.yTouched},untouch:function(t){t.yTouched=!1}};function Ae(t,e){this.x=t,this.y=e,this.axis=void 0,this.slope=e/t,this.normalSlope=-t/e,Object.freeze(this)}function Me(t,e){const n=Math.sqrt(t*t+e*e);return e/=n,1===(t/=n)&&0===e?Te:0===t&&1===e?Oe:new Ae(t,e)}function Ce(t,e,n,r){this.x=this.xo=Math.round(64*t)/64,this.y=this.yo=Math.round(64*e)/64,this.lastPointOfContour=n,this.onCurve=r,this.prevPointOnContour=void 0,this.nextPointOnContour=void 0,this.xTouched=!1,this.yTouched=!1,Object.preventExtensions(this)}Object.freeze(Te),Object.freeze(Oe),Ae.prototype.distance=function(t,e,n,r){return this.x*Te.distance(t,e,n,r)+this.y*Oe.distance(t,e,n,r)},Ae.prototype.interpolate=function(t,e,n,r){let i,o,a,s,u,l,c;a=r.distance(t,e,!0,!0),s=r.distance(t,n,!0,!0),i=r.distance(e,e,!1,!0),o=r.distance(n,n,!1,!0),0!==(c=(u=Math.abs(a))+(l=Math.abs(s)))?this.setRelative(t,t,(i*l+o*u)/c,r,!0):this.setRelative(t,t,(i+o)/2,r,!0)},Ae.prototype.setRelative=function(t,e,n,r,i){r=r||this;const o=i?e.xo:e.x,a=i?e.yo:e.y,s=o+n*r.x,u=a+n*r.y,l=r.normalSlope,c=this.slope,h=t.x,p=t.y;t.x=(c*h-l*s+u-p)/(c-l),t.y=c*(t.x-h)+p},Ae.prototype.touch=function(t){t.xTouched=!0,t.yTouched=!0},Ce.prototype.nextTouched=function(t){let e=this.nextPointOnContour;for(;!t.touched(e)&&e!==this;)e=e.nextPointOnContour;return e},Ce.prototype.prevTouched=function(t){let e=this.prevPointOnContour;for(;!t.touched(e)&&e!==this;)e=e.prevPointOnContour;return e};const ke=Object.freeze(new Ce(0,0)),Pe={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:!0};function Re(t,e){switch(this.env=t,this.stack=[],this.prog=e,t){case"glyf":this.zp0=this.zp1=this.zp2=1,this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=Te,this.round=be}}function Le(t){const e=t.tZone=new Array(t.gZone.length);for(let t=0;t<e.length;t++)e[t]=new Ce(0,0)}function Ie(t,e){const n=t.prog;let r,i=t.ip,o=1;do{if(88===(r=n[++i]))o++;else if(89===r)o--;else if(64===r)i+=n[i+1]+1;else if(65===r)i+=2*n[i+1]+1;else if(r>=176&&r<=183)i+=r-176+1;else if(r>=184&&r<=191)i+=2*(r-184+1);else if(e&&1===o&&27===r)break}while(o>0);t.ip=i}function De(t,e){exports.DEBUG&&console.log(e.step,"SVTCA["+t.axis+"]"),e.fv=e.pv=e.dpv=t}function Ne(t,e){exports.DEBUG&&console.log(e.step,"SPVTCA["+t.axis+"]"),e.pv=e.dpv=t}function je(t,e){exports.DEBUG&&console.log(e.step,"SFVTCA["+t.axis+"]"),e.fv=t}function Ue(t,e){const n=e.stack,r=n.pop(),i=n.pop(),o=e.z2[r],a=e.z1[i];let s,u;exports.DEBUG&&console.log("SPVTL["+t+"]",r,i),t?(s=o.y-a.y,u=a.x-o.x):(s=a.x-o.x,u=a.y-o.y),e.pv=e.dpv=Me(s,u)}function Fe(t,e){const n=e.stack,r=n.pop(),i=n.pop(),o=e.z2[r],a=e.z1[i];let s,u;exports.DEBUG&&console.log("SFVTL["+t+"]",r,i),t?(s=o.y-a.y,u=a.x-o.x):(s=a.x-o.x,u=a.y-o.y),e.fv=Me(s,u)}function Be(t){exports.DEBUG&&console.log(t.step,"POP[]"),t.stack.pop()}function ze(t,e){const n=e.stack.pop(),r=e.z0[n],i=e.fv,o=e.pv;exports.DEBUG&&console.log(e.step,"MDAP["+t+"]",n);let a=o.distance(r,ke);t&&(a=e.round(a)),i.setRelative(r,ke,a,o),i.touch(r),e.rp0=e.rp1=n}function Ge(t,e){const n=e.z2,r=n.length-2;let i,o,a;exports.DEBUG&&console.log(e.step,"IUP["+t.axis+"]");for(let e=0;e<r;e++)i=n[e],t.touched(i)||(o=i.prevTouched(t))!==i&&(o===(a=i.nextTouched(t))&&t.setRelative(i,i,t.distance(o,o,!1,!0),t,!0),t.interpolate(i,o,a,t))}function He(t,e){const n=e.stack,r=t?e.rp1:e.rp2,i=(t?e.z0:e.z1)[r],o=e.fv,a=e.pv;let s=e.loop;const u=e.z2;for(;s--;){const r=n.pop(),l=u[r],c=a.distance(i,i,!1,!0);o.setRelative(l,l,c,a),o.touch(l),exports.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-s)+": ":"")+"SHP["+(t?"rp1":"rp2")+"]",r)}e.loop=1}function Ve(t,e){const n=e.stack,r=t?e.rp1:e.rp2,i=(t?e.z0:e.z1)[r],o=e.fv,a=e.pv,s=n.pop(),u=e.z2[e.contours[s]];let l=u;exports.DEBUG&&console.log(e.step,"SHC["+t+"]",s);const c=a.distance(i,i,!1,!0);do{l!==i&&o.setRelative(l,l,c,a),l=l.nextPointOnContour}while(l!==u)}function We(t,e){const n=e.stack,r=t?e.rp1:e.rp2,i=(t?e.z0:e.z1)[r],o=e.fv,a=e.pv,s=n.pop();let u,l;switch(exports.DEBUG&&console.log(e.step,"SHZ["+t+"]",s),s){case 0:u=e.tZone;break;case 1:u=e.gZone;break;default:throw new Error("Invalid zone")}const c=a.distance(i,i,!1,!0),h=u.length-2;for(let t=0;t<h;t++)(l=u[t])!==i&&o.setRelative(l,l,c,a)}function qe(t,e){const n=e.stack,r=n.pop()/64,i=n.pop(),o=e.z1[i],a=e.z0[e.rp0],s=e.fv,u=e.pv;s.setRelative(o,a,r,u),s.touch(o),exports.DEBUG&&console.log(e.step,"MSIRP["+t+"]",r,i),e.rp1=e.rp0,e.rp2=i,t&&(e.rp0=i)}function Xe(t,e){const n=e.stack,r=n.pop(),i=n.pop(),o=e.z0[i],a=e.fv,s=e.pv;let u=e.cvt[r];t&&(u=e.round(u)),exports.DEBUG&&console.log(e.step,"MIAP["+t+"]",r,"(",u,")",i),a.setRelative(o,ke,u,s),0===e.zp0&&(o.xo=o.x,o.yo=o.y),a.touch(o),e.rp0=e.rp1=i}function Ye(t,e){const n=e.stack,r=n.pop(),i=e.z2[r];exports.DEBUG&&console.log(e.step,"GC["+t+"]",r),n.push(64*e.dpv.distance(i,ke,t,!1))}function $e(t,e){const n=e.stack,r=n.pop(),i=n.pop(),o=e.z1[r],a=e.z0[i],s=e.dpv.distance(a,o,t,t);exports.DEBUG&&console.log(e.step,"MD["+t+"]",r,i,"->",s),e.stack.push(Math.round(64*s))}function Ze(t,e){const n=e.stack,r=n.pop(),i=e.fv,o=e.pv,a=e.ppem,s=e.deltaBase+16*(t-1),u=e.deltaShift,l=e.z0;exports.DEBUG&&console.log(e.step,"DELTAP["+t+"]",r,n);for(let t=0;t<r;t++){const t=n.pop(),r=n.pop();if(s+((240&r)>>4)!==a)continue;let c=(15&r)-8;c>=0&&c++,exports.DEBUG&&console.log(e.step,"DELTAPFIX",t,"by",c*u);const h=l[t];i.setRelative(h,h,c*u,o)}}function Je(t,e){const n=e.stack,r=n.pop();exports.DEBUG&&console.log(e.step,"ROUND[]"),n.push(64*e.round(r/64))}function Ke(t,e){const n=e.stack,r=n.pop(),i=e.ppem,o=e.deltaBase+16*(t-1),a=e.deltaShift;exports.DEBUG&&console.log(e.step,"DELTAC["+t+"]",r,n);for(let t=0;t<r;t++){const t=n.pop(),r=n.pop();if(o+((240&r)>>4)!==i)continue;let s=(15&r)-8;s>=0&&s++;const u=s*a;exports.DEBUG&&console.log(e.step,"DELTACFIX",t,"by",u),e.cvt[t]+=u}}function Qe(t,e){const n=e.stack,r=n.pop(),i=n.pop(),o=e.z2[r],a=e.z1[i];let s,u;exports.DEBUG&&console.log("SDPVTL["+t+"]",r,i),t?(s=o.y-a.y,u=a.x-o.x):(s=a.x-o.x,u=a.y-o.y),e.dpv=Me(s,u)}function tn(t,e){const n=e.stack,r=e.prog;let i=e.ip;exports.DEBUG&&console.log(e.step,"PUSHB["+t+"]");for(let e=0;e<t;e++)n.push(r[++i]);e.ip=i}function en(t,e){let n=e.ip;const r=e.prog,i=e.stack;exports.DEBUG&&console.log(e.ip,"PUSHW["+t+"]");for(let e=0;e<t;e++){let t=r[++n]<<8|r[++n];32768&t&&(t=-(1+(65535^t))),i.push(t)}e.ip=n}function nn(t,e,n,r,i,o){const a=o.stack,s=t&&a.pop(),u=a.pop(),l=o.rp0,c=o.z0[l],h=o.z1[u],p=o.minDis,f=o.fv,d=o.dpv;let m,g,v,y;v=(g=m=d.distance(h,c,!0,!0))>=0?1:-1,g=Math.abs(g),t&&(y=o.cvt[s],r&&Math.abs(g-y)<o.cvCutIn&&(g=y)),n&&g<p&&(g=p),r&&(g=o.round(g)),f.setRelative(h,c,v*g,d),f.touch(h),exports.DEBUG&&console.log(o.step,(t?"MIRP[":"MDRP[")+(e?"M":"m")+(n?">":"_")+(r?"R":"_")+(0===i?"Gr":1===i?"Bl":2===i?"Wh":"")+"]",t?s+"("+o.cvt[s]+","+y+")":"",u,"(d =",m,"->",v*g,")"),o.rp1=o.rp0,o.rp2=u,e&&(o.rp0=u)}ve.prototype.exec=function(t,e){if("number"!=typeof e)throw new Error("Point size is not a number!");if(this._errorState>2)return;const n=this.font;let r=this._prepState;if(!r||r.ppem!==e){let t=this._fpgmState;if(!t){Re.prototype=Pe,(t=this._fpgmState=new Re("fpgm",n.tables.fpgm)).funcs=[],t.font=n,exports.DEBUG&&(console.log("---EXEC FPGM---"),t.step=-1);try{de(t)}catch(t){return console.log("Hinting error in FPGM:"+t),void(this._errorState=3)}}Re.prototype=t,(r=this._prepState=new Re("prep",n.tables.prep)).ppem=e;const i=n.tables.cvt;if(i){const t=r.cvt=new Array(i.length),o=e/n.unitsPerEm;for(let e=0;e<i.length;e++)t[e]=i[e]*o}else r.cvt=[];exports.DEBUG&&(console.log("---EXEC PREP---"),r.step=-1);try{de(r)}catch(t){this._errorState<2&&console.log("Hinting error in PREP:"+t),this._errorState=2}}if(!(this._errorState>1))try{return me(t,r)}catch(t){return this._errorState<1&&(console.log("Hinting error:"+t),console.log("Note: further hinting errors are silenced")),void(this._errorState=1)}},me=function(t,e){const n=e.ppem/e.font.unitsPerEm,r=n;let i,o,a,s=t.components;if(Re.prototype=e,s){const u=e.font;o=[],i=[];for(let t=0;t<s.length;t++){const e=s[t],l=u.glyphs.get(e.glyphIndex);a=new Re("glyf",l.instructions),exports.DEBUG&&(console.log("---EXEC COMP "+t+"---"),a.step=-1),ge(l,a,n,r);const c=Math.round(e.dx*n),h=Math.round(e.dy*r),p=a.gZone,f=a.contours;for(let t=0;t<p.length;t++){const e=p[t];e.xTouched=e.yTouched=!1,e.xo=e.x=e.x+c,e.yo=e.y=e.y+h}const d=o.length;o.push.apply(o,p);for(let t=0;t<f.length;t++)i.push(f[t]+d)}t.instructions&&!a.inhibitGridFit&&((a=new Re("glyf",t.instructions)).gZone=a.z0=a.z1=a.z2=o,a.contours=i,o.push(new Ce(0,0),new Ce(Math.round(t.advanceWidth*n),0)),exports.DEBUG&&(console.log("---EXEC COMPOSITE---"),a.step=-1),de(a),o.length-=2)}else a=new Re("glyf",t.instructions),exports.DEBUG&&(console.log("---EXEC GLYPH---"),a.step=-1),ge(t,a,n,r),o=a.gZone;return o},ge=function(t,e,n,r){const i=t.points||[],o=i.length,a=e.gZone=e.z0=e.z1=e.z2=[],s=e.contours=[];let u,l,c;for(let t=0;t<o;t++)u=i[t],a[t]=new Ce(u.x*n,u.y*r,u.lastPointOfContour,u.onCurve);for(let t=0;t<o;t++)u=a[t],l||(l=u,s.push(t)),u.lastPointOfContour?(u.nextPointOnContour=l,l.prevPointOnContour=u,l=void 0):(c=a[t+1],u.nextPointOnContour=c,c.prevPointOnContour=u);if(!e.inhibitGridFit&&(a.push(new Ce(0,0),new Ce(Math.round(t.advanceWidth*n),0)),de(e),a.length-=2,exports.DEBUG)){console.log("FINISHED GLYPH",e.stack);for(let t=0;t<o;t++)console.log(t,a[t].x,a[t].y)}},de=function(t){let e=t.prog;if(!e)return;const n=e.length;let r;for(t.ip=0;t.ip<n;t.ip++){if(exports.DEBUG&&t.step++,!(r=fe[e[t.ip]]))throw new Error("unknown instruction: 0x"+Number(e[t.ip]).toString(16));r(t)}},fe=[De.bind(void 0,Oe),De.bind(void 0,Te),Ne.bind(void 0,Oe),Ne.bind(void 0,Te),je.bind(void 0,Oe),je.bind(void 0,Te),Ue.bind(void 0,0),Ue.bind(void 0,1),Fe.bind(void 0,0),Fe.bind(void 0,1),function(t){const e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"SPVFS[]",n,r),t.pv=t.dpv=Me(r,n)},function(t){const e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"SPVFS[]",n,r),t.fv=Me(r,n)},function(t){const e=t.stack,n=t.pv;exports.DEBUG&&console.log(t.step,"GPV[]"),e.push(16384*n.x),e.push(16384*n.y)},function(t){const e=t.stack,n=t.fv;exports.DEBUG&&console.log(t.step,"GFV[]"),e.push(16384*n.x),e.push(16384*n.y)},function(t){t.fv=t.pv,exports.DEBUG&&console.log(t.step,"SFVTPV[]")},function(t){const e=t.stack,n=e.pop(),r=e.pop(),i=e.pop(),o=e.pop(),a=e.pop(),s=t.z0,u=t.z1,l=s[n],c=s[r],h=u[i],p=u[o],f=t.z2[a];exports.DEBUG&&console.log("ISECT[], ",n,r,i,o,a);const d=l.x,m=l.y,g=c.x,v=c.y,y=h.x,b=h.y,_=p.x,x=p.y,w=(d-g)*(b-x)-(m-v)*(y-_),E=d*v-m*g,S=y*x-b*_;f.x=(E*(y-_)-S*(d-g))/w,f.y=(E*(b-x)-S*(m-v))/w},function(t){t.rp0=t.stack.pop(),exports.DEBUG&&console.log(t.step,"SRP0[]",t.rp0)},function(t){t.rp1=t.stack.pop(),exports.DEBUG&&console.log(t.step,"SRP1[]",t.rp1)},function(t){t.rp2=t.stack.pop(),exports.DEBUG&&console.log(t.step,"SRP2[]",t.rp2)},function(t){const e=t.stack.pop();switch(exports.DEBUG&&console.log(t.step,"SZP0[]",e),t.zp0=e,e){case 0:t.tZone||Le(t),t.z0=t.tZone;break;case 1:t.z0=t.gZone;break;default:throw new Error("Invalid zone pointer")}},function(t){const e=t.stack.pop();switch(exports.DEBUG&&console.log(t.step,"SZP1[]",e),t.zp1=e,e){case 0:t.tZone||Le(t),t.z1=t.tZone;break;case 1:t.z1=t.gZone;break;default:throw new Error("Invalid zone pointer")}},function(t){const e=t.stack.pop();switch(exports.DEBUG&&console.log(t.step,"SZP2[]",e),t.zp2=e,e){case 0:t.tZone||Le(t),t.z2=t.tZone;break;case 1:t.z2=t.gZone;break;default:throw new Error("Invalid zone pointer")}},function(t){const e=t.stack.pop();switch(exports.DEBUG&&console.log(t.step,"SZPS[]",e),t.zp0=t.zp1=t.zp2=e,e){case 0:t.tZone||Le(t),t.z0=t.z1=t.z2=t.tZone;break;case 1:t.z0=t.z1=t.z2=t.gZone;break;default:throw new Error("Invalid zone pointer")}},function(t){t.loop=t.stack.pop(),exports.DEBUG&&console.log(t.step,"SLOOP[]",t.loop)},function(t){exports.DEBUG&&console.log(t.step,"RTG[]"),t.round=be},function(t){exports.DEBUG&&console.log(t.step,"RTHG[]"),t.round=xe},function(t){const e=t.stack.pop();exports.DEBUG&&console.log(t.step,"SMD[]",e),t.minDis=e/64},function(t){exports.DEBUG&&console.log(t.step,"ELSE[]"),Ie(t,!1)},function(t){const e=t.stack.pop();exports.DEBUG&&console.log(t.step,"JMPR[]",e),t.ip+=e-1},function(t){const e=t.stack.pop();exports.DEBUG&&console.log(t.step,"SCVTCI[]",e),t.cvCutIn=e/64},void 0,void 0,function(t){const e=t.stack;exports.DEBUG&&console.log(t.step,"DUP[]"),e.push(e[e.length-1])},Be,function(t){exports.DEBUG&&console.log(t.step,"CLEAR[]"),t.stack.length=0},function(t){const e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"SWAP[]"),e.push(n),e.push(r)},function(t){const e=t.stack;exports.DEBUG&&console.log(t.step,"DEPTH[]"),e.push(e.length)},function(t){const e=t.stack,n=e.pop();exports.DEBUG&&console.log(t.step,"CINDEX[]",n),e.push(e[e.length-n])},function(t){const e=t.stack,n=e.pop();exports.DEBUG&&console.log(t.step,"MINDEX[]",n),e.push(e.splice(e.length-n,1)[0])},void 0,void 0,void 0,function(t){const e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"LOOPCALL[]",n,r);const i=t.ip,o=t.prog;t.prog=t.funcs[n];for(let e=0;e<r;e++)de(t),exports.DEBUG&&console.log(++t.step,e+1<r?"next loopcall":"done loopcall",e);t.ip=i,t.prog=o},function(t){const e=t.stack.pop();exports.DEBUG&&console.log(t.step,"CALL[]",e);const n=t.ip,r=t.prog;t.prog=t.funcs[e],de(t),t.ip=n,t.prog=r,exports.DEBUG&&console.log(++t.step,"returning from",e)},function(t){if("fpgm"!==t.env)throw new Error("FDEF not allowed here");const e=t.stack,n=t.prog;let r=t.ip;const i=e.pop(),o=r;for(exports.DEBUG&&console.log(t.step,"FDEF[]",i);45!==n[++r];);t.ip=r,t.funcs[i]=n.slice(o+1,r)},void 0,ze.bind(void 0,0),ze.bind(void 0,1),Ge.bind(void 0,Oe),Ge.bind(void 0,Te),He.bind(void 0,0),He.bind(void 0,1),Ve.bind(void 0,0),Ve.bind(void 0,1),We.bind(void 0,0),We.bind(void 0,1),function(t){const e=t.stack;let n=t.loop;const r=t.fv,i=e.pop()/64,o=t.z2;for(;n--;){const a=e.pop(),s=o[a];exports.DEBUG&&console.log(t.step,(t.loop>1?"loop "+(t.loop-n)+": ":"")+"SHPIX[]",a,i),r.setRelative(s,s,i),r.touch(s)}t.loop=1},function(t){const e=t.stack,n=t.rp1,r=t.rp2;let i=t.loop;const o=t.z0[n],a=t.z1[r],s=t.fv,u=t.dpv,l=t.z2;for(;i--;){const c=e.pop(),h=l[c];exports.DEBUG&&console.log(t.step,(t.loop>1?"loop "+(t.loop-i)+": ":"")+"IP[]",c,n,"<->",r),s.interpolate(h,o,a,u),s.touch(h)}t.loop=1},qe.bind(void 0,0),qe.bind(void 0,1),function(t){const e=t.stack,n=t.rp0,r=t.z0[n];let i=t.loop;const o=t.fv,a=t.pv,s=t.z1;for(;i--;){const n=e.pop(),u=s[n];exports.DEBUG&&console.log(t.step,(t.loop>1?"loop "+(t.loop-i)+": ":"")+"ALIGNRP[]",n),o.setRelative(u,r,0,a),o.touch(u)}t.loop=1},function(t){exports.DEBUG&&console.log(t.step,"RTDG[]"),t.round=_e},Xe.bind(void 0,0),Xe.bind(void 0,1),function(t){const e=t.prog;let n=t.ip;const r=t.stack,i=e[++n];exports.DEBUG&&console.log(t.step,"NPUSHB[]",i);for(let t=0;t<i;t++)r.push(e[++n]);t.ip=n},function(t){let e=t.ip;const n=t.prog,r=t.stack,i=n[++e];exports.DEBUG&&console.log(t.step,"NPUSHW[]",i);for(let t=0;t<i;t++){let t=n[++e]<<8|n[++e];32768&t&&(t=-(1+(65535^t))),r.push(t)}t.ip=e},function(t){const e=t.stack;let n=t.store;n||(n=t.store=[]);const r=e.pop(),i=e.pop();exports.DEBUG&&console.log(t.step,"WS",r,i),n[i]=r},function(t){const e=t.stack,n=t.store,r=e.pop();exports.DEBUG&&console.log(t.step,"RS",r);const i=n&&n[r]||0;e.push(i)},function(t){const e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"WCVTP",n,r),t.cvt[r]=n/64},function(t){const e=t.stack,n=e.pop();exports.DEBUG&&console.log(t.step,"RCVT",n),e.push(64*t.cvt[n])},Ye.bind(void 0,0),Ye.bind(void 0,1),void 0,$e.bind(void 0,0),$e.bind(void 0,1),function(t){exports.DEBUG&&console.log(t.step,"MPPEM[]"),t.stack.push(t.ppem)},void 0,function(t){exports.DEBUG&&console.log(t.step,"FLIPON[]"),t.autoFlip=!0},void 0,void 0,function(t){const e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"LT[]",n,r),e.push(r<n?1:0)},function(t){const e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"LTEQ[]",n,r),e.push(r<=n?1:0)},function(t){const e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"GT[]",n,r),e.push(r>n?1:0)},function(t){const e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"GTEQ[]",n,r),e.push(r>=n?1:0)},function(t){const e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"EQ[]",n,r),e.push(n===r?1:0)},function(t){const e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"NEQ[]",n,r),e.push(n!==r?1:0)},function(t){const e=t.stack,n=e.pop();exports.DEBUG&&console.log(t.step,"ODD[]",n),e.push(Math.trunc(n)%2?1:0)},function(t){const e=t.stack,n=e.pop();exports.DEBUG&&console.log(t.step,"EVEN[]",n),e.push(Math.trunc(n)%2?0:1)},function(t){let e,n=t.stack.pop();exports.DEBUG&&console.log(t.step,"IF[]",n),n||(Ie(t,!0),exports.DEBUG&&console.log(t.step,27===e?"ELSE[]":"EIF[]"))},function(t){exports.DEBUG&&console.log(t.step,"EIF[]")},function(t){const e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"AND[]",n,r),e.push(n&&r?1:0)},function(t){const e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"OR[]",n,r),e.push(n||r?1:0)},function(t){const e=t.stack,n=e.pop();exports.DEBUG&&console.log(t.step,"NOT[]",n),e.push(n?0:1)},Ze.bind(void 0,1),function(t){const e=t.stack.pop();exports.DEBUG&&console.log(t.step,"SDB[]",e),t.deltaBase=e},function(t){const e=t.stack.pop();exports.DEBUG&&console.log(t.step,"SDS[]",e),t.deltaShift=Math.pow(.5,e)},function(t){const e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"ADD[]",n,r),e.push(r+n)},function(t){const e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"SUB[]",n,r),e.push(r-n)},function(t){const e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"DIV[]",n,r),e.push(64*r/n)},function(t){const e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"MUL[]",n,r),e.push(r*n/64)},function(t){const e=t.stack,n=e.pop();exports.DEBUG&&console.log(t.step,"ABS[]",n),e.push(Math.abs(n))},function(t){const e=t.stack;let n=e.pop();exports.DEBUG&&console.log(t.step,"NEG[]",n),e.push(-n)},function(t){const e=t.stack,n=e.pop();exports.DEBUG&&console.log(t.step,"FLOOR[]",n),e.push(64*Math.floor(n/64))},function(t){const e=t.stack,n=e.pop();exports.DEBUG&&console.log(t.step,"CEILING[]",n),e.push(64*Math.ceil(n/64))},Je.bind(void 0,0),Je.bind(void 0,1),Je.bind(void 0,2),Je.bind(void 0,3),void 0,void 0,void 0,void 0,function(t){const e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"WCVTF[]",n,r),t.cvt[r]=n*t.ppem/t.font.unitsPerEm},Ze.bind(void 0,2),Ze.bind(void 0,3),Ke.bind(void 0,1),Ke.bind(void 0,2),Ke.bind(void 0,3),function(t){let e,n=t.stack.pop();switch(exports.DEBUG&&console.log(t.step,"SROUND[]",n),t.round=Se,192&n){case 0:e=.5;break;case 64:e=1;break;case 128:e=2;break;default:throw new Error("invalid SROUND value")}switch(t.srPeriod=e,48&n){case 0:t.srPhase=0;break;case 16:t.srPhase=.25*e;break;case 32:t.srPhase=.5*e;break;case 48:t.srPhase=.75*e;break;default:throw new Error("invalid SROUND value")}n&=15,t.srThreshold=0===n?0:(n/8-.5)*e},function(t){let e,n=t.stack.pop();switch(exports.DEBUG&&console.log(t.step,"S45ROUND[]",n),t.round=Se,192&n){case 0:e=Math.sqrt(2)/2;break;case 64:e=Math.sqrt(2);break;case 128:e=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}switch(t.srPeriod=e,48&n){case 0:t.srPhase=0;break;case 16:t.srPhase=.25*e;break;case 32:t.srPhase=.5*e;break;case 48:t.srPhase=.75*e;break;default:throw new Error("invalid S45ROUND value")}n&=15,t.srThreshold=0===n?0:(n/8-.5)*e},void 0,void 0,function(t){exports.DEBUG&&console.log(t.step,"ROFF[]"),t.round=ye},void 0,function(t){exports.DEBUG&&console.log(t.step,"RUTG[]"),t.round=we},function(t){exports.DEBUG&&console.log(t.step,"RDTG[]"),t.round=Ee},Be,Be,void 0,void 0,void 0,void 0,void 0,function(t){const e=t.stack.pop();exports.DEBUG&&console.log(t.step,"SCANCTRL[]",e)},Qe.bind(void 0,0),Qe.bind(void 0,1),function(t){const e=t.stack,n=e.pop();let r=0;exports.DEBUG&&console.log(t.step,"GETINFO[]",n),1&n&&(r=35),32&n&&(r|=4096),e.push(r)},void 0,function(t){const e=t.stack,n=e.pop(),r=e.pop(),i=e.pop();exports.DEBUG&&console.log(t.step,"ROLL[]"),e.push(r),e.push(n),e.push(i)},function(t){const e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"MAX[]",n,r),e.push(Math.max(r,n))},function(t){const e=t.stack,n=e.pop(),r=e.pop();exports.DEBUG&&console.log(t.step,"MIN[]",n,r),e.push(Math.min(r,n))},function(t){const e=t.stack.pop();exports.DEBUG&&console.log(t.step,"SCANTYPE[]",e)},function(t){const e=t.stack.pop();let n=t.stack.pop();switch(exports.DEBUG&&console.log(t.step,"INSTCTRL[]",e,n),e){case 1:return void(t.inhibitGridFit=!!n);case 2:return void(t.ignoreCvt=!!n);default:throw new Error("invalid INSTCTRL[] selector")}},void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,tn.bind(void 0,1),tn.bind(void 0,2),tn.bind(void 0,3),tn.bind(void 0,4),tn.bind(void 0,5),tn.bind(void 0,6),tn.bind(void 0,7),tn.bind(void 0,8),en.bind(void 0,1),en.bind(void 0,2),en.bind(void 0,3),en.bind(void 0,4),en.bind(void 0,5),en.bind(void 0,6),en.bind(void 0,7),en.bind(void 0,8),nn.bind(void 0,0,0,0,0,0),nn.bind(void 0,0,0,0,0,1),nn.bind(void 0,0,0,0,0,2),nn.bind(void 0,0,0,0,0,3),nn.bind(void 0,0,0,0,1,0),nn.bind(void 0,0,0,0,1,1),nn.bind(void 0,0,0,0,1,2),nn.bind(void 0,0,0,0,1,3),nn.bind(void 0,0,0,1,0,0),nn.bind(void 0,0,0,1,0,1),nn.bind(void 0,0,0,1,0,2),nn.bind(void 0,0,0,1,0,3),nn.bind(void 0,0,0,1,1,0),nn.bind(void 0,0,0,1,1,1),nn.bind(void 0,0,0,1,1,2),nn.bind(void 0,0,0,1,1,3),nn.bind(void 0,0,1,0,0,0),nn.bind(void 0,0,1,0,0,1),nn.bind(void 0,0,1,0,0,2),nn.bind(void 0,0,1,0,0,3),nn.bind(void 0,0,1,0,1,0),nn.bind(void 0,0,1,0,1,1),nn.bind(void 0,0,1,0,1,2),nn.bind(void 0,0,1,0,1,3),nn.bind(void 0,0,1,1,0,0),nn.bind(void 0,0,1,1,0,1),nn.bind(void 0,0,1,1,0,2),nn.bind(void 0,0,1,1,0,3),nn.bind(void 0,0,1,1,1,0),nn.bind(void 0,0,1,1,1,1),nn.bind(void 0,0,1,1,1,2),nn.bind(void 0,0,1,1,1,3),nn.bind(void 0,1,0,0,0,0),nn.bind(void 0,1,0,0,0,1),nn.bind(void 0,1,0,0,0,2),nn.bind(void 0,1,0,0,0,3),nn.bind(void 0,1,0,0,1,0),nn.bind(void 0,1,0,0,1,1),nn.bind(void 0,1,0,0,1,2),nn.bind(void 0,1,0,0,1,3),nn.bind(void 0,1,0,1,0,0),nn.bind(void 0,1,0,1,0,1),nn.bind(void 0,1,0,1,0,2),nn.bind(void 0,1,0,1,0,3),nn.bind(void 0,1,0,1,1,0),nn.bind(void 0,1,0,1,1,1),nn.bind(void 0,1,0,1,1,2),nn.bind(void 0,1,0,1,1,3),nn.bind(void 0,1,1,0,0,0),nn.bind(void 0,1,1,0,0,1),nn.bind(void 0,1,1,0,0,2),nn.bind(void 0,1,1,0,0,3),nn.bind(void 0,1,1,0,1,0),nn.bind(void 0,1,1,0,1,1),nn.bind(void 0,1,1,0,1,2),nn.bind(void 0,1,1,0,1,3),nn.bind(void 0,1,1,1,0,0),nn.bind(void 0,1,1,1,0,1),nn.bind(void 0,1,1,1,0,2),nn.bind(void 0,1,1,1,0,3),nn.bind(void 0,1,1,1,1,0),nn.bind(void 0,1,1,1,1,1),nn.bind(void 0,1,1,1,1,2),nn.bind(void 0,1,1,1,1,3)];var rn=ve;function on(t){(t=t||{}).empty||(Object(pe.b)(t.familyName,"When creating a new Font object, familyName is required."),Object(pe.b)(t.styleName,"When creating a new Font object, styleName is required."),Object(pe.b)(t.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),Object(pe.b)(t.ascender,"When creating a new Font object, ascender is required."),Object(pe.b)(t.descender,"When creating a new Font object, descender is required."),Object(pe.b)(t.descender<0,"Descender should be negative (e.g. -512)."),this.names={fontFamily:{en:t.familyName||" "},fontSubfamily:{en:t.styleName||" "},fullName:{en:t.fullName||t.familyName+" "+t.styleName},postScriptName:{en:t.postScriptName||t.familyName+t.styleName},designer:{en:t.designer||" "},designerURL:{en:t.designerURL||" "},manufacturer:{en:t.manufacturer||" "},manufacturerURL:{en:t.manufacturerURL||" "},license:{en:t.license||" "},licenseURL:{en:t.licenseURL||" "},version:{en:t.version||"Version 0.1"},description:{en:t.description||" "},copyright:{en:t.copyright||" "},trademark:{en:t.trademark||" "}},this.unitsPerEm=t.unitsPerEm||1e3,this.ascender=t.ascender,this.descender=t.descender,this.createdTimestamp=t.createdTimestamp,this.tables={os2:{usWeightClass:t.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:t.widthClass||this.usWidthClasses.MEDIUM,fsSelection:t.fsSelection||this.fsSelectionValues.REGULAR}}),this.supported=!0,this.glyphs=new ut.GlyphSet(this,t.glyphs||[]),this.encoding=new X(this),this.substitution=new he(this),this.tables=this.tables||{},Object.defineProperty(this,"hinting",{get:function(){return this._hinting?this._hinting:"truetype"===this.outlinesFormat?this._hinting=new rn(this):void 0}})}on.prototype.hasChar=function(t){return null!==this.encoding.charToGlyphIndex(t)},on.prototype.charToGlyphIndex=function(t){return this.encoding.charToGlyphIndex(t)},on.prototype.charToGlyph=function(t){const e=this.charToGlyphIndex(t);let n=this.glyphs.get(e);return n||(n=this.glyphs.get(0)),n},on.prototype.stringToGlyphs=function(t,e){e=e||this.defaultRenderOptions;const n=[];for(let e=0;e<t.length;e+=1){const r=t[e];n.push(this.charToGlyphIndex(r))}let r=n.length;if(e.features){const t=e.script||this.substitution.getDefaultScriptName();let i=[];e.features.liga&&(i=i.concat(this.substitution.getFeature("liga",t,e.language))),e.features.rlig&&(i=i.concat(this.substitution.getFeature("rlig",t,e.language)));for(let t=0;t<r;t+=1)for(let e=0;e<i.length;e++){const o=i[e],a=o.sub,s=a.length;let u=0;for(;u<s&&a[u]===n[t+u];)u++;u===s&&(n.splice(t,s,o.by),r=r-s+1)}}const i=new Array(r),o=this.glyphs.get(0);for(let t=0;t<r;t+=1)i[t]=this.glyphs.get(n[t])||o;return i},on.prototype.nameToGlyphIndex=function(t){return this.glyphNames.nameToGlyphIndex(t)},on.prototype.nameToGlyph=function(t){const e=this.nameToGlyphIndex(t);let n=this.glyphs.get(e);return n||(n=this.glyphs.get(0)),n},on.prototype.glyphIndexToName=function(t){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(t):""},on.prototype.getKerningValue=function(t,e){t=t.index||t,e=e.index||e;const n=this.getGposKerningValue;return n?n(t,e):this.kerningPairs[t+","+e]||0},on.prototype.defaultRenderOptions={kerning:!0,features:{liga:!0,rlig:!0}},on.prototype.forEachGlyph=function(t,e,n,r,i,o){e=void 0!==e?e:0,n=void 0!==n?n:0,r=void 0!==r?r:72,i=i||this.defaultRenderOptions;const a=1/this.unitsPerEm*r,s=this.stringToGlyphs(t,i);for(let t=0;t<s.length;t+=1){const u=s[t];if(o.call(this,u,e,n,r,i),u.advanceWidth&&(e+=u.advanceWidth*a),i.kerning&&t<s.length-1)e+=this.getKerningValue(u,s[t+1])*a;i.letterSpacing?e+=i.letterSpacing*r:i.tracking&&(e+=i.tracking/1e3*r)}return e},on.prototype.getPath=function(t,e,n,r,i){const o=new l;return this.forEachGlyph(t,e,n,r,i,function(t,e,n,r){const a=t.getPath(e,n,r,i,this);o.extend(a)}),o},on.prototype.getPaths=function(t,e,n,r,i){const o=[];return this.forEachGlyph(t,e,n,r,i,function(t,e,n,r){const a=t.getPath(e,n,r,i,this);o.push(a)}),o},on.prototype.getAdvanceWidth=function(t,e,n){return this.forEachGlyph(t,0,0,e,n,function(){})},on.prototype.draw=function(t,e,n,r,i,o){this.getPath(e,n,r,i,o).draw(t)},on.prototype.drawPoints=function(t,e,n,r,i,o){this.forEachGlyph(e,n,r,i,o,function(e,n,r,i){e.drawPoints(t,n,r,i)})},on.prototype.drawMetrics=function(t,e,n,r,i,o){this.forEachGlyph(e,n,r,i,o,function(e,n,r,i){e.drawMetrics(t,n,r,i)})},on.prototype.getEnglishName=function(t){const e=this.names[t];if(e)return e.en},on.prototype.validate=function(){const t=[],e=this;function n(e,n){e||t.push(n)}function r(t){const r=e.getEnglishName(t);n(r&&r.trim().length>0,"No English "+t+" specified.")}r("fontFamily"),r("weightName"),r("manufacturer"),r("copyright"),r("version"),n(this.unitsPerEm>0,"No unitsPerEm specified.")},on.prototype.toTables=function(){return ie.fontToTable(this)},on.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()},on.prototype.toArrayBuffer=function(){const t=this.toTables().encode(),e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let e=0;e<t.length;e++)n[e]=t[e];return e},on.prototype.download=function(t){const e=this.getEnglishName("fontFamily"),r=this.getEnglishName("fontSubfamily");t=t||e.replace(/\s/g,"")+"-"+r+".otf";const i=this.toArrayBuffer();if(Object(pe.c)())window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,window.requestFileSystem(window.TEMPORARY,i.byteLength,function(e){e.root.getFile(t,{create:!0},function(t){t.createWriter(function(e){const n=new DataView(i),r=new Blob([n],{type:"font/opentype"});e.write(r),e.addEventListener("writeend",function(){location.href=t.toURL()},!1)})})},function(t){throw new Error(t.name+": "+t.message)});else{const e=n(186),r=Object(pe.a)(i);e.writeFileSync(t,r)}},on.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512},on.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9},on.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};var an=on;function sn(t,e){const n=JSON.stringify(t);let r=256;for(let t in e){let i=parseInt(t);if(i&&!(i<256)){if(JSON.stringify(e[t])===n)return i;r<=i&&(r=i+1)}}return e[r]=t,r}function un(t,e,n){const r=sn(e.name,n);return[{name:"tag_"+t,type:"TAG",value:e.tag},{name:"minValue_"+t,type:"FIXED",value:e.minValue<<16},{name:"defaultValue_"+t,type:"FIXED",value:e.defaultValue<<16},{name:"maxValue_"+t,type:"FIXED",value:e.maxValue<<16},{name:"flags_"+t,type:"USHORT",value:0},{name:"nameID_"+t,type:"USHORT",value:r}]}function ln(t,e,n){const r={},i=new z.Parser(t,e);return r.tag=i.parseTag(),r.minValue=i.parseFixed(),r.defaultValue=i.parseFixed(),r.maxValue=i.parseFixed(),i.skip("uShort",1),r.name=n[i.parseUShort()]||{},r}function cn(t,e,n,r){const i=[{name:"nameID_"+t,type:"USHORT",value:sn(e.name,r)},{name:"flags_"+t,type:"USHORT",value:0}];for(let r=0;r<n.length;++r){const o=n[r].tag;i.push({name:"axis_"+t+" "+o,type:"FIXED",value:e.coordinates[o]<<16})}return i}function hn(t,e,n,r){const i={},o=new z.Parser(t,e);i.name=r[o.parseUShort()]||{},o.skip("uShort",1),i.coordinates={};for(let t=0;t<n.length;++t)i.coordinates[n[t].tag]=o.parseFixed();return i}var pn={make:function(t,e){const n=new L.Table("fvar",[{name:"version",type:"ULONG",value:65536},{name:"offsetToData",type:"USHORT",value:0},{name:"countSizePairs",type:"USHORT",value:2},{name:"axisCount",type:"USHORT",value:t.axes.length},{name:"axisSize",type:"USHORT",value:20},{name:"instanceCount",type:"USHORT",value:t.instances.length},{name:"instanceSize",type:"USHORT",value:4+4*t.axes.length}]);n.offsetToData=n.sizeOf();for(let r=0;r<t.axes.length;r++)n.fields=n.fields.concat(un(r,t.axes[r],e));for(let r=0;r<t.instances.length;r++)n.fields=n.fields.concat(cn(r,t.instances[r],t.axes,e));return n},parse:function(t,e,n){const r=new z.Parser(t,e),i=r.parseULong();p.argument(65536===i,"Unsupported fvar table version.");const o=r.parseOffset16();r.skip("uShort",1);const a=r.parseUShort(),s=r.parseUShort(),u=r.parseUShort(),l=r.parseUShort(),c=[];for(let r=0;r<a;r++)c.push(ln(t,e+o+r*s,n));const h=[],f=e+o+a*s;for(let e=0;e<u;e++)h.push(hn(t,f+e*l,c,n));return{axes:c,instances:h}}};function fn(t,e){const n=new z.Parser(t,e),r=n.parseUShort(),i=[];for(let t=0;t<r;t++)i[n.parseTag()]={offset:n.parseUShort()};return i}function dn(t,e){const n=new z.Parser(t,e),r=n.parseUShort();if(1===r){const t=n.parseUShort(),e=n.parseUShort(),r=n.parseUShortList(e);return function(e){return r[e-t]||0}}if(2===r){const t=n.parseUShort(),e=[],r=[],i=[];for(let o=0;o<t;o++)e[o]=n.parseUShort(),r[o]=n.parseUShort(),i[o]=n.parseUShort();return function(t){let n=0,o=e.length-1;for(;n<o;){const r=n+o+1>>1;t<e[r]?o=r-1:n=r}return e[n]<=t&&t<=r[n]?i[n]||0:0}}}function mn(t,e){const n=new z.Parser(t,e),r=n.parseUShort(),i=function(t,e){const n=new z.Parser(t,e),r=n.parseUShort();let i=n.parseUShort();if(1===r)return n.parseUShortList(i);if(2===r){const t=[];for(;i--;){const e=n.parseUShort(),r=n.parseUShort();let i=n.parseUShort();for(let n=e;n<=r;n++)t[i++]=n}return t}}(t,e+n.parseUShort()),o=n.parseUShort(),a=n.parseUShort();let s,u;if(4!==o||0!==a)return;const l={};if(1===r){const t=n.parseUShort(),e=[],r=n.parseOffset16List(t);for(let c=0;c<t;c++){const t=r[c];let h=l[t];if(!h){h={},n.relativeOffset=t;let e=n.parseUShort();for(;e--;){const t=n.parseUShort();o&&(s=n.parseShort()),a&&(u=n.parseShort()),h[t]=s}}e[i[c]]=h}return function(t,n){const r=e[t];if(r)return r[n]}}if(2===r){const r=n.parseUShort(),l=n.parseUShort(),c=n.parseUShort(),h=n.parseUShort(),p=dn(t,e+r),f=dn(t,e+l),d=[];for(let t=0;t<c;t++){const e=d[t]=[];for(let t=0;t<h;t++)o&&(s=n.parseShort()),a&&(u=n.parseShort()),e[t]=s}const m={};for(let t=0;t<i.length;t++)m[i[t]]=1;return function(t,e){if(!m[t])return;const n=p(t),r=f(e),i=d[n];return i?i[r]:void 0}}}function gn(t,e){const n=new z.Parser(t,e),r=n.parseUShort(),i=n.parseUShort(),o=16&i,a=n.parseUShort(),s=n.parseOffset16List(a),u={lookupType:r,lookupFlag:i,markFilteringSet:o?n.parseUShort():-1};if(2===r){const n=[];for(let r=0;r<a;r++){const i=mn(t,e+s[r]);i&&n.push(i)}u.getKerningValue=function(t,e){for(let r=n.length;r--;){const i=n[r](t,e);if(void 0!==i)return i}return 0}}return u}var vn={parse:function(t,e,n){const r=new z.Parser(t,e),i=r.parseFixed();p.argument(1===i,"Unsupported GPOS table version."),fn(t,e+r.parseUShort()),fn(t,e+r.parseUShort());const o=r.parseUShort();r.relativeOffset=o;const a=r.parseUShort(),s=r.parseOffset16List(a),u=e+o;for(let e=0;e<a;e++){const r=gn(t,u+s[e]);2!==r.lookupType||n.getGposKerningValue||(n.getGposKerningValue=r.getKerningValue)}}};var yn={parse:function(t,e){const n=new z.Parser(t,e),r=n.parseUShort();if(0===r)return function(t){const e={};t.skip("uShort");const n=t.parseUShort();p.argument(0===n,"Unsupported kern sub-table version."),t.skip("uShort",2);const r=t.parseUShort();t.skip("uShort",3);for(let n=0;n<r;n+=1){const n=t.parseUShort(),r=t.parseUShort(),i=t.parseShort();e[n+","+r]=i}return e}(n);if(1===r)return function(t){const e={};t.skip("uShort"),t.parseULong()>1&&console.warn("Only the first kern subtable is supported."),t.skip("uLong");const n=255&t.parseUShort();if(t.skip("uShort"),0===n){const n=t.parseUShort();t.skip("uShort",3);for(let r=0;r<n;r+=1){const n=t.parseUShort(),r=t.parseUShort(),i=t.parseShort();e[n+","+r]=i}}return e}(n);throw new Error("Unsupported kern table version ("+r+").")}};var bn={parse:function(t,e,n,r){const i=new z.Parser(t,e),o=r?i.parseUShort:i.parseULong,a=[];for(let t=0;t<n+1;t+=1){let t=o.call(i);r&&(t*=2),a.push(t)}return a}};function _n(t,e){n(186).readFile(t,function(t,n){if(t)return e(t.message);e(null,Object(pe.d)(n))})}function xn(t,e){const n=new XMLHttpRequest;n.open("get",t,!0),n.responseType="arraybuffer",n.onload=function(){return 200!==n.status?e("Font could not be loaded: "+n.statusText):e(null,n.response)},n.onerror=function(){e("Font could not be loaded")},n.send()}function wn(t,e){const n=[];let r=12;for(let i=0;i<e;i+=1){const e=z.getTag(t,r),i=z.getULong(t,r+4),o=z.getULong(t,r+8),a=z.getULong(t,r+12);n.push({tag:e,checksum:i,offset:o,length:a,compression:!1}),r+=16}return n}function En(t,e){if("WOFF"===e.compression){const n=new Uint8Array(t.buffer,e.offset+2,e.compressedLength-2),r=new Uint8Array(e.length);if(i()(n,r),r.byteLength!==e.length)throw new Error("Decompression error: "+e.tag+" decompressed length doesn't match recorded length");return{data:new DataView(r.buffer,0),offset:0}}return{data:t,offset:e.offset}}function Sn(t){let e,n;const r=new an({empty:!0}),i=new DataView(t,0);let o,a=[];const s=z.getTag(i,0);if(s===String.fromCharCode(0,1,0,0)||"true"===s||"typ1"===s)r.outlinesFormat="truetype",a=wn(i,o=z.getUShort(i,4));else if("OTTO"===s)r.outlinesFormat="cff",a=wn(i,o=z.getUShort(i,4));else{if("wOFF"!==s)throw new Error("Unsupported OpenType signature "+s);{const t=z.getTag(i,4);if(t===String.fromCharCode(0,1,0,0))r.outlinesFormat="truetype";else{if("OTTO"!==t)throw new Error("Unsupported OpenType flavor "+s);r.outlinesFormat="cff"}a=function(t,e){const n=[];let r=44;for(let i=0;i<e;i+=1){const e=z.getTag(t,r),i=z.getULong(t,r+4),o=z.getULong(t,r+8),a=z.getULong(t,r+12);let s;s=o<a&&"WOFF",n.push({tag:e,offset:i,compression:s,compressedLength:o,length:a}),r+=20}return n}(i,o=z.getUShort(i,12))}}let u,l,c,h,p,f,d,m,g,v,y;for(let t=0;t<o;t+=1){const o=a[t];let s;switch(o.tag){case"cmap":s=En(i,o),r.tables.cmap=G.parse(s.data,s.offset),r.encoding=new Y(r.tables.cmap);break;case"cvt ":s=En(i,o),y=new z.Parser(s.data,s.offset),r.tables.cvt=y.parseShortList(o.length/2);break;case"fvar":l=o;break;case"fpgm":s=En(i,o),y=new z.Parser(s.data,s.offset),r.tables.fpgm=y.parseByteList(o.length);break;case"head":s=En(i,o),r.tables.head=At.parse(s.data,s.offset),r.unitsPerEm=r.tables.head.unitsPerEm,e=r.tables.head.indexToLocFormat;break;case"hhea":s=En(i,o),r.tables.hhea=Mt.parse(s.data,s.offset),r.ascender=r.tables.hhea.ascender,r.descender=r.tables.hhea.descender,r.numberOfHMetrics=r.tables.hhea.numberOfHMetrics;break;case"hmtx":f=o;break;case"ltag":s=En(i,o),n=kt.parse(s.data,s.offset);break;case"maxp":s=En(i,o),r.tables.maxp=Pt.parse(s.data,s.offset),r.numGlyphs=r.tables.maxp.numGlyphs;break;case"name":g=o;break;case"OS/2":s=En(i,o),r.tables.os2=qt.parse(s.data,s.offset);break;case"post":s=En(i,o),r.tables.post=Xt.parse(s.data,s.offset),r.glyphNames=new Z(r.tables.post);break;case"prep":s=En(i,o),y=new z.Parser(s.data,s.offset),r.tables.prep=y.parseByteList(o.length);break;case"glyf":c=o;break;case"loca":m=o;break;case"CFF ":u=o;break;case"kern":d=o;break;case"GPOS":h=o;break;case"GSUB":p=o;break;case"meta":v=o}}const b=En(i,g);if(r.tables.name=Vt.parse(b.data,b.offset,n),r.names=r.tables.name,c&&m){const t=0===e,n=En(i,m),o=bn.parse(n.data,n.offset,r.numGlyphs,t),a=En(i,c);r.glyphs=rt.parse(a.data,a.offset,o,r)}else{if(!u)throw new Error("Font doesn't contain TrueType or CFF outlines.");{const t=En(i,u);Ot.parse(t.data,t.offset,r)}}const _=En(i,f);if(Ct.parse(_.data,_.offset,r.numberOfHMetrics,r.numGlyphs,r.glyphs),function(t){let e;const n=t.tables.cmap.glyphIndexMap,r=Object.keys(n);for(let i=0;i<r.length;i+=1){const o=r[i],a=n[o];(e=t.glyphs.get(a)).addUnicode(parseInt(o))}for(let n=0;n<t.glyphs.length;n+=1)e=t.glyphs.get(n),t.cffEncoding?t.isCIDFont?e.name="gid"+n:e.name=t.cffEncoding.charset[n]:t.glyphNames.names&&(e.name=t.glyphNames.glyphIndexToName(n))}(r),d){const t=En(i,d);r.kerningPairs=yn.parse(t.data,t.offset)}else r.kerningPairs={};if(h){const t=En(i,h);vn.parse(t.data,t.offset,r)}if(p){const t=En(i,p);r.tables.gsub=Jt.parse(t.data,t.offset)}if(l){const t=En(i,l);r.tables.fvar=pn.parse(t.data,t.offset,r.names)}if(v){const t=En(i,v);r.tables.meta=Kt.parse(t.data,t.offset),r.metas=r.tables.meta}return r}function Tn(t,e){("undefined"==typeof window?_n:xn)(t,function(t,n){if(t)return e(t);let r;try{r=Sn(n)}catch(t){return e(t,null)}return e(null,r)})}function On(t){const e=n(186).readFileSync(t);return Sn(Object(pe.d)(e))}n.d(e,"parse",function(){return Sn}),n.d(e,"load",function(){return Tn}),n.d(e,"loadSync",function(){return On}),n.d(e,"Font",function(){return an}),n.d(e,"Glyph",function(){return ot}),n.d(e,"Path",function(){return l}),n.d(e,"BoundingBox",function(){return s}),n.d(e,"_parse",function(){return z})},function(t,e){var n=0,r=-3;function i(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}var o=new i,a=new i,s=new Uint8Array(30),u=new Uint16Array(30),l=new Uint8Array(30),c=new Uint16Array(30),h=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),p=new i,f=new Uint8Array(320);function d(t,e,n,r){var i,o;for(i=0;i<n;++i)t[i]=0;for(i=0;i<30-n;++i)t[i+n]=i/n|0;for(o=r,i=0;i<30;++i)e[i]=o,o+=1<<t[i]}var m=new Uint16Array(16);function g(t,e,n,r){var i,o;for(i=0;i<16;++i)t.table[i]=0;for(i=0;i<r;++i)t.table[e[n+i]]++;for(t.table[0]=0,o=0,i=0;i<16;++i)m[i]=o,o+=t.table[i];for(i=0;i<r;++i)e[n+i]&&(t.trans[m[e[n+i]]++]=i)}function v(t){t.bitcount--||(t.tag=t.source[t.sourceIndex++],t.bitcount=7);var e=1&t.tag;return t.tag>>>=1,e}function y(t,e,n){if(!e)return n;for(;t.bitcount<24;)t.tag|=t.source[t.sourceIndex++]<<t.bitcount,t.bitcount+=8;var r=t.tag&65535>>>16-e;return t.tag>>>=e,t.bitcount-=e,r+n}function b(t,e){for(;t.bitcount<24;)t.tag|=t.source[t.sourceIndex++]<<t.bitcount,t.bitcount+=8;var n=0,r=0,i=0,o=t.tag;do{r=2*r+(1&o),o>>>=1,++i,n+=e.table[i],r-=e.table[i]}while(r>=0);return t.tag=o,t.bitcount-=i,e.trans[n+r]}function _(t,e,n){var r,i,o,a,s,u;for(r=y(t,5,257),i=y(t,5,1),o=y(t,4,4),a=0;a<19;++a)f[a]=0;for(a=0;a<o;++a){var l=y(t,3,0);f[h[a]]=l}for(g(p,f,0,19),s=0;s<r+i;){var c=b(t,p);switch(c){case 16:var d=f[s-1];for(u=y(t,2,3);u;--u)f[s++]=d;break;case 17:for(u=y(t,3,3);u;--u)f[s++]=0;break;case 18:for(u=y(t,7,11);u;--u)f[s++]=0;break;default:f[s++]=c}}g(e,f,0,r),g(n,f,r,i)}function x(t,e,r){for(;;){var i,o,a,h,p=b(t,e);if(256===p)return n;if(p<256)t.dest[t.destLen++]=p;else for(i=y(t,s[p-=257],u[p]),o=b(t,r),h=a=t.destLen-y(t,l[o],c[o]);h<a+i;++h)t.dest[t.destLen++]=t.dest[h]}}function w(t){for(var e,i;t.bitcount>8;)t.sourceIndex--,t.bitcount-=8;if((e=256*(e=t.source[t.sourceIndex+1])+t.source[t.sourceIndex])!==(65535&~(256*t.source[t.sourceIndex+3]+t.source[t.sourceIndex+2])))return r;for(t.sourceIndex+=4,i=e;i;--i)t.dest[t.destLen++]=t.source[t.sourceIndex++];return t.bitcount=0,n}!function(t,e){var n;for(n=0;n<7;++n)t.table[n]=0;for(t.table[7]=24,t.table[8]=152,t.table[9]=112,n=0;n<24;++n)t.trans[n]=256+n;for(n=0;n<144;++n)t.trans[24+n]=n;for(n=0;n<8;++n)t.trans[168+n]=280+n;for(n=0;n<112;++n)t.trans[176+n]=144+n;for(n=0;n<5;++n)e.table[n]=0;for(e.table[5]=32,n=0;n<32;++n)e.trans[n]=n}(o,a),d(s,u,4,3),d(l,c,2,1),s[28]=0,u[28]=258,t.exports=function(t,e){var s,u,l=new function(t,e){this.source=t,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=e,this.destLen=0,this.ltree=new i,this.dtree=new i}(t,e);do{switch(s=v(l),y(l,2,0)){case 0:u=w(l);break;case 1:u=x(l,o,a);break;case 2:_(l,l.ltree,l.dtree),u=x(l,l.ltree,l.dtree);break;default:u=r}if(u!==n)throw new Error("Data error")}while(!s);return l.destLen<l.dest.length?"function"==typeof l.dest.slice?l.dest.slice(0,l.destLen):l.dest.subarray(0,l.destLen):l.dest}},function(t,e,n){"use strict";(function(t){var r=n(690),i=n(691),o=n(692);function a(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,e){if(a()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return h(this,t)}return l(this,t,e,n)}function l(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=p(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|d(e,n),i=(t=s(t,r)).write(e,n);i!==r&&(t=t.slice(0,i));return t}(t,e,n):function(t,e){if(u.isBuffer(e)){var n=0|f(e.length);return 0===(t=s(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?s(t,0):p(t,e);if("Buffer"===e.type&&o(e.data))return p(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function h(t,e){if(c(e),t=s(t,e<0?0:0|f(e)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function p(t,e){var n=e.length<0?0:0|f(e.length);t=s(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function f(t){if(t>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|t}function d(t,e){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return N(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return j(t).length;default:if(r)return N(t).length;e=(""+e).toLowerCase(),r=!0}}function m(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function g(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=u.from(e,r)),u.isBuffer(e))return 0===e.length?-1:v(t,e,n,r,i);if("number"==typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):v(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function v(t,e,n,r,i){var o,a=1,s=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;a=2,s/=2,u/=2,n/=2}function l(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(i){var c=-1;for(o=n;o<s;o++)if(l(t,o)===l(e,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===u)return c*a}else-1!==c&&(o-=o-c),c=-1}else for(n+u>s&&(n=s-u),o=n;o>=0;o--){for(var h=!0,p=0;p<u;p++)if(l(t,o+p)!==l(e,p)){h=!1;break}if(h)return o}return-1}function y(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))return a;t[n+a]=s}return a}function b(t,e,n,r){return U(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function _(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function x(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,a,s,u,l=t[i],c=null,h=l>239?4:l>223?3:l>191?2:1;if(i+h<=n)switch(h){case 1:l<128&&(c=l);break;case 2:128==(192&(o=t[i+1]))&&(u=(31&l)<<6|63&o)>127&&(c=u);break;case 3:o=t[i+1],a=t[i+2],128==(192&o)&&128==(192&a)&&(u=(15&l)<<12|(63&o)<<6|63&a)>2047&&(u<55296||u>57343)&&(c=u);break;case 4:o=t[i+1],a=t[i+2],s=t[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(u=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(c=u)}null===c?(c=65533,h=1):c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),i+=h}return function(t){var e=t.length;if(e<=w)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=w));return n}(r)}e.Buffer=u,e.SlowBuffer=function(t){+t!=t&&(t=0);return u.alloc(+t)},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=a(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,n){return l(null,t,e,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,e,n){return r=null,o=e,a=n,c(i=t),i<=0?s(r,i):void 0!==o?"string"==typeof a?s(r,i).fill(o,a):s(r,i).fill(o):s(r,i);var r,i,o,a},u.allocUnsafe=function(t){return h(null,t)},u.allocUnsafeSlow=function(t){return h(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=u.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var a=t[n];if(!u.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},u.byteLength=d,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)m(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)m(this,e,e+3),m(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)m(this,e,e+7),m(this,e+1,e+6),m(this,e+2,e+5),m(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?x(this,0,t):function(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return T(this,e,n);case"utf8":case"utf-8":return x(this,e,n);case"ascii":return E(this,e,n);case"latin1":case"binary":return S(this,e,n);case"base64":return _(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,n,r,i){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,r>>>=0,i>>>=0,this===t)return 0;for(var o=i-r,a=n-e,s=Math.min(o,a),l=this.slice(r,i),c=t.slice(e,n),h=0;h<s;++h)if(l[h]!==c[h]){o=l[h],a=c[h];break}return o<a?-1:a<o?1:0},u.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},u.prototype.indexOf=function(t,e,n){return g(this,t,e,n,!0)},u.prototype.lastIndexOf=function(t,e,n){return g(this,t,e,n,!1)},u.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o,a,s,u,l,c,h,p,f,d=!1;;)switch(r){case"hex":return y(this,t,e,n);case"utf8":case"utf-8":return p=e,f=n,U(N(t,(h=this).length-p),h,p,f);case"ascii":return b(this,t,e,n);case"latin1":case"binary":return b(this,t,e,n);case"base64":return u=this,l=e,c=n,U(j(t),u,l,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return a=e,s=n,U(function(t,e){for(var n,r,i,o=[],a=0;a<t.length&&!((e-=2)<0);++a)n=t.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,(o=this).length-a),o,a,s);default:if(d)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),d=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var w=4096;function E(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function S(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function T(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=D(t[o]);return i}function O(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function A(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function M(t,e,n,r,i,o){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function C(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function k(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function P(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function R(t,e,n,r,o){return o||P(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function L(t,e,n,r,o){return o||P(t,0,n,8),i.write(t,e,n,r,52,8),n+8}u.prototype.slice=function(t,e){var n,r=this.length;if(t=~~t,e=void 0===e?r:~~e,t<0?(t+=r)<0&&(t=0):t>r&&(t=r),e<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=u.prototype;else{var i=e-t;n=new u(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+t]}return n},u.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||A(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},u.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||A(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},u.prototype.readUInt8=function(t,e){return e||A(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||A(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||A(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||A(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||A(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||A(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},u.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||A(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},u.prototype.readInt8=function(t,e){return e||A(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){e||A(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(t,e){e||A(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(t,e){return e||A(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||A(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||A(t,4,this.length),i.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||A(t,4,this.length),i.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||A(t,8,this.length),i.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||A(t,8,this.length),i.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||M(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},u.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||M(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},u.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):C(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):C(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):k(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):k(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);M(this,t,e,n,i-1,-i)}var o=0,a=1,s=0;for(this[e]=255&t;++o<n&&(a*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},u.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);M(this,t,e,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[e+o]=255&t;--o>=0&&(a*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},u.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):C(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):C(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):k(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||M(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):k(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,n){return R(this,t,e,!0,n)},u.prototype.writeFloatBE=function(t,e,n){return R(this,t,e,!1,n)},u.prototype.writeDoubleLE=function(t,e,n){return L(this,t,e,!0,n)},u.prototype.writeDoubleBE=function(t,e,n){return L(this,t,e,!1,n)},u.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,o=r-n;if(this===t&&n<e&&e<r)for(i=o-1;i>=0;--i)t[i+e]=this[i+n];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},u.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var a=u.isBuffer(t)?t:N(new u(t,r).toString()),s=a.length;for(o=0;o<n-e;++o)this[o+e]=a[o%s]}return this};var I=/[^+\/0-9A-Za-z-_]/g;function D(t){return t<16?"0"+t.toString(16):t.toString(16)}function N(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],a=0;a<r;++a){if((n=t.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function j(t){return r.toByteArray(function(t){var e;if((t=(e=t,e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")).replace(I,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function U(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(e,n(78))},function(t,e,n){"use strict";e.byteLength=function(t){return 3*t.length/4-l(t)},e.toByteArray=function(t){var e,n,r,a,s,u=t.length;a=l(t),s=new o(3*u/4-a),n=a>0?u-4:u;var c=0;for(e=0;e<n;e+=4)r=i[t.charCodeAt(e)]<<18|i[t.charCodeAt(e+1)]<<12|i[t.charCodeAt(e+2)]<<6|i[t.charCodeAt(e+3)],s[c++]=r>>16&255,s[c++]=r>>8&255,s[c++]=255&r;2===a?(r=i[t.charCodeAt(e)]<<2|i[t.charCodeAt(e+1)]>>4,s[c++]=255&r):1===a&&(r=i[t.charCodeAt(e)]<<10|i[t.charCodeAt(e+1)]<<4|i[t.charCodeAt(e+2)]>>2,s[c++]=r>>8&255,s[c++]=255&r);return s},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,o="",a=[],s=0,u=n-i;s<u;s+=16383)a.push(c(t,s,s+16383>u?u:s+16383));1===i?(e=t[n-1],o+=r[e>>2],o+=r[e<<4&63],o+="=="):2===i&&(e=(t[n-2]<<8)+t[n-1],o+=r[e>>10],o+=r[e>>4&63],o+=r[e<<2&63],o+="=");return a.push(o),a.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,u=a.length;s<u;++s)r[s]=a[s],i[a.charCodeAt(s)]=s;function l(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===t[e-2]?2:"="===t[e-1]?1:0}function c(t,e,n){for(var i,o,a=[],s=e;s<n;s+=3)i=(t[s]<<16)+(t[s+1]<<8)+t[s+2],a.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,l=u>>1,c=-7,h=n?i-1:0,p=n?-1:1,f=t[e+h];for(h+=p,o=f&(1<<-c)-1,f>>=-c,c+=s;c>0;o=256*o+t[e+h],h+=p,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=r;c>0;a=256*a+t[e+h],h+=p,c-=8);if(0===o)o=1-l;else{if(o===u)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,r),o-=l}return(f?-1:1)*a*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var a,s,u,l=8*o-i-1,c=(1<<l)-1,h=c>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,d=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),(e+=a+h>=1?p/u:p*Math.pow(2,1-h))*u>=2&&(a++,u/=2),a+h>=c?(s=0,a=c):a+h>=1?(s=(e*u-1)*Math.pow(2,i),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;t[n+f]=255&s,f+=d,s/=256,i-=8);for(a=a<<i|s,l+=i;l>0;t[n+f]=255&a,f+=d,a/=256,l-=8);t[n+f-d]|=128*m}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){"use strict";var r,i,o,a,s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};a=function(t){var e="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(t){return void 0===t?"undefined":s(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":s(t)};function n(t,e,n){return void 0!==t&&e in t?t[e]:n}function r(t){var e=void 0;return function(){if(void 0===e){for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];e=new(Function.prototype.bind.apply(t,[null].concat(r)))}return e}}function i(){return null}function o(t){return t&&"object"===(void 0===t?"undefined":e(t))&&!Array.isArray(t)&&null!==t}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var u=function(){function t(e){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.renderer=n(e,"renderer",void 0),this.arrayBuffer=n(e,"arrayBuffer",void 0),this.decodedCallback=n(e,"decodedCallback",void 0),this.arrayBuffer&&this.renderer.audioContext.decodeAudioData(this.arrayBuffer,function(t){r.buffer=t,r.decodedCallback()})}return a(t,[{key:"getInternalAudioBuffer",value:function(){return this.buffer}}]),t}(),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._context=n(e,"context",null),this._name="unnamed",this._id=Date.now()+"_"+Math.floor(1e6*Math.random())}return l(t,[{key:"setContext",value:function(t){this._context=t}},{key:"getContext",value:function(){return this._context}},{key:"setName",value:function(t){this._name=t}},{key:"getName",value:function(){return this._name}},{key:"getID",value:function(){return this._id}}]),t}(),h=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var p=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._scope=n(e,"scope",this),this.listeners={}}return h(t,[{key:"on",value:function(t,e){return void 0===this.listeners[t]&&(this.listeners[t]=[]),this.listeners[t].push(e),this}},{key:"off",value:function(t,e){var n=void 0;if(this.listeners[t]instanceof Array)if(void 0===e)this.listeners[t]=[];else for(var r=0,i=(n=this.listeners[t]).length;r<i;r++)if(n[r]===e){n.splice(r,1);break}return this}},{key:"trigger",value:function(t){for(var e=this,n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return this.listeners[t]instanceof Array&&this.listeners[t].forEach(function(t){t.call.apply(t,[e._scope].concat(r))}),this}}]),t}(),f=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var d=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._active=!1,n._setupDone=!1,n.events=new p({scope:n}),n._nexts=[],n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,c),f(e,[{key:"setup",value:function(){this._setupDone||(this._setupDone=!0)}},{key:"preLoad",value:function(){}},{key:"on",value:function(){this._active=!0}},{key:"off",value:function(){this._active=!1}},{key:"byPass",value:function(){}},{key:"getStatus",value:function(){return this._active}},{key:"preUpdate",value:function(){}},{key:"update",value:function(){}},{key:"postUpdate",value:function(){}},{key:"chain",value:function(t){this._nexts.push(t)}},{key:"getChainedComponents",value:function(){return this._nexts}}]),e}(),m=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),g=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};var v=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.renderer=n(t,"renderer",void 0),void 0!==r.renderer.audioContext&&(r.panner=r.renderer.audioContext.createPanner(),r.panner.panningModel="HRTF",r.panner.distanceModel="exponential",r.panner.refDistance=10,r.panner.maxDistance=1e4,r.panner.rolloffFactor=1,r.panner.coneInnerAngle=360,r.panner.coneOuterAngle=0,r.panner.coneOuterGain=0),r.is3D=!1,r.loop=!1,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,d),m(e,[{key:"setRefDistance",value:function(t){this.panner.refDistance=t}},{key:"setMaxDistance",value:function(t){this.panner.maxDistance=t}},{key:"setBuffer",value:function(t){this.buffer=t}},{key:"set3D",value:function(t){this.is3D=t}},{key:"setTransform",value:function(t){this.transform=t}},{key:"setLoop",value:function(t){this.loop=t}},{key:"update",value:function(){if(void 0!==this.transform){var t=this.transform.getLocalPosition();this.panner.setPosition(t.x,t.y,t.z)}}},{key:"on",value:function(){g(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"on",this).call(this),this.play()}},{key:"off",value:function(){g(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"off",this).call(this),this.stop()}},{key:"play",value:function(){void 0!==this.renderer.audioContext&&(void 0!==this.source&&this.stop(),this.source=this.renderer.audioContext.createBufferSource(),this.is3D?(this.source.connect(this.panner),this.panner.connect(this.renderer.audioContext.destination)):this.source.connect(this.renderer.audioContext.destination),this.source.buffer=this.buffer.buffer),void 0!==this.source&&(this.playing=!0,this.loop&&(this.source.loop=!0),this.source.start(0))}},{key:"pause",value:function(){void 0!==this.source&&(this.playing=!1)}},{key:"stop",value:function(){void 0!==this.source&&(this.source.stop(0),this.source=void 0,this.playing=!1)}}]),e}(),y=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var b=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,THREE.Color),y(e,[{key:"setTo",value:function(t){return this.r=t,this.g=t,this.b=t,this}},{key:"setRGB32",value:function(t,e,n){this.r=t/255,this.g=e/255,this.b=n/255}},{key:"makeRGBAStringWithAlpha",value:function(t){return"rgba("+Math.floor(255*this.r)+","+Math.floor(255*this.g)+","+Math.floor(255*this.b)+","+t+")"}},{key:"copy",value:function(){(function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"copy",this).call(this)}}],[{key:"Create",value:function(t,n,r){return new e(t,n,r)}},{key:"random",value:function(){return new e(Math.random(),Math.random(),Math.random())}}]),e}();b.green=new b(0,1,0),b.blue=new b(0,0,1),b.red=new b(1,0,0),b.white=new b(1,1,1),b.darkGray=new b(.3,.3,.3),b.gray=new b(.5,.5,.5),b.lightGray=new b(.8,.8,.8),b.black=new b(0,0,0),b.cyan=new b(0,1,1),b.magenta=new b(1,0,1),b.yellow=new b(1,1,0),b.lightRed=new b(1,.5,.5),b.lightGreen=new b(.5,1,.5),b.lightBlue=new b(.5,.5,1),b.mobilizing=new b(60/255,30/255,1),b.mobilizingDark=new b(36/255,18/255,.6),b.mobilizingLight=new b(208/255,202/255,247/255),b.mobilizingAlternate=new b(1,158/255,116/255),b.transparent=new b((new b).makeRGBAStringWithAlpha(0));var _=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,THREE.Euler),e}();var x=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,THREE.Matrix3),e}();var w=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,THREE.Matrix4),e}();var E=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,THREE.Quaternion),e}(),S=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var T=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e,this.y=n,this.width=r,this.height=i}return S(t,[{key:"toArray",value:function(){return[this.x,this.y,this.width,this.height]}},{key:"fromArray",value:function(t){this.x=t[0],this.y=t[1],this.width=t[2],this.height=t[3]}}]),t}(),O=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var A=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,THREE.Vector2),O(e,[{key:"rotate90CW",value:function(){var t=this.x,e=this.y;this.x=e,this.y=-t}},{key:"rotate90CCW",value:function(){var t=this.x,e=this.y;this.x=-e,this.y=t}}]),e}();A.one=new A(1,1),A.zero=new A(0,0);var M=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,THREE.Vector3),e}();M.one=new M(1,1,1),M.zero=new M(0,0,0);var C=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var k=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return C(t,null,[{key:"randomFromTo",value:function(t,e){return Math.random()*(e-t)+t}},{key:"map",value:function(t,e,n,r,i){return r+(i-r)*(t-e)/(n-e)}},{key:"degToRad",value:function(t){return t*(Math.PI/180)}},{key:"radToDeg",value:function(t){return t*(180/Math.PI)}},{key:"dist",value:function(t,e,n,r){return Math.sqrt((n-t)*(n-t)+(r-e)*(r-e))}},{key:"lerp",value:function(t,e,n){return t+(e-t)*n}},{key:"clamp",value:function(t,e,n){return Math.min(n,Math.max(e,t))}},{key:"pointIsInside",value:function(t,e,n){var r=void 0,i=n.length-1,o=!1;for(r=0;r<n.length;r++)(n[r].y<e&&n[i].y>=e||n[i].y<e&&n[r].y>=e)&&n[r].x+(e-n[r].y)/(n[i].y-n[r].y)*(n[i].x-n[r].x)<t&&(o=!o),i=r;return o}},{key:"intersectionPoint",value:function(t,e){var n=t[1].x-t[0].x,r=e[0].x-e[1].x,i=e[0].x-t[0].x,o=t[1].y-t[0].y,a=e[0].y-e[1].y,s=e[0].y-t[0].y,u=void 0;return u=r*s==0&&a*i==0&&o*r==0&&n*a==0?0:(r*s-a*i)/(o*r-n*a),{x:t[0].x+u*(t[1].x-t[0].x),y:t[0].y+u*(t[1].y-t[0].y)}}}]),t}(),P=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var R=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r._startTime=n(t,"startTime",(new Date).getTime()),r._timeScale=n(t,"scale",1),r._currentTime=(new Date).getTime(),r._deltaTime=0,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,d),P(e,[{key:"on",value:function(){(function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"on",this).call(this),this.reset()}},{key:"reset",value:function(){this._startTime=(new Date).getTime()}},{key:"update",value:function(){if(this.getStatus()){var t=this._currentTime;this._currentTime=(new Date).getTime(),this._deltaTime=(this._currentTime-t)/1e3*this._timeScale}}},{key:"getAbsoluteDelta",value:function(){return this._currentTime-this._startTime}},{key:"setTimeScale",value:function(t){this._timeScale=t}},{key:"getTimeScale",value:function(){return this._timeScale}},{key:"getDelta",value:function(){return this._deltaTime}},{key:"getTime",value:function(){return this._currentTime}}]),e}(),L=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var I="start",D="update",N="restart",j="stop",U="resume",F="finish",B=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));r._target=t.target,r._from=n(t,"from",null),r._to=t.to,r._duration=t.duration,r._easing=n(t,"easing",e.Easing.linear),r._repeat=n(t,"repeat",0),r._yoyo=n(t,"yoyo",!1),r._delay=n(t,"delay",0),r._time=new R,r._timesPlayed=0,r._direction=1;var i=n(t,"onStart",null),o=n(t,"onUpdate",null),a=n(t,"onRestart",null),u=n(t,"onStop",null),l=n(t,"onResume",null),c=n(t,"onFinish",null);return i&&r.events.on(I,i),o&&r.events.on(D,o),a&&r.events.on(N,a),u&&r.events.on(j,u),l&&r.events.on(U,l),c&&r.events.on(F,c),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,d),L(e,[{key:"setup",value:function(){this.getContext().addComponent(this._time),this._time.setup(),this._time.on(),this._isPlaying=!1}},{key:"play",value:function(){var t=this;this._isPlaying=!0,this._time.reset(),this._from||(this._from={},Object.keys(this._to).forEach(function(e){t._from[e]=t._target[e]})),this.events.trigger(I,this._target)}},{key:"stop",value:function(){this._isPlaying=!1,this.events.trigger(j,this._target)}},{key:"resume",value:function(){}},{key:"rewind",value:function(){this.update(0)}},{key:"update",value:function(t){var e=this;if(this._isPlaying){var n=(void 0!==t?t:this._time.getAbsoluteDelta())/this._duration;if(n>=1)Object.keys(this._from).forEach(function(t){e._target[t]=e._to[t]}),this._timesPlayed++<this._repeat?(this._yoyo&&(this._direction*=-1),this._time.reset(),this.events.trigger(N,this._target,this._direction)):(this._isPlaying=!1,this.events.trigger(F,this._target));else{for(var r in this._from)this._direction<1?this._target[r]=k.map(this._easing(n),0,1,this._to[r],this._from[r]):this._target[r]=k.map(this._easing(n),0,1,this._from[r],this._to[r]);this.events.trigger(D,this._target)}}}},{key:"chain",value:function(t){this.events.on(F,function(){t.play()})}}]),e}();B.Easing={linear:function(t){return t},easeInQuad:function(t){return Math.pow(t,2)},easeOutQuad:function(t){return 1-Math.abs(Math.pow(t-1,2))},easeInOutQuad:function(t){return t<.5?B.Easing.easeInQuad(2*t)/2:B.Easing.easeOutQuad(2*t-1)/2+.5},easeInCubic:function(t){return Math.pow(t,3)},easeOutCubic:function(t){return 1-Math.abs(Math.pow(t-1,3))},easeInOutCubic:function(t){return t<.5?B.Easing.easeInCubic(2*t)/2:B.Easing.easeOutCubic(2*t-1)/2+.5},easeInQuart:function(t){return Math.pow(t,4)},easeOutQuart:function(t){return 1-Math.abs(Math.pow(t-1,4))},easeInOutQuart:function(t){return t<.5?B.Easing.easeInQuart(2*t)/2:B.Easing.easeOutQuart(2*t-1)/2+.5},easeInQuint:function(t){return Math.pow(t,5)},easeOutQuint:function(t){return 1-Math.abs(Math.pow(t-1,5))},easeInOutQuint:function(t){return t<.5?B.Easing.easeInQuint(2*t)/2:B.Easing.easeOutQuint(2*t-1)/2+.5},easeInSin:function(t){return 1+Math.sin(Math.PI/2*t-Math.PI/2)},easeOutSin:function(t){return Math.sin(Math.PI/2*t)},easeInOutSin:function(t){return(1+Math.sin(Math.PI*t-Math.PI/2))/2},easeInElastic:function(t){return(.04-.04/t)*Math.sin(25*t)+1},easeOutElastic:function(t){return.04*t/--t*Math.sin(25*t)},easeInOutElastic:function(t){return(t-=.5)<0?(.01+.01/t)*Math.sin(50*t):(.02-.01/t)*Math.sin(50*t)+1},easeInBounce:function(t){return 1-B.Easing.easeOutBounce(1-t)},easeOutBounce:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:function(t){return t<.5?.5*B.Easing.easeInBounce(2*t):.5*B.Easing.easeOutBounce(2*t-1)+.5}};var z=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var G=function(){function t(e){switch(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e.type=n(e,"type","default"),this.texture=void 0,e.type){case"basic":this._material=new THREE.MeshBasicMaterial({color:16777215,wireframe:!1});break;case"custom":this._material=new THREE.ShaderMaterial({fragmentShader:e.fragmentShader,vertexShader:e.vertexShader,uniforms:e.uniforms});break;case"projectionmapping":var r=THREE.ShaderLib.cube,i=THREE.UniformsUtils.clone(r.uniforms);r.vertexShader=r.vertexShader.replace("vWorldPosition = transformDirection( position, modelMatrix );","vWorldPosition = (modelMatrix * vec4( position, 0.0 )).xyz;"),r.fragmentShader=r.fragmentShader.replace("gl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );","vec3 viewDir = vWorldPosition-viewPosition;  gl_FragColor = textureCube( tCube, normalize(viewDir));"),r.fragmentShader=r.fragmentShader.replace("uniform samplerCube tCube;","uniform samplerCube tCube; uniform vec3 viewPosition;"),i.viewPosition={type:"v3",value:new THREE.Vector3(0,0,0)},this._material=new THREE.ShaderMaterial({fragmentShader:r.fragmentShader,vertexShader:r.vertexShader,uniforms:i});break;case"lambert":this._material=new THREE.MeshLambertMaterial({color:16777215,wireframe:!1,shading:THREE.FlatShading});break;case"default":case"phong":this._material=new THREE.MeshPhongMaterial({color:16777215}),this._material.shading=THREE.SmoothShading;break;case"line":this._material=new THREE.LineBasicMaterial({color:16777215});break;case"sprite":this._material=new THREE.SpriteMaterial({color:16777215});break;default:this._material=new THREE.MeshBasicMaterial({color:16777215,wireframe:!1})}this._material.side=THREE.DoubleSide,this.type=e.type}return z(t,[{key:"setTexture",value:function(t){this.texture=t,void 0!==this.texture._texture?this._material.map=this.texture._texture:void 0!==t.cube&&("projectionmapping"===this.type?this._material.uniforms.tCube.value=t.cube:this._material.envMap=t.cube)}},{key:"getTexture",value:function(){return this.texture}},{key:"setUniform",value:function(t,e){this._material.uniforms[t].value=e}},{key:"setTransparent",value:function(t){this._material.transparent=t}},{key:"getTransparent",value:function(){return this._material.transparent}},{key:"setColor",value:function(t){this._material.color=t}},{key:"getColor",value:function(){return this._material.color}},{key:"setWireframe",value:function(t){this._material.wireframe=t}},{key:"getWireframe",value:function(){return this._material.wireframe}},{key:"setOpacity",value:function(t){this._material.opacity=t}},{key:"getOpacity",value:function(){return this._material.opacity}},{key:"setDoubleSided",value:function(t){this._material.side=t?THREE.DoubleSide:THREE.FrontSide}},{key:"getDoubleSided",value:function(){return this._material.side===THREE.DoubleSide}},{key:"setAlphaTest",value:function(t){this._material.alphaTest=t}},{key:"getAlphaTest",value:function(){return this._material.alphaTest}},{key:"setDepthWrite",value:function(t){this._material.depthWrite=t}},{key:"setDepthTest",value:function(t){this._material.depthTest=t}},{key:"setLineWidth",value:function(t){this._material.linewidth=t}},{key:"getLineWidth",value:function(){return this._material.linewidth}},{key:"setShininess",value:function(t){this._material.shininess=t}},{key:"getShininess",value:function(){return this._material.shininess}},{key:"setEmissiveColor",value:function(t){this._material.emissive=t}},{key:"getEmissiveColor",value:function(){return this._material.emissive}},{key:"setShading",value:function(t){this._material.shading="smooth"===t?THREE.SmoothShading:THREE.FlatShading,this._material.needsUpdate=!0}},{key:"setSpecularColor",value:function(t){this._material.specular=t}},{key:"getSpecularColor",value:function(){return this._material.specular}},{key:"setProperty",value:function(t,e){this._material.uniforms[t].value=e}},{key:"getProperty",value:function(t){return this._material.uniforms[t].value}},{key:"setBlending",value:function(t){this._material.blending=t}},{key:"erase",value:function(){this._material.map&&this._material.map.dispose(),this._material.dispose()}}]),t}(),H=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var V=window.location.search.search("[?&]debug(=([^&#]*)|&|#|$)")>-1,W=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.label=e}return H(t,[{key:"log",value:function(){this.doLog()&&console.log.apply(console,arguments)}},{key:"warn",value:function(){this.doLog()&&console.warn.apply(console,arguments)}},{key:"info",value:function(){this.doLog()&&console.info.apply(console,arguments)}},{key:"error",value:function(){this.doLog()&&console.error.apply(console,arguments)}},{key:"doLog",value:function(){return this.label||V}}]),t}(),q=new W,X=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Y=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.context=n(e,"context",null),this.type=n(e,"type","perspective"),this.fov=n(e,"fov",35),this.cubeResolution=n(e,"cubeResolution",1024),this.near=n(e,"near",.1),this.far=n(e,"far",5e3);var r=n(e,"position",void 0);if("perspective"===this.type){if(this.context){var i=this.context.getCanvasSize();q.log("camera canvasSize",i),this._camera=new THREE.PerspectiveCamera(this.fov,i.width/i.height,this.near,this.far)}else this._camera=new THREE.PerspectiveCamera(this.fov,window.innerWidth/window.innerHeight,this.near,this.far);q.log("made perspective cam")}else if("ortho"===this.type){if(this.context){var o=this.context.getCanvasSize();this._camera=new THREE.OrthographicCamera(o.width/-2,o.width/2,o.height/2,o.height/-2,this.near,this.far)}else this._camera=new THREE.OrthographicCamera(window.innerWidth/-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2,this.near,this.far);this._camera.position.z=400,q.log("made ortho cam")}else"cube"===this.type&&(this._camera=new THREE.CubeCamera(.5,1e3,this.cubeResolution),q.log("made cube cam"));this.transform=new nt(this),void 0!==r&&this.transform.setLocalPosition(r),this.viewport=function(t,e,n){for(var r=arguments.length,i=Array(r>3?r-3:0),o=3;o<r;o++)i[o-3]=arguments[o];return void 0!==t&&e in t?t[e]:new(Function.prototype.bind.apply(n,[null].concat(i)))}(e,"viewport",T,0,0,1,1),this.layer=n(e,"layer","default"),this.verticalshift=n(e,"verticalshift",0),this.horizontalshift=n(e,"horizontalshift",0),this.autorender=n(e,"autorender",!0),this.autoclear=n(e,"autoclear",!0),this.autoupdatematrix=n(e,"autoupdatematrix",!1),this.dirty=!1}return X(t,[{key:"setRenderTexture",value:function(t){this.renderTexture=t}},{key:"setFOV",value:function(t){this.fov=t,"perspective"===this.type&&(this._camera.fov=this.fov,this.updateProjectionMatrix())}},{key:"getFOV",value:function(){return this.fov}},{key:"setClearColor",value:function(t){this.clearColor=t}},{key:"getClearColor",value:function(){return this.clearColor}},{key:"setAutorender",value:function(t){this.autorender=t}},{key:"lookAt",value:function(t){this._camera.lookAt(t)}},{key:"setAspect",value:function(t){this._camera.aspect=t,this.updateProjectionMatrix()}},{key:"setVerticalShift",value:function(t){this.verticalshift=t,this.updateProjectionMatrix()}},{key:"setHorizontalShift",value:function(t){this.horizontalshift=t,this.updateProjectionMatrix()}},{key:"updateProjectionMatrix",value:function(){var t=1/this._camera.aspect;"cube"!==this.type&&("ortho"!==this.type&&this._camera.setViewOffset(1,t,1*this.horizontalshift,t*this.verticalshift,1,t),this.autoupdatematrix&&this._camera.updateProjectionMatrix())}},{key:"getAspect",value:function(){return this._camera.aspect}},{key:"setOrthoPlanes",value:function(t,e,n,r){"ortho"===this.type?(this._camera.left=t,this._camera.right=e,this._camera.top=n,this._camera.bottom=r):console.warn("setOrthoBounds() can't be used on perspective cams!")}},{key:"setZoom",value:function(t){"ortho"===this.type?this._camera.zoom=t:console.warn("setZoom() can't be used on perspective cams!")}},{key:"getZoom",value:function(){return"ortho"===this.type?this._camera.zoom:(console.warn("getZoom() can't be used on perspective cams!"),null)}},{key:"setFarPlane",value:function(t){"cube"!==this.type?(this._camera.far=t,this.updateProjectionMatrix()):"cube"===this.type&&this._camera.children.forEach(function(e){e.far=t,e.updateProjectionMatrix()})}},{key:"getFarPlane",value:function(){return this._camera.far}},{key:"setNearPlane",value:function(t){"cube"!==this.type?(this._camera.near=t,this.updateProjectionMatrix()):"cube"===this.type&&this._camera.children.forEach(function(e){e.near=t,e.updateProjectionMatrix()})}},{key:"getNearPlane",value:function(){return this._camera.near}},{key:"setPlanes",value:function(t,e){this._camera.far=e,this._camera.near=t,this.updateProjectionMatrix()}},{key:"setToPixel",value:function(){if("perspective"===this.type){var t=void 0;if(this.context){var e=this.context.getCanvasSize();t=new M(e.width/2,-e.height/2,1/(2*Math.tan(k.degToRad(this.fov/2)/e.height)))}else t=new M(window.innerWidth/2,-window.innerHeight/2,1/(2*Math.tan(k.degToRad(this.fov/2)/window.innerHeight)));this.transform.setLocalPosition(t)}else console.error("only perspective camera can be setted to screen pixel z position")}},{key:"perspectiveOffCenter",value:function(t,e,n,r,i,o){var a=2*i/(e-t),s=2*i/(r-n),u=(e+t)/(e-t),l=(r+n)/(r-n),c=-(o+i)/(o-i),h=-2*o*i/(o-i);this._camera.projectionMatrix.set(a,0,u,0,0,s,l,0,0,0,c,h,0,0,-1,0)}},{key:"aspect",set:function(t){this.setAspect(t)},get:function(){return this.getAspect()}},{key:"zoom",set:function(t){this.setZoom(t)},get:function(){return this.getZoom()}},{key:"farPlane",set:function(t){this.setFarPlane(t)},get:function(){return this.setFarPlane}},{key:"nearPlane",set:function(t){this.setNearPlane(t)},get:function(){return this.getNearPlane()}}]),t}(),$=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Z=function(){function t(e){switch(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=n(e,"type","point"),this.type){case"point":this.light=new THREE.PointLight(16777215),this.light.distance=1e3;break;case"directional":this.light=new THREE.DirectionalLight(16777215),this.light.position.set(1,1,1).normalize();break;case"ambient":this.light=new THREE.AmbientLight(4210752),this.light.position.set(1,1,1).normalize();break;case"spot":this.light=new THREE.SpotLight(16777215),this.target=new THREE.Object3D,this.light.target=this.target;break;default:this.light=new THREE.PointLight(16777215),this.type="point"}this.light.intensity=n(e,"intensity",1),this.light.distance=n(e,"distance",5e3),this.light.color=n(e,"color",b.white),this.transform=new nt(this)}return $(t,[{key:"setIntensity",value:function(t){this.light.intensity=t}},{key:"getIntensity",value:function(){return this.light.intensity}},{key:"setDistance",value:function(t){"point"!==this.type&&"spot"!==this.type||(this.light.distance=t)}},{key:"getDistance",value:function(){return this.light.distance}},{key:"setColor",value:function(t){this.light.color=t}},{key:"getColor",value:function(){return this.light.color}},{key:"setAngle",value:function(t){"spot"===this.type&&(this.light.angle=t)}},{key:"getAngle",value:function(){return this.light.angle}},{key:"setTargetPosition",value:function(t,e,n){"spot"===this.type&&(t instanceof M?(this.target.position.set(t.x,t.y,t.z),this.target.updateMatrixWorld()):(this.target.position.set(t,e,n),this.target.updateMatrixWorld()))}},{key:"setPenumbra",value:function(t){this.light.penumbra=t}},{key:"setCastShadow",value:function(t){this.light.castShadow=t}},{key:"setShadowSize",value:function(t,e){this.light.shadow.mapSize.width=t,this.light.shadow.mapSize.height=e}},{key:"setShadowDistance",value:function(t,e){this.light.shadow.camera.near=t,this.light.shadow.camera.far=e}}]),t}(),J=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var K=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._image=n(e,"image",void 0),this._canvas=n(e,"canvas",void 0),this._image?this.fromImage(this._image):this._canvas&&this.fromCanvas(this._canvas)}return J(t,[{key:"fromImage",value:function(t){this._texture=new THREE.Texture(t),this._texture.needsUpdate=!0,this.width=t.width,this.height=t.height}},{key:"fromCanvas",value:function(t){var e=this;this._texture=new THREE.Texture(t),this._texture.needsUpdate=!0,this._texture.magFilter=THREE.LinearFilter,this._texture.minFilter=THREE.LinearFilter,this.width=this._texture.image.width,this.height=this._texture.image.height,t.events&&t.events.on("drawn",function(){e.setNeedsUpdate(!0)})}},{key:"dispose",value:function(){this._texture.dispose()}},{key:"setRepeat",value:function(t,e){this._texture&&void 0!==this._texture&&(this._texture.repeat.set(t,e),this._texture.wrapS=THREE.RepeatWrapping,this._texture.wrapT=THREE.RepeatWrapping)}},{key:"setOffset",value:function(t){this._texture.offset=t}},{key:"setNeedsUpdate",value:function(){this._texture.needsUpdate=!0}},{key:"setPremultiplyAlpha",value:function(t){this._texture.premultiplyAlpha=t}},{key:"setMapping",value:function(t){this._texture.mapping=t}}]),t}();K.UVMapping=THREE.UVMapping,K.CubeReflectionMapping=THREE.CubeReflectionMapping,K.CubeRefractionMapping=THREE.CubeRefractionMapping,K.EquirectangularReflectionMapping=THREE.EquirectangularReflectionMapping,K.EquirectangularRefractionMapping=THREE.EquirectangularRefractionMapping,K.SphericalReflectionMapping=THREE.SphericalReflectionMapping,K.CubeUVReflectionMapping=THREE.CubeUVReflectionMapping,K.CubeUVRefractionMapping=THREE.CubeUVRefractionMapping;var Q=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var tt=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.setName(n(t,"name",void 0)),r.font=n(t,"font",null),r.material=n(t,"material","basic"),r._text=n(t,"text",""),r._lineMaxCharCount=n(t,"lineMaxCharCount",40),r.style={},r._width=n(t,"width",100),r._height=n(t,"height",100),r.style.color=n(t,"color",b.white),r.style.fontSize=n(t,"fontSize",72),r.style.textAlign=n(t,"textAlign","center"),r.mesh=new ot({primitive:"plane",width:1,height:1,material:r.material}),void 0!==t.backgroundColor?(r.style.hasBackground=!0,r.style.backgroundColor=t.backgroundColor):r.style.hasBackground=!1,r.transform=new nt(r),r.transform.setLocalScale(r._width,r._height),r.needsComputeTextSize=!0,r.precLine=n(t,"precLine",""),r._textSize=0,void 0!==t.texture?(r.material.setTexture(t.texture),r.transform.setLocalScale(t.width,t.height,1)):r.render(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,c),Q(e,[{key:"setWidth",value:function(t){this._width=t}},{key:"setHeight",value:function(t){this._height=t}},{key:"setBackgroundTexture",value:function(t){this.style.backgroundTexture=t}},{key:"setText",value:function(t){this._text=t,this.render()}},{key:"setNeedsComputeTextSize",value:function(t){this.needsComputeTextSize=t}},{key:"setShadowColor",value:function(t){this.shadowColor="rgba("+t.r+","+t.g+","+t.b+",1)"}},{key:"setShadowBlur",value:function(t){this.shadowBlur=t}},{key:"render",value:function(){var t=this;void 0===this._text&&(this._text=""),void 0===this._canvas&&(this._canvas=document.createElement("canvas"),this._canvas.retinaResolutionEnabled=!1),this._width>2048&&(this._width=2048),this._height>2048&&(this._height=2048),this._canvas.width=this._width,this._canvas.height=this._height;var e=this._canvas.getContext("2d");if(e.fillStyle=this.style.backgroundColor.makeRGBAStringWithAlpha(this.style.backgroundColorAlpha),e.shadowColor=this.shadowColor,e.shadowBlur=this.shadowBlur,void 0!==this.style.backgroundTexture?e.drawImage(this.style.backgroundTexture.texture.image,0,0,this._width,this._height):this.style.hasBackground?e.fillRect(0,0,this._canvas.width,this._canvas.height):e.clearRect(0,0,this._canvas.width,this._canvas.height),void 0!==this.font&&null!==this.font){q.log("render label with font",this.font);for(var n="",r="",i=this._lineMaxCharCount,o=0;o<this._text.length;++o){var a=this._text[o];"\n"===a||" "===a?(r.length+1>i?(n+="\n",n+=r+" ",i=this._lineMaxCharCount-(r.length+1),"\n"===a&&(n+="\n",i=this._lineMaxCharCount)):"\n"===a?(n+=r,n+="\n",i=this._lineMaxCharCount):(n+=r+" ",i-=r.length+1),r=""):r+=a}r.length+1>i&&(n+="\n");var s=(n+=r).split("\n"),u=0,l=0,c=void 0;0===s.length?(s.push(n),this.lastLine=n):this.lastLine=s[s.length-1],this.nbLines=s.length,s.forEach(function(n,r){if(t.needsComputeTextSize){t._textSize=t.font.getTextSize(n,t.style.fontSize),"center"===t.style.textAlign?u=t._width/2-t._textSize.width/2:"end"===t.style.textAlign||"right"===t.style.textAlign?u=t._width-t._textSize.width:"left"!==t.style.textAlign&&"start"!==t.style.textAlign||(u=0===r?t.font.getTextSize(t.precLine,t.style.fontSize).width+t.style.textHorizontalMargin:0+t.style.textHorizontalMargin);var i=0;"center"===t.style.textVerticalAlign?(s.length>1&&(i=r-(s.length-1)/2),l=t._height/2+t._textSize.height/2+i*t.style.fontSize):"top"===t.style.textVerticalAlign?(i=r,l=t.style.fontSize+i*t.style.fontSize+t.style.textVerticalMargin):"bottom"===t.style.textVerticalAlign&&(l=(i=r)*t.style.fontSize),t.cursorx=u+t._textSize.width,t.cursory=l}(c=t.font.getFont().getPath(n,u,l,t.style.fontSize)).fill="#"+t.style.color.getHexString(),c.draw(e)})}this._texture?this._texture.dispose():this._texture=new K({canvas:this._canvas}),this._texture.fromCanvas(this._canvas),this.mesh.material.setTexture(this._texture)}},{key:"createTextLabel",value:function(t,n,r,i,o,a,s,u,l){var c=new e(t,n,o,a);return c.style.fontSize=r,c.style.color=s,void 0!==u?(c.style.hasBackground=!0,c.style.backgroundColor=u):c.style.hasBackground=!1,c.style.textAlign=i,void 0!==l?(c.material.setTexture(l),c.transform.setLocalScale(o,a,1)):c.render(),c}}]),e}(),et=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var nt=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mobObject=e,e instanceof ot?this.entity=e.mesh:e instanceof Y?this.entity=e._camera:e instanceof Z?this.entity=e.light:e instanceof tt&&(this.entity=e.mesh.mesh),this.children=[]}return et(t,[{key:"lookAt",value:function(t){this.entity.lookAt(t)}},{key:"setLocalQuaternion",value:function(t){t instanceof E&&this.entity.quaternion.set(t.x,t.y,t.z,t.w)}},{key:"getLocalQuaternion",value:function(){return new E(this.entity.quaternion.x,this.entity.quaternion.y,this.entity.quaternion.z,this.entity.quaternion.w)}},{key:"setLocalMatrix",value:function(t){this.entity.matrixAutoUpdate=!1;var e=(new w).multiplyMatrices(this.entity.matrix,t);this.entity.applyMatrix(e),this.entity.updateMatrix()}},{key:"setLocalEulerAngles",value:function(t,e,n){3===arguments.length?(this.entity.rotation.x=k.degToRad(t),this.entity.rotation.y=k.degToRad(e),this.entity.rotation.z=k.degToRad(n)):2===arguments.length?"number"==typeof t&&"number"==typeof e&&(this.entity.rotation.x=k.degToRad(t),this.entity.rotation.y=k.degToRad(e)):1===arguments.length&&(t instanceof M&&(this.entity.rotation.x=k.degToRad(t.x),this.entity.rotation.y=k.degToRad(t.y),this.entity.rotation.z=k.degToRad(t.z)),t instanceof A?(this.entity.rotation.x=k.degToRad(t.x),this.entity.rotation.y=k.degToRad(t.y)):"number"==typeof t&&(this.entity.rotation.z=k.degToRad(t)))}},{key:"getLocalEulerAngles",value:function(){return new M(k.radToDeg(this.entity.rotation.x)%360,k.radToDeg(this.entity.rotation.y)%360,k.radToDeg(this.entity.rotation.z)%360)}},{key:"setLocalRotation",value:function(){this.setLocalEulerAngles.apply(this,arguments)}},{key:"setLocalRotationX",value:function(t){"number"==typeof t&&(this.entity.rotation.x=k.degToRad(t))}},{key:"setLocalRotationY",value:function(t){"number"==typeof t&&(this.entity.rotation.y=k.degToRad(t))}},{key:"setLocalRotationZ",value:function(t){"number"==typeof t&&(this.entity.rotation.z=k.degToRad(t))}},{key:"getLocalRotation",value:function(){return this.getLocalEulerAngles()}},{key:"getLocalRotationX",value:function(){return this.getLocalEulerAngles().x}},{key:"getLocalRotationY",value:function(){return this.getLocalEulerAngles().y}},{key:"getLocalRotationZ",value:function(){return this.getLocalEulerAngles().z}},{key:"setLocalPosition",value:function(t,e,n){3===arguments.length?(this.entity.position.x=t,this.entity.position.y=e,this.entity.position.z=n):2===arguments.length?"number"==typeof t&&"number"==typeof e&&(this.entity.position.x=t,this.entity.position.y=e):1===arguments.length&&(t instanceof M?(this.entity.position.x=t.x,this.entity.position.y=t.y,this.entity.position.z=t.z):t instanceof A?(this.entity.position.x=t.x,this.entity.position.y=t.y):"number"==typeof t&&(this.entity.position.x=t,this.entity.position.y=t,this.entity.position.z=t))}},{key:"setLocalPositionX",value:function(t){"number"==typeof t&&(this.entity.position.x=t)}},{key:"setLocalPositionY",value:function(t){"number"==typeof t&&(this.entity.position.y=t)}},{key:"setLocalPositionZ",value:function(t){"number"==typeof t&&(this.entity.position.z=t)}},{key:"getLocalPosition",value:function(){return new M(this.entity.position.x,this.entity.position.y,this.entity.position.z)}},{key:"getLocalPositionX",value:function(){return this.entity.position.x}},{key:"getLocalPositionY",value:function(){return this.entity.position.y}},{key:"getLocalPositionZ",value:function(){return this.entity.position.z}},{key:"getWorldPosition",value:function(){var t=new M;return t.setFromMatrixPosition(this.entity.matrixWorld),t}},{key:"setLocalScale",value:function(t,e,n){3===arguments.length?(this.entity.scale.x=t,this.entity.scale.y=e,this.entity.scale.z=n):2===arguments.length?"number"==typeof t&&"number"==typeof e&&(this.entity.scale.x=t,this.entity.scale.y=e):1===arguments.length&&(t instanceof M?(this.entity.scale.x=t.x,this.entity.scale.y=t.y,this.entity.scale.z=t.z):t instanceof A?(this.entity.scale.x=t.x,this.entity.scale.y=t.y):"number"==typeof t&&(this.entity.scale.x=t,this.entity.scale.y=t,this.entity.scale.z=t))}},{key:"setLocalScaleX",value:function(t){"number"==typeof t&&(this.entity.scale.x=t)}},{key:"setLocalScaleY",value:function(t){"number"==typeof t&&(this.entity.scale.y=t)}},{key:"setLocalScaleZ",value:function(t){"number"==typeof t&&(this.entity.scale.z=t)}},{key:"getLocalScale",value:function(){return new M(this.entity.scale.x,this.entity.scale.y,this.entity.scale.z)}},{key:"getLocalScaleX",value:function(){return this.entity.scale.x}},{key:"getLocalScaleY",value:function(){return this.entity.scale.y}},{key:"getLocalScaleZ",value:function(){return this.entity.scale.z}},{key:"pick",value:function(t,e,n){[].push(this.entity);var r=0,i=0;if(t.context){var o=t.context.getCanvasSize();r=e/o.width*2-1,i=-n/o.height*2+1}else r=e/window.innerWidth*2-1,i=-n/window.innerHeight*2+1;var a=new THREE.Raycaster,s=new THREE.Vector3(r,i,1),u=t.transform.entity;a.setFromCamera(s,u);var l=a.intersectObjects([this.entity]);if(l.length>0){var c={};return c.point=l[0].point,c.uv=l[0].uv,c.distance=l[0].distance,c}return null}},{key:"getScreenCoordinates",value:function(t,e){if("perspective"===e.type){var n=new M,r=.5*t.getCanvasSize().width*e.viewport.width,i=.5*t.getCanvasSize().height*e.viewport.height;return this.entity.updateMatrixWorld(),n.setFromMatrixPosition(this.entity.matrixWorld),n.project(e.camera),n.x=n.x*r+r,n.y=-n.y*i+i,{x:n.x,y:n.y}}return null}},{key:"addChild",value:function(t){this.children.push(t.mobObject),this.entity.add(t.entity)}},{key:"removeChild",value:function(t){this.children.splice(this.children.indexOf(t),1),this.entity.remove(t.entity)}},{key:"getChildren",value:function(){return this.children}},{key:"getChild",value:function(t){return this.children[t]}},{key:"setRenderOrder",value:function(t){this.entity.renderOrder=t}},{key:"setVisible",value:function(t){this.entity.visible=t}},{key:"getVisible",value:function(){return this.entity.visible}}]),t}(),rt=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function it(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var ot=function(){function t(e){switch(it(this,t),this.primitive=n(e,"primitive","box"),this.name=n(e,"name",void 0),this.material=n(e,"material","phong"),this._geometry=n(e,"geometry",void 0),this.visible=!0,this.primitive){case"plane":this.constructPlane(e);break;case"quad":this.constructQuad(e);break;case"box":this.constructBox(e);break;case"cube":this.constructCube(e);break;case"sphere":this.constructSphere(e);break;case"circle":this.constructCircle(e);break;case"cylinder":this.constructCylinder(e);break;case"icosahedron":this.constructIcosahedron(e);break;case"octahedron":this.constructOctahedron(e);break;case"text":this.constructText(e);break;case"node":this.constructNode();break;case"line":this.constructLine(e);break;case"sprite":this.constructSprite();break;case"arc":this.constructArc(e);break;case"custom":this.constructCustom(e);break;default:this.constructNode()}this.transform||(this.transform=new nt(this))}return rt(t,[{key:"constructNode",value:function(){this.mesh=new THREE.Object3D}},{key:"constructLine",value:function(t){this._geometry=new THREE.Geometry,this._geometry.dynamic=!0;var e=n(t,"point1",new M(0,-1,0)),r=n(t,"point2",new M(0,1,0));console.log(e,r),this._geometry.vertices.push(e,r),this.material=new G({type:"line"}),this.mesh=new THREE.Line(this._geometry,this.material._material)}},{key:"constructSprite",value:function(){this.material=new G({type:"sprite"}),this.mesh=new THREE.Sprite(this.material._material)}},{key:"constructPlane",value:function(t){var e=n(t,"width",1),r=n(t,"height",1),i=n(t,"segments",1),o=n(t,"widthSegments",i),a=n(t,"heightSegments",i);this._geometry=new THREE.PlaneBufferGeometry(e,r,o,a),this.attachMaterial(this.material),this.mesh=new THREE.Mesh(this._geometry,this.material._material)}},{key:"constructQuad",value:function(t){var e=n(t,"point1",new A(-1,1)),r=n(t,"point2",new A(1,1)),i=n(t,"point3",new A(1,-1)),o=n(t,"point4",new A(-1,-1)),a=new THREE.Shape;a.moveTo(e.x,e.y),a.lineTo(r.x,r.y),a.lineTo(i.x,i.y),a.lineTo(o.x,o.y),a.lineTo(e.x,e.y),this._geometry=new THREE.ShapeGeometry(a),this.attachMaterial(this.material),this.mesh=new THREE.Mesh(this._geometry,this.material._material)}},{key:"constructCube",value:function(t){var e=n(t,"size",1),r=n(t,"segments",1),i=n(t,"widthSegments",r),o=n(t,"heightSegments",r),a=n(t,"depthSegments",r);this._geometry=new THREE.BoxGeometry(e,e,e,i,o,a),this.attachMaterial(this.material),this.mesh=new THREE.Mesh(this._geometry,this.material._material)}},{key:"constructBox",value:function(t){var e=n(t,"width",1),r=n(t,"height",1),i=n(t,"depth",1),o=n(t,"widthSegments",1),a=n(t,"heightSegments",1),s=n(t,"depthSegments",1);this._geometry=new THREE.BoxGeometry(e,r,i,o,a,s),this.attachMaterial(this.material),this.mesh=new THREE.Mesh(this._geometry,this.material._material)}},{key:"constructSphere",value:function(t){var e=n(t,"radius",1),r=n(t,"segments",8),i=n(t,"widthSegments",r),o=n(t,"heightSegments",r),a=n(t,"phiStart",0),s=n(t,"phiLength",2*Math.PI),u=n(t,"thetaStart",0),l=n(t,"thetaLength",Math.PI);this._geometry=new THREE.SphereGeometry(e,i,o,a,s,u,l),this._geometry.dynamic=!0,this.attachMaterial(this.material),this.mesh=new THREE.Mesh(this._geometry,this.material._material)}},{key:"constructCircle",value:function(t){var e=n(t,"radius",1),r=n(t,"segments",32),i=n(t,"thetaStart",0),o=n(t,"thetaLength",2*Math.PI);this._geometry=new THREE.CircleGeometry(e,r,i,o),this.attachMaterial(this.material),this.mesh=new THREE.Mesh(this._geometry,this.material._material)}},{key:"constructCylinder",value:function(t){var e=n(t,"radiusTop",1),r=n(t,"radiusBottom",1),i=n(t,"height",1),o=n(t,"radiusSegments",32),a=n(t,"heightSegments",1),s=n(t,"openEnded",!1),u=n(t,"thetaStart",0),l=n(t,"thetaLength",2*Math.PI);this._geometry=new THREE.CylinderGeometry(e,r,i,o,a,s,u,l),this.attachMaterial(this.material),this.mesh=new THREE.Mesh(this._geometry,this.material._material)}},{key:"constructIcosahedron",value:function(t){var e=n(t,"radius",1),r=n(t,"detail",0);this._geometry=new THREE.IcosahedronGeometry(e,r),this._geometry.dynamic=!0,this.attachMaterial(this.material),this.mesh=new THREE.Mesh(this._geometry,this.material._material)}},{key:"constructOctahedron",value:function(t){var e=n(t,"radius",1),r=n(t,"detail",0);this._geometry=new THREE.OctahedronGeometry(e,r),this._geometry.dynamic=!0,this.attachMaterial(this.material),this.mesh=new THREE.Mesh(this._geometry,this.material._material)}},{key:"constructText",value:function(t){var e=n(t,"text","text"),r=n(t,"fontSize",1),i=n(t,"height",1),o=n(t,"segments",5),a=n(t,"font",void 0),s=new THREE.Font(a);this._geometry=new THREE.TextGeometry(e,{size:r,height:i,curveSegments:o,font:s,weight:"normal",style:"normal",bevelEnabled:!1}),this._geometry.center(),this.attachMaterial(this.material),this.mesh=new THREE.Mesh(this._geometry,this.material._material)}},{key:"constructArc",value:function(t){this._geometry=new THREE.Geometry,this._geometry.dynamic=!0;var e=n(t,"radius",1),r=n(t,"width",.2),i=n(t,"segments",32),o=n(t,"startAngle",0),a=n(t,"endAngle",2*Math.PI),s=n(t,"color",b.white.clone()),u=t.texture,l=t.uvScale,c=n(t,"center",M.zero.clone());this.createArc({center:c,radius:e,segments:i,startAngle:o,endAngle:a,color:s,texture:u,width:r,uvScale:l})}},{key:"constructCustom",value:function(t){this._geometry=n(t,"geometry",new THREE.Geometry),this._geometry.dynamic=!0}},{key:"generateFillMesh",value:function(t){var e=new THREE.Shape;e.moveTo(t[0].x,t[0].y);for(var n=1;n<t.length;n++)e.lineTo(t[n].x,t[n].y);e.closePath();var r=new THREE.ShapeGeometry(e);this._geometry=r,this.constructMesh(),this.generateFlatUVs()}},{key:"generateFlatUVs",value:function(){for(var t=this._geometry,e=[],n=this.getBoundingBox(),r=0;r<t.faces.length;r++){var i=t.faces[r];e[r]=[new A(k.map(t.vertices[i.a].x,n.min.x,n.max.x,0,1),k.map(t.vertices[i.a].y,n.min.y,n.max.y,0,1)),new A(k.map(t.vertices[i.b].x,n.min.x,n.max.x,0,1),k.map(t.vertices[i.b].y,n.min.y,n.max.y,0,1)),new A(k.map(t.vertices[i.c].x,n.min.x,n.max.x,0,1),k.map(t.vertices[i.c].y,n.min.y,n.max.y,0,1))]}this.setUVs(0,e)}},{key:"updateStroke",value:function(e,n){var r=t.generateStrokeShape(e,n),i=new THREE.ShapeGeometry(r);this.setVertices(i.vertices),this.updateMesh()}},{key:"getBoundingBox",value:function(){return this._geometry?(this._geometry.boundingBox||this._geometry.computeBoundingBox(),this._geometry.boundingBox):(new THREE.Box3).setFromObject(this.mesh)}},{key:"getBoundingSphere",value:function(){return this._geometry?(this._geometry.boundingSphere||this._geometry.computeBoundingSphere(),this._geometry.boundingSphere):(new THREE.Box3).setFromObject(this.mesh).getBoundingSphere()}},{key:"createLine",value:function(t,e,n,r,i,o){var a=M.zero,s=M.zero;s.subVectors(e,t),void 0===o&&(o=s.length()),s.normalize(),a.crossVectors(s,new M(0,0,1)),a.x*=i,a.y*=i,a.z*=i;var u=new M(t.x-a.x,t.y-a.y,t.z-a.z),l=new M(t.x+a.x,t.y+a.y,t.z+a.z),c=new M(e.x+a.x,e.y+a.y,e.z+a.z),h=new M(e.x-a.x,e.y-a.y,e.z-a.z);this.transform.setLocalPosition(M.zero.clone());var p=new THREE.Vector2(0,o),f=new THREE.Vector2(1,o),d=new THREE.Vector2(1,0),m=new THREE.Vector2(0,0);this.pushQuad(u,l,c,h,p,f,d,m),this.material.setColor(n),this.material.setWireframe(!1)}},{key:"createCircle",value:function(t){var e=n(t,"center",new M(0,0,0)),r=n(t,"radius",1),i=n(t,"segments",32);this.createArc({center:e,radius:r,segments:i,startAngle:0,endAngle:2*Math.PI,color:b.white.clone(),width:1,uvScale:1})}},{key:"createArc",value:function(t){var e=n(t,"center",new M(0,0,0)),r=n(t,"radius",1),i=n(t,"segments",32),o=n(t,"startAngle",0),a=n(t,"endAngle",2*Math.PI),s=n(t,"color",b.white.clone()),u=n(t,"width",1),l=n(t,"uvScale",1);void 0===l&&(l=r*(a-o)*1);var c=[],h=[],p=2*Math.PI/i,f=a,d=0;for(d=o;d<=f;d+=p)c.push(new M(Math.cos(d)*(r-u/2),Math.sin(d)*(r-u/2),0)),h.push(new M(Math.cos(d)*(r+u/2),Math.sin(d)*(r+u/2),0));d!==f&&(c.push(new M(Math.cos(a)*(r-u/2),Math.sin(a)*(r-u/2),0)),h.push(new M(Math.cos(a)*(r+u/2),Math.sin(a)*(r+u/2),0)));for(var m=0;m<c.length-1;++m){var g=h[m],v=c[m],y=c[(m+1)%c.length],_=h[(m+1)%c.length],x=new A(0,(m+0)*l/(c.length-1)),w=new A(1,(m+0)*l/(c.length-1)),E=new A(1,(m+1)*l/(c.length-1)),S=new A(0,(m+1)*l/(c.length-1));this.pushQuad(g,v,y,_,x,w,E,S)}this.material=new G({type:"basic"}),this.material.setColor(s),this.mesh=new THREE.Mesh(this._geometry,this.material._material),this.transform=new nt(this),this.transform.setLocalPosition(e)}},{key:"createDisc",value:function(t,e,n,r,i){this.createDiscSector(t,e,n,0,2*Math.PI,r,i)}},{key:"createDiscSector",value:function(t){var e=n(t,"center",new M(0,0,0)),r=n(t,"radius",1),i=n(t,"segments",32),o=n(t,"startAngle",0),a=n(t,"endAngle",2*Math.PI),s=[],u=2*Math.PI/i,l=a,c=0;for(c=o;c<=l;c+=u)s.push(new M(Math.cos(c)*r,Math.sin(c)*r,0));c!==l&&s.push(new M(Math.cos(a)*r,Math.sin(a)*r,0));for(var h=new M(0,0,0),p=0;p<s.length-1;++p){var f=s[p],d=s[p+1];this.pushTriangle(h,f,d);var m=new A(0,0),g=new A(1,0),v=new A(1,1);this.pushUV(m,g,v)}this.material=new G({type:"basic"}),this.mesh=new THREE.Mesh(this._geometry,this.material._material),this.transform=new nt(this),this.transform.setLocalPosition(e)}},{key:"constructMesh",value:function(){this.material=new G({type:"basic"}),this.mesh=new THREE.Mesh(this._geometry,this.material._material),this.transform=new nt(this),this._geometry.computeBoundingBox()}},{key:"pushVertex",value:function(t){this._geometry.vertices.push(t),this._geometry.verticesNeedUpdate=!0}},{key:"pushFace",value:function(t,e,n){var r=new THREE.Face3(t,e,n);return this._geometry.faces.push(r),this._geometry.elementsNeedUpdate=!0,r}},{key:"pushUV",value:function(t,e,n){this._geometry.faceVertexUvs[0].push([t,e,n]),this._geometry.uvsNeedUpdate=!0,this._geometry.elementsNeedUpdate=!0}},{key:"pushNormal",value:function(t,e,n){this._geometry.faceVertexNormals[0].push([t,e,n]),this._geometry.uvsNeedUpdate=!0,this._geometry.elementsNeedUpdate=!0,this._geometry.normalsNeedUpdate=!0}},{key:"pushTriangle",value:function(t,e,n){var r=this._geometry.vertices.length;this._geometry.vertices.push(t,e,n),this._geometry.faces.push(new THREE.Face3(r+0,r+1,r+2)),this._geometry.verticesNeedUpdate=!0,this._geometry.elementsNeedUpdate=!0}},{key:"pushQuad",value:function(t,e,n,r,i,o,a,s){var u=this._geometry.vertices.length;this._geometry.vertices.push(t,e,n,r),this._geometry.faces.push(new THREE.Face3(u+0,u+1,u+2)),this._geometry.faces.push(new THREE.Face3(u+0,u+2,u+3)),this._geometry.faceVertexUvs[0].push([i,o,a]),this._geometry.faceVertexUvs[0].push([i,a,s]),this._geometry.verticesNeedUpdate=!0,this._geometry.elementsNeedUpdate=!0,this._geometry.uvsNeedUpdate=!0}},{key:"computeNormals",value:function(){this._geometry.computeFaceNormals(),this._geometry.normalsNeedUpdate=!0,this._geometry.computeVertexNormals(!0),this._geometry.verticesNeedUpdate=!0}},{key:"updateMesh",value:function(){this._geometry.normalsNeedUpdate=!0,this._geometry.verticesNeedUpdate=!0,this._geometry.elementsNeedUpdate=!0,this._geometry.uvsNeedUpdate=!0}},{key:"clear",value:function(){this._geometry.vertices=[],this._geometry.faces=[],this._geometry.faceVertexUvs[0]=[],this._geometry.verticesNeedUpdate=!0,this._geometry.elementsNeedUpdate=!0,this._geometry.uvsNeedUpdate=!0}},{key:"erase",value:function(){this._geometry.dispose(),this.material.erase()}},{key:"setVertices",value:function(t){this._geometry.vertices=t,this._geometry.verticesNeedUpdate=!0,this._geometry.computeBoundingBox()}},{key:"getVertices",value:function(){return this._geometry.vertices}},{key:"setUVs",value:function(t,e){this._geometry.faceVertexUvs[t]=e,this._geometry.uvsNeedUpdate=!0,this._geometry.elementsNeedUpdate=!0}},{key:"getUVs",value:function(t){return this._geometry.faceVertexUvs[t]}},{key:"setVertexColors",value:function(t){this.material._material.vertexColors=THREE.VertexColors,this._geometry.colors=t,this._geometry.colorsNeedUpdate=!0}},{key:"getVertexColors",value:function(){return this._geometry.colors}},{key:"setCenter",value:function(t,e,n){this._geometry.applyMatrix((new w).makeTranslation(t,e,n))}},{key:"getCenter",value:function(){return null===this._geometry.boundingBox&&this._geometry.computeBoundingBox(),this._geometry.boundingBox.center()}},{key:"setScale",value:function(t,e,n){3===arguments.length?this._geometry.applyMatrix((new w).makeScale(t,e,n)):2===arguments.length?"number"==typeof t&&"number"==typeof e&&this._geometry.applyMatrix((new w).makeScale(t,e,1)):1===arguments.length&&(t instanceof M?this._geometry.applyMatrix((new w).makeScale(t.x,t.y,t.z)):t instanceof A?this._geometry.applyMatrix((new w).makeScale(t.x,t.y,1)):"number"==typeof t&&this._geometry.applyMatrix((new w).makeScale(t,t,t)))}},{key:"setRotationX",value:function(t){this._geometry.applyMatrix((new w).makeRotationX(k.degToRad(t)))}},{key:"setRotationY",value:function(t){this._geometry.applyMatrix((new w).makeRotationY(k.degToRad(t)))}},{key:"setRotationZ",value:function(t){this._geometry.applyMatrix((new w).makeRotationZ(k.degToRad(t)))}},{key:"setVisible",value:function(t){this.mesh.visible=t}},{key:"getVisible",value:function(){return this.mesh.visible}},{key:"updateMaterial",value:function(){this.mesh.material&&(this.mesh.material=this.material._material)}},{key:"setMaterial",value:function(t){this.material=null,void 0===t?this.material=new G({type:"default"}):t instanceof G?this.material=t:"string"==typeof t&&(this.material=new G({type:t}));var e=new THREE.Mesh(this._geometry,this.material._material),n=this.transform;this.mesh=e,this.transform=new nt(this),this.transform.setLocalScale(n.getLocalScale().x,n.getLocalScale().y,n.getLocalScale().z),this.transform.setLocalPosition(n.getLocalPosition().x,n.getLocalPosition().y,n.getLocalPosition().z),this.transform.setLocalRotation(n.getLocalRotation().x,n.getLocalRotation().y,n.getLocalRotation().z)}},{key:"attachMaterial",value:function(t){void 0===t?this.material=new G({type:"default"}):t instanceof G?this.material=t:"string"==typeof t&&(this.material=new G({type:t})),void 0!==t&&this.mesh&&this.updateMaterial()}},{key:"setCastShadow",value:function(t){this.mesh.castShadow=t}},{key:"setReceiveShadow",value:function(t){this.mesh.receiveShadow=t}}],[{key:"generateStrokeShape",value:function(e,n){for(var r=e._geometry.clone(),i=e._geometry.clone(),o=e._geometry.clone(),a=t.geometryIsCW(r)?"ccw":"cw",s=0;s<o.vertices.length;s++){var u=o.vertices[s>0?s-1:o.vertices.length-1],l=o.vertices[s],c=o.vertices[s<o.vertices.length-1?s+1:0],h=new A(l.x-u.x,l.y-u.y),p=new A(c.x-l.x,c.y-l.y);"ccw"===a?(h.rotate90CCW(),p.rotate90CCW()):(h.rotate90CW(),p.rotate90CW()),h.normalize(),p.normalize();var f=h.multiplyScalar(n).clone(),d=p.multiplyScalar(n).clone(),m={x:u.x+f.x,y:u.y+f.y},g={x:l.x+f.x,y:l.y+f.y},v={x:l.x+d.x,y:l.y+d.y},y={x:c.x+d.x,y:c.y+d.y},b=k.intersectionPoint([m,g],[v,y]);i.vertices[s].x=b.x,i.vertices[s].y=b.y}var _=new THREE.Shape,x=new THREE.Path;_.moveTo(i.vertices[0].x,i.vertices[0].y),x.moveTo(r.vertices[0].x,r.vertices[0].y);for(var w=r.vertices.length-1;w>0;w--)_.lineTo(i.vertices[w].x,i.vertices[w].y),x.lineTo(r.vertices[w].x,r.vertices[w].y);return _.closePath(),x.closePath(),_.holes.push(x),_}},{key:"geometryIsCW",value:function(t){for(var e=t.vertices,n=0;n<e.length;n++){var r=new A(e[n+1].x-e[n].x,e[n+1].y-e[n].y),i=new A(e[n+2].x-e[n+1].x,e[n+2].y-e[n+1].y);r.rotate90CW();var o=r.dot(i);if(0!==o)return o>0;console.log("dot product is 0")}return null}},{key:"generateStrokeMesh",value:function(e,n){var r=t.generateStrokeShape(e,n),i=new t({primitive:"custom",geometry:new THREE.ShapeGeometry(r)});return i.constructMesh(),i}},{key:"generateStrokeMeshFromShape",value:function(e){var n=new t({primitive:"custom",geometry:new THREE.ShapeGeometry(e)});return n.constructMesh(),n.material.setColor(this.strokeColor),n}},{key:"CreatePlane",value:function(e,n,r){return new t({primitive:"plane",width:e,height:n,segments:r,material:"material"})}},{key:"CreateBox",value:function(e,n,r,i,o){return new t({primitive:"box",width:e,height:n,depth:r,segments:i,material:o})}},{key:"CreateText",value:function(e,n,r,i,o,a){return new t({primitive:"text",text:e,font:n,fontSize:r,height:a,segments:o,material:i})}},{key:"CreateSphere",value:function(e,n,r,i){return new t({primitive:"sphere",radius:e,widthSegments:n,heightSegments:r,material:i})}},{key:"CreateCircle",value:function(e,n,r){return new t({primitive:"circle",segments:n,material:r})}}]),t}(),at=function(t){function e(t){it(this,e);var r=n(t,{});r.threshold=n(r.threshold,void 0);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r));return i.material=void 0,i.material=void 0,i.material=new G({type:"line"}),r.mesh?i.mesh=new THREE.LineSegments(new THREE.EdgesGeometry(r.mesh.geometry,r.threshold),i.material._material):i.mesh=new THREE.LineSegments(new THREE.EdgesGeometry(i._geometry,r.threshold),i.material._material),i.transform=void 0,i.transform=new nt(i),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,ot),e}(),st=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var ut=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.context=e}return st(t,null,[{key:"substract",value:function(t,e){var n=new ThreeBSP(t.mesh),r=new ThreeBSP(e.mesh),i=n.subtract(r).toGeometry();return new ot(void 0,void 0,i)}},{key:"union",value:function(t,e){var n=new ThreeBSP(t.mesh),r=new ThreeBSP(e.mesh),i=n.union(r).toGeometry();return new ot(void 0,void 0,i)}},{key:"intersect",value:function(t,e){var n=new ThreeBSP(t.mesh),r=new ThreeBSP(e.mesh),i=n.intersect(r).toGeometry();return new ot(void 0,void 0,i)}}]),t}(),lt=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),ct=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var ht=new Map([["Windows 10",/(Windows 10.0|Windows NT 10.0)/],["Windows 8.1",/(Windows 8.1|Windows NT 6.3)/],["Windows 8",/(Windows 8|Windows NT 6.2)/],["Windows 7",/(Windows 7|Windows NT 6.1)/],["Windows Vista",/Windows NT 6.0/],["Windows Server 2003",/Windows NT 5.2/],["Windows XP",/(Windows NT 5.1|Windows XP)/],["Windows 2000",/(Windows NT 5.0|Windows 2000)/],["Windows ME",/(Win 9x 4.90|Windows ME)/],["Windows 98",/(Windows 98|Win98)/],["Windows 95",/(Windows 95|Win95|Windows_95)/],["Windows NT 4.0",/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/],["Windows CE",/Windows CE/],["Windows 3.11",/Win16/],["Android",/Android/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Linux",/(Linux|X11)/],["iOS",/(iPhone|iPad|iPod)/],["Mac OS X",/Mac OS X/],["Mac OS",/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/],["QNX",/QNX/],["UNIX",/UNIX/],["BeOS",/BeOS/],["OS/2",/OS\/2/],["Search Bot",/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/]]),pt={},ft=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return ct(t,null,[{key:"parseOSData",value:function(){var t="unknown",e="unknown",n=!0,r=!1,i=void 0;try{for(var o,a=ht[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,u=lt(s,2),l=u[0];if(u[1].test(navigator.userAgent)){/Windows/.test(t=l)&&(e=/Windows (.*)/.exec(t)[1],t="Windows");break}}}catch(t){r=!0,i=t}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}switch(t){case"Mac OS X":e=/Mac OS X (10[._\d]+)/.exec(navigator.userAgent)[1];break;case"Android":e=/Android ([._\d]+)/.exec(navigator.userAgent)[1];break;case"iOS":e=(e=/OS (\d+)_(\d+)_?(\d+)?/.exec(navigator.appVersion))[1]+"."+e[2]+"."+(0|e[3])}pt.os=t,pt.osVersion=e}},{key:"parseBrowserData",value:function(){var t=navigator.appName,e=void 0,n=void 0,r=void 0,i=void 0,o=void 0;-1!==(r=navigator.userAgent.indexOf("Opera"))?(t="Opera",e=navigator.userAgent.substring(r+6),-1!==(r=navigator.userAgent.indexOf("Version"))&&(e=navigator.userAgent.substring(r+8))):-1!==(r=navigator.userAgent.indexOf("MSIE"))?(t="Microsoft Internet Explorer",e=navigator.userAgent.substring(r+5)):-1!==(r=navigator.userAgent.indexOf("Chrome"))?(t="Chrome",e=navigator.userAgent.substring(r+7)):-1!==(r=navigator.userAgent.indexOf("Safari"))?(t="Safari",e=navigator.userAgent.substring(r+7),-1!==(r=navigator.userAgent.indexOf("Version"))&&(e=navigator.userAgent.substring(r+8))):-1!==(r=navigator.userAgent.indexOf("Firefox"))?(t="Firefox",e=navigator.userAgent.substring(r+8)):-1!==navigator.userAgent.indexOf("Trident/")?(t="Microsoft Internet Explorer",e=navigator.userAgent.substring(navigator.userAgent.indexOf("rv:")+3)):(i=navigator.userAgent.lastIndexOf(" ")+1)<(r=navigator.userAgent.lastIndexOf("/"))&&(t=navigator.userAgent.substring(i,r),e=navigator.userAgent.substring(r+1),t.toLowerCase()===t.toUpperCase()&&(t=navigator.appName)),-1!==(o=e.indexOf(";"))&&(e=e.substring(0,o)),-1!==(o=e.indexOf(" "))&&(e=e.substring(0,o)),-1!==(o=e.indexOf(")"))&&(e=e.substring(0,o)),n=parseInt(""+e,10),isNaN(n)&&(e=""+parseFloat(navigator.appVersion),n=parseInt(navigator.appVersion,10)),pt.browser=t,pt.browserVersion=e,pt.browserMajorVersion=n}},{key:"getType",value:function(){return"type"in pt||(pt.type=/Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(navigator.appVersion)?"mobile":"desktop"),pt.type}},{key:"getOS",value:function(){return"os"in pt||t.parseOSData(),pt.os}},{key:"getOSVersion",value:function(){return"osVersion"in pt||t.parseOSData(),pt.osVersion}},{key:"getBrowser",value:function(){return"browser"in pt||t.parseBrowserData(),pt.browser}},{key:"getBrowserVersion",value:function(){return"browserVersion"in pt||t.parseBrowserData(),pt.browserVersion}},{key:"getBrowserMajorVersion",value:function(){return"browserMajorVersion"in pt||t.parseBrowserData(),pt.browserMajorVersion}},{key:"getFramework",value:function(){return"framework"in pt||(pt.framework=null,navigator.userAgent.toLowerCase().indexOf("ejecta")>-1?pt.framework="ejecta":window.cordova&&(pt.framework="cordova")),pt.framework}},{key:"getScreenWidth",value:function(){return window.screen.width}},{key:"getScreenHeight",value:function(){return window.screen.height}},{key:"getScreenSize",value:function(){return{width:t.getScreenWidth(),height:t.getScreenHeight()}}}]),t}(),dt=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),mt=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};var gt=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,d),dt(e,[{key:"setup",value:function(){this._manager=null,this._batteryAvailable=void 0!==navigator.getBattery}},{key:"on",value:function(){var t=this;this._batteryAvailable?(mt(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"on",this).call(this),navigator.getBattery().then(function(e){return t.onBatteryManager(e)})):q.warn("The battery API is not supported on this device")}},{key:"off",value:function(){var t=this;mt(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"off",this).call(this),this._manager&&(this._manager.removeEventListener("chargingchange",function(e){return t.onChargingChange(e)}),this._manager.removeEventListener("chargingtimechange",function(e){return t.onChargingTimeChange(e)}),this._manager.removeEventListener("levelchange",function(e){return t.onLevelChange(e)}),this._manager.removeEventListener("dischargingtimechange",function(e){return t.onDischargingTimeChange(e)}),this._manager=null)}},{key:"onBatteryManager",value:function(t){var e=this;this.getStatus()&&(this._manager=t,this._manager.addEventListener("chargingchange",function(t){return e.onChargingChange(t)}),this._manager.addEventListener("chargingtimechange",function(t){return e.onChargingTimeChange(t)}),this._manager.addEventListener("levelchange",function(t){return e.onLevelChange(t)}),this._manager.addEventListener("dischargingtimechange",function(t){return e.onDischargingTimeChange(t)}))}},{key:"onChargingChange",value:function(t){this.events.trigger("chargingchange",t.target.charging)}},{key:"onChargingTimeChange",value:function(t){this.events.trigger("chargingtimechange",t.target.chargingTime)}},{key:"onDischargingTimeChange",value:function(t){this.events.trigger("dischargingtimechange",t.target.dischargingTime)}},{key:"onLevelChange",value:function(t){this.events.trigger("levelchange",t.target.level)}},{key:"isCharging",value:function(){return this._manager?this._manager.charging:(q.warn("The battery component needs to be active to get battery information"),null)}},{key:"getChargingTime",value:function(){return this._manager?this._manager.chargingTime:(q.warn("The battery component needs to be active to get battery information"),null)}},{key:"getDischargingTime",value:function(){return this._manager?this._manager.dischargingTime:(q.warn("The battery component needs to be active to get battery information"),null)}},{key:"getLevel",value:function(){return this._manager?this._manager.level:(q.warn("The battery component needs to be active to get battery information"),null)}}]),e}(),vt=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),yt=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};var bt=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r._target=n(t,"target",window),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,d),vt(e,[{key:"on",value:function(){var t=this;yt(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"on",this).call(this),this._target.addEventListener("keydown",function(e){return t.onKeyDown(e)}),this._target.addEventListener("keypress",function(e){return t.onKeyPress(e)}),this._target.addEventListener("keyup",function(e){return t.onKeyUp(e)})}},{key:"off",value:function(){var t=this;yt(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"off",this).call(this),this._target.removeEventListener("keydown",function(e){return t.onKeyDown(e)}),this._target.removeEventListener("keypress",function(e){return t.onKeyPress(e)}),this._target.removeEventListener("keyup",function(e){return t.onKeyUp(e)})}},{key:"setup",value:function(){this._isPressed=!1}},{key:"update",value:function(){}},{key:"getKeyIsDown",value:function(t){return this._keyDownCode===t.toLowerCase()}},{key:"onKeyDown",value:function(t){this._keyDownCode=String.fromCharCode(t.keyCode).toLowerCase(),this.events.trigger("keydown",t)}},{key:"onKeyPress",value:function(t){this._keyDownCode=String.fromCharCode(t.keyCode).toLowerCase(),this.events.trigger("keypress",t),this._isPressed=!0,t.preventDefault()}},{key:"onKeyUp",value:function(t){this._keyDownCode=void 0,this._isPressed=!1,this.events.trigger("keyup",t)}}]),e}(),_t=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var xt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return _t(t,null,[{key:"getElementPosition",value:function(t){for(var e=0,n=0;t;){if("BODY"===t.tagName){var r=t.scrollLeft||document.documentElement.scrollLeft,i=t.scrollTop||document.documentElement.scrollTop;e+=t.offsetLeft-r+t.clientLeft,n+=t.offsetTop-i+t.clientTop}else e+=t.offsetLeft-t.scrollLeft+t.clientLeft,n+=t.offsetTop-t.scrollTop+t.clientTop;t=t.offsetParent}return{x:e,y:n}}}]),t}(),wt=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),Et=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};var St=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r._target=n(t,"target",window),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,d),wt(e,[{key:"setup",value:function(){this._x=null,this._y=null,this._pX=null,this._pY=null,this._dragStartX=null,this._dragStartY=null,this._wheelDeltaX=0,this._wheelDeltaY=0,this._wheelDeltaZ=0,this._pressed=!1,this._wheelActivated=!1,this._resetWheel=!1}},{key:"on",value:function(){var t=this;Et(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"on",this).call(this),this._target?(this._target.addEventListener("mousemove",function(e){return t.onMouseMove(e)}),this._target.addEventListener("mouseover",function(e){return t.onMouseOver(e)}),this._target.addEventListener("mouseout",function(e){return t.onMouseOut(e)}),this._target.addEventListener("mousedown",function(e){return t.onMouseDown(e)}),this._target.addEventListener("mouseup",function(e){return t.onMouseUp(e)}),this._target.addEventListener("click",function(e){return t.onClick(e)}),this._target.addEventListener("dblclick",function(e){return t.onDblClick(e)}),this._target.addEventListener("wheel",function(e){return t.onWheel(e)})):q.error("Can't activate the mouse input component without a target")}},{key:"off",value:function(){var t=this;Et(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"off",this).call(this),this._target?(this._target.removeEventListener("mousemove",function(e){return t.onMouseMove(e)}),this._target.removeEventListener("mouseover",function(e){return t.onMouseOver(e)}),this._target.removeEventListener("mouseout",function(e){return t.onMouseOut(e)}),this._target.removeEventListener("mousedown",function(e){return t.onMouseDown(e)}),this._target.removeEventListener("mouseup",function(e){return t.onMouseUp(e)}),this._target.removeEventListener("click",function(e){return t.onClick(e)}),this._target.removeEventListener("dblclick",function(e){return t.onDblClick(e)}),this._target.removeEventListener("wheel",function(e){return t.onWheel(e)})):q.error("Can't deactivate the mouse input component without a target")}},{key:"preUpdate",value:function(){this._wheelActivated&&(this._resetWheel?(this._wheelActivated=!1,this._resetWheel=!1,this._wheelDeltaX=0,this._wheelDeltaY=0,this._wheelDeltaZ=0):this._resetWheel=!0)}},{key:"update",value:function(){}},{key:"postUpdate",value:function(){this._pX=this._x,this._pY=this._y,this.events.trigger("mouseupdate",{pX:this.getPX(),pY:this.getPY(),x:this.getX(),y:this.getY()})}},{key:"onMouseMove",value:function(t){if(this._target instanceof Window)this._x=t.clientX,this._y=t.clientY;else{var e=xt.getElementPosition(this._target);this._x=t.clientX-e.x,this._y=t.clientY-e.y}this.events.trigger("mousemove",{pX:this.getPX(),pY:this.getPY(),x:this.getX(),y:this.getY()}),this.isPressed()&&this.events.trigger("mousedrag",{pX:this.getPX(),pY:this.getPY(),x:this.getX(),y:this.getY()}),t.preventDefault()}},{key:"onMouseOver",value:function(t){this.events.trigger("mouseover"),t.preventDefault()}},{key:"onMouseOut",value:function(t){this.events.trigger("mouseout"),t.preventDefault()}},{key:"onMouseDown",value:function(t){this._pressed=!0,this._dragStartX=this.getX(),this._dragStartY=this.getY(),this.events.trigger("mousepress",t.button),t.preventDefault()}},{key:"onMouseUp",value:function(t){this._pressed=!1,this._dragStartX=null,this._dragStartY=null,this.events.trigger("mouserelease"),t.preventDefault()}},{key:"onClick",value:function(t){this.events.trigger("mouseclick",t.button),t.preventDefault()}},{key:"onDblClick",value:function(t){this.events.trigger("mousedblclick",t.button),t.preventDefault()}},{key:"onWheel",value:function(t){this._wheelActivated=!0,this._wheelDeltaX+=t.deltaX,this._wheelDeltaY+=t.deltaY,this._wheelDeltaZ+=t.deltaZ,this.events.trigger("mousewheel",t.deltaX,t.deltaY,t.deltaZ),t.preventDefault()}},{key:"isPressed",value:function(){return this._pressed}},{key:"getX",value:function(){return this._x}},{key:"getY",value:function(){return this._y}},{key:"getPX",value:function(){return this._pX}},{key:"getPY",value:function(){return this._pY}},{key:"getDeltaX",value:function(){return this._x-this._pX}},{key:"getDeltaY",value:function(){return this._y-this._pY}},{key:"getDelta",value:function(){return{x:this.getDeltaX(),y:this.getDeltaY()}}},{key:"getDragOffsetX",value:function(){return this.isPressed()?this.getX()-this._dragStartX:0}},{key:"getDragOffsetY",value:function(){return this.isPressed()?this.getY()-this._dragStartY:0}},{key:"getDragOffset",value:function(){return{x:this.getDragOffsetX(),y:this.getDragOffsetY()}}},{key:"isWheelSupported",value:function(){return"desktop"===ft.getType()&&void 0!==window.WheelEvent}},{key:"isWheelActivated",value:function(){return this._wheelActivated}},{key:"getWheelDeltaX",value:function(){return this._wheelDeltaX}},{key:"getWheelDeltaY",value:function(){return this._wheelDeltaY}},{key:"getWheelDeltaZ",value:function(){return this._wheelDeltaZ}},{key:"getWheelDelta",value:function(){return{x:this.getWheelDeltaX(),y:this.getWheelDeltaY(),z:this.getWheelDeltaZ()}}}]),e}(),Tt=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0},Ot=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function At(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Mt=function(){function t(e,n,r){At(this,t),this.index=r,this.x=e,this.y=n,this.pX=this.x,this.pY=this.y,this.id=void 0,this.xDelta=0,this.yDelta=0,this.startX=this.x,this.startY=this.y,this.offsetX=0,this.offsetY=0}return Ot(t,[{key:"setX",value:function(t){this.x=t,this.xDelta=this.x-this.pX,this.offsetX=this.x-this.startX}},{key:"setY",value:function(t){this.y=t,this.yDelta=this.y-this.pY,this.offsetY=this.y-this.startY}},{key:"setPX",value:function(){this.pX=this.x}},{key:"setPY",value:function(){this.pY=this.y}}]),t}(),Ct=function(t){function e(t){At(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r._target=n(t,"target",window),r._time=new R,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,d),Ot(e,[{key:"setup",value:function(){this.getContext().addComponent(this._time),this._time.setup(),this._time.on(),this.count=0,this.pressed=!1,this.touches={},this.taps=0,this.tapsMaxInterval=500,this.oldTapTime=0,this.pinchTouches=[],this.pinchStart=0,this.pinch=0,this.pinchActive=!1}},{key:"on",value:function(){var t=this;Tt(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"on",this).call(this),this._target.addEventListener("touchstart",function(e){return t.onTouchStart(e)}),this._target.addEventListener("touchend",function(e){return t.onTouchEnd(e)}),this._target.addEventListener("touchcancel",function(e){return t.onTouchEnd(e)}),this._target.addEventListener("touchleave",function(e){return t.onTouchEnd(e)}),this._target.addEventListener("touchmove",function(e){return t.onTouchMove(e)})}},{key:"off",value:function(){var t=this;Tt(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"off",this).call(this),this._target.removeEventListener("touchstart",function(e){return t.onTouchStart(e)}),this._target.removeEventListener("touchend",function(e){return t.onTouchEnd(e)}),this._target.removeEventListener("touchcancel",function(e){return t.onTouchEnd(e)}),this._target.removeEventListener("touchleave",function(e){return t.onTouchEnd(e)}),this._target.removeEventListener("touchmove",function(e){return t.onTouchMove(e)})}},{key:"update",value:function(){var t=this;this.pressed&&!this.touchState?this.touchDown=!0:this.touchDown=!1,!this.pressed&&this.touchState?this.touchUp=!0:this.touchUp=!1,this.touchState=this.pressed,Object.keys(this.touches).forEach(function(e){t.touches[e].setPX(),t.touches[e].setPY()})}},{key:"onTouchStart",value:function(t){var e=xt.getElementPosition(this._target),n=null;if(null!==t.changedTouches&&void 0!==t.changedTouches)for(var r=0;r<t.changedTouches.length;r++){var i=t.changedTouches[r];if(i.identifier in this.touches){var o=this.touches[i.identifier],a=o.pageX-e.x,s=o.pageY-e.x;o.setX(a),o.setY(s)}else{var u=i.pageX-e.x,l=i.pageY-e.x;n=new Mt(u,l,this.count),q.log("newTouch",n),n.setX(u),n.setY(l),n.id=i.identifier,n.up=!1,n.down=!0,this.touches[i.identifier]=n,this.count+=1}this.events.trigger("touchstart",n)}this._time.getTime()-this.oldTapTime<this.tapsMaxInterval?(this.taps+=1,this.events.trigger("tapchanged",this.taps)):(this.taps=1,this.events.trigger("tapchanged",this.taps)),this.oldTapTime=this._time.getTime(),this.pressed=!0,this.events.trigger("pressedchanged",this.pressed),t.preventDefault()}},{key:"onTouchEnd",value:function(t){if(null!==t.changedTouches&&void 0!==t.changedTouches){for(var e=0;e<t.changedTouches.length;e++){var n=t.changedTouches[e];n.identifier in this.touches&&(this.events.trigger("touchend",this.touches[n.identifier]),delete this.touches[n.identifier],this.count-=1)}this.count<=1&&(this.pinchTouches=[],this.pinchStart=0,this.pinch=0,this.pinchActive=!1)}0===this.count&&(this.pressed=!1,this.events.trigger("pressedchanged",this.pressed)),t.preventDefault()}},{key:"onTouchMove",value:function(t){var e=xt.getElementPosition(this._target);if(null!==t.changedTouches&&void 0!==t.changedTouches)for(var n=0;n<t.changedTouches.length;n++){var r=t.changedTouches[n];if(r.identifier in this.touches){var i=this.touches[r.identifier],o=r.pageX-e.x,a=r.pageY-e.y;i.setX(o),i.setY(a),this.events.trigger("touchmoved",i)}}this.taps=0,t.preventDefault()}},{key:"getX",value:function(t){var e=void 0;if("number"==typeof t)for(var n in this.touches)this.touches[n].index===t&&(e=this.touches[n].x);return e}},{key:"getY",value:function(t){var e=void 0;if("number"==typeof t)for(var n in this.touches)this.touches[n].index===t&&(e=this.touches[n].y);return e}},{key:"get",value:function(t){var e=void 0;if("number"==typeof t)for(var n in this.touches)this.touches[n].index===t&&(e=this.touches[n]);return e}},{key:"getDeltaX",value:function(t){var e=this,n=void 0;return"number"==typeof t&&Object.keys(this.touches).forEach(function(r){var i=e.touches[r];i.index===t&&(n=i.xDelta)}),n}},{key:"getDeltaY",value:function(t){var e=this,n=void 0;return"number"==typeof t&&Object.keys(this.touches).forEach(function(r){var i=e.touches[r];i.index===t&&(n=i.yDelta)}),n}},{key:"getDelta",value:function(t){var e=this,n=void 0;return"number"==typeof t&&Object.keys(this.touches).forEach(function(r){var i=e.touches[r];i.index===t&&(n={x:i.xDelta,y:i.yDelta})}),n}},{key:"getOffsetX",value:function(t){var e=this,n=void 0;return Object.keys(this.touches).forEach(function(r){var i=e.touches[r];i.index===t&&(n=i.offsetX)}),n}},{key:"getOffsetY",value:function(t){var e=this,n=void 0;return Object.keys(this.touches).forEach(function(r){var i=e.touches[r];i.index===t&&(n=i.offsetY)}),n}},{key:"getOffset",value:function(t){var e=this,n=void 0;return Object.keys(this.touches).forEach(function(r){var i=e.touches[r];i.index===t&&(n={x:i.offsetX,y:i.offsetY})}),n}},{key:"getPinch",value:function(){var t=0;if(this.count>=2){if(void 0===this.pinchTouches[1])for(var e in this.touches)if(t<2&&(this.pinchTouches[t]=this.touches[e],t++),2===t){this.pinchActive=!0,this.pinchStart=k.dist(this.pinchTouches[0].x,this.pinchTouches[0].y,this.pinchTouches[1].x,this.pinchTouches[1].y);break}this.pinch=k.dist(this.pinchTouches[0].x,this.pinchTouches[0].y,this.pinchTouches[1].x,this.pinchTouches[1].y)-this.pinchStart,this.pinchStart=k.dist(this.pinchTouches[0].x,this.pinchTouches[0].y,this.pinchTouches[1].x,this.pinchTouches[1].y)}else this.pinchStart=0,this.pinch=0,this.pinchTouches=[];return this.pinch}}]),e}(),kt=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),Pt=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};var Rt=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._accAvailable=window.DeviceMotionEvent,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,d),kt(e,[{key:"setup",value:function(){this.rotationRate=new M,this.acc=new M,this.userAcc=new M,this.smoothedAcc=new M,this.accel=[0,0,0],this.kFilteringFactor=.07,this.gravityVector=new M}},{key:"on",value:function(){var t=this;this._accAvailable?(Pt(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"on",this).call(this),window.addEventListener("devicemotion",function(e){return t.onDeviceMotion(e)})):q.info("this device doesn't have acceloremeters")}},{key:"off",value:function(){var t=this;Pt(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"off",this).call(this),window.removeEventListener("devicemotion",function(e){return t.onDeviceMotion(e)})}},{key:"onDeviceMotion",value:function(t){var e=this,n=1;"Android"===ft.getOS()&&(n=-1),t.acceleration&&(this.userAcc.x=t.acceleration.x*n,this.userAcc.y=t.acceleration.y*n,this.userAcc.z=t.acceleration.z*n,null!==t.acceleration.x&&void 0!==t.acceleration.x||this.computeUserAcc(),this.events.trigger("acceleration",this.userAcc)),t.accelerationIncludingGravity&&(this.acc.x=t.accelerationIncludingGravity.x*n,this.acc.y=t.accelerationIncludingGravity.y*n,this.acc.z=t.accelerationIncludingGravity.z*n,this.events.trigger("accelerationIncludingGravity",this.acc),this.events.trigger("accelerationGravityVector",function(){return e.computeGravityVector(),e.gravityVector})),t.rotationRate&&(this.rotationRate.x=t.rotationRate.alpha,this.rotationRate.y=t.rotationRate.beta,this.rotationRate.z=t.rotationRate.gamma,this.events.trigger("rotationrate",this.rotationRate))}},{key:"computeUserAcc",value:function(){this.accel[0]=this.acc.x*this.kFilteringFactor+this.accel[0]*(1-this.kFilteringFactor),this.accel[1]=this.acc.y*this.kFilteringFactor+this.accel[1]*(1-this.kFilteringFactor),this.accel[2]=this.acc.z*this.kFilteringFactor+this.accel[2]*(1-this.kFilteringFactor),this.userAcc.x=this.acc.x-this.accel[0],this.userAcc.y=this.acc.y-this.accel[1],this.userAcc.z=this.acc.z-this.accel[2]}},{key:"computeGravityVector",value:function(){this.accel[0]=this.acc.x*this.kFilteringFactor+this.accel[0]*(1-this.kFilteringFactor),this.accel[1]=this.acc.y*this.kFilteringFactor+this.accel[1]*(1-this.kFilteringFactor),this.accel[2]=this.acc.z*this.kFilteringFactor+this.accel[2]*(1-this.kFilteringFactor),this.gravityVector.z=this.accel[2]*(360/(2*Math.PI))*1.1,this.gravityVector.x=this.accel[1]*(360/(2*Math.PI))*1.1,this.gravityVector.y=Math.atan2(this.accel[0],this.accel[1])*(180/Math.PI)}},{key:"getUserAcc",value:function(){return this.userAcc}},{key:"getAcc",value:function(){return this.acc}},{key:"getGravityVector",value:function(){return this.gravityVector}},{key:"getSmoothedAcc",value:function(t){return this.smoothedAcc.x=this.acc.x*t+this.smoothedAcc.x*(1-t),this.smoothedAcc.y=this.acc.y*t+this.smoothedAcc.y*(1-t),this.smoothedAcc.z=this.acc.z*t+this.smoothedAcc.z*(1-t),this.smoothedAcc}}]),e}(),Lt=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),It=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};var Dt=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.compassAvailable=window.DeviceOrientationEvent,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,d),Lt(e,[{key:"setup",value:function(){this.compass=new M,this.deviceRotationMatrix=new w,this.deviceHeading=null,this.deviceAttitude=null,this.deviceBank=null}},{key:"on",value:function(){var t=this;It(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"on",this).call(this),window.addEventListener("deviceorientation",function(e){return t.onDeviceOrientation(e)}),window.addEventListener("compassneedscalibration",function(e){return t.onCompassCalibration(e)})}},{key:"off",value:function(){var t=this;It(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"off",this).call(this),window.removeEventListener("deviceorientation",function(e){return t.onDeviceOrientation(e)}),window.removeEventListener("compassneedscalibration",function(e){return t.onCompassCalibration(e)})}},{key:"getDeviceOrientation",value:function(){return this.compass}},{key:"createGyroQuaternion",value:function(t,e,n,r){if(0!==t&&0!==e&&0!==n){var i,o=new E,a=new _,s=new E,u=new E(-Math.sqrt(.5),0,0,Math.sqrt(.5));return a.set(e,t,-n,"YXZ"),o.setFromEuler(a),i=-r/2,s.set(0,Math.sin(i),0,Math.cos(i)),o.multiply(s),o.multiply(u),o}return new E(0,0,0)}},{key:"getGyroQuaternion",value:function(){return this.compassAvailable&&this.compass.alpha?this.createGyroQuaternion(k.degToRad(this.compass.alpha),k.degToRad(this.compass.beta),k.degToRad(this.compass.gamma),k.degToRad(window.orientation||0)):null}},{key:"onCompassCalibration",value:function(t){this.events.trigger("compassneedscalibration",t)}},{key:"onDeviceOrientation",value:function(t){this.compass.alpha=t.alpha,this.compass.beta=t.beta,this.compass.gamma=t.gamma,t.webkitCompassHeading?this.compass.heading=t.webkitCompassHeading:this.compass.heading=-t.alpha,this.events.trigger("deviceorientation",this.compass)}},{key:"computeRotationMatrix",value:function(t,e,n){var r=e?k.degToRad(e):0,i=n?k.degToRad(n):0,o=t?k.degToRad(t):0,a=Math.cos(r),s=Math.cos(i),u=Math.cos(o),l=Math.sin(r),c=Math.sin(i),h=Math.sin(o),p=u*s-h*l*c,f=-a*h,d=s*h*l+u*c,m=s*h+u*l*c,g=u*a,v=h*c-u*s*l,y=-a*c,b=l,_=a*s;return this.deviceRotationMatrix.set(p,m,y,0,f,g,b,0,d,v,_,0,0,0,0,1),f>.998?(this.deviceHeading=Math.atan2(y,_),this.deviceAttitude=Math.PI/2,void(this.deviceBank=0)):f<-.998?(this.deviceHeading=Math.atan2(y,_),this.deviceAttitude=-Math.PI/2,void(this.deviceBank=0)):(this.deviceHeading=Math.atan2(-d,p),this.deviceBank=Math.atan2(-b,g),void(this.deviceAttitude=Math.asin(f)))}},{key:"updateDeviceRotationMatrix",value:function(){this.computeRotationMatrix(this.compass.alpha,this.compass.beta,this.compass.gamma)}},{key:"getDeviceRotationMatrix",value:function(){return this.updateDeviceRotationMatrix(),this.deviceRotationMatrix}}]),e}(),Nt=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),jt=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};function Ut(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Ft=function(t){function e(t){Ut(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r._enableHighAccuracy=n(t,"enableHighAccuracy",!1),r._maximumAge=n(t,"maximumAge",void 0),r._timeout=n(t,"timeout",void 0),r._GPSAvailable=void 0!==navigator&&"geolocation"in navigator,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,d),Nt(e,[{key:"setup",value:function(){this._location={latitude:null,longitude:null,altitude:null,accuracy:null,altitudeAccuracy:null,heading:null,speed:null,timestamp:null}}},{key:"on",value:function(){var t=this;if(this._GPSAvailable){jt(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"on",this).call(this);var n={enableHighAccuracy:this._enableHighAccuracy,timeout:this._timeout,maximumAge:this._maximumAge};this._watchID=navigator.geolocation.watchPosition(function(e){return t.updateLocationCallBack(e)},function(e){return t.updateLocationErrorCallBack(e)},n)}else q.info("this device has no GPS!")}},{key:"off",value:function(){jt(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"off",this).call(this),navigator.geolocation.clearWatch(this._watchID)}},{key:"setEnableHighAccuracy",value:function(t){this._enableHighAccuracy=t}},{key:"setTimeout",value:function(t){this._timeout=t}},{key:"setMaximumAge",value:function(t){this._maximumAge=t}},{key:"getLocation",value:function(){return this._active?this._location:(q.warn("geolocation is off, turn it on with context.input.setGeolocationStatus(true);"),null)}},{key:"updateLocationCallBack",value:function(t){this._location.longitude=t.coords.longitude,this._location.latitude=t.coords.latitude,this._location.altitude=t.coords.altitude,this._location.accuracy=t.coords.accuracy,this._location.altitudeAccuracy=t.coords.altitudeAccuracy,this._location.heading=t.coords.heading,this._location.speed=t.coords.speed,this._location.timestamp=t.timestamp,this._location.error="no error",this.events.trigger("locationupdated",this._location)}},{key:"updateLocationErrorCallBack",value:function(t){1===t.code?(console.error("location permission denied"),this._location.error="location permission denied"):2===t.code?(console.error("location unavailable"),this._location.error="location unavailable"):3===t.code&&(console.error("location timeout"),this._location.error="location timeout"),this.events.trigger("locationerror",this._location.error)}},{key:"resetLocation",value:function(){this._location={latitude:null,longitude:null,altitude:null,accuracy:null,altitudeAccuracy:null,heading:null,speed:null,timestamp:null}}}]),e}(),Bt={};Bt.zoom=1,Bt.worldSize=512*Math.pow(2,Bt.zoom);var zt=function(){function t(){Ut(this,t)}return Nt(t,null,[{key:"getPixelsCoordsFromOSMLngLat",value:function(e,n,r){return r&&(Bt.zoom=r,Bt.worldSize=512*Math.pow(2,Bt.zoom)),{x:t.lngX(e),y:t.latY(n)}}},{key:"getCoordinateInMap",value:function(e,n,r,i,o,a){a&&(Bt.zoom=a);var s=r[0],u=r[1],l=r[2],c=r[3],h=t.getPixelsCoordsFromOSMLngLat(l,c),p=t.getPixelsCoordsFromOSMLngLat(s,c),f=t.getPixelsCoordsFromOSMLngLat(l,u),d=t.getPixelsCoordsFromOSMLngLat(e,n);return{x:k.map(d.x,h.x,p.x,i/2,-o/2),y:k.map(d.y,h.y,f.y,i/2,-o/2)}}},{key:"lngX",value:function(t){return(180+t)*Bt.worldSize/360}},{key:"latY",value:function(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))*Bt.worldSize/360}},{key:"xLng",value:function(t){return 360*t/Bt.worldSize-180}},{key:"yLat",value:function(t){var e=180-360*t/Bt.worldSize;return 360/Math.PI*Math.atan(Math.exp(e*Math.PI/180))-90}},{key:"getPolarFromLngLat",value:function(t,e,n){var r=k.degToRad(t+180),i=k.degToRad(90-e);return{x:-n*Math.cos(r)*Math.sin(i),y:n*Math.cos(i),z:n*Math.sin(i)*Math.sin(r)}}}]),t}(),Gt=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Ht=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return Gt(t,null,[{key:"Noise",value:function(t,e){for(var n=t.getVertices(),r=0;r<n.length;++r){var i=new M(Math.random()-.5,Math.random()-.5,Math.random()-.5);n[r]=new M(n[r].x+i.x*e,n[r].y+i.y*e,n[r].z+i.z*e)}t.setVertices(n)}},{key:"Nothing",value:function(t){for(var e=t.getVertices(),n=0;n<e.length;++n)e[n]=new M(e[n].x,e[n].y,e[n].z);t.setVertices(e)}},{key:"Offset",value:function(t,e){for(var n=t.getVertices(),r=0;r<n.length;++r)n[r]=new M(n[r].x+e.x,n[r].y+e.y,n[r].z+e.z);t.setVertices(n)}},{key:"Scale",value:function(t,e){for(var n=t.getVertices(),r=0;r<n.length;++r)n[r]=new M(n[r].x*e.x,n[r].y*e.y,n[r].z*e.z);t.setVertices(n)}}]),t}(),Vt=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Wt=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.midioutname=t.out,n.midiinname=t.in,n.onMidiIn=t.onMidiIn,q.log("params.onMidiIn="+t.onMidiIn),q.log("this.onMidiIn="+n.onMidiIn),navigator.requestMIDIAccess?navigator.requestMIDIAccess().then(n.onMIDIInit.bind(n),n.onMIDIReject.bind(n)):console.warn("No MIDI support present in your browser. Try in another browser."),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,d),Vt(e,[{key:"onMIDIInit",value:function(t){this.midiAccess=t,this.hookUpMIDI(),this.midiAccess.onstatechange=this.hookUpMIDI}},{key:"onMIDIReject",value:function(t){alert("\n            The MIDI system failed to start.\n            You're gonna have a bad time.\n            Error: "+t.message+"\n        ")}},{key:"hookUpMIDI",value:function(){if(void 0!==this.midiinname){var t=this.midiAccess.inputs.values();q.log("MIDI inputs on your system : ");for(var e=t.next();e&&!e.done;e=t.next())q.log("input=",e),e.value.name===this.midiinname&&(q.log("found midi interface IN : "+e.value.name),e.value.onmidimessage=this.onMIDIMessage.bind(this))}if(void 0!==this.midioutname){var n=this.midiAccess.outputs.values();q.log("MIDI outputs on your system : ");for(var r=n.next();r&&!r.done;r=n.next())q.log("output=",r),r.value.name===this.midioutname&&(q.log("found midi interface OUT : "+r.value.name),this.midioutput=r.value)}}},{key:"onMIDIMessage",value:function(t){if(q.log("this.onMidiIn="+this.onMidiIn),void 0!==this.onMidiIn){var e=240&t.data[0],n=t.data[0]-e,r=t.data[1],i=t.data[2];this.onMidiIn(n,e,r,i)}}},{key:"ControlChange",value:function(t,e,n){if(void 0!==this.midioutput){var r;r=[176+t,e,n],this.midioutput.send(r)}}},{key:"NoteOn",value:function(t,e,n){if(void 0!==this.midioutput){var r;r=[144+t,e,n],this.midioutput.send(r)}}},{key:"NoteOff",value:function(t,e,n){if(void 0!==this.midioutput){var r;r=[128+t,e,n],this.midioutput.send(r)}}}]),e}();Wt.NoteOn=144,Wt.NoteOff=128,Wt.Aftertouch=160,Wt.ControlChange=176,Wt.ProgramChange=192;var qt=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Xt=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.timers=[],n.current_frame=0,n.last_time=0,n.initialize(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,d),qt(e,[{key:"initialize",value:function(){this.last_time=this.getTime()}},{key:"update",value:function(){var t=this.getTime(),e=t-this.last_time;this.last_time=t;var n=this.timers[this.current_frame];n||(n={},this.timers[this.current_frame]=n),this.timers[this.current_frame].dt=e,this.current_frame++,this.logTimers()}},{key:"startTimer",value:function(){}},{key:"getTime",value:function(){return Date.now()}},{key:"logTimers",value:function(){console.log("Profiler timers : "+this.timers.map(function(t){return t.dt}).join(" "))}}]),e}(),Yt=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var $t=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.callback=n(e,"callback",void 0),this.context=e.context,"complete"===document.readyState?this.run():window.addEventListener("load",this.run.bind(this)),this.frame=0}return Yt(t,[{key:"run",value:function(){var t=this;this.context.init(),this.context.preLoad(),this.context.loader.events.on("complete",function(){t.startLoop()}),this.context.loader.consumeAll()}},{key:"startLoop",value:function(){this.context.setup(),this.loop()}},{key:"onFrameBegin",value:function(){this.frame++,void 0!==this.context.stats&&this.context.stats.begin()}},{key:"onFrameEnd",value:function(){void 0!==this.context.stats&&this.context.stats.end()}},{key:"loop",value:function(){this.onFrameBegin(),this.context.update(),this.onFrameEnd(),requestAnimationFrame(this.loop.bind(this))}}]),t}(),Zt=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Jt="readystatechange",Kt="start",Qt="progress",te="load",ee="success",ne="error",re=function(){function t(e){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.url=e.url,this.method=n(e,"method","GET");var i=n(e,"data",null),o=n(e,"headers",null);this.async=n(e,"async",!0);var a=n(e,"autoSend",!0),s=n(e,"withCredentials",null),u=n(e,"timeout",null),l=n(e,"responseType","text"),c=n(e,"onReadyStateChange",null),h=n(e,"onStart",null),f=n(e,"onProgress",null),d=n(e,"onLoad",null),m=n(e,"onSuccess",null),g=n(e,"onError",null);if(this.events=new p({scope:this}),this._xhr=new XMLHttpRequest,c&&this.events.on(Jt,c),h&&this.events.on(Kt,h),f&&this.events.on(Qt,f),d&&this.events.on(te,d),m&&this.events.on(ee,m),g&&this.events.on(ne,g),this._xhr.addEventListener("readystatechange",this.onReadyStateChange.bind(this)),"GET"===this.method&&i){var v=[];Object.keys(i).forEach(function(t){v.push(t+"="+encodeURIComponent(i[t]))}),this.url+="?"+v.join("&"),i=null}this.setResponseType(l),null!==o&&Object.keys(o).forEach(function(t){r.setRequestHeader(t,o[t])}),null!==s&&this.setWithCredentials(s),null!==u&&this.setTimeout(u),a&&(this._xhr.open(this.method,this.url,this.async),this.send(i))}return Zt(t,[{key:"onReadyStateChange",value:function(){switch(this.events.trigger(Jt,this),this.getReadyState()){case XMLHttpRequest.OPENED:this.events.trigger(Kt,this);break;case XMLHttpRequest.LOADING:this.events.trigger(Qt,this);break;case XMLHttpRequest.DONE:var t=this.getStatus(),e=!1;200===t&&t<300||304===t?e=!0:0!==t||this._xhr.error||(e=!0),this.events.trigger(te,this,e),e?this.events.trigger(ee,this):this.events.trigger(ne,this)}}},{key:"getXHR",value:function(){return this._xhr}},{key:"setRequestHeader",value:function(t,e){this._xhr.setRequestHeader(t,e)}},{key:"setWithCredentials",value:function(t){this._xhr.withCredentials=t}},{key:"setTimeout",value:function(t){this._xhr.timeout=t}},{key:"setResponseType",value:function(t){this._xhr.responseType=t}},{key:"send",value:function(t){this._xhr.open(this.method,this.url,this.async),this._xhr.send(t)}},{key:"abort",value:function(){this._xhr.abort()}},{key:"getStatus",value:function(){return this._xhr.status}},{key:"getStatusText",value:function(){return this._xhr.statusText}},{key:"getReadyState",value:function(){return this._xhr.readyState}},{key:"getResponseType",value:function(){return this._xhr.responseType}},{key:"getResponse",value:function(){return this._xhr.response}},{key:"getResponseText",value:function(){return this._xhr.responseText}},{key:"getJSON",value:function(){return JSON.parse(this.getResponseText())}}],[{key:"get",value:function(e){return e.method="GET",new t(e)}},{key:"post",value:function(e){return e.method="POST",new t(e)}},{key:"put",value:function(e){return e.method="PUT",new t(e)}}]),t}(),ie=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var oe=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return ie(t,null,[{key:"load",value:function(e,n){return t.callBack=n.onLoad,e.loadText({url:n.url,onLoad:t.parseOBJ.bind(null,e)})}},{key:"attachTexture",value:function(t,e,n){q.log("attachTexture ",t,e,n),e.material.setTexture(n)}},{key:"parseMTL",value:function(e,n,r){q.log("model="+n),q.log("mtl content =",r),r.toString().split("\n").forEach(function(r){var i=r.split(" ");switch(i[0]){case"#":break;case"newmtl":q.log("new material : "+i[1]);break;case"Ka":n.material.setEmissiveColor(new Mobilizing.Color(i[1],i[2],i[3]));break;case"Kd":n.material.setColor(new Mobilizing.Color(i[1],i[2],i[3]));break;case"Ks":n.material.setSpecularColor(new Mobilizing.Color(i[1],i[2],i[3])),n.material._material.shininess=20;break;case"Ns":case"d":case"Tr":case"illum":break;case"map_Kd":e.loadTexture({url:i[1],onLoad:t.attachTexture.bind(null,e,n)}),n.updateMaterial();break;default:q.log("unknown MTL line : ",r)}})}},{key:"parseOBJ",value:function(e,n){q.log("onLoaded data=",n),q.log("loader=",e),t.text=n,q.log("text=",t.text);var r=void 0;void 0!==t.mesh?r=t.mesh:(q.log("create material"),(r=new ot({})).clear(),r.material=new G({type:"phong"}),q.log("Material created : ",r.material)),q.log("parsing obj file...");var i=[],o=[];t.text.toString().split("\n").forEach(function(n){var a=n.split(" ");switch(a[0]){case"mtllib":q.log("mtllib "+a[1]),t.resultmtl=e.loadText({url:a[1],onLoad:t.parseMTL.bind(null,e,r)});break;case"usemtl":q.log("usemtl "+a[1]);break;case"o":q.log("OBJ o "+a[1]);break;case"g":q.log("OBJ g "+a[1]);break;case"v":r.pushVertex(new M(a[1],a[2],a[3]));break;case"vt":q.log("uv "+a[1]+" "+a[2]),i.push(new A(a[1],a[2]));break;case"vn":o.push(new M(a[1],a[2],a[3]));break;case"s":break;case"f":var s=a[1].split("/"),u=a[2].split("/"),l=a[3].split("/");if(r.pushFace(s[0]-1,u[0]-1,l[0]-1),r.pushUV(i[s[1]-1],i[u[1]-1],i[l[1]-1]),a.length>4){var c=a[4].split("/");r.pushFace(s[0]-1,l[0]-1,c[0]-1),r.pushUV(i[s[1]-1],i[l[1]-1],i[c[1]-1])}}}),r.updateMesh(),r.computeNormals(),q.log("callback called : ",r),t.callBack(r)}}]),t}(),ae=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function se(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var ue="start",le="load",ce="error",he="load",pe="error",fe="complete",de="pending",me=function(){function t(e){se(this,t),this._consumeCallback=e.consume,this._value=void 0,this._error=void 0,this.events=new p({scope:this});var r=n(e,"onStart",null),i=n(e,"onLoad",null),o=n(e,"onError",null);r&&this.events.on(ue,r),i&&this.events.on(le,i),o&&this.events.on(ce,o)}return ae(t,[{key:"consume",value:function(){this._consumeCallback(this)}},{key:"setValue",value:function(t){this._value=t}},{key:"getValue",value:function(){return this._value}},{key:"setError",value:function(t){this._error=t}},{key:"getError",value:function(){return this._error}}]),t}(),ge=function(){function t(e){se(this,t);var r=n(e,"onLoad",null),i=n(e,"onError",null),o=n(e,"onComplete",null);this._status=de,this._requests=[],this._complete=0,this.events=new p({scope:this}),r&&this.events.on(he,r),i&&this.events.on(pe,i),o&&this.events.on(fe,o)}return ae(t,[{key:"consumeAll",value:function(){if(this._requests.length>0){this._status="loading";var t=!0,e=!1,n=void 0;try{for(var r,i=this._requests[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){r.value.consume()}}catch(t){e=!0,n=t}finally{try{!t&&i.return&&i.return()}finally{if(e)throw n}}}else this.doComplete()}},{key:"doComplete",value:function(){this._status="complete",this.events.trigger(fe,this._requests)}},{key:"load",value:function(t){var e=this,r=t.url,i=n(t,"onStart",null),o=n(t,"onLoad",null),a=n(t,"onError",null),s=n(t,"responseType",""),u=n(t,"processData",function(t){return t.getResponse()}),l=new re({url:r,responseType:s,autoSend:!1}),c=new me({consume:function(){l.send()},onStart:i,onLoad:o,onError:a});return l.events.on("start",function(){c.events.trigger(ue)}),l.events.on("success",function(t){var n=u(t,e);c.setValue(n),c.events.trigger(le,n),e.events.trigger(he,c),e._complete++,e._complete===e._requests.length&&e.doComplete()}),l.events.on("error",function(t){var n=t.getStatusText();c.setError(n),c.events.trigger(ce,n),e.events.trigger(pe,c),e._complete++,e._complete===e._requests.length&&e.doComplete()}),this._requests.push(c),"loading"===this._status&&c.consume(),c}},{key:"loadText",value:function(t){return this.load(Object.assign({},t,{responseType:"text"}))}},{key:"loadJSON",value:function(t){return this.load(Object.assign({},t,{responseType:"json"}))}},{key:"loadImage",value:function(t){var e=this,r=t.url,i=n(t,"onStart",null),o=n(t,"onLoad",null),a=n(t,"onError",null),s=new Image,u=new me({consume:function(t){s.src=r,t.events.trigger(ue)},onStart:i,onLoad:o,onError:a});return s.addEventListener("load",function(){u.setValue(s),u.events.trigger(le,s),e.events.trigger(he,u),e._complete++,e._complete===e._requests.length&&e.doComplete()},!1),s.addEventListener("error",function(){var t="Error loading the image "+r;u.setError(t),u.events.trigger(ce,t),e.events.trigger(pe,u),e._complete++,e._complete===e._requests.length&&e.doComplete()}),this._requests.push(u),"loading"===this._status&&u.consume(),u}},{key:"loadVideo",value:function(t){var e=this,r=t.url,i=n(t,"onStart",null),o=n(t,"onLoad",null),a=n(t,"onError",null),s=document.createElement("video");s.autoplay=!1;var u=new me({consume:function(t){s.src=r,s.setAttribute("crossorigin","anonymous"),s.load(),t.events.trigger(ue)},onStart:i,onLoad:o,onError:a});return s.addEventListener("canplay",function(){u.setValue(s),u.events.trigger(le,s),e.events.trigger(he,u),e._complete++,e._complete===e._requests.length&&e.doComplete()},!1),s.addEventListener("error",function(){var t="Error loading the video "+r+" "+s.error.code;q.log(s.error),u.setError(t),u.events.trigger(ce,t),e.events.trigger(pe,u),e._complete++,e._complete===e._requests.length&&e.doComplete()}),this._requests.push(u),"loading"===this._status&&u.consume(),u}},{key:"loadArrayBuffer",value:function(t){return this.load(Object.assign({},t,{responseType:"arraybuffer"}))}},{key:"loadBlob",value:function(t){return this.load(Object.assign({},t,{responseType:"blob"}))}},{key:"loadOBJ",value:function(t){return oe.load(this,t)}},{key:"loadTexture",value:function(t){var e=new K;console.log("try to load "+t.url);var n=this.loadImage({url:t.url,onLoad:function(n){e.fromImage(n),void 0!==t.onLoad&&(console.log("call onLoad:",t.onLoad),t.onLoad(e))}});return console.log("result=",n),e}}],[{key:"load",value:function(e,n,r,i){if(t.Cache.isLoading(e)&&n)return t.Cache.addCallback(e,n),null;if(t.Cache.isCached(e))return q.info("ressource "+e+" is cached and won't be loaded again"),t.Cache.get(e);t.Cache.addKey(e);var o=new re({url:e,responseType:r,autoSend:!1});return void 0===i&&(i=function(t){return t.getResponse()}),o.events.on("success",function(r){var o=i(r);n(o),t.Cache.addValue(e,o)}),o.events.on("error",function(t){n(void 0,t.getStatusText())}),o.send(),null}},{key:"loadText",value:function(e,n){t.load(e,n,"text")}},{key:"loadJSON",value:function(e,n){t.load(e,n,"json")}},{key:"loadArrayBuffer",value:function(e,n){t.load(e,n,"arraybuffer")}},{key:"loadBlob",value:function(e,n){t.load(e,n,"blob")}},{key:"loadImage",value:function(t,e){var n=new Image;n.addEventListener("load",function(){e(n)},!1),n.addEventListener("error",function(){e(void 0,"Error loading the image "+t)},!1),n.src=t}},{key:"loadScript",value:function(t,e){var n=document.createElement("script");document.head.appendChild(n),n.addEventListener("load",e),n.src=t}}]),t}(),ve=function(){function t(){se(this,t),this.enabled=!0,this.files={},this.callbacks=[]}return ae(t,[{key:"enable",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.enabled=t}},{key:"add",value:function(t,e){!0!==this.enabled||this.getKey(t)||(q.info("Cache Adding key and file:",t,e),this.files[t]=e)}},{key:"addKey",value:function(t){!0!==this.enabled||this.getKey(t)||(q.info("Cache Adding key:",t),this.files[t]=void 0)}},{key:"addValue",value:function(t,e){if(!1!==this.enabled&&this.getKey(t)&&void 0===this.files[t]&&this.getKey(t)&&void 0===this.files[t]){q.info("Cache Adding value:",e,"to key",t),this.files[t]=e;for(var n=this.callbacks.length-1;n>=0;n--){if(this.callbacks[n].key===t)(0,this.callbacks[n].callback)(e),this.callbacks.splice(n,1)}q.log("this.callbacks.length",this.callbacks.length)}}},{key:"get",value:function(t){return!1===this.enabled?null:this.files[t]}},{key:"remove",value:function(t){delete this.files[t]}},{key:"isCached",value:function(t){return this.files.hasOwnProperty(t)&&void 0!==this.files[t]}},{key:"isLoading",value:function(t){return this.files.hasOwnProperty(t)&&void 0===this.files[t]}},{key:"getKey",value:function(t){for(var e=Object.keys(this.files),n=0;n<e.length;n++)if(e[n]===t)return e[n]}},{key:"clear",value:function(){this.files={}}},{key:"addCallback",value:function(t,e){var n={key:t,callback:e};this.callbacks.push(n)}}]),t}();ge.Cache=new ve;var ye=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function be(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _e=function(){function t(e){be(this,t);var r=n(e,"x",0),i=n(e,"y",0),o=n(e,"state",!1),a=n(e,"type",void 0);this._x=r,this._y=i,this._deltaX=0,this._deltaY=0,this._state=o,this._type=a,this._component=null}return ye(t,[{key:"setComponent",value:function(t){this._component=t}},{key:"getComponent",value:function(){return this._component}},{key:"setX",value:function(t){this._x=t}},{key:"setY",value:function(t){this._y=t}},{key:"getX",value:function(){return this._x}},{key:"getY",value:function(){return this._y}},{key:"setDeltaX",value:function(t){this._deltaX=t}},{key:"setDeltaY",value:function(t){this._deltaY=t}},{key:"getDeltaX",value:function(){return this._deltaX}},{key:"getDeltaY",value:function(){return this._deltaY}},{key:"setState",value:function(t){this._state=t}},{key:"getState",value:function(){return this._state}},{key:"setType",value:function(t){this._type=t}},{key:"getType",value:function(){return this._type}}]),t}(),xe=function(t){function e(t){be(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),i=n(t,"components",void 0);return r.pointers=new Map,r.lastActivePointer=new _e,r.lastActivePointer.setType("lastActive"),Array.isArray(i)&&i.forEach(function(t){r.add(t)}),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,d),ye(e,[{key:"postUpdate",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this.pointers.keys()[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value,a=this.pointers.get(o);!1===a.getState()&&"touch"===a.getType()&&this.pointers.delete(o),"touch"===a.getType()?(a.setDeltaX(a.getComponent().getDeltaX()),a.setDeltaY(a.getComponent().getDeltaY())):"mouse"===a.getType()&&(a.setDeltaX(a.getComponent().getDeltaX()),a.setDeltaY(a.getComponent().getDeltaY()))}}catch(t){e=!0,n=t}finally{try{!t&&i.return&&i.return()}finally{if(e)throw n}}}},{key:"add",value:function(t){var e=this;if(t instanceof Ct){var n=t;n.events.on("touchstart",function(n){var r=new _e;r.setComponent(t),r.setType("touch"),r.setState(!0),r.setX(n.x),r.setY(n.y),e.pointers.set(n.id,r),e.events.trigger("on",{pointer:r,x:r.getX(),y:r.getY()}),e.lastActivePointer.setState(!0),e.lastActivePointer.setX(n.x),e.lastActivePointer.setY(n.y)}),n.events.on("touchmoved",function(t){var n=e.pointers.get(t.id);n.setState(!0),n.setX(t.x),n.setY(t.y),n.setDeltaX(t.xDelta),n.setDeltaY(t.yDelta),e.events.trigger("moved",{pointer:n,x:n.getX(),y:n.getY()}),e.lastActivePointer.setState(!0),e.lastActivePointer.setX(t.x),e.lastActivePointer.setY(t.y),e.lastActivePointer.setDeltaX(t.xDelta),e.lastActivePointer.setDeltaY(t.yDelta)}),n.events.on("touchend",function(t){var n=e.pointers.get(t.id);n.setState(!1),n.setX(t.x),n.setY(t.y),e.events.trigger("off",{pointer:n}),e.lastActivePointer.setState(!1),e.lastActivePointer.setX(t.x),e.lastActivePointer.setY(t.y)})}else if(t instanceof St){var r=t;r.events.on("mousepress",function(){var n=e.pointers.get(t.getID());n.setState(!0),e.events.trigger("on",{pointer:n,x:n.getX(),y:n.getY()}),e.lastActivePointer.setState(!0)}),r.events.on("mouserelease",function(){var n=e.pointers.get(t.getID());n.setState(!1),e.events.trigger("off",{pointer:n}),e.lastActivePointer.setState(!1)}),r.events.on("mousemove",function(n){var i=e.pointers.get(t.getID());i.setDeltaX(r.getDeltaX()),i.setDeltaY(r.getDeltaY()),i.setX(n.x),i.setY(n.y),e.events.trigger("moved",{pointer:i,x:i.getX(),y:i.getY()}),e.lastActivePointer.setState(!0),e.lastActivePointer.setX(i.getX()),e.lastActivePointer.setY(i.getY()),e.lastActivePointer.setDeltaX(i.getDeltaX()),e.lastActivePointer.setDeltaY(i.getDeltaY())}),r.events.on("mouseupdate",function(){var n=e.pointers.get(t.getID());n.setDeltaX(r.getDeltaX()),n.setDeltaY(r.getDeltaY()),e.lastActivePointer.setState(!0),e.lastActivePointer.setDeltaX(n.getDeltaX()),e.lastActivePointer.setDeltaY(n.getDeltaY())});var i=new _e;i.setComponent(t),i.setType("mouse"),this.pointers.set(t.getID(),i)}}},{key:"get",value:function(t){return this.pointers.get(t.id)}},{key:"getPointers",value:function(){return Array.from(this.pointers.values())}},{key:"getState",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this.pointers.values()[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){if(r.value.getState())return!0}}catch(t){e=!0,n=t}finally{try{!t&&i.return&&i.return()}finally{if(e)throw n}}return this.events.trigger("off"),!1}},{key:"getX",value:function(t){var e=[],n=!0,r=!1,i=void 0;try{for(var o,a=this.pointers.values()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;e.push(s.getX())}}catch(t){r=!0,i=t}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return t?void 0===t?e:e[t]:this.lastActivePointer.getX()}},{key:"getY",value:function(t){var e=[],n=!0,r=!1,i=void 0;try{for(var o,a=this.pointers.values()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;e.push(s.getY())}}catch(t){r=!0,i=t}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return t?void 0===t?e:e[t]:this.lastActivePointer.getY()}},{key:"getDeltaX",value:function(t){var e=[],n=!0,r=!1,i=void 0;try{for(var o,a=this.pointers.values()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;e.push(s.getDeltaX())}}catch(t){r=!0,i=t}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return t?void 0===t?e:e[t]:this.lastActivePointer.getDeltaX()}},{key:"getDeltaY",value:function(t){var e=[],n=!0,r=!1,i=void 0;try{for(var o,a=this.pointers.values()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;e.push(s.getDeltaY())}}catch(t){r=!0,i=t}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return t?void 0===t?e:e[t]:this.lastActivePointer.getDeltaY()}}]),e}(),we=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Ee=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r=n(e,"url",""),i=n(e,"autoConnect",!0);this.events=new p({scope:this}),i&&this.open(r)}return we(t,[{key:"open",value:function(t){var e=this;if("undefined"==typeof io){var n=document.createElement("script");n.src=t+"/socket.io/socket.io.js",n.onload=function(){e.open(t)},document.head.appendChild(n)}else this.socket=io(t),this.socket.on("connect",function(){e.socket.on("disconnect",function(){e.events.trigger("disconnect")}),e.events.trigger("connect")}),this.socket.on("error",function(t){e.events.trigger("error",t)})}},{key:"close",value:function(){this.socket&&(this.socket.disconnect(),delete this.socket)}},{key:"publish",value:function(t,e){this.socket&&this.socket.emit("publish",{channel:t,message:e})}},{key:"subscribe",value:function(t,e){this.socket&&(this.socket.emit("subscribe",{channel:t}),this.socket.on(t,e))}},{key:"unsubscribe",value:function(t){this.socket&&(this.socket.emit("unsubscribe",{channel:t}),this.socket.off(t))}},{key:"getID",value:function(){return this.socket?this.socket.id:null}}]),t}(),Se=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Te=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.joints=[],r.bodies=[],r.iterations=n(t,"iterations",5),r.G=6.6742*Math.pow(10,-11),r.ke=8.99*Math.pow(10,9),r.relaxationCoeff=1,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,d),Se(e,[{key:"setup",value:function(){this.context=this.getContext(),this._time=new R,this.context.addComponent(this._time),this._time.setup(),this._time.on()}},{key:"update",value:function(){if(this._active){var t=void 0,e=void 0,n=void 0,r=void 0,i=void 0,o=void 0,a=void 0,s=void 0,u=this._time.getDelta();if(0===u)return;u>1&&(u=1);for(var l=void 0,c=0;c<this.bodies.length;++c)(t=this.bodies[c]).forces=new M(0,0,0);for(var h=0;h<this.joints.length;++h)if((e=this.joints[h]).enabled)if("spring"===e.type){n=e.body1.position,i=(r=e.body2.position).x-n.x,o=r.y-n.y,a=r.z-n.z,l=((s=Math.sqrt(i*i+o*o+a*a))-e.distance)*e.k,e.body1.forces.x+=i*l,e.body1.forces.y+=o*l,e.body1.forces.z+=a*l,e.body2.forces.x-=i*l,e.body2.forces.y-=o*l,e.body2.forces.z-=a*l;var p=e.body2.velocity.x-e.body1.velocity.x,f=e.body2.velocity.y-e.body1.velocity.y,d=e.body2.velocity.z-e.body1.velocity.z;e.body1.forces.x+=p*e.damping,e.body1.forces.y+=f*e.damping,e.body1.forces.z+=d*e.damping,e.body2.forces.x-=p*e.damping,e.body2.forces.y-=f*e.damping,e.body2.forces.z-=d*e.damping}else if("gravity"===e.type){n=e.body1.position,i=(r=e.body2.position).x-n.x,o=r.y-n.y,a=r.z-n.z,i/=s=Math.sqrt(i*i+o*o+a*a),o/=s,a/=s;var m=e.body1.mass+e.body2.mass;l=this.G*m/(s*s),e.body1.forces.x+=i*l,e.body1.forces.y+=o*l,e.body1.forces.z+=a*l,e.body2.forces.x-=i*l,e.body2.forces.y-=o*l,e.body2.forces.z-=a*l}else"electrostatics"===e.type&&(n=e.body1.position,i=(r=e.body2.position).x-n.x,o=r.y-n.y,a=r.z-n.z,i/=s=Math.sqrt(i*i+o*o+a*a),o/=s,a/=s,l=this.ke*e.charge1*e.charge2/(s*s),e.body1.forces.x-=i*l,e.body1.forces.y-=o*l,e.body1.forces.z-=a*l,e.body2.forces.x+=i*l,e.body2.forces.y+=o*l,e.body2.forces.z+=a*l);for(var g=0;g<this.bodies.length;++g){void 0!==(t=this.bodies[g]).speed?(t.velocity=new M(t.speed.x,t.speed.y,t.speed.z),t.speed=void 0):(t.velocity=new M(t.position.x-t.previousposition.x,t.position.y-t.previousposition.y,t.position.z-t.previousposition.z),t.velocity.x/=u,t.velocity.y/=u,t.velocity.z/=u),t.previousposition=new M(t.position.x,t.position.y,t.position.z),void 0!==this.globalgravity&&(t.forces.x+=this.globalgravity.x*t.mass,t.forces.y+=this.globalgravity.y*t.mass,t.forces.z+=this.globalgravity.z*t.mass),void 0!==this.globalwind&&(t.forces.x+=this.globalwind.x,t.forces.y+=this.globalwind.y,t.forces.z+=this.globalwind.z);var v=new M(0,0,0);v.x=t.forces.x/t.mass,v.y=t.forces.y/t.mass,v.z=t.forces.z/t.mass,t.velocity.x+=v.x*u,t.velocity.y+=v.y*u,t.velocity.z+=v.z*u,t.position.x+=t.velocity.x*u,t.position.y+=t.velocity.y*u,t.position.z+=t.velocity.z*u}for(var y=0;y<this.iterations;++y)for(var b=0;b<this.joints.length;++b)if((e=this.joints[b]).enabled)if("stick"===e.type||"string"===e.type){n=e.body1.position,i=(r=e.body2.position).x-n.x,o=r.y-n.y,a=r.z-n.z;var _=((s=Math.sqrt(i*i+o*o+a*a))-e.distance)/s*1;if("stick"===e.type||"string"===e.type&&s>e.distance){var x=_/2,w=_/2;e.body1.fixed?(x=0,w=_):e.body2.fixed&&(x=_,w=0),n.x=n.x+i*x*this.relaxationCoeff,r.x=r.x-i*w*this.relaxationCoeff,n.y=n.y+o*x*this.relaxationCoeff,r.y=r.y-o*w*this.relaxationCoeff,n.z=n.z+a*x*this.relaxationCoeff,r.z=r.z-a*w*this.relaxationCoeff}}else"fixed"===e.type&&(e.body1.position=new M(e.position.x,e.position.y,e.position.z),e.body1.velocity=new M(0,0,0));for(var E=0;E<this.bodies.length;++E)void 0!==(t=this.bodies[E]).object&&t.object.transform.setLocalPosition(t.position)}}},{key:"addBody",value:function(t,e,n){var r={};return r.position=new M(t.x,t.y,t.z),r.previousposition=new M(t.x,t.y,t.z),r.mass=e,r.object=n,r.velocity=new M(0,0,0),this.bodies.push(r),r}},{key:"addFixedJoint",value:function(t,e){var n={};return n.body1=t,n.body1.fixed=!0,n.type="fixed",n.position=new M(e.x,e.y,e.z),n.enabled=!0,this.joints.push(n),n}},{key:"addStickJoint",value:function(t,e,n){var r={};return r.body1=t,r.body2=e,r.type="stick",r.distance=n,r.enabled=!0,this.joints.push(r),r}},{key:"addSpringJoint",value:function(t,e,n,r,i){var o={};return o.body1=t,o.body2=e,o.type="spring",o.distance=n,o.k=r,o.damping=i,o.enabled=!0,this.joints.push(o),o}},{key:"addStringJoint",value:function(t,e,n){var r={};return r.body1=t,r.body2=e,r.type="string",r.distance=n,r.enabled=!0,this.joints.push(r),r}},{key:"addGravityJoint",value:function(t,e){var n={};return n.body1=t,n.body2=e,n.type="gravity",n.enabled=!0,this.joints.push(n),n}},{key:"addElectrostaticsJoint",value:function(t,e,n,r){var i={};return i.body1=t,i.body2=e,i.type="electrostatics",i.charge1=n,i.charge2=r,i.enabled=!0,this.joints.push(i),i}},{key:"setGlobalGravity",value:function(t){this.globalgravity=t}},{key:"setGlobalWind",value:function(t){this.globalwind=t}}]),e}(),Oe=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Ae=function(){function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e.canvas){var n=e.canvas;q.log("try to attach the Canvas...",n),this.renderer=new THREE.WebGLRenderer({canvas:n}),this.engine="webgl",void 0===this.renderer.devicePixelRatio&&(this.renderer.devicePixelRatio=window.devicePixelRatio),this.renderer.setPixelRatio(window.devicePixelRatio?window.devicePixelRatio:1),this.renderer.setSize(n.width/window.devicePixelRatio,n.height/window.devicePixelRatio),n.style.width=n.width/window.devicePixelRatio+"px",n.style.height=n.height/window.devicePixelRatio+"px",this.canvas=n,this.canvas.retinaResolutionEnabled=!0,this.windowWidth=this.canvas.clientWidth,this.windowHeight=this.canvas.clientHeight,q.log("existing CANVAS",this.renderer)}else q.log("retrieve Canvas failed, create a new canvas"),this.renderer=new THREE.WebGLRenderer({alpha:!0}),this.engine="webgl",this.renderer.setPixelRatio(window.devicePixelRatio?window.devicePixelRatio:1),void 0===this.renderer.devicePixelRatio&&(this.renderer.devicePixelRatio=window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(this.renderer.domElement),this.canvas=this.renderer.domElement,this.canvas.retinaResolutionEnabled=!0,this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight;q.log("engine = "+this.engine),this.renderer.setClearColor(0,1),this.renderer.autoClear=!0,q.log("window pixel ratio = "+window.devicePixelRatio)}return Oe(t,[{key:"getCanvas",value:function(){return this.canvas}}]),t}(),Me=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Ce=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.canvas=n(t,"canvas",void 0),r.scenes=[],r.cameras=[],r.fog=void 0,r.setCurrentScene("default"),r.engine=new Mobilizing.Engine3D({canvas:r.canvas}),r.canvas?(r.fullscreen=!1,q.log("got canvas from runner to context",r.canvas)):(r.canvas=r.engine.canvas,r.fullscreen=!0,q.log("got canvas from Engine",r.canvas)),window.addEventListener("orientationchange",function(t){return r.onWindowResize(t)},!1),window.addEventListener("resize",function(t){return r.onWindowResize(t)},!1),window.addEventListener("scroll",function(t){return r.updateCanvasPosition(t)},!1),window.addEventListener("resize",function(t){return r.updateCanvasPosition(t)},!1),r.canvasPosition=r.getCanvasPosition(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,d),Me(e,[{key:"update",value:function(){this.render()}},{key:"setClearColor",value:function(t,e){this.engine.renderer.setClearColor(t,e)}},{key:"setEnableShadowMap",value:function(t){this.engine.renderer.shadowMap.type=THREE.PCFSoftShadowMap,this.engine.renderer.shadowMapEnabled=t}},{key:"setCurrentScene",value:function(t){this.scene=this.scenes[t],void 0===this.scene&&(this.scene=new THREE.Scene,this.scenes[t]=this.scene,q.log("current scene is : ",this.scene))}},{key:"addToCurrentScene",value:function(t){this.scene.add(t.transform.entity)}},{key:"removeFromCurrentScene",value:function(t){this.scene.remove(t.transform.entity)}},{key:"clear",value:function(){var t=this;console.log("scene=",this.scene),this.scene.children.forEach(function(e){console.log("removing ",e),t.scene.remove(e)}),this.scene.children=[],this.cameras=[]}},{key:"addCamera",value:function(t){this.cameras.push(t)}},{key:"removeCamera",value:function(t){this.cameras.splice(this.cameras.indexOf(t),1)}},{key:"setFog",value:function(t,e){switch(e||(e=b.black.clone()),t){case"linear":this.fog=new THREE.Fog(e.getHex()),this.fog.type="linear";break;case"exp":this.fog=new THREE.FogExp2(e.getHex()),this.fog.type="exp";break;default:this.fog=new THREE.Fog(e.getHex()),this.fog.type="linear"}this.scene.fog=this.fog}},{key:"setFogNear",value:function(t){"linear"===this.fog.type&&(this.fog.near=t)}},{key:"setFogFar",value:function(t){"linear"===this.fog.type&&(this.fog.far=t)}},{key:"setFogDensity",value:function(t){"exp"===this.fog.type&&(this.fog.density=t)}},{key:"setFogColor",value:function(t){this.fog.color=t}},{key:"onWindowResize",value:function(){var t=this;this.fullscreen&&(this.cameras.forEach(function(e){if("perspective"===e.type){var n=t.engine.renderer.domElement.width/t.engine.renderer.devicePixelRatio,r=t.engine.renderer.domElement.height/t.engine.renderer.devicePixelRatio;e.setAspect(n*e.viewport.width/(r*e.viewport.height))}else"ortho"===e.type&&e.setOrthoPlanes(window.innerWidth/-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2)}),this.engine.renderer.setSize(window.innerWidth,window.innerHeight))}},{key:"render",value:function(){for(var t=0;t<this.cameras.length;++t)this.cameras[t].sort=!1,void 0===this.cameras[t].index&&(this.cameras[t].index=0);for(var e=[],n=9999,r=null,i=0;i<this.cameras.length;++i){n=9999,r=null;for(var o=0;o<this.cameras.length;++o){var a=this.cameras[o];a.index<=n&&!a.sort&&(r=a,n=a.index)}r&&(r.sort=!0,e.push(r))}for(var s=0;s<e.length;++s){var u=e[s];if(u.transform.getVisible()&&(u.dirty||u.autorender)){var l=this.engine.renderer.domElement.width/this.engine.renderer.devicePixelRatio,c=this.engine.renderer.domElement.height/this.engine.renderer.devicePixelRatio;"cube"!==u.type&&u.setAspect(l*u.viewport.width/(c*u.viewport.height));var h=l*u.viewport.x,p=c*u.viewport.y,f=l*u.viewport.width,d=c*u.viewport.height;this.engine.renderer.setViewport(h,p,f,d),this.engine.renderer.setScissor(h,p,f,d),this.engine.renderer.setScissorTest(!0),this.engine.renderer.autoClear=u.autoclear;for(var m in this.scenes)1===this.logLevel&&q.log("render cam/scene ",u,m),u.layer===m&&(void 0!==u.renderTexture?this.engine.renderer.render(this.scenes[m],u._camera,u.renderTexture._engineTexture,u.autoClear):"cube"===u.type?u._camera.updateCubeMap(this.engine.renderer,this.scenes[m]):this.engine.renderer.render(this.scenes[m],u._camera),u.dirty=!1)}}}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getCanvasSize",value:function(){return{width:this.canvas.width/window.devicePixelRatio,height:this.canvas.height/window.devicePixelRatio}}},{key:"getCanvasPosition",value:function(){return xt.getElementPosition(this.canvas)}},{key:"updateCanvasPosition",value:function(){this.canvasPosition=this.getCanvasPosition()}}]),e}(),ke=(r(Ce),function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}());var Pe=r(function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));if(n.renderer=n.getContext(),n.audioContext=void 0,(void 0===n.params||n.params.audioEnabled)&&(void 0!==window.AudioContext?n.audioContext=new window.AudioContext:void 0!==window.webkitAudioContext&&(n.audioContext=new window.webkitAudioContext),n.audioContext)){if(44100!==n.audioContext.sampleRate){var r=n.audioContext.createBuffer(1,1,44100),i=n.audioContext.createBufferSource();i.buffer=r,i.connect(n.audioContext.destination),i.start(0),i.disconnect(),n.audioContext.close(),void 0!==window.AudioContext?n.audioContext=new window.AudioContext:void 0!==window.webkitAudioContext&&(n.audioContext=new window.webkitAudioContext)}n.audioOutputNode=n.audioContext.createGain(),n.audioOutputNode.connect(n.audioContext.destination)}return n.listener=n.audioContext.listener,n.listener.forwardX?(n.listener.forwardX.value=0,n.listener.forwardY.value=0,n.listener.forwardZ.value=-1,n.listener.upX.value=0,n.listener.upY.value=1,n.listener.upZ.value=0):n.listener.setOrientation(0,0,-1,0,1,0),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,d),ke(e,[{key:"beep",value:function(t){var e=t||440,n=this.audioContext.createOscillator();n.connect(this.audioOutputNode),n.frequency.value=e,n.start(0),n.stop(this.audioContext.currentTime+.3)}},{key:"setListenerTransform",value:function(t){this.listener.transform=t}},{key:"update",value:function(){if(function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this),this.listener.transform){var t=this.listener.transform.getLocalPosition();this.listener.setPosition(t.x,t.y,t.z)}}}]),e}()),Re=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Le=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._fontFile=n(e,"fontFile",void 0),this._font=opentype.parse(this._fontFile)}return Re(t,[{key:"getFont",value:function(){return this._font}},{key:"getTextSize",value:function(t,e){if(!this._font.supported)return null;var n,r,i,o=void 0,a=void 0,s=void 0,u=[],l=0;for(e=void 0!==e?e:72,n=void 0===(s=s||{}).kerning||s.kerning,r=1/this._font.unitsPerEm*e,i=this._font.stringToGlyphs(t),o=0;o<i.length;o+=1)a=i[o],u.push((a.getMetrics().yMax-a.getMetrics().yMin)*r),a.advanceWidth&&(l+=a.advanceWidth*r),n&&o<i.length-1&&(l+=this._font.getKerningValue(a,i[o+1])*r);return{width:l,height:Math.max.apply(0,u)}}}]),t}(),Ie=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var De=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.transform=new nt(this),this.bias=1,this.factor=-.1}return Ie(t,[{key:"process",value:function(){}},{key:"getDistance",value:function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)+(t.z-e.z)*(t.z-e.z))}},{key:"applyLOD",value:function(){}}]),t}(),Ne=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function je(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Ue=function(){function t(e){je(this,t),this.letter=n(e,"letter",""),this.size=n(e,"size",40),this.font=n(e,"font",void 0),this.color=n(e,"color",b.black.clone()),this.x=0,this.y=0,this.width=0,this.height=0,this.font&&this.update()}return Ne(t,[{key:"update",value:function(){var t=this.font.getTextSize(this.letter,this.size);this.width=t.width,this.height=t.height,this.path=this.font.getFont().getPath(this.letter,this.x,this.y,this.size),this.path.fill="#"+this.color.getHexString(),this.boundingBox=this.path.getBoundingBox()}},{key:"setLetter",value:function(t){this.letter=t}},{key:"setX",value:function(t){this.x=t}},{key:"setY",value:function(t){this.y=t}},{key:"setSize",value:function(t){this.size=t}},{key:"setColor",value:function(t){this.color=t}},{key:"setFont",value:function(t){this.font=t}}]),t}(),Fe=function(){function t(e){je(this,t),this.text=n(e,"text",""),this.font=n(e,"font",void 0),this.size=n(e,"size",40),this.color=n(e,"color",b.black.clone()),this.line=0,this.x=0,this.y=0,this.width=0,this.height=0,this.styledLetters=[],this.font&&this.update()}return Ne(t,[{key:"update",value:function(){var t=this.font.getTextSize(this.text,this.size);this.width=t.width,this.height=t.height,this.path=this.font.getFont().getPath(this.text,this.x,this.y,this.size),this.path.fill="#"+this.color.getHexString(),this.boundingBox=this.path.getBoundingBox();for(var e=0,n=0;n<this.styledLetters.length;n++){var r=this.styledLetters[n];r.font=this.font,0===n?(r.setX(this.x),e=r.width):(r.setX(this.x+e),e+=r.width),r.setY(this.y),r.setSize(this.size),r.setColor(this.color),r.update()}}},{key:"setFont",value:function(t){this.font=t}},{key:"setColor",value:function(t){this.color=t}},{key:"setX",value:function(t){this.x=t}},{key:"setY",value:function(t){this.y=t}},{key:"setSize",value:function(t){this.size=t}},{key:"setPath",value:function(t){this.path=t}},{key:"setText",value:function(t){this.text=t,this.styledLetters=[];for(var e=0;e<this.text.length;e++){var n=this.text.charCodeAt(e),r=new Ue({letter:String.fromCharCode(n),font:this.font,size:this.size,color:this.color});this.styledLetters.push(r)}}}]),t}(),Be=function t(){je(this,t),this.styledTextElements=[],this.width=0},ze=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Ge="left",He=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));r._width=n(t,"width",512),r._height=n(t,"height",512),r._backgroundColor=n(t,"backgroundColor",b.white.clone()),r._lineHeight=n(t,"lineHeight",1),r._margins={left:0,right:0,top:0,bottom:0};var i=n(t,"margins",10);return r._margins.left=n(t,"marginLeft",i),r._margins.right=n(t,"marginRight",i),r._margins.top=n(t,"marginTop",i),r._margins.bottom=n(t,"marginBottom",i),r._textSize=n(t,"textSize",20),r._textColor=n(t,"textColor",b.black.clone()),r._textAlign=n(t,"textAlign",Ge),r._boundingBoxStrokeWidth=n(t,"boundingBoxStrokeWidth",1),r._drawBoundingBox=n(t,"drawBoundingBox",!1),r._fontURL=n(t,"fontURL","fonts/Raleway-Regular.ttf"),r._fontItalicURL=n(t,"fontItalicURL","fonts/Raleway-Regular-Italic.ttf"),r._fontBoldURL=n(t,"fontBoldURL","fonts/Raleway-Bold.ttf"),r._fontBoldItalicURL=n(t,"fontBoldItalicURL","fonts/Raleway-Bold-Italic.ttf"),r._canvas=document.createElement("canvas"),r._canvas.width=r._width,r._canvas.height=r._height,r._canvasContext=r._canvas.getContext("2d"),r._canvas.events=new p({scope:r._canvas}),r._text=n(t,"text",void 0),r._text?(r._DOMText=document.createElement("div"),r._DOMText.innerHTML=r._text,r.styledText=r.parseDOMTree(r._DOMText)):console.error("no html text provided"),r._lines=[],ge.loadArrayBuffer(r._fontURL,function(t){r._defaultFontFile=t,ge.loadArrayBuffer(r._fontItalicURL,function(t){r._defaultItalicFontFile=t,ge.loadArrayBuffer(r._fontBoldURL,function(t){r._defaultBoldFontFile=t,ge.loadArrayBuffer(r._fontBoldItalicURL,function(t){r._defaultBoldItalicFontFile=t,r.setup()})})})}),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,c),ze(e,[{key:"setup",value:function(){this._defaultFont=new Le({fontFile:this._defaultFontFile}),this._defaultItalicFont=new Le({fontFile:this._defaultItalicFontFile}),this._defaultBoldFont=new Le({fontFile:this._defaultBoldFontFile}),this._defaultBoldItalicFont=new Le({fontFile:this._defaultBoldItalicFontFile}),this.render()}},{key:"getWidth",value:function(){return this._width}},{key:"getHeight",value:function(){return this._height}},{key:"getCanvas",value:function(){return this._canvas}},{key:"parseDOMTree",value:function(t){var e=[];return this.processDOMTree(t,e),e}},{key:"processDOMTree",value:function(t,e){var n=0,r=void 0;for("P"===t.tagName&&("P"===t.previousElementSibling.tagName?t.innerHTML=t.innerHTML+"<br>":t.innerHTML="<br><br>"+t.innerHTML+"<br>");r=t.childNodes[n];){if(r.childNodes.length>=1)this.processDOMTree(r,e);else for(var i=r.textContent.split(/\s/),o=0;o<i.length;o++){var a=new Fe;if(a.attributes=[],a.tags=[],a.setText(i[o]),0!==o&&(a.text=" "+a.text),r.parentNode.attributes)for(var s=0;s<r.parentNode.attributes.length;s++)a.attributes.push({name:r.parentNode.attributes[s].name,value:r.parentNode.attributes[s].value});r.tagName&&a.tags.push(r.tagName);for(var u=r;u.parentNode;)"DIV"!==u.parentNode.tagName&&a.tags.push(u.parentNode.tagName),u=u.parentNode;e.push(a)}n++}return e}},{key:"render",value:function(){this._backgroundColor!==b.transparent.makeRGBAStringWithAlpha(0)&&(this._canvasContext.fillStyle="#"+this._backgroundColor.getHexString(),this._canvasContext.fillRect(0,0,this._width,this._height));for(var t=this._margins.left,e=this._margins.top,n=0,r=0;r<this.styledText.length;r++){var i=this.styledText[r],o=this._defaultFont;(i.tags.indexOf("B")>=0||i.tags.indexOf("STRONG")>=0)&&(o=this._defaultBoldFont),(i.tags.indexOf("I")>=0||i.tags.indexOf("EM")>=0)&&(o=this._defaultItalicFont),(i.tags.indexOf("B")>=0&&i.tags.indexOf("I")>=0||i.tags.indexOf("STRONG")>=0&&i.tags.indexOf("EM")>=0)&&(o=this._defaultBoldItalicFont);var a=this._textSize;i.tags.indexOf("BR")>=0&&(e+=a*this._lineHeight,t=this._margins.left,n++,console.log("lineYOffset",e));var s=this._textColor;if(e===this._margins.top&&(e+=a),t+o.getTextSize(i.text,a).width>this._width-this._margins.right&&(e+=a*this._lineHeight,t=this._margins.left,i.text=i.text.replace(/^\s/,""),n++),i.attributes)for(var u=0;u<i.attributes.length;u++)"color"===i.attributes[u].name&&(s=new b(i.attributes[u].value)),"size"===i.attributes[u].name&&(a=Number(i.attributes[u].value));i.setFont(o);var l=o.getTextSize(i.text,a);if(i.line=n,i.setX(t),i.setY(e),i.setSize(a),i.setColor(s),i.update(),this._lines[n]){var c=this._lines[n];c.styledTextElements.push(i),c.width+=i.width}else{var h=new Be;h.styledTextElements.push(i),h.width+=i.width,this._lines.push(h)}t+=l.width}for(var p=0;p<this._lines.length;p++){var f=void 0,d=this._lines[p];switch(this._textAlign){case"center":f=this._width/2-(this._margins.left+d.width/2);break;case"right":f=this._width-this._margins.left-(this._margins.right+d.width)}if(void 0!==f)for(var m=0;m<d.styledTextElements.length;m++){var g=d.styledTextElements[m];g.setX(g.x+f),g.update()}}for(var v=0;v<this.styledText.length;v++){var y=this.styledText[v];if(y.path.draw(this._canvasContext),this._drawBoundingBox){var _=y.path.getBoundingBox();this._canvasContext.beginPath(),this._canvasContext.moveTo(_.x1,_.y1),this._canvasContext.lineTo(_.x2,_.y1),this._canvasContext.lineTo(_.x2,_.y2),this._canvasContext.lineTo(_.x1,_.y2),this._canvasContext.lineTo(_.x1,_.y1-this._boundingBoxStrokeWidth/2),this._canvasContext.lineWidth=this._boundingBoxStrokeWidth,this._canvasContext.stroke()}}this._canvas.events.trigger("drawn")}}]),e}(),Ve=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var We=function(){function t(e){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._strokeWidth=n(e,"strokeWidth",1),this._strokeColor=n(e,"strokeColor",void 0),this._strokeOpacity=n(e,"strokeOpacity",1),this._fillColor=n(e,"fillColor",void 0),this._fillOpacity=n(e,"fillOpacity",1),this._width=n(e,"width",100),this._height=n(e,"height",100),this._canvas=function(t,e,n){for(var r=arguments.length,i=Array(r>3?r-3:0),o=3;o<r;o++)i[o-3]=arguments[o];return void 0!==t&&e in t?t[e]:n.apply(void 0,i)}(e,"canvas",function(){var t=document.createElement("canvas");return t.width=r._width,t.height=r._height,t}),this._texture=new THREE.Texture(this._canvas),this._texture.needsUpdate=!0,this._texture.minFilter=THREE.NearestFilter,this._texture.magFilter=THREE.NearestFilter,this._texture.generateMipmaps=!1,this._canvasContext=this._canvas.getContext("2d"),this.update()}return Ve(t,[{key:"getCanvas",value:function(){return this._canvas}},{key:"getCanvasContext",value:function(){return this._canvasContext}},{key:"fillWithColor",value:function(t){this.setFillColor(t),this.update(),this._canvasContext.fillRect(0,0,this._width,this._height),this._texture.needsUpdate=!0}},{key:"resizeCanvas",value:function(t,e){this._canvas.width=t,this._canvas.height=e,this._canvasContext=this._canvas.getContext("2d")}},{key:"getWidth",value:function(){return this._width}},{key:"getHeight",value:function(){return this._height}},{key:"setStrokeColor",value:function(t){this._strokeColor=t}},{key:"setFillColor",value:function(t){this._fillColor=t}},{key:"setStrokeWidth",value:function(t){this._strokeWidth=t}},{key:"update",value:function(){var t=void 0,e=void 0;t=this._strokeColor?this.toRGBAColorString(this._strokeColor,this._strokeOpacity):"rgba(0,0,0,0)",e=this._fillColor?this.toRGBAColorString(this._fillColor,this._fillOpacity):"rgba(0,0,0,0)",q.log("this._strokeColor",this._strokeColor,"this._fillColor",this._fillColor),q.log("tempStrokeColor",t,"tempFillColor",e),this._canvasContext.strokeStyle=t,this._canvasContext.fillStyle=e,this._canvasContext.lineWidth=this._strokeWidth,this._canvasContext.clearRect(0,0,this._width,this._height),this._canvasContext.fill(),this._canvasContext.stroke(),this._texture.needsUpdate=!0}},{key:"drawStyledText",value:function(t){t.path.draw(this._canvasContext),this._texture.needsUpdate=!0}},{key:"drawImage",value:function(t,e,n,r,i){this._canvasContext.drawImage(t,e||0,n||0,r||this._width,i||this._height),this._texture.needsUpdate=!0}},{key:"toRGBAColorString",value:function(t,e){return"rgba("+Math.floor(255*t.r)+","+Math.floor(255*t.g)+","+Math.floor(255*t.b)+","+e+")"}}],[{key:"CreateRect",value:function(e){var r=n(e,"width",100),i=n(e,"height",100),o=n(e,"strokeWidth",1),a=n(e,"strokeColor",0),s=n(e,"fillColor",0),u=n(e,"fillOpacity",1),l=n(e,"strokeOpacity",1),c=document.createElement("canvas");c.width=r,c.height=i;var h=c.getContext("2d");return h.lineWidth=o,h.beginPath(),h.lineTo(0,0),h.lineTo(r,0),h.lineTo(r,i),h.lineTo(0,i),h.lineTo(0,0),h.closePath(),h.fill(),h.stroke(),(e={}).canvas=c,e.width=r,e.height=i,e.strokeWidth=o,e.strokeColor=a,e.fillColor=s,e.fillOpacity=u,e.strokeOpacity=l,new t(e)}},{key:"CreateCircle",value:function(e){var r=n(e,"radius",100),i=n(e,"strokeWidth",1),o=n(e,"strokeColor",0),a=n(e,"fillColor",0),s=n(e,"fillOpacity",1),u=n(e,"strokeOpacity",1),l=document.createElement("canvas");l.width=r+i,l.height=r+i;var c=l.getContext("2d");return c.strokeStyle=o?o.getHexString():void 0,c.fillStyle=a?a.getHexString():void 0,c.lineWidth=i,c.beginPath(),c.arc(r/2+i/2,r/2+i/2,r/2,0,2*Math.PI,!1),c.closePath(),c.fill(),c.stroke(),document.body.appendChild(l),(e={}).canvas=l,e.width=r,e.height=r,e.strokeWidth=i,e.strokeColor=o,e.fillColor=a,e.fillOpacity=s,e.strokeOpacity=u,new t(e)}}]),t}(),qe=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Xe=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.canvas=document.createElement("canvas"),this.canvas.width=512,this.canvas.height=512;var r=this.canvas.getContext("2d");r.fillStyle="rgba(0,0,255,255)",r.lineTo(0,0),r.lineTo(this.canvas.width,0),r.lineTo(this.canvas.width,this.canvas.height),r.lineTo(0,this.canvas.height),r.lineTo(0,0),r.closePath(),r.fill(),r.stroke(),document.body.appendChild(this.canvas);var i=new Image;i.src=this.canvas.toDataURL("image/png");var o=document.createElement("img");o.src=i.src,document.body.appendChild(o),this.texture=new THREE.Texture(i),this.texture.needsUpdate=!0,document.body.appendChild(e),domvas.toImage(e,function(){r.drawImage(n,0,0),i.src=n.canvas.toDataURL("image/png"),o.src=i.src,n.update()})}return qe(t,[{key:"update",value:function(){var t=new Image;t.src=this.canvas.toDataURL(),this.texture.image=t,this.texture.needsUpdate=!0}}],[{key:"addCSSToNode",value:function(t,e){var n=document.styleSheets[0].cssRules;if(n)for(var r=0;r<n.length;r++){var i=n[r].selectorText;if(i&&i.indexOf(e)>0)return void t.classList.add(e)}console.error("no css class of this name found. Remove the . if any in your argument")}}]),t}(),Ye=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var $e=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.currentTime=0,this.playing=!1,this.frameRate=10,this.context=e,this.textures=[],this.sequenceMode="FORWARD",this.direction=1,this.lapsToDo=-1,this.frameCount=0,this.laps=0,this.currentFrame=0}return Ye(t,[{key:"load",value:function(t,e,n){for(var r=e;r<=n;++r){var i=new K({context:this.context}),o=t.replace("*",""+r);i.loadFromFile(o,!0),this.textures.push(i)}this.frameCount=this.textures.count,this.enterFrame=0,this.currentFrame=0,this.outFrame=n}},{key:"setEnterFrame",value:function(t){t>=0&&t<this.frameCount?(this.enterFrame=t,this.currentFrame=this.enterFrame):(this.enterFrame=0,this.currentFrame=0,q.log("ERROR enterFrame %i is out of sequence bounds - back to 0",t))}},{key:"setOutFrame",value:function(t){t>=this.enterFrame&&t<this.frameCount?this.outFrame=t:(this.outFrame=this.frameCount-1,q.log("ERROR outFrame %i is out of sequence bounds - back to frameCount",t))}},{key:"setMode",value:function(t){this.sequenceMode=t}},{key:"update",value:function(){this.playing&&(this.currentTime+=this.context.Time.deltaTime,this.currentTime>1/this.frameRate&&(this.currentTime-=1/this.frameRate,"FORWARD"===this.sequenceMode?(this.laps>=0&&this.laps<this.lapsToDo?(this.currentFrame++,this.currentFrame%=this.outFrame+1,0===this.currentFrame&&(this.currentFrame=this.enterFrame),this.currentFrame===this.outFrame&&this.laps++):this.lapsToDo<0&&(this.currentFrame++,this.currentFrame%=this.outFrame+1,0===this.currentFrame&&(this.currentFrame=this.enterFrame)),this.lapsToDo===this.laps&&this.stop(),q.log("currentFrame = "+this.currentFrame)):"BACKWARD"===this.sequenceMode?(this.laps>=0&&this.laps<this.lapsToDo?(this.currentFrame--,this.currentFrame<this.enterFrame&&(this.currentFrame=this.outFrame),this.currentFrame===this.enterFrame&&this.laps++):this.lapsToDo<0&&(this.currentFrame--,this.currentFrame<this.enterFrame&&(this.currentFrame=this.outFrame)),this.lapsToDo===this.laps&&this.stop(),q.log("currentFrame = "+this.currentFrame)):"PINGPONG"===this.sequenceMode?(this.laps>=0&&this.laps<this.lapsToDo?(this.currentFrame+=this.direction,this.currentFrame<0&&(this.currentFrame=0),this.currentFrame>this.outFrame&&(this.currentFrame=this.outFrame),this.currentFrame>=this.outFrame&&(this.direction=-this.direction,this.laps++),this.currentFrame<=this.enterFrame&&(this.direction=-this.direction,this.laps++)):this.lapsToDo<0&&(this.currentFrame+=this.direction,this.currentFrame>=this.outFrame&&(this.direction=-this.direction),this.currentFrame<=this.enterFrame&&(this.direction=-this.direction)),this.lapsToDo===this.laps&&this.stop(),q.log("currentFrame = "+this.currentFrame)):"RANDOM"===this.sequenceMode&&(this.currentFrame=Math.floor(Math.random()*(this.outFrame-this.enterFrame)+this.enterFrame),q.log("currentFrame = "+this.currentFrame))))}},{key:"getCurrentTexture",value:function(){return this.textures[this.currentFrame]}},{key:"play",value:function(){this.playing=!0}},{key:"pause",value:function(){this.playing=!1}},{key:"stop",value:function(){this.currentTime=0,this.currentFrame=0,this.playing=!1,this.laps=0}},{key:"loop",value:function(t){this.lapsToDo=t}}]),t}(),Ze=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Je=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._width=n(e,"width",512),this._height=n(e,"height",512),this._engineTexture=new THREE.WebGLRenderTarget(this._width,this._height,{minFilter:THREE.LinearFilter,magFilter:THREE.NearestFilter,format:THREE.RGBFormat}),this._texture=this._engineTexture.texture}return Ze(t,[{key:"getTexture",value:function(){return this._engineTexture.texture}}]),t}(),Ke=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Qe=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._video=n(e,"video",void 0),this._loop=n(e,"loop",!1),this._autoPlay=n(e,"autoPlay",!1),this._fps=n(e,"fps",30),this._isIOS="iOS"===ft.getOS(),this._isPlaying=!1,this._bufferedPourcent={start:0,end:0},this._isIOS&&(this._autoPlay=!1,this._videoCanvasTexture=new We({width:this._video.videoWidth,height:this._video.videoHeight})),this._video.addEventListener("progress",this.onLoadProgess.bind(this)),this._video.addEventListener("ended",this.onVideoEnded.bind(this)),this._isIOS?this._texture=this._videoCanvasTexture._texture:(this._texture=new THREE.Texture(this._video),this._texture.generateMipmaps=!1,this._texture.minFilter=THREE.NearestFilter,this._texture.magFilter=THREE.NearestFilter),this._autoPlay&&!this._isIOS&&this.play()}return Ke(t,[{key:"onLoadProgess",value:function(){var t=this.getBuffered();q.log("progress",t,this.getDuration()),t&&t.length>=1&&(this._bufferedPourcent={start:100*this.getBuffered().start(0)/this.getDuration(),end:100*this.getBuffered().end(0)/this.getDuration()})}},{key:"onVideoEnded",value:function(){this._loop?this.play():this.stop()}},{key:"setLoop",value:function(t){this._loop=t}},{key:"update",value:function(){if(this._video.readyState>=this._video.HAVE_FUTURE_DATA){if(this._isIOS&&this._isPlaying){var t=Date.now(),e=(t-this.lastTime)/1e3;e>=1/this._fps&&(this._video.currentTime=this._video.currentTime+e,this.lastTime=t,this._videoCanvasTexture.drawImage(this._video))}!this._isIOS&&this._texture&&(this._texture.needsUpdate=!0)}}},{key:"play",value:function(){this._isIOS?this.lastTime=Date.now():this._video.play(),this._isPlaying=!0}},{key:"pause",value:function(){this._video.pause(),this._isPlaying=!1}},{key:"stop",value:function(){this._video.pause(),this._video.currentTime=0,this._isPlaying=!1}},{key:"getIsPlaying",value:function(){return this._isPlaying}},{key:"getCurrentTime",value:function(){return this._video.currentTime}},{key:"getBuffered",value:function(){return this._video.buffered}},{key:"setCurrentTime",value:function(t){this._video.currentTime<this._video.duration?this._video.currentTime=t:this._video.currentTime=this._video.duration}},{key:"getDuration",value:function(){return this._video.duration}},{key:"setPlaybackRate",value:function(t){this._video.playbackRate=t}},{key:"getPlaybackRate",value:function(){return this._video.playbackRate}},{key:"getWidth",value:function(){return this._video.videoWidth}},{key:"getHeight",value:function(){return this._video.videoHeight}}]),t}(),tn=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var en=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return q.log("constructor post super"),r.interval=n(t,"interval",100),r.callback=n(t,"callback",null),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,d),tn(e,[{key:"setup",value:function(){this.startTime=(new Date).getTime(),this.currentTime=(new Date).getTime()}},{key:"off",value:function(){(function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"off",this).call(this),this.stop()}},{key:"start",value:function(){this._active?(this.startTime=(new Date).getTime(),this.currentTime=(new Date).getTime()):q.info("component is off")}},{key:"stop",value:function(){this.startTime=0,this.currentTime=0}},{key:"update",value:function(){this._active&&(this.currentTime=(new Date).getTime(),this.currentTime-this.startTime>=this.interval&&(this.callback(),this.reset()))}},{key:"reset",value:function(){this.startTime=(new Date).getTime(),this.currentTime=(new Date).getTime()}}]),e}(),nn=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var rn=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r._startTime=n(t,"startTime",0),r._timeScale=n(t,"scale",1),r._smoothingFactor=n(t,"smoothingFactor",.9),r._NTPEnabled=n(t,"NtpEnabled",!1),r._currentTime=0,r._deltaTime=0,r._timeOffsetSmooth=0,r._lastTime=(new Date).getTime(),r._offset=0,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,d),nn(e,[{key:"setup",value:function(){var t=this;if(this._lastTime=(new Date).getTime(),this._offset=this._lastTime-this._startTime,this._NTPEnabled){var e=new WebSocket("ws://ntp.surexposition.mobi:8000/");ntp_websockets.init(e),setInterval(function(){t._offset=ntp_websockets.offset()},1e3)}}},{key:"start",value:function(){this._startTime=(new Date).getTime()}},{key:"pause",value:function(){}},{key:"reset",value:function(){this._startTime=0}},{key:"update",value:function(){if(this.getStatus()){var t=(new Date).getTime();this._deltaTime=(t-this._currentTime)/1e3,this._currentTime=t}}},{key:"setTimeScale",value:function(t){this._timeScale=t}},{key:"getTimeScale",value:function(){return this._timeScale}},{key:"getDelta",value:function(){return this._deltaTime*this._timeScale}},{key:"getTime",value:function(){return(this._currentTime+this._offset)*this._timeScale}},{key:"getTimeSmooth",value:function(){return this._timeOffsetSmooth=this._timeOffsetSmooth*this._startTime+this._offset*(1-this._startTime),(this._currentTime+this._timeOffsetSmooth)*this._timeScale}},{key:"getDateTime",value:function(){return(new Date).getTime()}},{key:"resync",value:function(){this._NTPEnabled&&ntp_websockets.resync()}}]),e}(),on=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var an=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.pointer=n(t,"pointer",void 0),r.onPress=n(t,"onPress",i),r.onRelease=n(t,"onRelease",i),r.onEnter=n(t,"onEnter",i),r.onLeave=n(t,"onLeave",i),r.camera=t.camera,r.target=n(t,"target",void 0),r.picked=!1,r.hovered=!1,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,d),on(e,[{key:"setup",value:function(){var t=this;(function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setup",this).call(this);var n=this.getContext();if(!this.pointer){var r=new St;n.addComponent(r),r.setup(),r.on(),this.pointer=new xe,this.pointer.add(r),n.addComponent(this.pointer),this.pointer.setup(),this.pointer.on()}this.pointer.events.on("on",function(e){t.target.transform.pick(t.camera,e.x,e.y)?(t.picked=!0,t.onPress()):t.picked=!1}),this.pointer.events.on("off",function(){!0===t.picked&&t.onRelease()}),this.pointer.events.on("moved",function(e){t.target.transform.pick(t.camera,e.x,e.y)?(t.picked=!0,t.hovered||(t.onEnter(),t.hovered=!0)):t.picked&&(t.onLeave(),t.hovered=!1,t.picked=!1)})}}]),e}(),sn=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),un=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};var ln="released",cn=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));if(r.camera=t.camera,r.pointer=n(t,"pointer",void 0),r.mesh=n(t,"mesh",void 0),r.width=n(t,"width",3),r.height=n(t,"height",1),r.radius=n(t,"radius",void 0),r.sideCount=n(t,"sideCount",6),r.cutOff=n(t,"cutOff",r.height/3),r.strokeWidth=n(t,"strokeWidth",.1),r.strokeColor=n(t,"strokeColor",b.mobilizing.clone()),r.fillColor=n(t,"fillColor",b.white.clone()),r.pressFillColor=n(t,"pressFillColor",b.mobilizing.clone()),r.hoverFillColor=n(t,"hoverFillColor",b.mobilizingAlternate.clone()),r.onPress=n(t,"onPress",i),r.onRelease=n(t,"onRelease",i),r.onEnter=n(t,"onEnter",i),r.onLeave=n(t,"onLeave",i),r._fontURL=n(t,"fontURL","fonts/Raleway-Regular.ttf"),r._fontItalicURL=n(t,"fontItalicURL","fonts/Raleway-Regular-Italic.ttf"),r._fontBoldURL=n(t,"fontBoldURL","fonts/Raleway-Bold.ttf"),r._fontBoldItalicURL=n(t,"fontBoldItalicURL","fonts/Raleway-Bold-Italic.ttf"),r.text=n(t,"text",void 0),r.textSize=n(t,"textSize",40),r.root=new ot({primitive:"node"}),r.transform=r.root.transform,r.state=ln,r.text){var o=void 0;o=r.width<100?512:r.width;var a=void 0;if(a=r.height<100?o/(r.width/r.height):r.height,r.radius)a=o*(2/Math.sqrt(3));var u=new Mobilizing.RichText({width:o,height:a,text:r.text,marginTop:a/2-r.textSize/2,backgroundColor:b.transparent.makeRGBAStringWithAlpha(0),textColor:b.mobilizing.clone(),textAlign:"center",textSize:r.textSize,fontURL:r._fontURL,fontItalicURL:r._fontItalicURL,fontBoldURL:r._fontBoldURL,fontBoldItalicURL:r._fontBoldItalicURL}),l=new Mobilizing.RichText({width:o,height:a,text:r.text,marginTop:a/2-r.textSize/2,backgroundColor:b.transparent.makeRGBAStringWithAlpha(0),textColor:b.white.clone(),textAlign:"center",textSize:r.textSize,fontURL:r._fontURL,fontItalicURL:r._fontItalicURL,fontBoldURL:r._fontBoldURL,fontBoldItalicURL:r._fontBoldItalicURL});r.textTexture=new K({canvas:u.getCanvas()}),r.pressTextTexture=new K({canvas:l.getCanvas()})}return r.mesh||r.generateDefaultMesh(),r.root.transform.addChild(r.mesh.transform),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,d),sn(e,[{key:"setup",value:function(){var t=this;un(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setup",this).call(this);var n=this.getContext();this.clickable=new an({camera:this.camera,target:this.mesh,pointer:this.pointer,onPress:function(){t._active&&(t.mesh.material.setColor(t.pressFillColor),t.pressTextTexture&&t.texturedMesh.material.setTexture(t.pressTextTexture),t.onPress(),t.state="pressed")},onRelease:function(){t._active&&(t.mesh.material.setColor(t.hoverFillColor),t.textTexture&&t.texturedMesh.material.setTexture(t.textTexture),t.onRelease(),t.state=ln)},onEnter:function(){t._active&&(t.mesh.material.setColor(t.hoverFillColor),t.onEnter())},onLeave:function(){t._active&&(t.mesh.material.setColor(t.fillColor),t.textTexture&&t.texturedMesh.material.setTexture(t.textTexture),t.onLeave())}}),n.addComponent(this.clickable),this.clickable.setup(),this.on()}},{key:"on",value:function(){un(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"on",this).call(this),this.mesh.material.setOpacity(1),this.strokeMesh.material.setOpacity(1),this.text&&this.texturedMesh.material.setOpacity(1)}},{key:"off",value:function(){un(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"off",this).call(this),this.mesh.material.setOpacity(.3),this.strokeMesh.material.setOpacity(.3),this.text&&this.texturedMesh.material.setOpacity(.3)}},{key:"update",value:function(){}},{key:"generateDefaultMesh",value:function(){var t=this.width/2,e=this.height/2;if(this.vertex=[],this.radius)for(var n=this.sideCount,r=this.radius,i=0;i<n;i++)this.vertex.push(new A(Math.cos(k.degToRad(360/n/2)+2*Math.PI/n*i)*r,Math.sin(k.degToRad(360/n/2)+2*Math.PI/n*i)*r));else this.vertex.push(new A(-t+this.cutOff,e)),this.vertex.push(new A(t-this.cutOff,e)),this.vertex.push(new A(t,e-this.cutOff)),this.vertex.push(new A(t,-e+this.cutOff)),this.vertex.push(new A(t-this.cutOff,-e)),this.vertex.push(new A(-t+this.cutOff,-e)),this.vertex.push(new A(-t,-e+this.cutOff)),this.vertex.push(new A(-t,e-this.cutOff));this.topLeftIndex=0,this.topRightIndex=1,this.bottomRightIndex=4,this.bottomLeftIndex=5,this.mesh=new ot({primitive:"custom"}),this.mesh.generateFillMesh(this.vertex),this.mesh.material.setTransparent(!0),this.text&&(this.texturedMesh=new ot({primitive:"custom"}),this.texturedMesh.generateFillMesh(this.vertex),this.texturedMesh.material.setTransparent(!0),this.texturedMesh.material.setTexture(this.textTexture),this.root.transform.addChild(this.texturedMesh.transform)),this.strokeMesh=ot.generateStrokeMesh(this.mesh,this.strokeWidth),this.strokeMesh.material.setColor(this.strokeColor),this.strokeMesh.material.setTransparent(!0),this.root.transform.addChild(this.strokeMesh.transform)}},{key:"adaptCorner",value:function(t,e){if(this.width!==this.height){var n=null;switch(e){case"topLeft":n=this.mesh._geometry.vertices[this.topLeftIndex],"straight"===t?n.x=-this.width/2:"cutOff"===t&&(n.x=-this.width/2+this.cutOff),this.mesh.updateMesh(),this.regenerateStrokeGeometry(this.mesh);break;case"topRight":n=this.mesh._geometry.vertices[this.topRightIndex],"straight"===t?n.x=this.width/2:"cutOff"===t&&(n.x=this.width/2-this.cutOff),this.mesh.updateMesh(),this.regenerateStrokeGeometry(this.mesh);break;case"bottomRight":n=this.mesh._geometry.vertices[this.bottomRightIndex],"straight"===t?n.x=this.width/2:"cutOff"===t&&(n.x=this.width/2-this.cutOff),this.mesh.updateMesh(),this.regenerateStrokeGeometry(this.mesh);break;case"bottomLeft":n=this.mesh._geometry.vertices[this.bottomLeftIndex],"straight"===t?n.x=-this.width/2:"cutOff"===t&&(n.x=-this.width/2+this.cutOff),this.mesh.updateMesh(),this.regenerateStrokeGeometry(this.mesh)}this.mesh.generateFlatUVs()}}},{key:"regenerateStrokeGeometry",value:function(t){this.strokeMesh.updateStroke(t,this.strokeWidth)}},{key:"fakePress",value:function(){this.fakePressed=!0}}]),e}(),hn=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var pn=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),i=n(t,"columns",2),o=n(t,"mode","grid"),a=n(t,"offsetType","even");if(r.buttons=n(t,"buttons",[]),r.orderedIndices=[],r.width=0,r.height=0,r.root=new ot({primitive:"node"}),r.transform=r.root.transform,r.buttons.length>0){for(var u=0;u<r.buttons.length;u++)r.root.transform.addChild(r.buttons[u].transform);r.organize(o,i,a)}return r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,d),hn(e,[{key:"organize",value:function(t,e,n){var r=this.organizeGrid(e);switch(t){case"grid":this.positionGrid(r);break;case"honeycomb":this.positionHoneyComb(r,n)}}},{key:"organizeGrid",value:function(t){for(var e=[],n=0;n<this.buttons.length;n++)0!==n&&n%t!=0||(e[e.length]=[]),e[e.length-1].push({index:n,position:new M,isTop:!1,isBottom:!1,isLeft:!1,isRight:!1});return e}},{key:"positionGrid",value:function(t){for(var e=0,n=0;n<t.length;n++)for(var r=t[n],i=0;i<r.length;i++){var o=this.buttons[r[i].index];r[i].position.x=i*(o.width+o.strokeWidth),r[i].position.y=n*-(o.height+o.strokeWidth),0===n&&(r[i].isTop=!0),n===t.length-1&&(r[i].isBottom=!0),0===i&&(r[i].isLeft=!0),i===r.length-1&&(r[i].isRight=!0,e+r.length>this.buttons.length-1&&(r[i].isBottom=!0)),this.orderedIndices.push(r[i]),e++}this.renderGrid()}},{key:"renderGrid",value:function(){for(var t=0;t<this.orderedIndices.length;t++){var e=this.orderedIndices[t],n=this.buttons[t];if(n.transform.setLocalPosition(e.position),e.isTop&&e.isLeft&&!e.isBottom&&e.isRight){var r=this.orderedIndices[t+1];!r.isTop&&r.isLeft&&!r.isBottom&&r.isRight&&(n.adaptCorner("straight","bottomRight"),n.adaptCorner("straight","bottomLeft"))}e.isTop&&e.isLeft&&e.isBottom&&!e.isRight&&(n.adaptCorner("straight","topRight"),n.adaptCorner("straight","bottomRight")),e.isTop&&!e.isLeft&&e.isBottom&&!e.isRight&&(n.adaptCorner("straight","topRight"),n.adaptCorner("straight","bottomRight"),n.adaptCorner("straight","topLeft"),n.adaptCorner("straight","bottomLeft")),e.isTop&&!e.isLeft&&e.isBottom&&e.isRight&&(n.adaptCorner("straight","topLeft"),n.adaptCorner("straight","bottomLeft")),!e.isTop||e.isLeft||e.isBottom||e.isRight||(n.adaptCorner("straight","topRight"),n.adaptCorner("straight","bottomRight"),n.adaptCorner("straight","topLeft"),n.adaptCorner("straight","bottomLeft")),e.isTop&&e.isLeft&&!e.isBottom&&!e.isRight&&(n.adaptCorner("straight","topRight"),n.adaptCorner("straight","bottomRight"),n.adaptCorner("straight","bottomLeft")),e.isTop&&!e.isLeft&&!e.isBottom&&e.isRight&&(n.adaptCorner("straight","topLeft"),n.adaptCorner("straight","bottomLeft"),n.adaptCorner("straight","bottomRight")),e.isTop||e.isBottom||(n.adaptCorner("straight","topRight"),n.adaptCorner("straight","bottomRight"),n.adaptCorner("straight","topLeft"),n.adaptCorner("straight","bottomLeft")),!e.isTop&&e.isLeft&&e.isBottom&&e.isRight&&(n.adaptCorner("straight","topLeft"),n.adaptCorner("straight","topRight")),!e.isTop&&e.isLeft&&e.isBottom&&!e.isRight&&(n.adaptCorner("straight","topLeft"),n.adaptCorner("straight","topRight"),n.adaptCorner("straight","bottomRight")),!e.isTop&&!e.isLeft&&e.isBottom&&e.isRight&&(n.adaptCorner("straight","topLeft"),n.adaptCorner("straight","topRight"),n.adaptCorner("straight","bottomLeft")),e.isTop||e.isLeft||!e.isBottom||e.isRight||(n.adaptCorner("straight","topRight"),n.adaptCorner("straight","bottomRight"),n.adaptCorner("straight","topLeft"),n.adaptCorner("straight","bottomLeft"))}this.computeSize()}},{key:"positionHoneyComb",value:function(t,e){for(var n=0;n<t.length;n++)for(var r=t[n],i=0;i<r.length;i++){var o=this.buttons[r[i].index],a=3*o.mesh.getBoundingBox().getSize().y/4;r[i].position.x=i*(o.mesh.getBoundingBox().getSize().x+o.strokeWidth),r[i].position.y=n*-(a+o.strokeWidth),n%2==1&&("odd"===e?r[i].position.x-=(o.mesh.getBoundingBox().getSize().x+o.strokeWidth)/2:r[i].position.x+=(o.mesh.getBoundingBox().getSize().x+o.strokeWidth)/2),this.orderedIndices.push(r[i])}this.renderHoneyComb()}},{key:"renderHoneyComb",value:function(){for(var t=0;t<this.orderedIndices.length;t++){var e=this.orderedIndices[t];this.buttons[t].transform.setLocalPosition(e.position)}this.computeSize()}},{key:"computeSize",value:function(){var t=this.buttons[0].mesh.getBoundingBox();t.expandByObject(this.root.transform.entity),this.width=t.getSize().x,this.height=t.getSize().y}}]),e}(),fn=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),dn=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};var mn={title:null,camera:null,pointer:null,width:50,height:50,cutOff:"auto",strokeWidth:"auto",titleHeight:"auto",fillColor:b.black.clone(),strokeColor:b.mobilizing.clone(),fontURL:null,fontItalicURL:null,fontBoldURL:null,fontBoldItalicURL:null,texture:null},gn=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));t=Object.assign({},mn,t),n.title=t.title,n.camera=t.camera,n.pointer=t.pointer,n.width=t.width,n.height=t.height,n.cutOff=t.cutOff,n.strokeWidth=t.strokeWidth,n.titleHeight=t.titleHeight,n.fillColor=t.fillColor,n.strokeColor=t.strokeColor,n.titleHeight=t.titleHeight,n.fontURL=t.fontURL,n.fontItalicURL=t.fontItalicURL,n.fontBoldURL=t.fontBoldURL,n.fontBoldItalicURL=t.fontBoldItalicURL,n.texture=t.texture,"auto"===n.cutOff&&(n.cutOff=Math.min(n.width,n.height)/10),"auto"===n.strokeWidth&&(n.strokeWidth=Math.min(n.width,n.height)/100),n.titleWidth=n.height-2*n.cutOff,"auto"===n.titleHeight&&(n.titleHeight="number"==typeof n.cutOff?n.cutOff:n.width/10),n.root=new ot({primitive:"node"}),n.transform=n.root.transform,n.materials=[];var r=n.width/2,i=n.height/2;if(n.vertices=[new A(-r+n.cutOff,i),new A(r-n.cutOff,i),new A(r,i-n.cutOff),new A(r,-i+n.cutOff),new A(r-n.cutOff,-i),new A(-r+n.cutOff,-i),new A(-r,-i+n.cutOff),new A(-r,i-n.cutOff)],n.mesh=new ot({primitive:"custom"}),n.mesh.generateFillMesh(n.vertices),n.root.transform.addChild(n.mesh.transform),null===t.title&&o(t.texture)?n.mesh.material.setTexture(t.texture):n.mesh.material.setColor(n.fillColor),n.mesh.material.setTransparent(!0),n.materials.push(n.mesh.material),n.strokeMesh=ot.generateStrokeMesh(n.mesh,n.strokeWidth),n.root.transform.addChild(n.strokeMesh.transform),n.strokeMesh.material.setColor(n.strokeColor),n.strokeMesh.material.setTransparent(!0),n.materials.push(n.strokeMesh.material),null!==t.title){var a=Math.max(n.titleWidth,512),u=a*(n.titleHeight/n.titleWidth);n.titleText=new Mobilizing.RichText({width:a,height:u,marginTop:0,text:"<b>"+n.title+"</b>",textSize:.75*u,textAlign:"right",textColor:n.strokeColor,backgroundColor:n.fillColor,fontURL:n.fontURL,fontItalicURL:n.fontItalicURL,fontBoldURL:n.fontBoldURL,fontBoldItalicURL:n.fontBoldItalicURL}),n.titleTexture=new K({canvas:n.titleText.getCanvas()}),n.texturedMesh=new ot({primitive:"plane",material:"basic",width:n.titleWidth,height:n.titleHeight}),n.texturedMesh.transform.setLocalPosition(n.titleHeight/2-n.width/2,0,0),n.texturedMesh.transform.setLocalRotation(0,0,90),n.root.transform.addChild(n.texturedMesh.transform),n.texturedMesh.material.setTexture(n.titleTexture),n.texturedMesh.material.setTransparent(!0),n.materials.push(n.texturedMesh.material),o(n.texture)&&(n.imgMesh=new ot({primitive:"plane",material:"basic",width:n.width-2*n.titleHeight,height:n.height-2*n.titleHeight}),n.imgMesh.material.setTransparent(!0),n.imgMesh.material.setTexture(t.texture),n.root.transform.addChild(n.imgMesh.transform),n.materials.push(n.imgMesh.material))}return n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,d),fn(e,[{key:"setup",value:function(){var t=this;dn(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setup",this).call(this);var n=this.getContext();if(null===n)throw new Error("Add Panel to a context before calling setup()");this.clickable=new an({camera:this.camera,target:this.mesh,pointer:this.pointer,onPress:function(){t._active&&t.events.trigger("down")},onRelease:function(){t._active&&(t.events.trigger("up"),t.events.trigger("click"))},onEnter:function(){t._active&&t.events.trigger("over")},onLeave:function(){t._active&&t.events.trigger("out")}}),n.addComponent(this.clickable),this.clickable.setup(),this.on()}},{key:"update",value:function(){}},{key:"setStrokeColor",value:function(t){this.strokeColor=t,this.strokeMesh.material.setColor(this.strokeColor),this.titleText._textColor=t,this.titleText._lines=[],this.titleText.render()}},{key:"on",value:function(){dn(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"on",this).call(this),this.materials.forEach(function(t){return t.setOpacity(1)})}},{key:"off",value:function(){dn(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"off",this).call(this),this.materials.forEach(function(t){return t.setOpacity(.3)})}}]),e}(),vn=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),yn=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};var bn=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.camera=t.camera,n.pointer=t.pointer,n.root=new ot({primitive:"node"}),n.transform=n.root.transform,n.width="number"==typeof t.width?t.width:2.5*t.defaults.width,n.height=t.defaults.height,n.hand="number"==typeof t.hand?t.hand:null,n.isFolded=!1,n.current=null,n.positions={x:{min:t.defaults.width/2-n.width/2,max:n.width/2-t.defaults.width/2,offset:n.width/2-t.defaults.width/2+1.1*t.defaults.width},z:{min:"number"==typeof t.depth?-1*t.depth:-1*t.defaults.height,max:0}},n.defaults=t.defaults,n.panels=[],n.count=t.panels.length,t.panels.forEach(function(e,r){var i=Object.assign({},t.defaults,e,{camera:n.camera,pointer:n.pointer}),o=new gn(i);o.transform.setLocalPosition(n.getPanelPosition(r)),n.root.transform.addChild(o.transform),n.panels.push(o)}),n.updatePositions=function(t){var e=t.delta,r=0,i=0;if(1===n.count){var o=.1*n.defaults.width;r=e<.25?k.map(e,0,.25,n.positions.x.max,n.positions.x.max+o):e<.75?k.map(e,.25,.75,n.positions.x.max+o,n.positions.x.max-o):k.map(e,.75,1,n.positions.x.max-o,n.positions.x.max),n.panels[0].transform.setLocalPositionX(r)}else{var a=n.getPanelPosition(n.count-1);e<.3?(r=k.map(e,0,.3,n.positions.x.max,n.positions.x.offset),i=0):r=k.map(e,.3,1,n.positions.x.offset,a.x),i=k.map(e,0,1,n.positions.z.max,a.z),n.panels[0].transform.setLocalPositionX(r),n.panels[0].transform.setLocalPositionZ(i);for(var s=1;s<n.count;s++){var u=n.getPanelPosition(s),l=n.getPanelPosition(s-1);r=k.map(e,0,1,u.x,l.x),i=k.map(e,0,1,u.z,l.z),n.panels[s].transform.setLocalPositionX(r),n.panels[s].transform.setLocalPositionZ(i)}}},n.updateFolding=function(t){var e=t.delta,r=n.panels[0].strokeWidth+2;n.panels.slice(1).forEach(function(t,i){i++;var o=n.getPanelPosition(i),a={x:n.positions.x.max-r*i,z:n.positions.z.max-r*i};t.transform.setLocalPositionX(k.map(e,0,1,o.x,a.x)),t.transform.setLocalPositionZ(k.map(e,0,1,o.z,a.z))})},n.animations={next:new B({duration:400,target:{delta:0},to:{delta:1},easing:B.Easing.easeInOutQuint,onUpdate:n.updatePositions,onFinish:function(){n.panels.push(n.panels.shift())}}),previous:new B({duration:400,target:{delta:1},to:{delta:0},easing:B.Easing.easeInOutQuint,onUpdate:n.updatePositions,onStart:function(){n.panels.unshift(n.panels.pop())}}),fold:new B({duration:400,target:{delta:0},to:{delta:1},easing:B.Easing.easeInOutQuint,onUpdate:n.updateFolding}),unfold:new B({duration:400,target:{delta:1},to:{delta:0},easing:B.Easing.easeInOutQuint,onUpdate:n.updateFolding})},n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,d),vn(e,[{key:"setup",value:function(){var t=this;yn(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setup",this).call(this);var n=this.getContext();if(null===n)throw new Error("Add Panel to a context before calling setup()");Object.keys(this.animations).forEach(function(e){var r=t.animations[e];r.events.on("start",function(){t.current=r}),r.events.on("finish",function(){t.current=null}),n.addComponent(r),r.setup(),r.on()});var r=null,i=!1,o=!1,a={x:0,y:0},s={x:0,y:0};this.pointer.events.on("on",function(e){var n=e.x,u=e.y,l=e.pointer;!t._active||t.animations.previous._isPlaying||t.animations.next._isPlaying||(r=l,o=!1,a={x:0,y:0},s={x:0,y:0},!0===(i=t.panels.some(function(e){return null!==e.mesh.transform.pick(t.camera,n,u)}))&&(a={x:n,y:u}))}),this.pointer.events.on("moved",function(t){var e=t.x,n=t.y,u=t.pointer;i&&u===r&&(s={x:e-a.x,y:n-a.y},(Math.abs(s.x)>20||Math.abs(s.y)>20)&&(o=!0))}),this.pointer.events.on("off",function(e){var n=e.pointer;i&&n===r&&!0===o&&(t.events.trigger("swipe",s),Math.abs(s.x)>Math.abs(s.y)?t.events.trigger(s.x>0?"swiperight":"swipeleft"):t.events.trigger(s.y>0?"swipeup":"swipedown"))}),this.panels.forEach(function(e){n.addComponent(e),e.setup(),e.events.on("click",function(){!1===o&&e===t.panels[0]&&t.events.trigger("click",e)})}),this.on()}},{key:"update",value:function(){}},{key:"isIdle",value:function(){return null===this.current}},{key:"next",value:function(){this.animations.next.play()}},{key:"previous",value:function(){this.animations.previous.play()}},{key:"fold",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isFolded||(this.isFolded=!0,t?this.animations.fold.play():this.updateFolding({delta:1}))}},{key:"unfold",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isFolded&&(this.isFolded=!1,t?this.animations.unfold.play():this.updateFolding({delta:0}))}},{key:"on",value:function(){yn(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"on",this).call(this),this.panels.forEach(function(t){return t.on()})}},{key:"off",value:function(){yn(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"off",this).call(this),this.panels.forEach(function(t){return t.off()})}},{key:"getPanelPosition",value:function(t){if(1===this.count)return new M(this.positions.x.max,0,this.positions.z.max);var e=B.Easing.easeOutSin,n=B.Easing.linear,r=this.hand>0?Math.min(t,5)/5:t/(this.count-1),i=k.map(e(r),0,1,this.positions.x.max,this.positions.x.min),o=k.map(n(r),0,1,this.positions.z.max,this.positions.z.min);return new M(i,0,o)}}]),e}(),_n=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var xn=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.setName(n(t,"name",void 0)),r._ready=!1,r._styledLetters=[],r._maxCharCount=n(t,"maxCharCount",1e3),r._maxLineCount=n(t,"maxLineCount",1),r._size=n(t,"size",20),r._color=n(t,"color",b.gray),r._backgroundColor=n(t,"backgroundColor",b.white),r._lineHeight=n(t,"lineHeight",1),r._margins=n(t,"margins",10),r._width=n(t,"width",300),r._height=n(t,"height",100),r._fontURL=n(t,"fontURL","fonts/Raleway-Regular.ttf"),r._fontItalicURL=n(t,"fontItalicURL","fonts/Raleway-Regular-Italic.ttf"),r._fontBoldURL=n(t,"fontBoldURL","fonts/Raleway-Bold.ttf"),r._fontBoldItalicURL=n(t,"fontBoldItalicURL","fonts/Raleway-Bold-Italic.ttf"),r._font=n(t,"font",void 0),r._currentFont=r._font,r._cursorColor=n(t,"cursorColor",r._color),r._cursorWidth=n(t,"cursorWidth",2),r._blinkTime=n(t,"blinkTime",300),r._blinkState=!1,setInterval(r.onBlink.bind(r),r._blinkTime),r._cursorIndex=-1,r._cursorX=0,r._cursorY=0,r._canvas=document.createElement("canvas"),r._canvas.width=r._width,r._canvas.height=r._height,r._canvasContext=r._canvas.getContext("2d"),r._canvas.events=new p({scope:r._canvas}),ge.loadArrayBuffer(r._fontURL,function(t){r._defaultFontFile=t,ge.loadArrayBuffer(r._fontItalicURL,function(t){r._defaultItalicFontFile=t,ge.loadArrayBuffer(r._fontBoldURL,function(t){r._defaultBoldFontFile=t,ge.loadArrayBuffer(r._fontBoldItalicURL,function(t){r._defaultBoldItalicFontFile=t,r.setup()})})})}),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,c),_n(e,[{key:"setup",value:function(){this._defaultFont=new Le({fontFile:this._defaultFontFile}),this._defaultItalicFont=new Le({fontFile:this._defaultItalicFontFile}),this._defaultBoldFont=new Le({fontFile:this._defaultBoldFontFile}),this._defaultBoldItalicFont=new Le({fontFile:this._defaultBoldItalicFontFile}),this._currentFont=this._defaultFont,this.render()}},{key:"setFont",value:function(t){this._currentFont=t}},{key:"setSize",value:function(t){this._size=t}},{key:"setColor",value:function(t){this._color=t}},{key:"addLetter",value:function(t){var e=t.charCodeAt(0),n=String.fromCharCode(e);"\n"===t&&(n=t);var r=new Ue({letter:n,font:this._currentFont,size:this._size,color:this._color});this._styledLetters.splice(this._cursorIndex+1,0,r),this.moveCursorForward(),this.render()}},{key:"delete",value:function(){this._cursorIndex>=0&&(this._styledLetters.splice(this._cursorIndex,1),this.moveCursorBack())}},{key:"onBlink",value:function(){this._blinkState=!this._blinkState,this.render()}},{key:"moveCursorForward",value:function(){this._cursorIndex++,this._cursorIndex>this._styledLetters.length-1&&(this._cursorIndex=this._styledLetters.length-1),0===this._styledLetters.length&&(this._cursorIndex=-1),this.render()}},{key:"moveCursorBack",value:function(){this._cursorIndex--,this._cursorIndex<-1&&(this._cursorIndex=-1),this.render()}},{key:"moveCursorTo",value:function(t){t>=-1&&t<this._styledLetters.length&&(this._cursorIndex=t,this.render())}},{key:"pickLetter",value:function(t,e){for(var n=0;n<this._styledLetters.length;n++){var r=this._styledLetters[n].path.getBoundingBox(),i=[{x:r.x1,y:r.y1},{x:r.x2,y:r.y1},{x:r.x2,y:r.y2},{x:r.x1,y:r.y2}];if(k.pointIsInside(t,e,i))return{index:n,letter:this._styledLetters[n]}}return null}},{key:"render",value:function(){this._canvasContext.fillStyle="#"+this._backgroundColor.getHexString(),this._canvasContext.fillRect(0,0,this._width,this._height);for(var t=this._margins,e=this._margins,n=0;n<this._styledLetters.length;n++)if(n<this._maxCharCount){var r=this._styledLetters[n];e===this._margins&&(e+=r.size),t+r.width>this._width-this._margins&&(e+=r.size,t=this._margins),"\n"===r.letter&&(e+=r.size,t=this._margins),r.setX(t),r.setY(e),r.update(),r.path.draw(this._canvasContext),t+=r.width}if(this._blinkState){var i=this._styledLetters[this._cursorIndex];if(i){var o=i.path.getBoundingBox();this._canvasContext.beginPath(),i.height<1?(this._canvasContext.moveTo(i.x+i.width,i.y),this._canvasContext.lineTo(i.x+i.width,i.y),this._canvasContext.lineTo(i.x+i.width,i.y-this._size)):(this._canvasContext.moveTo(o.x2,o.y1),this._canvasContext.lineTo(o.x2,o.y1),this._canvasContext.lineTo(o.x2,o.y2))}else this._canvasContext.beginPath(),this._canvasContext.moveTo(this._margins,this._margins),this._canvasContext.lineTo(this._margins,this._margins),this._canvasContext.lineTo(this._margins,this._margins+this._size);this._canvasContext.lineWidth=this._cursorWidth,this._canvasContext.strokeStyle="#"+this._cursorColor.getHex(),this._canvasContext.stroke()}this._canvas.events.trigger("drawn")}},{key:"getWidth",value:function(){return this._width}},{key:"getHeight",value:function(){return this._height}},{key:"getCanvas",value:function(){return this._canvas}}]),e}(),wn=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var En=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.targetScript=t.targetScript,n.targetScript.context=t.context,n.targetScript.getContext=function(){return this.context},n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,d),wn(e,[{key:"preLoad",value:function(){if("function"==typeof this.targetScript.preLoad){var t=void 0;(t=this.targetScript).preLoad.apply(t,arguments)}}},{key:"setup",value:function(){this.targetScript.setup()}},{key:"update",value:function(){this.targetScript.update()}}]),e}(),Sn=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Tn=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._components=[],n.loader=new ge,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,d),Sn(e,[{key:"init",value:function(){}},{key:"setup",value:function(){var t=this;this._components.forEach(function(e){t.chainedCall(e,"setup")})}},{key:"preLoad",value:function(){var t=this;this._components.forEach(function(e){e.preLoad(t.loader)})}},{key:"update",value:function(){var t=this;this._components.forEach(function(e){t.chainedCall(e,"preUpdate")}),this._components.forEach(function(e){t.chainedCall(e,"update")}),this._components.forEach(function(e){t.chainedCall(e,"postUpdate")})}},{key:"chainedCall",value:function(t,e,n){var r=this;t[e](n);var i=t.getChainedComponents();i.length>0&&i.forEach(function(t){r.chainedCall(t,e,n)})}},{key:"addComponent",value:function(t){return t instanceof d||(t=new En({targetScript:t,context:this})),this._components.push(t),t.setContext(this),t}}]),e}(),On=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),An=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0};var Mn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":s(e))&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":s(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,Tn),On(e,[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};An(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this,t),t.context=this,this.audio=this.addComponent(new Mobilizing.RendererAudio(t)),this.renderer=this.addComponent(new Mobilizing.Renderer3D(t)),this.physics=this.addComponent(new Mobilizing.PhysicsEngine(t)),this.time=this.addComponent(new Mobilizing.Time(t)),this.touch=this.addComponent(new Mobilizing.input.Touch({context:this}))}},{key:"update",value:function(t){An(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this,t)}},{key:"getMainRenderer",value:function(){return this.renderer}},{key:"getRenderingSurface",value:function(){return this.canvas}},{key:"getTouchSurface",value:function(){return this.canvas}},{key:"setCurrentScene",value:function(t){this.renderer.setCurrentScene(t)}},{key:"addToCurrentScene",value:function(t){this.renderer.addToCurrentScene(t)}},{key:"removeFromCurrentScene",value:function(t){this.renderer.removeFromCurrentScene(t)}},{key:"clear",value:function(){this.renderer.clear()}},{key:"addCamera",value:function(t){this.renderer.addCamera(t)}},{key:"removeCamera",value:function(t){this.renderer.removeCamera(t)}},{key:"getCanvasSize",value:function(){return{width:this.canvas.width/window.devicePixelRatio,height:this.canvas.height/window.devicePixelRatio}}},{key:"beep",value:function(t){this.audio.beep(t)}},{key:"getCanvasPosition",value:function(){return xt.getElementPosition(this.canvas)}},{key:"updateCanvasPosition",value:function(){this.canvasPosition=this.getCanvasPosition()}},{key:"createCube",value:function(){var t=new Mobilizing.Mesh({primitive:"box"});return this.addToCurrentScene(t),t}},{key:"createSphere",value:function(){var t=new Mobilizing.Mesh({primitive:"sphere"});return this.addToCurrentScene(t),t}},{key:"createPlane",value:function(){var t=new Mobilizing.Mesh({primitive:"plane"});return this.addToCurrentScene(t),t}},{key:"createLight",value:function(){var t=new(Function.prototype.bind.apply(Mobilizing.Light,[null].concat(Array.prototype.slice.call(arguments))));return this.addToCurrentScene(t),t}},{key:"createLabel",value:function(t){t.context=this;var e=new Mobilizing.Label(t);return this.addToCurrentScene(e),e}},{key:"createMesh",value:function(t){t.context=this;var e=new Mobilizing.Mesh(t);return this.addToCurrentScene(e),e}},{key:"createCamera",value:function(){var t=new(Function.prototype.bind.apply(Mobilizing.Camera,[null].concat(Array.prototype.slice.call(arguments))));return this.addCamera(t),this.addToCurrentScene(t),t}},{key:"createCameraX",value:function(t){var e=new Mobilizing.Camera(t.type);return this.addCamera(e),this.addToCurrentScene(e),void 0!==t.fov&&e.setFOV(t.fov),void 0!==t.position&&e.transform.setLocalPosition(t.position),void 0!==t.layer&&(e.layer=t.layer),e}},{key:"createTextLabel",value:function(t,e,n,r,i,o,a,s){var u=new Mobilizing.Label(t,e,r,i);return u.style.fontSize=n,u.style.color=o,void 0!==a?(u.style.hasBackground=!0,u.style.backgroundColor=a):u.style.hasBackground=!1,u.style.textAlign="center",void 0!==s?(u.material.texture=s,u.transform.setLocalScale(r,i,1)):u.render(),this.addToCurrentScene(u),u}},{key:"createVideoQuad",value:function(t){var e=new Mobilizing.Mesh({primitive:"plane"});return e.vt=new Mobilizing.VideoTexture,e.vt.loadFromFile(t),e.material.setTexture(e.vt),this.addToCurrentScene(e),e}},{key:"loadFont",value:function(t){return new Mobilizing.Font(t,this)}},{key:"loadObj3dModel",value:function(t,e){var n=new Mobilizing.Mesh;n.material=new Mobilizing.Material({type:"lambert"}),n.updateMaterial(),n.loadFromFile(t,this.onObjLoaded.bind(this));var r=new Mobilizing.Texture({context:this});return r.loadFromFile(e),n.material.setTexture(r),n}},{key:"onObjLoaded",value:function(t){this.addToCurrentScene(t)}},{key:"createAudioSource",value:function(t){var e=new Mobilizing.AudioSource(this);return e.set3D(!1),new Mobilizing.AudioBuffer(this).loadFromURL(t,this.onBufferLoaded.bind(this)),e}},{key:"onBufferLoaded",value:function(){}},{key:"createTexture",value:function(){return new Mobilizing.Texture({context:this})}},{key:"createTextureFromCubeCamera",value:function(t){var e=new Mobilizing.Texture({context:this});return e.cube=t._camera.renderTarget,e.cube.minFilter=THREE.LinearMipMapLinearFilter,e}},{key:"loadTexture",value:function(t,e){var n=new Mobilizing.Texture({context:this});return n.loadFromFile(t,e),n}},{key:"createTextButton",value:function(t,e,n,r,i,o,a){var s=Mobilizing.Button.CreateButton(void 0,t,r,i,o,e,n,void 0,void 0,this);return s.transform.setLocalScale(a),this.addToCurrentScene(s),s}}]),e}(),Cn={Keyboard:bt,Mouse:St,Touch:Ct,Motion:Rt,Orientation:Dt,GPS:Ft},kn={Ajax:re,PubSub:Ee};t.version="0.0.1",t.revision="8fdb694",t.input=Cn,t.net=kn,t.GPSUtils=zt,t.math=k,t.getOrDefault=n,t.AudioBuffer=u,t.AudioSource=v,t.Color=b,t.Euler=_,t.Matrix3=x,t.Matrix4=w,t.Quaternion=E,t.Rect=T,t.Vector2=A,t.Vector3=M,t.Animation=B,t.Csg=ut,t.Debug=W,t.debug=q,t.Device=ft,t.BatteryStatus=gt,t.MeshFX=Ht,t.Midi=Wt,t.Profiler=Xt,t.Runner=$t,t.Loader=ge,t.Cache=ve,t.Pointer=xe,t._DOM=xt,t.PhysicsEngine=Te,t.Engine3D=Ae,t.Renderer3D=Ce,t.RendererAudio=Pe,t.Camera=Y,t.Font=Le,t.Light=Z,t.LODGroup=De,t.Material=G,t.Transform=nt,t.Label=tt,t.Mesh=ot,t.EdgesMesh=at,t.StyledLetter=Ue,t.StyledTextElement=Fe,t.TextLine=Be,t.RichText=He,t.CanvasTexture=We,t.DOMNodeTexture=Xe,t.ImageSequenceTexture=$e,t.RenderTexture=Je,t.Texture=K,t.VideoTexture=Qe,t.Time=R,t.Timer=en,t.NTP=rn,t.Button=cn,t.ButtonGroup=pn,t.Clickable=an,t.Panel=gn,t.PanelStack=bn,t.TextField=xn,t.Context=Tn,t.EasyContext=Mn,Object.defineProperty(t,"__esModule",{value:!0})},"object"===s(e)&&void 0!==t?a(e,n(185)):(i=[e,n(185)],void 0===(o="function"==typeof(r=a)?r.apply(e,i):r)||(t.exports=o))},function(t,e,n){"use strict";t.exports=function(t,e,n,r){var i=e.content_type,o=e.content,a=e.geometry,s=void 0,u=void 0,l=void 0,c=void 0,h=void 0,p=void 0,f=void 0,d=void 0,m=void 0,g=void 0,v=void 0,y=void 0,b=void 0;this.preLoad=function(t){"video"===i?d=t.loadVideo({url:n}):v=t.loadJSON({url:r})},this.setup=function(){s=this.getContext(),u=new Mobilizing.Renderer3D({canvas:t}),s.addComponent(u);var e=new Mobilizing.input.Touch({target:u.canvas});s.addComponent(e),e.setup(),e.on();var n,r=new Mobilizing.input.Mouse({target:u.canvas});s.addComponent(r),r.setup(),r.on(),y=new Mobilizing.Pointer,s.addComponent(y),y.add(e),y.add(r),f=new Mobilizing.input.Orientation,s.addComponent(f),f.setup(),f.on(),(l=new Mobilizing.Camera).setFOV(90),u.addCamera(l),(h=new Mobilizing.Light).transform.setLocalPosition(20,20,0),h.setIntensity(2),u.addToCurrentScene(h),p=new Mobilizing.Light,u.addToCurrentScene(p),"sphere"===a?c=new Mobilizing.Mesh({primitive:"sphere",radius:100,segments:32,material:"basic"}):"cube"===a?c=new Mobilizing.Mesh({primitive:"cube",size:100,segments:32,material:"basic"}):"cylinder"===a&&((c=new Mobilizing.Mesh({primitive:"cylinder",height:5,radius:50,heightSegments:12,radiusSegments:16,material:"basic"})).transform.setLocalScale(-1,1,1),c.material.setWireframe(!0)),c.transform.setLocalScale(-1,1,1),u.addToCurrentScene(c),"video"===i?(n=d.getValue(),m=new Mobilizing.VideoTexture({video:n,autoPlay:!0}),c.material.setTexture(m)):function(){y.setup(),y.on(),c.setVisible(!1);var t=c.getVertices();b=new Mobilizing.Mesh({primitive:"node"}),u.addToCurrentScene(b),g=v.getValue();for(var e=o.split(" "),n=0;n<e.length;n++)if(e[n]&&t[n]){var r=new Mobilizing.Mesh({primitive:"text",text:e[n],font:g});r.transform.setLocalPosition(t[n].x,t[n].y,t[n].z),r.transform.lookAt(new Mobilizing.Vector3),r.transform.setLocalScale(.05),b.transform.addChild(r.transform)}}()},this.update=function(){m&&m.update();var t=f.getGyroQuaternion();if(t)l.transform.setLocalQuaternion(t);else if(y.getState()){var e=-y.getDeltaX()/5,n=-y.getDeltaY()/5,r=c.transform.getLocalRotationY();c.transform.setLocalRotationY(r+e);var i=c.transform.getLocalRotationX();c.transform.setLocalRotationX(i+n),b&&(b.transform.setLocalRotationY(c.transform.getLocalRotationY()),b.transform.setLocalRotationX(c.transform.getLocalRotationX()))}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(1),o=(r=i)&&r.__esModule?r:{default:r};e.default=function(t){switch(t.renderingMode){case"web":return o.default.createElement("span",null,"inline web");case"pdf":return o.default.createElement("span",null,"inline pdf");case"epub-reflowable":return o.default.createElement("span",null,"inline epub reflowable");case"epub-fixed":return o.default.createElement("span",null,"inline epub fixed");case"micro":return o.default.createElement("span",null,"inline micro");default:return null}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.meta=e.Inline=e.Block=void 0;var r=a(n(697)),i=a(n(698)),o=a(n(699));function a(t){return t&&t.__esModule?t:{default:t}}e.Block=r.default,e.Inline=i.default,e.meta=o.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a(n(1)),i=a(n(2)),o=n(169);function a(t){return t&&t.__esModule?t:{default:t}}var s=function(t,e){var n,i,a,s=t.resource,u=e.citationLocale,l=e.citationStyle,c=e.citationItems[s.data.id];return c?r.default.createElement(o.Bibliography,{style:l,locale:u,items:(n={},i=c.id,a=c,i in n?Object.defineProperty(n,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[i]=a,n)}):null};s.contextTypes={citationLocale:i.default.string,citationStyle:i.default.string,citationItems:i.default.object},e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=o(n(1)),i=o(n(2));function o(t){return t&&t.__esModule?t:{default:t}}var a=function(t,e){var n=t.contextualization,i=e.citations[n.id];return i&&i.html?r.default.createElement("cite",{dangerouslySetInnerHTML:{__html:i.html}}):null};a.contextTypes={citations:i.default.object},e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={id:"bib",accepts:["bib"]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(1),o=u(i),a=u(n(2)),s=u(n(273));function u(t){return t&&t.__esModule?t:{default:t}}var l=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i.Component),r(e,[{key:"shouldComponentUpdate",value:function(){return!0}},{key:"render",value:function(){var t=this.props.data,e=this.context,n=e.renderingMode,r=e.contextualizations,i=e.contextualizers,a=e.resources,u=r[t.asset.id];if(!u)return null;var l=i[u.contextualizerId],c=a[u.resourceId];if(!l||!c||!u)return null;var h=s.default[l.type],p=h&&h.Inline;return p?o.default.createElement(p,{resource:c,contextualization:u,contextualizer:l,renderingMode:n}):null}}]),e}();l.propTypes={asset:a.default.shape({resource:a.default.object})},l.contextTypes={renderingMode:a.default.string,contextualizations:a.default.object,contextualizers:a.default.object,resources:a.default.object},e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=o(n(1)),i=o(n(2));function o(t){return t&&t.__esModule?t:{default:t}}var a=function(t,e){var n=t.noteId,i=e.notes,o=e.NoteContentPointer,a=i&&i[n];return a&&o?r.default.createElement(o,{note:a,noteId:n}):null};a.contextTypes={notes:i.default.object,NoteContentPointer:i.default.func},e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a(n(1)),i=a(n(2)),o=a(n(176));function a(t){return t&&t.__esModule?t:{default:t}}var s=function(t,e){var n=t.note,i=t.renderingMode,a=t.composition,s=t.resources,u=t.assets,l=t.noteId,c=e.NotePointerPointer,h=e.Link;return r.default.createElement("section",{className:"note-content",id:"note-content-"+l},r.default.createElement(c,{noteId:l,note:n}),r.default.createElement("section",{className:"note-content-container"},r.default.createElement(o.default,{raw:n.contents,renderingMode:i,contextualizations:a.contextualizations,contextualizers:a.contextualizers,resources:s,assets:u,Link:h})))};s.contextTypes={NotePointerPointer:i.default.oneOfType([i.default.func,i.default.element]),Link:i.default.oneOfType([i.default.func,i.default.element])},e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(1),a=l(o),s=l(n(176)),u=l(n(177));function l(t){return t&&t.__esModule?t:{default:t}}function c(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var h=function(t){function e(){var t,n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=r=c(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(o))),r.shouldComponentUpdate=function(){return!0},c(r,n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Component),i(e,[{key:"render",value:function(){var t=this.props,e=t.containerWidth,n=t.containerHeight,r=t.children;return a.default.createElement("section",{className:"figure-wrapper",style:{width:e,height:n}},r)}}]),e}(),p=(0,u.default)()(h);e.default=function(t){var e=t.composition,n=t.renderingMode,i=t.assets,o=t.resources,u=r({},e.contents,{blocks:[e.contents.blocks.find(function(t){return"atomic"===t.type})]});return a.default.createElement("div",{className:"metis-DynamicFullscreenTemplate"},a.default.createElement("h2",null,e.metadata.title),a.default.createElement("section",{className:"figure-container"},a.default.createElement(p,null,a.default.createElement(s.default,{raw:u,renderingMode:n,contextualizations:e.contextualizations,contextualizers:e.contextualizers,resources:o,assets:i}))))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.makeCitationData=e.makeAssets=void 0;var r,i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},o=n(705),a=n(272);function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var u=((r=a)&&r.__esModule?r:{default:r}).default.draftEntitiesNames;e.makeAssets=function(t){var e=t.composition,n=e.contextualizations,r=e.contextualizers,o=t.resources;return Object.keys(n).reduce(function(t,e){var a=n[e],l=r[a.contextualizerId],c=o.find(function(t){return a.resourceId===t._id});return c?i({},t,s({},e,i({},a,{resource:c,contextualizer:l,type:l?l.type:u}))):t},{})},e.makeCitationData=function(t,e){var n=t.resources,r=t.composition,a=r.contextualizations,u=r.contextualizers,l=Object.keys(e).map(function(t){return e[t]}),c=l.reduce(function(t,e){return i({},t,s({},(0,o.resourceToCslJSON)(e.resource).id,(0,o.resourceToCslJSON)(e.resource)))},{}),h=l.map(function(t,e){var r=t.id,i=a[r],s=u[i.contextualizerId],l=n.find(function(t){return t._id===i.resourceId});return{citationID:r,citationItems:[{id:(0,o.resourceToCslJSON)(l).id,locator:s.locator,prefix:s.prefix,suffix:s.suffix}],properties:{noteIndex:e+1}}});return{citationData:h.map(function(t,e){return[t,h.slice(0,0===e?0:e).map(function(t){return[t.citationID,t.properties.noteIndex]}),[]]}),citationItems:c,assets:e}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.resourceToCslJSON=void 0,e.parseBibTeXToCSLJSON=function(t){return t.split("\n\n").reduce(function(t,e){return[].concat(a(t),a(new o.default(e).get({type:"json",style:"csl"})))},[])};var r,i=n(706),o=(r=i)&&r.__esModule?r:{default:r};function a(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}e.resourceToCslJSON=function(t){var e=t.metadata.resource_type,n=void 0;if("bib"===e)return t.data;switch(e){case"video":n="broadcast";break;case"data-presentation":n="dataset";break;case"webpage":n="webpage";break;case"table":n="dataset";break;case"image":case"imagegallery":n="graphic";break;default:n="misc"}return{type:n,title:t.metadata.title||t.metadata.name,id:t._id,abstract:t.metadata.description,issued:t.metadata.date&&{raw:t.metadata.date},URL:t.metadata.url||t.data.url,author:t.metadata.creators&&Array.isArray(t.metadata.creators)&&t.metadata.creators.map(function(t){return"string"==typeof t?{family:t}:t})||[]}}},function(t,e,n){"use strict";n(707);var r=p(n(909)),i=h(n(910)),o=h(n(912)),a=h(n(915)),s=h(n(942)),u=h(n(943)),l=p(n(945)),c=p(n(222));function h(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function p(t){return t&&t.__esModule?t:{default:t}}Object.assign(c.default,{async:l.default,get:i,CSL:o,parse:a,util:s,version:u,input:a.input.chain,inputAsync:a.input.async.chain}),(0,r.default)(c.default),t.exports=c.default},function(t,e,n){"use strict";(function(t){if(n(708),n(905),n(906),t._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");t._babelPolyfill=!0;var e="defineProperty";function r(t,n,r){t[n]||Object[e](t,n,{writable:!0,configurable:!0,value:r})}r(String.prototype,"padLeft","".padStart),r(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(t){[][t]&&r(Array,t,Function.call.bind([][t]))})}).call(e,n(78))},function(t,e,n){n(709),n(711),n(712),n(713),n(714),n(715),n(716),n(717),n(718),n(719),n(720),n(721),n(722),n(723),n(724),n(725),n(727),n(728),n(729),n(730),n(731),n(732),n(733),n(734),n(735),n(736),n(737),n(738),n(739),n(740),n(741),n(742),n(743),n(744),n(745),n(746),n(747),n(748),n(749),n(750),n(751),n(752),n(753),n(754),n(755),n(756),n(757),n(758),n(759),n(760),n(761),n(762),n(763),n(764),n(765),n(766),n(767),n(768),n(769),n(770),n(771),n(772),n(773),n(774),n(775),n(776),n(777),n(778),n(779),n(780),n(781),n(782),n(783),n(784),n(785),n(786),n(787),n(789),n(790),n(792),n(793),n(794),n(795),n(796),n(797),n(798),n(800),n(801),n(802),n(803),n(804),n(805),n(806),n(807),n(808),n(809),n(810),n(811),n(812),n(208),n(813),n(814),n(322),n(815),n(816),n(817),n(818),n(819),n(325),n(327),n(328),n(820),n(821),n(822),n(823),n(824),n(825),n(826),n(827),n(828),n(829),n(830),n(831),n(832),n(833),n(834),n(835),n(836),n(837),n(838),n(839),n(840),n(841),n(842),n(843),n(844),n(845),n(846),n(847),n(848),n(849),n(850),n(851),n(852),n(853),n(854),n(855),n(856),n(857),n(858),n(859),n(860),n(861),n(862),n(863),n(864),n(865),n(866),n(867),n(868),n(869),n(870),n(871),n(872),n(873),n(874),n(875),n(876),n(877),n(878),n(879),n(880),n(881),n(882),n(883),n(884),n(885),n(886),n(887),n(888),n(889),n(890),n(891),n(892),n(893),n(894),n(895),n(896),n(897),n(898),n(899),n(900),n(901),n(902),n(903),n(904),t.exports=n(38)},function(t,e,n){"use strict";var r=n(4),i=n(22),o=n(11),a=n(0),s=n(24),u=n(51).KEY,l=n(5),c=n(122),h=n(82),p=n(63),f=n(7),d=n(305),m=n(188),g=n(710),v=n(125),y=n(3),b=n(27),_=n(39),x=n(62),w=n(67),E=n(308),S=n(28),T=n(12),O=n(65),A=S.f,M=T.f,C=E.f,k=r.Symbol,P=r.JSON,R=P&&P.stringify,L="prototype",I=f("_hidden"),D=f("toPrimitive"),N={}.propertyIsEnumerable,j=c("symbol-registry"),U=c("symbols"),F=c("op-symbols"),B=Object[L],z="function"==typeof k,G=r.QObject,H=!G||!G[L]||!G[L].findChild,V=o&&l(function(){return 7!=w(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a})?function(t,e,n){var r=A(B,e);r&&delete B[e],M(t,e,n),r&&t!==B&&M(B,e,r)}:M,W=function(t){var e=U[t]=w(k[L]);return e._k=t,e},q=z&&"symbol"==typeof k.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof k},X=function(t,e,n){return t===B&&X(F,e,n),y(t),e=_(e,!0),y(n),i(U,e)?(n.enumerable?(i(t,I)&&t[I][e]&&(t[I][e]=!1),n=w(n,{enumerable:x(0,!1)})):(i(t,I)||M(t,I,x(1,{})),t[I][e]=!0),V(t,e,n)):M(t,e,n)},Y=function(t,e){y(t);for(var n,r=g(e=b(e)),i=0,o=r.length;o>i;)X(t,n=r[i++],e[n]);return t},$=function(t){var e=N.call(this,t=_(t,!0));return!(this===B&&i(U,t)&&!i(F,t))&&(!(e||!i(this,t)||!i(U,t)||i(this,I)&&this[I][t])||e)},Z=function(t,e){if(t=b(t),e=_(e,!0),t!==B||!i(U,e)||i(F,e)){var n=A(t,e);return!n||!i(U,e)||i(t,I)&&t[I][e]||(n.enumerable=!0),n}},J=function(t){for(var e,n=C(b(t)),r=[],o=0;n.length>o;)i(U,e=n[o++])||e==I||e==u||r.push(e);return r},K=function(t){for(var e,n=t===B,r=C(n?F:b(t)),o=[],a=0;r.length>a;)!i(U,e=r[a++])||n&&!i(B,e)||o.push(U[e]);return o};z||(s((k=function(){if(this instanceof k)throw TypeError("Symbol is not a constructor!");var t=p(arguments.length>0?arguments[0]:void 0),e=function(n){this===B&&e.call(F,n),i(this,I)&&i(this[I],t)&&(this[I][t]=!1),V(this,t,x(1,n))};return o&&H&&V(B,t,{configurable:!0,set:e}),W(t)})[L],"toString",function(){return this._k}),S.f=Z,T.f=X,n(68).f=E.f=J,n(97).f=$,n(124).f=K,o&&!n(64)&&s(B,"propertyIsEnumerable",$,!0),d.f=function(t){return W(f(t))}),a(a.G+a.W+a.F*!z,{Symbol:k});for(var Q="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),tt=0;Q.length>tt;)f(Q[tt++]);for(var et=O(f.store),nt=0;et.length>nt;)m(et[nt++]);a(a.S+a.F*!z,"Symbol",{for:function(t){return i(j,t+="")?j[t]:j[t]=k(t)},keyFor:function(t){if(!q(t))throw TypeError(t+" is not a symbol!");for(var e in j)if(j[e]===t)return e},useSetter:function(){H=!0},useSimple:function(){H=!1}}),a(a.S+a.F*!z,"Object",{create:function(t,e){return void 0===e?w(t):Y(w(t),e)},defineProperty:X,defineProperties:Y,getOwnPropertyDescriptor:Z,getOwnPropertyNames:J,getOwnPropertySymbols:K}),P&&a(a.S+a.F*(!z||l(function(){var t=k();return"[null]"!=R([t])||"{}"!=R({a:t})||"{}"!=R(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!q(t)){for(var e,n,r=[t],i=1;arguments.length>i;)r.push(arguments[i++]);return"function"==typeof(e=r[1])&&(n=e),!n&&v(e)||(e=function(t,e){if(n&&(e=n.call(this,t,e)),!q(e))return e}),r[1]=e,R.apply(P,r)}}}),k[L][D]||n(23)(k[L],D,k[L].valueOf),h(k,"Symbol"),h(Math,"Math",!0),h(r.JSON,"JSON",!0)},function(t,e,n){var r=n(65),i=n(124),o=n(97);t.exports=function(t){var e=r(t),n=i.f;if(n)for(var a,s=n(t),u=o.f,l=0;s.length>l;)u.call(t,a=s[l++])&&e.push(a);return e}},function(t,e,n){var r=n(0);r(r.S,"Object",{create:n(67)})},function(t,e,n){var r=n(0);r(r.S+r.F*!n(11),"Object",{defineProperty:n(12).f})},function(t,e,n){var r=n(0);r(r.S+r.F*!n(11),"Object",{defineProperties:n(307)})},function(t,e,n){var r=n(27),i=n(28).f;n(42)("getOwnPropertyDescriptor",function(){return function(t,e){return i(r(t),e)}})},function(t,e,n){var r=n(14),i=n(29);n(42)("getPrototypeOf",function(){return function(t){return i(r(t))}})},function(t,e,n){var r=n(14),i=n(65);n(42)("keys",function(){return function(t){return i(r(t))}})},function(t,e,n){n(42)("getOwnPropertyNames",function(){return n(308).f})},function(t,e,n){var r=n(6),i=n(51).onFreeze;n(42)("freeze",function(t){return function(e){return t&&r(e)?t(i(e)):e}})},function(t,e,n){var r=n(6),i=n(51).onFreeze;n(42)("seal",function(t){return function(e){return t&&r(e)?t(i(e)):e}})},function(t,e,n){var r=n(6),i=n(51).onFreeze;n(42)("preventExtensions",function(t){return function(e){return t&&r(e)?t(i(e)):e}})},function(t,e,n){var r=n(6);n(42)("isFrozen",function(t){return function(e){return!r(e)||!!t&&t(e)}})},function(t,e,n){var r=n(6);n(42)("isSealed",function(t){return function(e){return!r(e)||!!t&&t(e)}})},function(t,e,n){var r=n(6);n(42)("isExtensible",function(t){return function(e){return!!r(e)&&(!t||t(e))}})},function(t,e,n){var r=n(0);r(r.S+r.F,"Object",{assign:n(309)})},function(t,e,n){var r=n(0);r(r.S,"Object",{is:n(726)})},function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},function(t,e,n){var r=n(0);r(r.S,"Object",{setPrototypeOf:n(192).set})},function(t,e,n){"use strict";var r=n(98),i={};i[n(7)("toStringTag")]="z",i+""!="[object z]"&&n(24)(Object.prototype,"toString",function(){return"[object "+r(this)+"]"},!0)},function(t,e,n){var r=n(0);r(r.P,"Function",{bind:n(310)})},function(t,e,n){var r=n(12).f,i=Function.prototype,o=/^\s*function ([^ (]*)/;"name"in i||n(11)&&r(i,"name",{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(t){return""}}})},function(t,e,n){"use strict";var r=n(6),i=n(29),o=n(7)("hasInstance"),a=Function.prototype;o in a||n(12).f(a,o,{value:function(t){if("function"!=typeof this||!r(t))return!1;if(!r(this.prototype))return t instanceof this;for(;t=i(t);)if(this.prototype===t)return!0;return!1}})},function(t,e,n){var r=n(0),i=n(312);r(r.G+r.F*(parseInt!=i),{parseInt:i})},function(t,e,n){var r=n(0),i=n(313);r(r.G+r.F*(parseFloat!=i),{parseFloat:i})},function(t,e,n){"use strict";var r=n(4),i=n(22),o=n(32),a=n(194),s=n(39),u=n(5),l=n(68).f,c=n(28).f,h=n(12).f,p=n(83).trim,f=r.Number,d=f,m=f.prototype,g="Number"==o(n(67)(m)),v="trim"in String.prototype,y=function(t){var e=s(t,!1);if("string"==typeof e&&e.length>2){var n,r,i,o=(e=v?e.trim():p(e,3)).charCodeAt(0);if(43===o||45===o){if(88===(n=e.charCodeAt(2))||120===n)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+e}for(var a,u=e.slice(2),l=0,c=u.length;l<c;l++)if((a=u.charCodeAt(l))<48||a>i)return NaN;return parseInt(u,r)}}return+e};if(!f(" 0o1")||!f("0b1")||f("+0x1")){f=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof f&&(g?u(function(){m.valueOf.call(n)}):"Number"!=o(n))?a(new d(y(e)),n,f):y(e)};for(var b,_=n(11)?l(d):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),x=0;_.length>x;x++)i(d,b=_[x])&&!i(f,b)&&h(f,b,c(d,b));f.prototype=m,m.constructor=f,n(24)(r,"Number",f)}},function(t,e,n){"use strict";var r=n(0),i=n(41),o=n(314),a=n(195),s=1..toFixed,u=Math.floor,l=[0,0,0,0,0,0],c="Number.toFixed: incorrect invocation!",h=function(t,e){for(var n=-1,r=e;++n<6;)r+=t*l[n],l[n]=r%1e7,r=u(r/1e7)},p=function(t){for(var e=6,n=0;--e>=0;)n+=l[e],l[e]=u(n/t),n=n%t*1e7},f=function(){for(var t=6,e="";--t>=0;)if(""!==e||0===t||0!==l[t]){var n=String(l[t]);e=""===e?n:e+a.call("0",7-n.length)+n}return e},d=function(t,e,n){return 0===e?n:e%2==1?d(t,e-1,n*t):d(t*t,e/2,n)};r(r.P+r.F*(!!s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n(5)(function(){s.call({})})),"Number",{toFixed:function(t){var e,n,r,s,u=o(this,c),l=i(t),m="",g="0";if(l<0||l>20)throw RangeError(c);if(u!=u)return"NaN";if(u<=-1e21||u>=1e21)return String(u);if(u<0&&(m="-",u=-u),u>1e-21)if(n=(e=function(t){for(var e=0,n=t;n>=4096;)e+=12,n/=4096;for(;n>=2;)e+=1,n/=2;return e}(u*d(2,69,1))-69)<0?u*d(2,-e,1):u/d(2,e,1),n*=4503599627370496,(e=52-e)>0){for(h(0,n),r=l;r>=7;)h(1e7,0),r-=7;for(h(d(10,r,1),0),r=e-1;r>=23;)p(1<<23),r-=23;p(1<<r),h(1,1),p(2),g=f()}else h(0,n),h(1<<-e,0),g=f()+a.call("0",l);return g=l>0?m+((s=g.length)<=l?"0."+a.call("0",l-s)+g:g.slice(0,s-l)+"."+g.slice(s-l)):m+g}})},function(t,e,n){"use strict";var r=n(0),i=n(5),o=n(314),a=1..toPrecision;r(r.P+r.F*(i(function(){return"1"!==a.call(1,void 0)})||!i(function(){a.call({})})),"Number",{toPrecision:function(t){var e=o(this,"Number#toPrecision: incorrect invocation!");return void 0===t?a.call(e):a.call(e,t)}})},function(t,e,n){var r=n(0);r(r.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,e,n){var r=n(0),i=n(4).isFinite;r(r.S,"Number",{isFinite:function(t){return"number"==typeof t&&i(t)}})},function(t,e,n){var r=n(0);r(r.S,"Number",{isInteger:n(315)})},function(t,e,n){var r=n(0);r(r.S,"Number",{isNaN:function(t){return t!=t}})},function(t,e,n){var r=n(0),i=n(315),o=Math.abs;r(r.S,"Number",{isSafeInteger:function(t){return i(t)&&o(t)<=9007199254740991}})},function(t,e,n){var r=n(0);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,e,n){var r=n(0);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,e,n){var r=n(0),i=n(313);r(r.S+r.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(t,e,n){var r=n(0),i=n(312);r(r.S+r.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(t,e,n){var r=n(0),i=n(316),o=Math.sqrt,a=Math.acosh;r(r.S+r.F*!(a&&710==Math.floor(a(Number.MAX_VALUE))&&a(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:i(t-1+o(t-1)*o(t+1))}})},function(t,e,n){var r=n(0),i=Math.asinh;r(r.S+r.F*!(i&&1/i(0)>0),"Math",{asinh:function t(e){return isFinite(e=+e)&&0!=e?e<0?-t(-e):Math.log(e+Math.sqrt(e*e+1)):e}})},function(t,e,n){var r=n(0),i=Math.atanh;r(r.S+r.F*!(i&&1/i(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},function(t,e,n){var r=n(0),i=n(196);r(r.S,"Math",{cbrt:function(t){return i(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(t,e,n){var r=n(0);r(r.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,e,n){var r=n(0),i=Math.exp;r(r.S,"Math",{cosh:function(t){return(i(t=+t)+i(-t))/2}})},function(t,e,n){var r=n(0),i=n(197);r(r.S+r.F*(i!=Math.expm1),"Math",{expm1:i})},function(t,e,n){var r=n(0);r(r.S,"Math",{fround:n(317)})},function(t,e,n){var r=n(0),i=Math.abs;r(r.S,"Math",{hypot:function(t,e){for(var n,r,o=0,a=0,s=arguments.length,u=0;a<s;)u<(n=i(arguments[a++]))?(o=o*(r=u/n)*r+1,u=n):o+=n>0?(r=n/u)*r:n;return u===1/0?1/0:u*Math.sqrt(o)}})},function(t,e,n){var r=n(0),i=Math.imul;r(r.S+r.F*n(5)(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function(t,e){var n=+t,r=+e,i=65535&n,o=65535&r;return 0|i*o+((65535&n>>>16)*o+i*(65535&r>>>16)<<16>>>0)}})},function(t,e,n){var r=n(0);r(r.S,"Math",{log10:function(t){return Math.log(t)*Math.LOG10E}})},function(t,e,n){var r=n(0);r(r.S,"Math",{log1p:n(316)})},function(t,e,n){var r=n(0);r(r.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,e,n){var r=n(0);r(r.S,"Math",{sign:n(196)})},function(t,e,n){var r=n(0),i=n(197),o=Math.exp;r(r.S+r.F*n(5)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(i(t)-i(-t))/2:(o(t-1)-o(-t-1))*(Math.E/2)}})},function(t,e,n){var r=n(0),i=n(197),o=Math.exp;r(r.S,"Math",{tanh:function(t){var e=i(t=+t),n=i(-t);return e==1/0?1:n==1/0?-1:(e-n)/(o(t)+o(-t))}})},function(t,e,n){var r=n(0);r(r.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},function(t,e,n){var r=n(0),i=n(66),o=String.fromCharCode,a=String.fromCodePoint;r(r.S+r.F*(!!a&&1!=a.length),"String",{fromCodePoint:function(t){for(var e,n=[],r=arguments.length,a=0;r>a;){if(e=+arguments[a++],i(e,1114111)!==e)throw RangeError(e+" is not a valid code point");n.push(e<65536?o(e):o(55296+((e-=65536)>>10),e%1024+56320))}return n.join("")}})},function(t,e,n){var r=n(0),i=n(27),o=n(13);r(r.S,"String",{raw:function(t){for(var e=i(t.raw),n=o(e.length),r=arguments.length,a=[],s=0;n>s;)a.push(String(e[s++])),s<r&&a.push(String(arguments[s]));return a.join("")}})},function(t,e,n){"use strict";n(83)("trim",function(t){return function(){return t(this,3)}})},function(t,e,n){"use strict";var r=n(198)(!0);n(199)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e,n){"use strict";var r=n(0),i=n(198)(!1);r(r.P,"String",{codePointAt:function(t){return i(this,t)}})},function(t,e,n){"use strict";var r=n(0),i=n(13),o=n(201),a="".endsWith;r(r.P+r.F*n(202)("endsWith"),"String",{endsWith:function(t){var e=o(this,t,"endsWith"),n=arguments.length>1?arguments[1]:void 0,r=i(e.length),s=void 0===n?r:Math.min(i(n),r),u=String(t);return a?a.call(e,u,s):e.slice(s-u.length,s)===u}})},function(t,e,n){"use strict";var r=n(0),i=n(201);r(r.P+r.F*n(202)("includes"),"String",{includes:function(t){return!!~i(this,t,"includes").indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){var r=n(0);r(r.P,"String",{repeat:n(195)})},function(t,e,n){"use strict";var r=n(0),i=n(13),o=n(201),a="".startsWith;r(r.P+r.F*n(202)("startsWith"),"String",{startsWith:function(t){var e=o(this,t,"startsWith"),n=i(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),r=String(t);return a?a.call(e,r,n):e.slice(n,n+r.length)===r}})},function(t,e,n){"use strict";n(25)("anchor",function(t){return function(e){return t(this,"a","name",e)}})},function(t,e,n){"use strict";n(25)("big",function(t){return function(){return t(this,"big","","")}})},function(t,e,n){"use strict";n(25)("blink",function(t){return function(){return t(this,"blink","","")}})},function(t,e,n){"use strict";n(25)("bold",function(t){return function(){return t(this,"b","","")}})},function(t,e,n){"use strict";n(25)("fixed",function(t){return function(){return t(this,"tt","","")}})},function(t,e,n){"use strict";n(25)("fontcolor",function(t){return function(e){return t(this,"font","color",e)}})},function(t,e,n){"use strict";n(25)("fontsize",function(t){return function(e){return t(this,"font","size",e)}})},function(t,e,n){"use strict";n(25)("italics",function(t){return function(){return t(this,"i","","")}})},function(t,e,n){"use strict";n(25)("link",function(t){return function(e){return t(this,"a","href",e)}})},function(t,e,n){"use strict";n(25)("small",function(t){return function(){return t(this,"small","","")}})},function(t,e,n){"use strict";n(25)("strike",function(t){return function(){return t(this,"strike","","")}})},function(t,e,n){"use strict";n(25)("sub",function(t){return function(){return t(this,"sub","","")}})},function(t,e,n){"use strict";n(25)("sup",function(t){return function(){return t(this,"sup","","")}})},function(t,e,n){var r=n(0);r(r.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,e,n){"use strict";var r=n(0),i=n(14),o=n(39);r(r.P+r.F*n(5)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(t){var e=i(this),n=o(e);return"number"!=typeof n||isFinite(n)?e.toISOString():null}})},function(t,e,n){var r=n(0),i=n(788);r(r.P+r.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},function(t,e,n){"use strict";var r=n(5),i=Date.prototype.getTime,o=Date.prototype.toISOString,a=function(t){return t>9?t:"0"+t};t.exports=r(function(){return"0385-07-25T07:06:39.999Z"!=o.call(new Date(-5e13-1))})||!r(function(){o.call(new Date(NaN))})?function(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var t=this.getUTCFullYear(),e=this.getUTCMilliseconds(),n=t<0?"-":t>9999?"+":"";return n+("00000"+Math.abs(t)).slice(n?-6:-4)+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"."+(e>99?e:"0"+a(e))+"Z"}:o},function(t,e,n){var r=Date.prototype,i=r.toString,o=r.getTime;new Date(NaN)+""!="Invalid Date"&&n(24)(r,"toString",function(){var t=o.call(this);return t==t?i.call(this):"Invalid Date"})},function(t,e,n){var r=n(7)("toPrimitive"),i=Date.prototype;r in i||n(23)(i,r,n(791))},function(t,e,n){"use strict";var r=n(3),i=n(39);t.exports=function(t){if("string"!==t&&"number"!==t&&"default"!==t)throw TypeError("Incorrect hint");return i(r(this),"number"!=t)}},function(t,e,n){var r=n(0);r(r.S,"Array",{isArray:n(125)})},function(t,e,n){"use strict";var r=n(31),i=n(0),o=n(14),a=n(318),s=n(203),u=n(13),l=n(204),c=n(205);i(i.S+i.F*!n(127)(function(t){Array.from(t)}),"Array",{from:function(t){var e,n,i,h,p=o(t),f="function"==typeof this?this:Array,d=arguments.length,m=d>1?arguments[1]:void 0,g=void 0!==m,v=0,y=c(p);if(g&&(m=r(m,d>2?arguments[2]:void 0,2)),void 0==y||f==Array&&s(y))for(n=new f(e=u(p.length));e>v;v++)l(n,v,g?m(p[v],v):p[v]);else for(h=y.call(p),n=new f;!(i=h.next()).done;v++)l(n,v,g?a(h,m,[i.value,v],!0):i.value);return n.length=v,n}})},function(t,e,n){"use strict";var r=n(0),i=n(204);r(r.S+r.F*n(5)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,e=arguments.length,n=new("function"==typeof this?this:Array)(e);e>t;)i(n,t,arguments[t++]);return n.length=e,n}})},function(t,e,n){"use strict";var r=n(0),i=n(27),o=[].join;r(r.P+r.F*(n(96)!=Object||!n(33)(o)),"Array",{join:function(t){return o.call(i(this),void 0===t?",":t)}})},function(t,e,n){"use strict";var r=n(0),i=n(191),o=n(32),a=n(66),s=n(13),u=[].slice;r(r.P+r.F*n(5)(function(){i&&u.call(i)}),"Array",{slice:function(t,e){var n=s(this.length),r=o(this);if(e=void 0===e?n:e,"Array"==r)return u.call(this,t,e);for(var i=a(t,n),l=a(e,n),c=s(l-i),h=Array(c),p=0;p<c;p++)h[p]="String"==r?this.charAt(i+p):this[i+p];return h}})},function(t,e,n){"use strict";var r=n(0),i=n(17),o=n(14),a=n(5),s=[].sort,u=[1,2,3];r(r.P+r.F*(a(function(){u.sort(void 0)})||!a(function(){u.sort(null)})||!n(33)(s)),"Array",{sort:function(t){return void 0===t?s.call(o(this)):s.call(o(this),i(t))}})},function(t,e,n){"use strict";var r=n(0),i=n(43)(0),o=n(33)([].forEach,!0);r(r.P+r.F*!o,"Array",{forEach:function(t){return i(this,t,arguments[1])}})},function(t,e,n){var r=n(6),i=n(125),o=n(7)("species");t.exports=function(t){var e;return i(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!i(e.prototype)||(e=void 0),r(e)&&null===(e=e[o])&&(e=void 0)),void 0===e?Array:e}},function(t,e,n){"use strict";var r=n(0),i=n(43)(1);r(r.P+r.F*!n(33)([].map,!0),"Array",{map:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(0),i=n(43)(2);r(r.P+r.F*!n(33)([].filter,!0),"Array",{filter:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(0),i=n(43)(3);r(r.P+r.F*!n(33)([].some,!0),"Array",{some:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(0),i=n(43)(4);r(r.P+r.F*!n(33)([].every,!0),"Array",{every:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(0),i=n(319);r(r.P+r.F*!n(33)([].reduce,!0),"Array",{reduce:function(t){return i(this,t,arguments.length,arguments[1],!1)}})},function(t,e,n){"use strict";var r=n(0),i=n(319);r(r.P+r.F*!n(33)([].reduceRight,!0),"Array",{reduceRight:function(t){return i(this,t,arguments.length,arguments[1],!0)}})},function(t,e,n){"use strict";var r=n(0),i=n(123)(!1),o=[].indexOf,a=!!o&&1/[1].indexOf(1,-0)<0;r(r.P+r.F*(a||!n(33)(o)),"Array",{indexOf:function(t){return a?o.apply(this,arguments)||0:i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(0),i=n(27),o=n(41),a=n(13),s=[].lastIndexOf,u=!!s&&1/[1].lastIndexOf(1,-0)<0;r(r.P+r.F*(u||!n(33)(s)),"Array",{lastIndexOf:function(t){if(u)return s.apply(this,arguments)||0;var e=i(this),n=a(e.length),r=n-1;for(arguments.length>1&&(r=Math.min(r,o(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in e&&e[r]===t)return r||0;return-1}})},function(t,e,n){var r=n(0);r(r.P,"Array",{copyWithin:n(320)}),n(52)("copyWithin")},function(t,e,n){var r=n(0);r(r.P,"Array",{fill:n(207)}),n(52)("fill")},function(t,e,n){"use strict";var r=n(0),i=n(43)(5),o=!0;"find"in[]&&Array(1).find(function(){o=!1}),r(r.P+r.F*o,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(52)("find")},function(t,e,n){"use strict";var r=n(0),i=n(43)(6),o=!0;"findIndex"in[]&&Array(1).findIndex(function(){o=!1}),r(r.P+r.F*o,"Array",{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(52)("findIndex")},function(t,e,n){n(69)("Array")},function(t,e,n){var r=n(4),i=n(194),o=n(12).f,a=n(68).f,s=n(126),u=n(128),l=r.RegExp,c=l,h=l.prototype,p=/a/g,f=/a/g,d=new l(p)!==p;if(n(11)&&(!d||n(5)(function(){return f[n(7)("match")]=!1,l(p)!=p||l(f)==f||"/a/i"!=l(p,"i")}))){l=function(t,e){var n=this instanceof l,r=s(t),o=void 0===e;return!n&&r&&t.constructor===l&&o?t:i(d?new c(r&&!o?t.source:t,e):c((r=t instanceof l)?t.source:t,r&&o?u.call(t):e),n?this:h,l)};for(var m=function(t){t in l||o(l,t,{configurable:!0,get:function(){return c[t]},set:function(e){c[t]=e}})},g=a(c),v=0;g.length>v;)m(g[v++]);h.constructor=l,l.prototype=h,n(24)(r,"RegExp",l)}n(69)("RegExp")},function(t,e,n){"use strict";n(322);var r=n(3),i=n(128),o=n(11),a=/./.toString,s=function(t){n(24)(RegExp.prototype,"toString",t,!0)};n(5)(function(){return"/a/b"!=a.call({source:"a",flags:"b"})})?s(function(){var t=r(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?i.call(t):void 0)}):"toString"!=a.name&&s(function(){return a.call(this)})},function(t,e,n){n(129)("match",1,function(t,e,n){return[function(n){"use strict";var r=t(this),i=void 0==n?void 0:n[e];return void 0!==i?i.call(n,r):new RegExp(n)[e](String(r))},n]})},function(t,e,n){n(129)("replace",2,function(t,e,n){return[function(r,i){"use strict";var o=t(this),a=void 0==r?void 0:r[e];return void 0!==a?a.call(r,o,i):n.call(String(o),r,i)},n]})},function(t,e,n){n(129)("search",1,function(t,e,n){return[function(n){"use strict";var r=t(this),i=void 0==n?void 0:n[e];return void 0!==i?i.call(n,r):new RegExp(n)[e](String(r))},n]})},function(t,e,n){n(129)("split",2,function(t,e,r){"use strict";var i=n(126),o=r,a=[].push;if("c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length){var s=void 0===/()??/.exec("")[1];r=function(t,e){var n=String(this);if(void 0===t&&0===e)return[];if(!i(t))return o.call(n,t,e);var r,u,l,c,h,p=[],f=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),d=0,m=void 0===e?4294967295:e>>>0,g=new RegExp(t.source,f+"g");for(s||(r=new RegExp("^"+g.source+"$(?!\\s)",f));(u=g.exec(n))&&!((l=u.index+u[0].length)>d&&(p.push(n.slice(d,u.index)),!s&&u.length>1&&u[0].replace(r,function(){for(h=1;h<arguments.length-2;h++)void 0===arguments[h]&&(u[h]=void 0)}),u.length>1&&u.index<n.length&&a.apply(p,u.slice(1)),c=u[0].length,d=l,p.length>=m));)g.lastIndex===u.index&&g.lastIndex++;return d===n.length?!c&&g.test("")||p.push(""):p.push(n.slice(d)),p.length>m?p.slice(0,m):p}}else"0".split(void 0,0).length&&(r=function(t,e){return void 0===t&&0===e?[]:o.call(this,t,e)});return[function(n,i){var o=t(this),a=void 0==n?void 0:n[e];return void 0!==a?a.call(n,o,i):r.call(String(o),n,i)},r]})},function(t,e,n){"use strict";var r,i,o,a,s=n(64),u=n(4),l=n(31),c=n(98),h=n(0),p=n(6),f=n(17),d=n(70),m=n(71),g=n(130),v=n(209).set,y=n(210)(),b=n(211),_=n(323),x=n(324),w="Promise",E=u.TypeError,S=u.process,T=u.Promise,O="process"==c(S),A=function(){},M=i=b.f,C=!!function(){try{var t=T.resolve(1),e=(t.constructor={})[n(7)("species")]=function(t){t(A,A)};return(O||"function"==typeof PromiseRejectionEvent)&&t.then(A)instanceof e}catch(t){}}(),k=function(t){var e;return!(!p(t)||"function"!=typeof(e=t.then))&&e},P=function(t,e){if(!t._n){t._n=!0;var n=t._c;y(function(){for(var r=t._v,i=1==t._s,o=0,a=function(e){var n,o,a=i?e.ok:e.fail,s=e.resolve,u=e.reject,l=e.domain;try{a?(i||(2==t._h&&I(t),t._h=1),!0===a?n=r:(l&&l.enter(),n=a(r),l&&l.exit()),n===e.promise?u(E("Promise-chain cycle")):(o=k(n))?o.call(n,s,u):s(n)):u(r)}catch(t){u(t)}};n.length>o;)a(n[o++]);t._c=[],t._n=!1,e&&!t._h&&R(t)})}},R=function(t){v.call(u,function(){var e,n,r,i=t._v,o=L(t);if(o&&(e=_(function(){O?S.emit("unhandledRejection",i,t):(n=u.onunhandledrejection)?n({promise:t,reason:i}):(r=u.console)&&r.error&&r.error("Unhandled promise rejection",i)}),t._h=O||L(t)?2:1),t._a=void 0,o&&e.e)throw e.v})},L=function(t){if(1==t._h)return!1;for(var e,n=t._a||t._c,r=0;n.length>r;)if((e=n[r++]).fail||!L(e.promise))return!1;return!0},I=function(t){v.call(u,function(){var e;O?S.emit("rejectionHandled",t):(e=u.onrejectionhandled)&&e({promise:t,reason:t._v})})},D=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),P(e,!0))},N=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw E("Promise can't be resolved itself");(e=k(t))?y(function(){var r={_w:n,_d:!1};try{e.call(t,l(N,r,1),l(D,r,1))}catch(t){D.call(r,t)}}):(n._v=t,n._s=1,P(n,!1))}catch(t){D.call({_w:n,_d:!1},t)}}};C||(T=function(t){d(this,T,w,"_h"),f(t),r.call(this);try{t(l(N,this,1),l(D,this,1))}catch(t){D.call(this,t)}},(r=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(72)(T.prototype,{then:function(t,e){var n=M(g(this,T));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=O?S.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&P(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),o=function(){var t=new r;this.promise=t,this.resolve=l(N,t,1),this.reject=l(D,t,1)},b.f=M=function(t){return t===T||t===a?new o(t):i(t)}),h(h.G+h.W+h.F*!C,{Promise:T}),n(82)(T,w),n(69)(w),a=n(38).Promise,h(h.S+h.F*!C,w,{reject:function(t){var e=M(this);return(0,e.reject)(t),e.promise}}),h(h.S+h.F*(s||!C),w,{resolve:function(t){return x(s&&this===a?T:this,t)}}),h(h.S+h.F*!(C&&n(127)(function(t){T.all(t).catch(A)})),w,{all:function(t){var e=this,n=M(e),r=n.resolve,i=n.reject,o=_(function(){var n=[],o=0,a=1;m(t,!1,function(t){var s=o++,u=!1;n.push(void 0),a++,e.resolve(t).then(function(t){u||(u=!0,n[s]=t,--a||r(n))},i)}),--a||r(n)});return o.e&&i(o.v),n.promise},race:function(t){var e=this,n=M(e),r=n.reject,i=_(function(){m(t,!1,function(t){e.resolve(t).then(n.resolve,r)})});return i.e&&r(i.v),n.promise}})},function(t,e,n){"use strict";var r=n(329),i=n(85);n(131)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return r.def(i(this,"WeakSet"),t,!0)}},r,!1,!0)},function(t,e,n){"use strict";var r=n(0),i=n(132),o=n(212),a=n(3),s=n(66),u=n(13),l=n(6),c=n(4).ArrayBuffer,h=n(130),p=o.ArrayBuffer,f=o.DataView,d=i.ABV&&c.isView,m=p.prototype.slice,g=i.VIEW;r(r.G+r.W+r.F*(c!==p),{ArrayBuffer:p}),r(r.S+r.F*!i.CONSTR,"ArrayBuffer",{isView:function(t){return d&&d(t)||l(t)&&g in t}}),r(r.P+r.U+r.F*n(5)(function(){return!new p(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(t,e){if(void 0!==m&&void 0===e)return m.call(a(this),t);for(var n=a(this).byteLength,r=s(t,n),i=s(void 0===e?n:e,n),o=new(h(this,p))(u(i-r)),l=new f(this),c=new f(o),d=0;r<i;)c.setUint8(d++,l.getUint8(r++));return o}}),n(69)("ArrayBuffer")},function(t,e,n){var r=n(0);r(r.G+r.W+r.F*!n(132).ABV,{DataView:n(212).DataView})},function(t,e,n){n(46)("Int8",1,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(46)("Uint8",1,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(46)("Uint8",1,function(t){return function(e,n,r){return t(this,e,n,r)}},!0)},function(t,e,n){n(46)("Int16",2,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(46)("Uint16",2,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(46)("Int32",4,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(46)("Uint32",4,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(46)("Float32",4,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(46)("Float64",8,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){var r=n(0),i=n(17),o=n(3),a=(n(4).Reflect||{}).apply,s=Function.apply;r(r.S+r.F*!n(5)(function(){a(function(){})}),"Reflect",{apply:function(t,e,n){var r=i(t),u=o(n);return a?a(r,e,u):s.call(r,e,u)}})},function(t,e,n){var r=n(0),i=n(67),o=n(17),a=n(3),s=n(6),u=n(5),l=n(310),c=(n(4).Reflect||{}).construct,h=u(function(){function t(){}return!(c(function(){},[],t)instanceof t)}),p=!u(function(){c(function(){})});r(r.S+r.F*(h||p),"Reflect",{construct:function(t,e){o(t),a(e);var n=arguments.length<3?t:o(arguments[2]);if(p&&!h)return c(t,e,n);if(t==n){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var r=[null];return r.push.apply(r,e),new(l.apply(t,r))}var u=n.prototype,f=i(s(u)?u:Object.prototype),d=Function.apply.call(t,f,e);return s(d)?d:f}})},function(t,e,n){var r=n(12),i=n(0),o=n(3),a=n(39);i(i.S+i.F*n(5)(function(){Reflect.defineProperty(r.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,e,n){o(t),e=a(e,!0),o(n);try{return r.f(t,e,n),!0}catch(t){return!1}}})},function(t,e,n){var r=n(0),i=n(28).f,o=n(3);r(r.S,"Reflect",{deleteProperty:function(t,e){var n=i(o(t),e);return!(n&&!n.configurable)&&delete t[e]}})},function(t,e,n){"use strict";var r=n(0),i=n(3),o=function(t){this._t=i(t),this._i=0;var e,n=this._k=[];for(e in t)n.push(e)};n(200)(o,"Object",function(){var t,e=this._k;do{if(this._i>=e.length)return{value:void 0,done:!0}}while(!((t=e[this._i++])in this._t));return{value:t,done:!1}}),r(r.S,"Reflect",{enumerate:function(t){return new o(t)}})},function(t,e,n){var r=n(28),i=n(29),o=n(22),a=n(0),s=n(6),u=n(3);a(a.S,"Reflect",{get:function t(e,n){var a,l,c=arguments.length<3?e:arguments[2];return u(e)===c?e[n]:(a=r.f(e,n))?o(a,"value")?a.value:void 0!==a.get?a.get.call(c):void 0:s(l=i(e))?t(l,n,c):void 0}})},function(t,e,n){var r=n(28),i=n(0),o=n(3);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(t,e){return r.f(o(t),e)}})},function(t,e,n){var r=n(0),i=n(29),o=n(3);r(r.S,"Reflect",{getPrototypeOf:function(t){return i(o(t))}})},function(t,e,n){var r=n(0);r(r.S,"Reflect",{has:function(t,e){return e in t}})},function(t,e,n){var r=n(0),i=n(3),o=Object.isExtensible;r(r.S,"Reflect",{isExtensible:function(t){return i(t),!o||o(t)}})},function(t,e,n){var r=n(0);r(r.S,"Reflect",{ownKeys:n(331)})},function(t,e,n){var r=n(0),i=n(3),o=Object.preventExtensions;r(r.S,"Reflect",{preventExtensions:function(t){i(t);try{return o&&o(t),!0}catch(t){return!1}}})},function(t,e,n){var r=n(12),i=n(28),o=n(29),a=n(22),s=n(0),u=n(62),l=n(3),c=n(6);s(s.S,"Reflect",{set:function t(e,n,s){var h,p,f=arguments.length<4?e:arguments[3],d=i.f(l(e),n);if(!d){if(c(p=o(e)))return t(p,n,s,f);d=u(0)}return a(d,"value")?!(!1===d.writable||!c(f)||((h=i.f(f,n)||u(0)).value=s,r.f(f,n,h),0)):void 0!==d.set&&(d.set.call(f,s),!0)}})},function(t,e,n){var r=n(0),i=n(192);i&&r(r.S,"Reflect",{setPrototypeOf:function(t,e){i.check(t,e);try{return i.set(t,e),!0}catch(t){return!1}}})},function(t,e,n){"use strict";var r=n(0),i=n(123)(!0);r(r.P,"Array",{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(52)("includes")},function(t,e,n){"use strict";var r=n(0),i=n(332),o=n(14),a=n(13),s=n(17),u=n(206);r(r.P,"Array",{flatMap:function(t){var e,n,r=o(this);return s(t),e=a(r.length),n=u(r,0),i(n,r,r,e,0,1,t,arguments[1]),n}}),n(52)("flatMap")},function(t,e,n){"use strict";var r=n(0),i=n(332),o=n(14),a=n(13),s=n(41),u=n(206);r(r.P,"Array",{flatten:function(){var t=arguments[0],e=o(this),n=a(e.length),r=u(e,0);return i(r,e,e,n,0,void 0===t?1:s(t)),r}}),n(52)("flatten")},function(t,e,n){"use strict";var r=n(0),i=n(198)(!0);r(r.P,"String",{at:function(t){return i(this,t)}})},function(t,e,n){"use strict";var r=n(0),i=n(333);r(r.P,"String",{padStart:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,e,n){"use strict";var r=n(0),i=n(333);r(r.P,"String",{padEnd:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,e,n){"use strict";n(83)("trimLeft",function(t){return function(){return t(this,1)}},"trimStart")},function(t,e,n){"use strict";n(83)("trimRight",function(t){return function(){return t(this,2)}},"trimEnd")},function(t,e,n){"use strict";var r=n(0),i=n(40),o=n(13),a=n(126),s=n(128),u=RegExp.prototype,l=function(t,e){this._r=t,this._s=e};n(200)(l,"RegExp String",function(){var t=this._r.exec(this._s);return{value:t,done:null===t}}),r(r.P,"String",{matchAll:function(t){if(i(this),!a(t))throw TypeError(t+" is not a regexp!");var e=String(this),n="flags"in u?String(t.flags):s.call(t),r=new RegExp(t.source,~n.indexOf("g")?n:"g"+n);return r.lastIndex=o(t.lastIndex),new l(r,e)}})},function(t,e,n){n(188)("asyncIterator")},function(t,e,n){n(188)("observable")},function(t,e,n){var r=n(0),i=n(331),o=n(27),a=n(28),s=n(204);r(r.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,n,r=o(t),u=a.f,l=i(r),c={},h=0;l.length>h;)void 0!==(n=u(r,e=l[h++]))&&s(c,e,n);return c}})},function(t,e,n){var r=n(0),i=n(334)(!1);r(r.S,"Object",{values:function(t){return i(t)}})},function(t,e,n){var r=n(0),i=n(334)(!0);r(r.S,"Object",{entries:function(t){return i(t)}})},function(t,e,n){"use strict";var r=n(0),i=n(14),o=n(17),a=n(12);n(11)&&r(r.P+n(133),"Object",{__defineGetter__:function(t,e){a.f(i(this),t,{get:o(e),enumerable:!0,configurable:!0})}})},function(t,e,n){"use strict";var r=n(0),i=n(14),o=n(17),a=n(12);n(11)&&r(r.P+n(133),"Object",{__defineSetter__:function(t,e){a.f(i(this),t,{set:o(e),enumerable:!0,configurable:!0})}})},function(t,e,n){"use strict";var r=n(0),i=n(14),o=n(39),a=n(29),s=n(28).f;n(11)&&r(r.P+n(133),"Object",{__lookupGetter__:function(t){var e,n=i(this),r=o(t,!0);do{if(e=s(n,r))return e.get}while(n=a(n))}})},function(t,e,n){"use strict";var r=n(0),i=n(14),o=n(39),a=n(29),s=n(28).f;n(11)&&r(r.P+n(133),"Object",{__lookupSetter__:function(t){var e,n=i(this),r=o(t,!0);do{if(e=s(n,r))return e.set}while(n=a(n))}})},function(t,e,n){var r=n(0);r(r.P+r.R,"Map",{toJSON:n(335)("Map")})},function(t,e,n){var r=n(0);r(r.P+r.R,"Set",{toJSON:n(335)("Set")})},function(t,e,n){n(134)("Map")},function(t,e,n){n(134)("Set")},function(t,e,n){n(134)("WeakMap")},function(t,e,n){n(134)("WeakSet")},function(t,e,n){n(135)("Map")},function(t,e,n){n(135)("Set")},function(t,e,n){n(135)("WeakMap")},function(t,e,n){n(135)("WeakSet")},function(t,e,n){var r=n(0);r(r.G,{global:n(4)})},function(t,e,n){var r=n(0);r(r.S,"System",{global:n(4)})},function(t,e,n){var r=n(0),i=n(32);r(r.S,"Error",{isError:function(t){return"Error"===i(t)}})},function(t,e,n){var r=n(0);r(r.S,"Math",{clamp:function(t,e,n){return Math.min(n,Math.max(e,t))}})},function(t,e,n){var r=n(0);r(r.S,"Math",{DEG_PER_RAD:Math.PI/180})},function(t,e,n){var r=n(0),i=180/Math.PI;r(r.S,"Math",{degrees:function(t){return t*i}})},function(t,e,n){var r=n(0),i=n(337),o=n(317);r(r.S,"Math",{fscale:function(t,e,n,r,a){return o(i(t,e,n,r,a))}})},function(t,e,n){var r=n(0);r(r.S,"Math",{iaddh:function(t,e,n,r){var i=t>>>0,o=n>>>0;return(e>>>0)+(r>>>0)+((i&o|(i|o)&~(i+o>>>0))>>>31)|0}})},function(t,e,n){var r=n(0);r(r.S,"Math",{isubh:function(t,e,n,r){var i=t>>>0,o=n>>>0;return(e>>>0)-(r>>>0)-((~i&o|~(i^o)&i-o>>>0)>>>31)|0}})},function(t,e,n){var r=n(0);r(r.S,"Math",{imulh:function(t,e){var n=+t,r=+e,i=65535&n,o=65535&r,a=n>>16,s=r>>16,u=(a*o>>>0)+(i*o>>>16);return a*s+(u>>16)+((i*s>>>0)+(65535&u)>>16)}})},function(t,e,n){var r=n(0);r(r.S,"Math",{RAD_PER_DEG:180/Math.PI})},function(t,e,n){var r=n(0),i=Math.PI/180;r(r.S,"Math",{radians:function(t){return t*i}})},function(t,e,n){var r=n(0);r(r.S,"Math",{scale:n(337)})},function(t,e,n){var r=n(0);r(r.S,"Math",{umulh:function(t,e){var n=+t,r=+e,i=65535&n,o=65535&r,a=n>>>16,s=r>>>16,u=(a*o>>>0)+(i*o>>>16);return a*s+(u>>>16)+((i*s>>>0)+(65535&u)>>>16)}})},function(t,e,n){var r=n(0);r(r.S,"Math",{signbit:function(t){return(t=+t)!=t?t:0==t?1/t==1/0:t>0}})},function(t,e,n){"use strict";var r=n(0),i=n(38),o=n(4),a=n(130),s=n(324);r(r.P+r.R,"Promise",{finally:function(t){var e=a(this,i.Promise||o.Promise),n="function"==typeof t;return this.then(n?function(n){return s(e,t()).then(function(){return n})}:t,n?function(n){return s(e,t()).then(function(){throw n})}:t)}})},function(t,e,n){"use strict";var r=n(0),i=n(211),o=n(323);r(r.S,"Promise",{try:function(t){var e=i.f(this),n=o(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}})},function(t,e,n){var r=n(47),i=n(3),o=r.key,a=r.set;r.exp({defineMetadata:function(t,e,n,r){a(t,e,i(n),o(r))}})},function(t,e,n){var r=n(47),i=n(3),o=r.key,a=r.map,s=r.store;r.exp({deleteMetadata:function(t,e){var n=arguments.length<3?void 0:o(arguments[2]),r=a(i(e),n,!1);if(void 0===r||!r.delete(t))return!1;if(r.size)return!0;var u=s.get(e);return u.delete(n),!!u.size||s.delete(e)}})},function(t,e,n){var r=n(47),i=n(3),o=n(29),a=r.has,s=r.get,u=r.key,l=function(t,e,n){if(a(t,e,n))return s(t,e,n);var r=o(e);return null!==r?l(t,r,n):void 0};r.exp({getMetadata:function(t,e){return l(t,i(e),arguments.length<3?void 0:u(arguments[2]))}})},function(t,e,n){var r=n(327),i=n(336),o=n(47),a=n(3),s=n(29),u=o.keys,l=o.key,c=function(t,e){var n=u(t,e),o=s(t);if(null===o)return n;var a=c(o,e);return a.length?n.length?i(new r(n.concat(a))):a:n};o.exp({getMetadataKeys:function(t){return c(a(t),arguments.length<2?void 0:l(arguments[1]))}})},function(t,e,n){var r=n(47),i=n(3),o=r.get,a=r.key;r.exp({getOwnMetadata:function(t,e){return o(t,i(e),arguments.length<3?void 0:a(arguments[2]))}})},function(t,e,n){var r=n(47),i=n(3),o=r.keys,a=r.key;r.exp({getOwnMetadataKeys:function(t){return o(i(t),arguments.length<2?void 0:a(arguments[1]))}})},function(t,e,n){var r=n(47),i=n(3),o=n(29),a=r.has,s=r.key,u=function(t,e,n){if(a(t,e,n))return!0;var r=o(e);return null!==r&&u(t,r,n)};r.exp({hasMetadata:function(t,e){return u(t,i(e),arguments.length<3?void 0:s(arguments[2]))}})},function(t,e,n){var r=n(47),i=n(3),o=r.has,a=r.key;r.exp({hasOwnMetadata:function(t,e){return o(t,i(e),arguments.length<3?void 0:a(arguments[2]))}})},function(t,e,n){var r=n(47),i=n(3),o=n(17),a=r.key,s=r.set;r.exp({metadata:function(t,e){return function(n,r){s(t,e,(void 0!==r?i:o)(n),a(r))}}})},function(t,e,n){var r=n(0),i=n(210)(),o=n(4).process,a="process"==n(32)(o);r(r.G,{asap:function(t){var e=a&&o.domain;i(e?e.bind(t):t)}})},function(t,e,n){"use strict";var r=n(0),i=n(4),o=n(38),a=n(210)(),s=n(7)("observable"),u=n(17),l=n(3),c=n(70),h=n(72),p=n(23),f=n(71),d=f.RETURN,m=function(t){return null==t?void 0:u(t)},g=function(t){var e=t._c;e&&(t._c=void 0,e())},v=function(t){return void 0===t._o},y=function(t){v(t)||(t._o=void 0,g(t))},b=function(t,e){l(t),this._c=void 0,this._o=t,t=new _(this);try{var n=e(t),r=n;null!=n&&("function"==typeof n.unsubscribe?n=function(){r.unsubscribe()}:u(n),this._c=n)}catch(e){return void t.error(e)}v(this)&&g(this)};b.prototype=h({},{unsubscribe:function(){y(this)}});var _=function(t){this._s=t};_.prototype=h({},{next:function(t){var e=this._s;if(!v(e)){var n=e._o;try{var r=m(n.next);if(r)return r.call(n,t)}catch(t){try{y(e)}finally{throw t}}}},error:function(t){var e=this._s;if(v(e))throw t;var n=e._o;e._o=void 0;try{var r=m(n.error);if(!r)throw t;t=r.call(n,t)}catch(t){try{g(e)}finally{throw t}}return g(e),t},complete:function(t){var e=this._s;if(!v(e)){var n=e._o;e._o=void 0;try{var r=m(n.complete);t=r?r.call(n,t):void 0}catch(t){try{g(e)}finally{throw t}}return g(e),t}}});var x=function(t){c(this,x,"Observable","_f")._f=u(t)};h(x.prototype,{subscribe:function(t){return new b(t,this._f)},forEach:function(t){var e=this;return new(o.Promise||i.Promise)(function(n,r){u(t);var i=e.subscribe({next:function(e){try{return t(e)}catch(t){r(t),i.unsubscribe()}},error:r,complete:n})})}}),h(x,{from:function(t){var e="function"==typeof this?this:x,n=m(l(t)[s]);if(n){var r=l(n.call(t));return r.constructor===e?r:new e(function(t){return r.subscribe(t)})}return new e(function(e){var n=!1;return a(function(){if(!n){try{if(f(t,!1,function(t){if(e.next(t),n)return d})===d)return}catch(t){if(n)throw t;return void e.error(t)}e.complete()}}),function(){n=!0}})},of:function(){for(var t=0,e=arguments.length,n=Array(e);t<e;)n[t]=arguments[t++];return new("function"==typeof this?this:x)(function(t){var e=!1;return a(function(){if(!e){for(var r=0;r<n.length;++r)if(t.next(n[r]),e)return;t.complete()}}),function(){e=!0}})}}),p(x.prototype,s,function(){return this}),r(r.G,{Observable:x}),n(69)("Observable")},function(t,e,n){var r=n(4),i=n(0),o=r.navigator,a=[].slice,s=!!o&&/MSIE .\./.test(o.userAgent),u=function(t){return function(e,n){var r=arguments.length>2,i=!!r&&a.call(arguments,2);return t(r?function(){("function"==typeof e?e:Function(e)).apply(this,i)}:e,n)}};i(i.G+i.B+i.F*s,{setTimeout:u(r.setTimeout),setInterval:u(r.setInterval)})},function(t,e,n){var r=n(0),i=n(209);r(r.G+r.B,{setImmediate:i.set,clearImmediate:i.clear})},function(t,e,n){for(var r=n(208),i=n(65),o=n(24),a=n(4),s=n(23),u=n(84),l=n(7),c=l("iterator"),h=l("toStringTag"),p=u.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},d=i(f),m=0;m<d.length;m++){var g,v=d[m],y=f[v],b=a[v],_=b&&b.prototype;if(_&&(_[c]||s(_,c,p),_[h]||s(_,h,v),u[v]=p,y))for(g in r)_[g]||o(_,g,r[g],!0)}},function(t,e,n){(function(e){!function(e){"use strict";var n,r=Object.prototype,i=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag",l="object"==typeof t,c=e.regeneratorRuntime;if(c)l&&(t.exports=c);else{(c=e.regeneratorRuntime=l?t.exports:{}).wrap=_;var h="suspendedStart",p="suspendedYield",f="executing",d="completed",m={},g={};g[a]=function(){return this};var v=Object.getPrototypeOf,y=v&&v(v(P([])));y&&y!==r&&i.call(y,a)&&(g=y);var b=S.prototype=w.prototype=Object.create(g);E.prototype=b.constructor=S,S.constructor=E,S[u]=E.displayName="GeneratorFunction",c.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===E||"GeneratorFunction"===(e.displayName||e.name))},c.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,S):(t.__proto__=S,u in t||(t[u]="GeneratorFunction")),t.prototype=Object.create(b),t},c.awrap=function(t){return{__await:t}},T(O.prototype),O.prototype[s]=function(){return this},c.AsyncIterator=O,c.async=function(t,e,n,r){var i=new O(_(t,e,n,r));return c.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},T(b),b[u]="Generator",b[a]=function(){return this},b.toString=function(){return"[object Generator]"},c.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},c.values=P,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(C),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,i){return s.type="throw",s.arg=t,e.next=r,i&&(e.method="next",e.arg=n),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var u=i.call(a,"catchLoc"),l=i.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),C(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;C(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:P(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=n),m}}}function _(t,e,n,r){var i,o,a,s,u=e&&e.prototype instanceof w?e:w,l=Object.create(u.prototype),c=new k(r||[]);return l._invoke=(i=t,o=n,a=c,s=h,function(t,e){if(s===f)throw new Error("Generator is already running");if(s===d){if("throw"===t)throw e;return R()}for(a.method=t,a.arg=e;;){var n=a.delegate;if(n){var r=A(n,a);if(r){if(r===m)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(s===h)throw s=d,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s=f;var u=x(i,o,a);if("normal"===u.type){if(s=a.done?d:p,u.arg===m)continue;return{value:u.arg,done:a.done}}"throw"===u.type&&(s=d,a.method="throw",a.arg=u.arg)}}),l}function x(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function w(){}function E(){}function S(){}function T(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function O(t){function n(e,r,o,a){var s=x(t[e],t,r);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==typeof l&&i.call(l,"__await")?Promise.resolve(l.__await).then(function(t){n("next",t,o,a)},function(t){n("throw",t,o,a)}):Promise.resolve(l).then(function(t){u.value=t,o(u)},a)}a(s.arg)}var r;"object"==typeof e.process&&e.process.domain&&(n=e.process.domain.bind(n)),this._invoke=function(t,e){function i(){return new Promise(function(r,i){n(t,e,r,i)})}return r=r?r.then(i,i):i()}}function A(t,e){var r=t.iterator[e.method];if(r===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=n,A(t,e),"throw"===e.method))return m;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var i=x(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,m;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,m):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,m)}function M(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(M,this),this.reset(!0)}function P(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(i.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=n,e.done=!0,e};return o.next=o}}return{next:R}}function R(){return{value:n,done:!0}}}("object"==typeof e?e:"object"==typeof window?window:"object"==typeof self?self:this)}).call(e,n(78))},function(t,e,n){n(907),t.exports=n(38).RegExp.escape},function(t,e,n){var r=n(0),i=n(908)(/[\\^$*+?.()|[\]{}]/g,"\\$&");r(r.S,"RegExp",{escape:function(t){return i(t)}})},function(t,e){t.exports=function(t,e){var n=e===Object(e)?function(t){return e[t]}:e;return function(e){return String(e).replace(t,n)}}},function(t,e){t.exports=function t(e){return Object.freeze(e),Object.getOwnPropertyNames(e).forEach(function(n){!e.hasOwnProperty(n)||null===e[n]||"object"!=typeof e[n]&&"function"!=typeof e[n]||Object.isFrozen(e[n])||t(e[n])}),e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.label=e.name=e.date=e.json=e.dict=e.bibtxt=e.bibtex=void 0;var r=h(n(911)),i=c(n(341)),o=h(n(137)),a=c(n(342)),s=c(n(339)),u=c(n(214)),l=c(n(343));function c(t){return t&&t.__esModule?t:{default:t}}function h(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}e.bibtex=r,e.bibtxt=i.default,e.dict=o,e.json=a.default,e.date=s.default,e.name=u.default,e.label=l.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.type=e.label=e.text=e.json=void 0;var r=s(n(136)),i=s(n(340)),o=s(n(213)),a=s(n(338));function s(t){return t&&t.__esModule?t:{default:t}}e.json=r.default,e.text=i.default,e.label=o.default,e.type=a.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.register=e.item=e.engine=e.locale=e.style=void 0;var r=u(n(344)),i=u(n(345)),o=u(n(346)),a=u(n(347)),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(215));function u(t){return t&&t.__esModule?t:{default:t}}e.style=r.default,e.locale=i.default,e.engine=o.default,e.item=a.default,e.register=s},function(t,e){t.exports={apa:'<?xml version="1.0" encoding="utf-8"?><style xmlns="http://purl.org/net/xbiblio/csl" class="in-text" version="1.0" demote-non-dropping-particle="never"><info><title>American Psychological Association 6th edition</title><title-short>APA</title-short><id>http://www.zotero.org/styles/apa</id><link href="http://www.zotero.org/styles/apa" rel="self"/><link href="http://owl.english.purdue.edu/owl/resource/560/01/" rel="documentation"/><author><name>Simon Kornblith</name><email>simon@simonster.com</email></author><contributor><name>Bruce D\'Arcus</name></contributor><contributor><name>Curtis M. Humphrey</name></contributor><contributor><name>Richard Karnesky</name><email>karnesky+zotero@gmail.com</email><uri>http://arc.nucapt.northwestern.edu/Richard_Karnesky</uri></contributor><contributor><name>Sebastian Karcher</name></contributor><contributor><name> Brenton M. Wiernik</name><email>zotero@wiernik.org</email></contributor><category citation-format="author-date"/><category field="psychology"/><category field="generic-base"/><updated>2016-05-25T09:01:49+00:00</updated><rights license="http://creativecommons.org/licenses/by-sa/3.0/">This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 License</rights></info><locale xml:lang="en"><terms><term name="editortranslator" form="short"><single>ed. &amp; trans.</single><multiple>eds. &amp; trans.</multiple></term><term name="translator" form="short"><single>trans.</single><multiple>trans.</multiple></term></terms></locale><macro name="container-contributors"><choose><if type="chapter paper-conference entry-dictionary entry-encyclopedia" match="any"><group delimiter=", "><names variable="container-author" delimiter=", "><name and="symbol" initialize-with=". " delimiter=", "/><label form="short" prefix=" (" text-case="title" suffix=")"/></names><names variable="editor translator" delimiter=", "><name and="symbol" initialize-with=". " delimiter=", "/><label form="short" prefix=" (" text-case="title" suffix=")"/></names></group></if></choose></macro><macro name="secondary-contributors"><choose><if type="article-journal chapter paper-conference entry-dictionary entry-encyclopedia" match="none"><group delimiter=", " prefix=" (" suffix=")"><names variable="container-author" delimiter=", "><name and="symbol" initialize-with=". " delimiter=", "/><label form="short" prefix=", " text-case="title"/></names><names variable="editor translator" delimiter=", "><name and="symbol" initialize-with=". " delimiter=", "/><label form="short" prefix=", " text-case="title"/></names></group></if></choose></macro><macro name="author"><names variable="author"><name name-as-sort-order="all" and="symbol" sort-separator=", " initialize-with=". " delimiter=", " delimiter-precedes-last="always"/><label form="short" prefix=" (" suffix=")" text-case="capitalize-first"/><substitute><names variable="editor"/><names variable="translator"/><choose><if type="report"><text variable="publisher"/><text macro="title"/></if><else><text macro="title"/></else></choose></substitute></names></macro><macro name="author-short"><names variable="author"><name form="short" and="symbol" delimiter=", " initialize-with=". "/><substitute><names variable="editor"/><names variable="translator"/><choose><if type="report"><text variable="publisher"/><text variable="title" form="short" font-style="italic"/></if><else-if type="legal_case"><text variable="title" font-style="italic"/></else-if><else-if type="bill book graphic legislation motion_picture song" match="any"><text variable="title" form="short" font-style="italic"/></else-if><else-if variable="reviewed-author"><choose><if variable="reviewed-title" match="none"><text variable="title" form="short" font-style="italic" prefix="Review of "/></if><else><text variable="title" form="short" quotes="true"/></else></choose></else-if><else><text variable="title" form="short" quotes="true"/></else></choose></substitute></names></macro><macro name="access"><choose><if type="thesis report" match="any"><choose><if variable="DOI" match="any">\n<text variable="DOI" prefix="https://doi.org/"/></if><else-if variable="archive" match="any"><group><text term="retrieved" text-case="capitalize-first" suffix=" "/><text term="from" suffix=" "/><text variable="archive" suffix="."/><text variable="archive_location" prefix=" (" suffix=")"/></group></else-if><else><group><text term="retrieved" text-case="capitalize-first" suffix=" "/><text term="from" suffix=" "/><text variable="URL"/></group></else></choose></if><else><choose><if variable="DOI"><text variable="DOI" prefix="https://doi.org/"/></if><else><choose><if type="webpage"><group delimiter=" "><text term="retrieved" text-case="capitalize-first" suffix=" "/><group><date variable="accessed" form="text" suffix=", "/></group><text term="from"/><text variable="URL"/></group></if><else><group><text term="retrieved" text-case="capitalize-first" suffix=" "/><text term="from" suffix=" "/><text variable="URL"/></group></else></choose></else></choose></else></choose></macro><macro name="title"><choose><if type="book graphic manuscript motion_picture report song speech thesis" match="any"><choose><if variable="version" type="book" match="all"><text variable="title"/></if><else><text variable="title" font-style="italic"/></else></choose></if><else-if variable="reviewed-author"><choose><if variable="reviewed-title"><group delimiter=" "><text variable="title"/><group delimiter=", " prefix="[" suffix="]"><text variable="reviewed-title" font-style="italic" prefix="Review of "/><names variable="reviewed-author" delimiter=", "><label form="verb-short" suffix=" "/><name and="symbol" initialize-with=". " delimiter=", "/></names></group></group></if><else><group delimiter=", " prefix="[" suffix="]"><text variable="title" font-style="italic" prefix="Review of "/><names variable="reviewed-author" delimiter=", "><label form="verb-short" suffix=" "/><name and="symbol" initialize-with=". " delimiter=", "/></names></group></else></choose></else-if><else><text variable="title"/></else></choose></macro><macro name="title-plus-extra"><text macro="title"/><choose><if type="report thesis" match="any"><group prefix=" (" suffix=")" delimiter=", "><group delimiter=" "><choose><if variable="genre" match="any"><text variable="genre"/></if><else><text variable="collection-title"/></else></choose><text variable="number" prefix="No. "/></group><group delimiter=" "><text term="version" text-case="capitalize-first"/><text variable="version"/></group><text macro="edition"/></group></if><else-if type="post-weblog webpage" match="any"><text variable="genre" prefix=" [" suffix="]"/></else-if><else-if variable="version"><group delimiter=" " prefix=" (" suffix=")"><text term="version" text-case="capitalize-first"/><text variable="version"/></group></else-if></choose><text macro="format" prefix=" [" suffix="]"/></macro><macro name="format"><choose><if match="any" variable="medium"><text variable="medium" text-case="capitalize-first"/></if><else-if type="dataset" match="any"><text value="Data set"/></else-if></choose></macro><macro name="publisher"><choose><if type="report" match="any"><group delimiter=": "><text variable="publisher-place"/><text variable="publisher"/></group></if><else-if type="thesis" match="any"><group delimiter=", "><text variable="publisher"/><text variable="publisher-place"/></group></else-if><else-if type="post-weblog webpage" match="none"><group delimiter=", "><choose><if variable="event version" type="speech motion_picture" match="none"><text variable="genre"/></if></choose><choose><if type="article-journal article-magazine" match="none"><group delimiter=": "><choose><if variable="publisher-place"><text variable="publisher-place"/></if><else><text variable="event-place"/></else></choose><text variable="publisher"/></group></if></choose></group></else-if></choose></macro><macro name="event"><choose><if variable="container-title" match="none"><choose><if variable="event"><choose><if variable="genre" match="none"><text term="presented at" text-case="capitalize-first" suffix=" "/><text variable="event"/></if><else>\n<group delimiter=" "><text variable="genre" text-case="capitalize-first"/><text term="presented at"/><text variable="event"/></group></else></choose></if><else-if type="speech"><text variable="genre" text-case="capitalize-first"/></else-if></choose></if></choose></macro><macro name="issued"><choose><if type="bill legal_case legislation" match="none"><choose><if variable="issued"><group prefix=" (" suffix=")"><date variable="issued"><date-part name="year"/></date><text variable="year-suffix"/><choose><if type="speech" match="any"><date variable="issued"><date-part prefix=", " name="month"/></date></if><else-if type="article-journal bill book chapter graphic legal_case legislation motion_picture paper-conference report song dataset" match="none"><date variable="issued"><date-part prefix=", " name="month"/><date-part prefix=" " name="day"/></date></else-if></choose></group></if><else-if variable="status"><group prefix=" (" suffix=")"><text variable="status"/><text variable="year-suffix" prefix="-"/></group></else-if><else><group prefix=" (" suffix=")"><text term="no date" form="short"/><text variable="year-suffix" prefix="-"/></group></else></choose></if></choose></macro><macro name="issued-sort"><choose><if type="article-journal bill book chapter graphic legal_case legislation motion_picture paper-conference report song dataset" match="none"><date variable="issued"><date-part name="year"/><date-part name="month"/><date-part name="day"/></date></if><else><date variable="issued"><date-part name="year"/></date></else></choose></macro><macro name="issued-year"><choose><if variable="issued"><group delimiter="/"><date variable="original-date" form="text"/><group><date variable="issued"><date-part name="year"/></date><text variable="year-suffix"/></group></group></if><else-if variable="status"><text variable="status"/><text variable="year-suffix" prefix="-"/></else-if><else><text term="no date" form="short"/><text variable="year-suffix" prefix="-"/></else></choose></macro><macro name="edition"><choose><if is-numeric="edition"><group delimiter=" "><number variable="edition" form="ordinal"/><text term="edition" form="short"/></group></if><else><text variable="edition"/></else></choose></macro><macro name="locators"><choose><if type="article-journal article-magazine" match="any"><group prefix=", " delimiter=", "><group><text variable="volume" font-style="italic"/><text variable="issue" prefix="(" suffix=")"/></group><text variable="page"/></group><choose><if variable="issued"><choose><if variable="page issue" match="none"><text variable="status" prefix=". "/></if></choose></if></choose></if><else-if type="article-newspaper"><group delimiter=" " prefix=", "><label variable="page" form="short"/><text variable="page"/></group></else-if><else-if type="book graphic motion_picture report song chapter paper-conference entry-encyclopedia entry-dictionary" match="any"><group prefix=" (" suffix=")" delimiter=", "><choose><if type="report" match="none"><text macro="edition"/></if></choose><choose><if variable="volume" match="any"><group><text term="volume" form="short" text-case="capitalize-first" suffix=" "/><number variable="volume" form="numeric"/></group></if><else><group><text term="volume" form="short" plural="true" text-case="capitalize-first" suffix=" "/><number variable="number-of-volumes" form="numeric" prefix="1&#8211;"/></group></else></choose><group><label variable="page" form="short" suffix=" "/><text variable="page"/></group></group></else-if><else-if type="legal_case"><group prefix=" (" suffix=")" delimiter=" "><text variable="authority"/><date variable="issued" form="text"/></group></else-if><else-if type="bill legislation" match="any"><date variable="issued" prefix=" (" suffix=")"><date-part name="year"/></date></else-if></choose></macro><macro name="citation-locator"><group><choose><if locator="chapter"><label variable="locator" form="long" text-case="capitalize-first"/></if><else><label variable="locator" form="short"/></else></choose><text variable="locator" prefix=" "/></group></macro>\n<macro name="container"><choose><if type="post-weblog webpage" match="none"><group><choose><if type="chapter paper-conference entry-encyclopedia" match="any"><text term="in" text-case="capitalize-first" suffix=" "/></if></choose><group delimiter=", "><text macro="container-contributors"/><text macro="secondary-contributors"/><text macro="container-title"/></group></group></if></choose></macro><macro name="container-title"><choose><if type="article article-journal article-magazine article-newspaper" match="any"><text variable="container-title" font-style="italic" text-case="title"/></if><else-if type="bill legal_case legislation" match="none"><text variable="container-title" font-style="italic"/></else-if></choose></macro><macro name="legal-cites"><choose><if type="bill legal_case legislation" match="any"><group delimiter=" " prefix=", "><choose><if variable="container-title"><text variable="volume"/><text variable="container-title"/><group delimiter=" "><text term="section" form="symbol"/><text variable="section"/></group><text variable="page"/></if><else><choose><if type="legal_case"><text variable="number" prefix="No. "/></if><else><text variable="number" prefix="Pub. L. No. "/><group delimiter=" "><text term="section" form="symbol"/><text variable="section"/></group></else></choose></else></choose></group></if></choose></macro><macro name="original-date"><choose><if variable="original-date"><group prefix="(" suffix=")" delimiter=" "><text value="Original work published"/><date variable="original-date" form="text"/></group></if></choose></macro><citation et-al-min="6" et-al-use-first="1" et-al-subsequent-min="3" et-al-subsequent-use-first="1" disambiguate-add-year-suffix="true" disambiguate-add-names="true" disambiguate-add-givenname="true" collapse="year" givenname-disambiguation-rule="primary-name"><sort><key macro="author"/><key macro="issued-sort"/></sort><layout prefix="(" suffix=")" delimiter="; "><group delimiter=", "><text macro="author-short"/><text macro="issued-year"/><text macro="citation-locator"/></group></layout></citation><bibliography hanging-indent="true" et-al-min="8" et-al-use-first="6" et-al-use-last="true" entry-spacing="0" line-spacing="2"><sort><key macro="author"/><key macro="issued-sort" sort="ascending"/><key macro="title"/></sort><layout><group suffix="."><group delimiter=". "><text macro="author"/><text macro="issued"/><text macro="title-plus-extra"/><text macro="container"/></group><text macro="legal-cites"/><text macro="locators"/><group delimiter=", " prefix=". "><text macro="event"/><text macro="publisher"/></group></group><text macro="access" prefix=" "/><text macro="original-date" prefix=" "/></layout></bibliography></style>',vancouver:'<?xml version="1.0" encoding="utf-8"?><style xmlns="http://purl.org/net/xbiblio/csl" class="in-text" version="1.0" demote-non-dropping-particle="sort-only" page-range-format="minimal"><info><title>Vancouver</title><id>http://www.zotero.org/styles/vancouver</id><link href="http://www.zotero.org/styles/vancouver" rel="self"/><link href="http://www.nlm.nih.gov/bsd/uniform_requirements.html" rel="documentation"/><author><name>Michael Berkowitz</name><email>mberkowi@gmu.edu</email></author><contributor><name>Sean Takats</name><email>stakats@gmu.edu</email></contributor><contributor><name>Sebastian Karcher</name></contributor><category citation-format="numeric"/><category field="medicine"/><summary>Vancouver style as outlined by International Committee of Medical Journal Editors Uniform Requirements for Manuscripts Submitted to Biomedical Journals: Sample References</summary><updated>2014-09-06T16:03:01+00:00</updated><rights license="http://creativecommons.org/licenses/by-sa/3.0/">This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 License</rights></info><locale xml:lang="en"><date form="text" delimiter=" "><date-part name="year"/><date-part name="month" form="short" strip-periods="true"/><date-part name="day"/></date><terms><term name="collection-editor" form="long"><single>editor</single><multiple>editors</multiple></term><term name="presented at">presented at</term><term name="available at">available from</term><term name="section" form="short">sect.</term></terms></locale><locale xml:lang="fr"><date form="text" delimiter=" "><date-part name="day"/><date-part name="month" form="short" strip-periods="true"/><date-part name="year"/></date></locale><macro name="author"><names variable="author"><name sort-separator=" " initialize-with="" name-as-sort-order="all" delimiter=", " delimiter-precedes-last="always"/><label form="long" prefix=", "/><substitute><names variable="editor"/></substitute></names></macro><macro name="editor"><names variable="editor" suffix="."><name sort-separator=" " initialize-with="" name-as-sort-order="all" delimiter=", " delimiter-precedes-last="always"/><label form="long" prefix=", "/></names></macro><macro name="chapter-marker"><choose><if type="chapter paper-conference entry-dictionary entry-encyclopedia" match="any"><text term="in" text-case="capitalize-first"/></if></choose></macro><macro name="publisher"><choose><if type="article-journal article-magazine article-newspaper" match="none"><group delimiter=": " suffix=";"><choose><if type="thesis"><text variable="publisher-place" prefix="[" suffix="]"/></if><else-if type="speech"/><else><text variable="publisher-place"/></else></choose><text variable="publisher"/></group></if></choose></macro><macro name="access"><choose><if variable="URL"><group delimiter=": "><text term="available at" text-case="capitalize-first"/><text variable="URL"/></group></if></choose></macro><macro name="accessed-date"><choose><if variable="URL"><group prefix="[" suffix="]" delimiter=" "><text term="cited" text-case="lowercase"/><date variable="accessed" form="text"/></group></if></choose></macro><macro name="container-title"><choose><if type="article-journal article-magazine chapter paper-conference article-newspaper review review-book entry-dictionary entry-encyclopedia" match="any"><group suffix="." delimiter=" "><choose><if type="article-journal review review-book" match="any"><text variable="container-title" form="short" strip-periods="true"/></if><else><text variable="container-title" strip-periods="true"/></else></choose><choose><if variable="URL"><text term="internet" prefix="[" suffix="]" text-case="capitalize-first"/></if></choose></group><text macro="edition" prefix=" "/></if><else-if type="bill legislation" match="any"><group delimiter=", "><group delimiter=". "><text variable="container-title"/><group delimiter=" "><text term="section" form="short" text-case="capitalize-first"/><text variable="section"/></group></group><text variable="number"/></group></else-if><else-if type="speech">\n<group delimiter=": " suffix=";"><group delimiter=" "><text variable="genre" text-case="capitalize-first"/><text term="presented at"/></group><text variable="event"/></group></else-if><else><group delimiter=", " suffix="."><choose><if variable="collection-title" match="none"><group delimiter=" "><label variable="volume" form="short" text-case="capitalize-first"/><text variable="volume"/></group></if></choose><text variable="container-title"/></group></else></choose></macro><macro name="title"><text variable="title"/><choose><if type="article-journal article-magazine chapter paper-conference article-newspaper review review-book entry-dictionary entry-encyclopedia" match="none"><choose><if variable="URL"><text term="internet" prefix=" [" suffix="]" text-case="capitalize-first"/></if></choose><text macro="edition" prefix=". "/></if></choose><choose><if type="thesis"><text variable="genre" prefix=" [" suffix="]"/></if></choose></macro><macro name="edition"><choose><if is-numeric="edition"><group delimiter=" "><number variable="edition" form="ordinal"/><text term="edition" form="short"/></group></if><else><text variable="edition" suffix="."/></else></choose></macro><macro name="date"><choose><if type="article-journal article-magazine article-newspaper review review-book" match="any"><group suffix=";" delimiter=" "><date variable="issued" form="text"/><text macro="accessed-date"/></group></if><else-if type="bill legislation" match="any"><group delimiter=", "><date variable="issued" delimiter=" "><date-part name="month" form="short" strip-periods="true"/><date-part name="day"/></date><date variable="issued"><date-part name="year"/></date></group></else-if><else-if type="report"><date variable="issued" delimiter=" "><date-part name="year"/><date-part name="month" form="short" strip-periods="true"/></date><text macro="accessed-date" prefix=" "/></else-if><else-if type="patent"><group suffix="."><group delimiter=", "><text variable="number"/><date variable="issued"><date-part name="year"/></date></group><text macro="accessed-date" prefix=" "/></group></else-if><else-if type="speech"><group delimiter="; "><group delimiter=" "><date variable="issued" delimiter=" "><date-part name="year"/><date-part name="month" form="short" strip-periods="true"/><date-part name="day"/></date><text macro="accessed-date"/></group><text variable="event-place"/></group></else-if><else><group suffix="."><date variable="issued"><date-part name="year"/></date><text macro="accessed-date" prefix=" "/></group></else></choose></macro><macro name="pages"><choose><if type="article-journal article-magazine article-newspaper review review-book" match="any"><text variable="page" prefix=":"/></if><else-if type="book" match="any"><text variable="number-of-pages" prefix=" "/><choose><if is-numeric="number-of-pages"><label variable="number-of-pages" form="short" prefix=" " plural="never"/></if></choose></else-if><else><group prefix=" " delimiter=" "><label variable="page" form="short" plural="never"/><text variable="page"/></group></else></choose></macro><macro name="journal-location"><choose><if type="article-journal article-magazine review review-book" match="any"><text variable="volume"/><text variable="issue" prefix="(" suffix=")"/></if></choose></macro><macro name="collection-details"><choose><if type="article-journal article-magazine article-newspaper review review-book" match="none"><choose><if variable="collection-title"><group delimiter=" " prefix="(" suffix=")"><names variable="collection-editor" suffix="."><name sort-separator=" " initialize-with="" name-as-sort-order="all" delimiter=", " delimiter-precedes-last="always"/><label form="long" prefix=", "/></names><group delimiter="; "><text variable="collection-title"/><group delimiter=" "><label variable="volume" form="short"/><text variable="volume"/></group></group></group></if></choose></if></choose></macro><macro name="report-details"><choose><if type="report"><text variable="number" prefix="Report No.: "/></if></choose></macro><citation collapse="citation-number">\n<sort><key variable="citation-number"/></sort><layout prefix="(" suffix=")" delimiter=","><text variable="citation-number"/></layout></citation><bibliography et-al-min="7" et-al-use-first="6" second-field-align="flush"><layout><text variable="citation-number" suffix=". "/><group delimiter=". " suffix=". "><text macro="author"/><text macro="title"/></group><group delimiter=" " suffix=". "><group delimiter=": "><text macro="chapter-marker"/><group delimiter=" "><text macro="editor"/><text macro="container-title"/></group></group><text macro="publisher"/><group><text macro="date"/><text macro="journal-location"/><text macro="pages"/></group></group><text macro="collection-details" suffix=". "/><text macro="report-details" suffix=". "/><text macro="access"/></layout></bibliography></style>',harvard1:'<?xml version="1.0" encoding="utf-8"?><style xmlns="http://purl.org/net/xbiblio/csl" class="in-text" version="1.0" demote-non-dropping-particle="sort-only"><info><title>Harvard Reference format 1 (author-date)</title><id>http://www.zotero.org/styles/harvard1</id><link href="http://www.zotero.org/styles/harvard1" rel="self"/><link href="http://libweb.anglia.ac.uk/referencing/harvard.htm" rel="documentation"/><author><name>Julian Onions</name><email>julian.onions@gmail.com</email></author><category citation-format="author-date"/><category field="generic-base"/><summary>The Harvard author-date style</summary><updated>2012-09-27T22:06:38+00:00</updated><rights license="http://creativecommons.org/licenses/by-sa/3.0/">This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 License</rights></info><macro name="editor"><names variable="editor" delimiter=", "><name and="symbol" initialize-with=". " delimiter=", "/><label form="short" prefix=", " text-case="lowercase"/></names></macro><macro name="anon"><text term="anonymous" form="short" text-case="capitalize-first" strip-periods="true"/></macro><macro name="author"><names variable="author"><name name-as-sort-order="all" and="symbol" sort-separator=", " initialize-with="." delimiter-precedes-last="never" delimiter=", "/><label form="short" prefix=" " text-case="lowercase"/><substitute><names variable="editor"/><text macro="anon"/></substitute></names></macro><macro name="author-short"><names variable="author"><name form="short" and="symbol" delimiter=", " delimiter-precedes-last="never" initialize-with=". "/><substitute><names variable="editor"/><names variable="translator"/><text macro="anon"/></substitute></names></macro><macro name="access"><choose><if variable="URL"><text value="Available at:" suffix=" "/><text variable="URL"/><group prefix=" [" suffix="]"><text term="accessed" text-case="capitalize-first" suffix=" "/><date variable="accessed"><date-part name="month" suffix=" "/><date-part name="day" suffix=", "/><date-part name="year"/></date></group></if></choose></macro><macro name="title"><choose><if type="bill book graphic legal_case legislation motion_picture report song thesis" match="any"><text variable="title" font-style="italic"/></if><else><text variable="title"/></else></choose></macro><macro name="publisher"><group delimiter=": "><text variable="publisher-place"/><text variable="publisher"/></group></macro><macro name="year-date"><choose><if variable="issued"><date variable="issued"><date-part name="year"/></date></if><else><text term="no date" form="short"/></else></choose></macro><macro name="edition"><choose><if is-numeric="edition"><group delimiter=" "><number variable="edition" form="ordinal"/><text term="edition" form="short"/></group></if><else><text variable="edition" suffix="."/></else></choose></macro><macro name="pages"><group><label variable="page" form="short" suffix=" "/><text variable="page"/></group></macro><citation et-al-min="3" et-al-use-first="1" disambiguate-add-year-suffix="true" disambiguate-add-names="true" disambiguate-add-givenname="true"><layout prefix="(" suffix=")" delimiter="; "><group delimiter=", "><group delimiter=" "><text macro="author-short"/><text macro="year-date"/></group><group><label variable="locator" form="short"/><text variable="locator"/></group></group></layout></citation><bibliography hanging-indent="true" et-al-min="4" et-al-use-first="1"><sort><key macro="author"/><key variable="title"/></sort><layout><text macro="author" suffix=","/><date variable="issued" prefix=" " suffix="."><date-part name="year"/></date><choose><if type="bill book graphic legal_case legislation motion_picture report song" match="any"><group prefix=" " delimiter=" " suffix=","><text macro="title"/><text macro="edition"/><text macro="editor"/></group><text prefix=" " suffix="." macro="publisher"/></if><else-if type="chapter paper-conference" match="any"><text macro="title" prefix=" " suffix="."/><group prefix=" " delimiter=" "><text term="in" text-case="capitalize-first"/>\n<text macro="editor"/><text variable="container-title" font-style="italic" suffix="."/><text variable="collection-title" suffix="."/><text variable="event" suffix="."/><group suffix="." delimiter=", "><text macro="publisher" prefix=" "/><text macro="pages"/></group></group></else-if><else-if type="thesis"><group prefix=" " suffix="." delimiter=". "><text macro="title"/><text variable="genre"/><text macro="publisher"/></group></else-if><else><group suffix="."><text macro="title" prefix=" "/><text macro="editor" prefix=" "/></group><group prefix=" " suffix="."><text variable="container-title" font-style="italic"/><group prefix=", "><text variable="volume"/><text variable="issue" prefix="(" suffix=")"/></group><group prefix=", "><label variable="page" form="short"/><text variable="page"/></group></group></else></choose><text prefix=" " macro="access" suffix="."/></layout></bibliography></style>'}},function(t,e){t.exports={"en-US":'<?xml version="1.0" encoding="utf-8"?><locale xmlns="http://purl.org/net/xbiblio/csl" version="1.0" xml:lang="en-US"><info><rights license="http://creativecommons.org/licenses/by-sa/3.0/">This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 License</rights><updated>2015-10-10T23:31:02+00:00</updated></info><style-options punctuation-in-quote="true"/><date form="text"><date-part name="month" suffix=" "/><date-part name="day" suffix=", "/><date-part name="year"/></date><date form="numeric"><date-part name="month" form="numeric-leading-zeros" suffix="/"/><date-part name="day" form="numeric-leading-zeros" suffix="/"/><date-part name="year"/></date><terms><term name="accessed">accessed</term><term name="and">and</term><term name="and others">and others</term><term name="anonymous">anonymous</term><term name="anonymous" form="short">anon.</term><term name="at">at</term><term name="available at">available at</term><term name="by">by</term><term name="circa">circa</term><term name="circa" form="short">c.</term><term name="cited">cited</term><term name="edition"><single>edition</single><multiple>editions</multiple></term><term name="edition" form="short">ed.</term><term name="et-al">et al.</term><term name="forthcoming">forthcoming</term><term name="from">from</term><term name="ibid">ibid.</term><term name="in">in</term><term name="in press">in press</term><term name="internet">internet</term><term name="interview">interview</term><term name="letter">letter</term><term name="no date">no date</term><term name="no date" form="short">n.d.</term><term name="online">online</term><term name="presented at">presented at the</term><term name="reference"><single>reference</single><multiple>references</multiple></term><term name="reference" form="short"><single>ref.</single><multiple>refs.</multiple></term><term name="retrieved">retrieved</term><term name="scale">scale</term><term name="version">version</term><term name="ad">AD</term><term name="bc">BC</term><term name="open-quote">“</term><term name="close-quote">”</term><term name="open-inner-quote">‘</term><term name="close-inner-quote">’</term><term name="page-range-delimiter">–</term><term name="ordinal">th</term><term name="ordinal-01">st</term><term name="ordinal-02">nd</term><term name="ordinal-03">rd</term><term name="ordinal-11">th</term><term name="ordinal-12">th</term><term name="ordinal-13">th</term><term name="long-ordinal-01">first</term><term name="long-ordinal-02">second</term><term name="long-ordinal-03">third</term><term name="long-ordinal-04">fourth</term><term name="long-ordinal-05">fifth</term><term name="long-ordinal-06">sixth</term><term name="long-ordinal-07">seventh</term><term name="long-ordinal-08">eighth</term><term name="long-ordinal-09">ninth</term><term name="long-ordinal-10">tenth</term><term name="book"><single>book</single><multiple>books</multiple></term><term name="chapter"><single>chapter</single><multiple>chapters</multiple></term><term name="column"><single>column</single><multiple>columns</multiple></term><term name="figure"><single>figure</single><multiple>figures</multiple></term><term name="folio"><single>folio</single><multiple>folios</multiple></term><term name="issue"><single>number</single><multiple>numbers</multiple></term><term name="line"><single>line</single><multiple>lines</multiple></term><term name="note"><single>note</single><multiple>notes</multiple></term><term name="opus"><single>opus</single><multiple>opera</multiple></term><term name="page"><single>page</single><multiple>pages</multiple></term><term name="number-of-pages"><single>page</single><multiple>pages</multiple></term><term name="paragraph"><single>paragraph</single><multiple>paragraphs</multiple></term><term name="part"><single>part</single><multiple>parts</multiple></term><term name="section"><single>section</single><multiple>sections</multiple></term><term name="sub verbo"><single>sub verbo</single><multiple>sub verbis</multiple></term><term name="verse"><single>verse</single><multiple>verses</multiple>\n</term><term name="volume"><single>volume</single><multiple>volumes</multiple></term><term name="book" form="short"><single>bk.</single><multiple>bks.</multiple></term><term name="chapter" form="short"><single>chap.</single><multiple>chaps.</multiple></term><term name="column" form="short"><single>col.</single><multiple>cols.</multiple></term><term name="figure" form="short"><single>fig.</single><multiple>figs.</multiple></term><term name="folio" form="short"><single>fol.</single><multiple>fols.</multiple></term><term name="issue" form="short"><single>no.</single><multiple>nos.</multiple></term><term name="line" form="short"><single>l.</single><multiple>ll.</multiple></term><term name="note" form="short"><single>n.</single><multiple>nn.</multiple></term><term name="opus" form="short"><single>op.</single><multiple>opp.</multiple></term><term name="page" form="short"><single>p.</single><multiple>pp.</multiple></term><term name="number-of-pages" form="short"><single>p.</single><multiple>pp.</multiple></term><term name="paragraph" form="short"><single>para.</single><multiple>paras.</multiple></term><term name="part" form="short"><single>pt.</single><multiple>pts.</multiple></term><term name="section" form="short"><single>sec.</single><multiple>secs.</multiple></term><term name="sub verbo" form="short"><single>s.v.</single><multiple>s.vv.</multiple></term><term name="verse" form="short"><single>v.</single><multiple>vv.</multiple></term><term name="volume" form="short"><single>vol.</single><multiple>vols.</multiple></term><term name="paragraph" form="symbol"><single>¶</single><multiple>¶¶</multiple></term><term name="section" form="symbol"><single>§</single><multiple>§§</multiple></term><term name="director"><single>director</single><multiple>directors</multiple></term><term name="editor"><single>editor</single><multiple>editors</multiple></term><term name="editorial-director"><single>editor</single><multiple>editors</multiple></term><term name="illustrator"><single>illustrator</single><multiple>illustrators</multiple></term><term name="translator"><single>translator</single><multiple>translators</multiple></term><term name="editortranslator"><single>editor &amp; translator</single><multiple>editors &amp; translators</multiple></term><term name="director" form="short"><single>dir.</single><multiple>dirs.</multiple></term><term name="editor" form="short"><single>ed.</single><multiple>eds.</multiple></term><term name="editorial-director" form="short"><single>ed.</single><multiple>eds.</multiple></term><term name="illustrator" form="short"><single>ill.</single><multiple>ills.</multiple></term><term name="translator" form="short"><single>tran.</single><multiple>trans.</multiple></term><term name="editortranslator" form="short"><single>ed. &amp; tran.</single><multiple>eds. &amp; trans.</multiple></term><term name="container-author" form="verb">by</term><term name="director" form="verb">directed by</term><term name="editor" form="verb">edited by</term><term name="editorial-director" form="verb">edited by</term><term name="illustrator" form="verb">illustrated by</term><term name="interviewer" form="verb">interview by</term><term name="recipient" form="verb">to</term><term name="reviewed-author" form="verb">by</term><term name="translator" form="verb">translated by</term><term name="editortranslator" form="verb">edited &amp; translated by</term><term name="director" form="verb-short">dir. by</term><term name="editor" form="verb-short">ed. by</term><term name="editorial-director" form="verb-short">ed. by</term><term name="illustrator" form="verb-short">illus. by</term><term name="translator" form="verb-short">trans. by</term><term name="editortranslator" form="verb-short">ed. &amp; trans. by</term><term name="month-01">January</term><term name="month-02">February</term><term name="month-03">March</term><term name="month-04">April</term><term name="month-05">May</term><term name="month-06">June</term><term name="month-07">July</term><term name="month-08">August</term><term name="month-09">September</term>\n<term name="month-10">October</term><term name="month-11">November</term><term name="month-12">December</term><term name="month-01" form="short">Jan.</term><term name="month-02" form="short">Feb.</term><term name="month-03" form="short">Mar.</term><term name="month-04" form="short">Apr.</term><term name="month-05" form="short">May</term><term name="month-06" form="short">Jun.</term><term name="month-07" form="short">Jul.</term><term name="month-08" form="short">Aug.</term><term name="month-09" form="short">Sep.</term><term name="month-10" form="short">Oct.</term><term name="month-11" form="short">Nov.</term><term name="month-12" form="short">Dec.</term><term name="season-01">Spring</term><term name="season-02">Summer</term><term name="season-03">Autumn</term><term name="season-04">Winter</term></terms></locale>',"nl-NL":'<?xml version="1.0" encoding="utf-8"?><locale xmlns="http://purl.org/net/xbiblio/csl" version="1.0" xml:lang="nl-NL"><info><translator><name>Rintze Zelle</name><uri>http://twitter.com/rintzezelle</uri></translator><rights license="http://creativecommons.org/licenses/by-sa/3.0/">This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 License</rights><updated>2012-07-04T23:31:02+00:00</updated></info><style-options punctuation-in-quote="false"/><date form="text"><date-part name="day" suffix=" "/><date-part name="month" suffix=" "/><date-part name="year"/></date><date form="numeric"><date-part name="day" suffix="-" range-delimiter="/"/><date-part name="month" form="numeric" suffix="-" range-delimiter="/"/><date-part name="year"/></date><terms><term name="accessed">geraadpleegd</term><term name="and">en</term><term name="and others">en anderen</term><term name="anonymous">anoniem</term><term name="anonymous" form="short">anon.</term><term name="at">bij</term><term name="available at">beschikbaar op</term><term name="by">door</term><term name="circa">circa</term><term name="circa" form="short">c.</term><term name="cited">geciteerd</term><term name="edition"><single>editie</single><multiple>edities</multiple></term><term name="edition" form="short">ed.</term><term name="et-al">e.a.</term><term name="forthcoming">in voorbereiding</term><term name="from">van</term><term name="ibid">ibid.</term><term name="in">in</term><term name="in press">in druk</term><term name="internet">internet</term><term name="interview">interview</term><term name="letter">brief</term><term name="no date">zonder datum</term><term name="no date" form="short">z.d.</term><term name="online">online</term><term name="presented at">gepresenteerd bij</term><term name="reference"><single>referentie</single><multiple>referenties</multiple></term><term name="reference" form="short"><single>ref.</single><multiple>refs.</multiple></term><term name="retrieved">geraadpleegd</term><term name="scale">schaal</term><term name="version">versie</term><term name="ad">AD</term><term name="bc">BC</term><term name="open-quote">“</term><term name="close-quote">”</term><term name="open-inner-quote">‘</term><term name="close-inner-quote">’</term><term name="page-range-delimiter">–</term><term name="ordinal">ste</term><term name="ordinal-00" match="whole-number">de</term><term name="ordinal-02" match="last-two-digits">de</term><term name="ordinal-03" match="last-two-digits">de</term><term name="ordinal-04" match="last-two-digits">de</term><term name="ordinal-05" match="last-two-digits">de</term><term name="ordinal-06" match="last-two-digits">de</term><term name="ordinal-07" match="last-two-digits">de</term><term name="ordinal-09" match="last-two-digits">de</term><term name="ordinal-10">de</term><term name="ordinal-11">de</term><term name="ordinal-12">de</term><term name="ordinal-13">de</term><term name="ordinal-14">de</term><term name="ordinal-15">de</term><term name="ordinal-16">de</term><term name="ordinal-17">de</term><term name="ordinal-18">de</term><term name="ordinal-19">de</term><term name="long-ordinal-01">eerste</term><term name="long-ordinal-02">tweede</term><term name="long-ordinal-03">derde</term><term name="long-ordinal-04">vierde</term><term name="long-ordinal-05">vijfde</term><term name="long-ordinal-06">zesde</term><term name="long-ordinal-07">zevende</term><term name="long-ordinal-08">achtste</term><term name="long-ordinal-09">negende</term><term name="long-ordinal-10">tiende</term><term name="book"><single>boek</single><multiple>boeken</multiple></term><term name="chapter"><single>hoofdstuk</single><multiple>hoofdstukken</multiple></term><term name="column"><single>column</single><multiple>columns</multiple></term><term name="figure"><single>figuur</single><multiple>figuren</multiple></term><term name="folio"><single>folio</single><multiple>folio\'s</multiple></term><term name="issue"><single>nummer</single><multiple>nummers</multiple></term><term name="line"><single>regel</single><multiple>regels</multiple>\n</term><term name="note"><single>aantekening</single><multiple>aantekeningen</multiple></term><term name="opus"><single>opus</single><multiple>opera</multiple></term><term name="page"><single>pagina</single><multiple>pagina\'s</multiple></term><term name="number-of-pages"><single>pagina</single><multiple>pagina\'s</multiple></term><term name="paragraph"><single>paragraaf</single><multiple>paragrafen</multiple></term><term name="part"><single>deel</single><multiple>delen</multiple></term><term name="section"><single>sectie</single><multiple>secties</multiple></term><term name="sub verbo"><single>sub verbo</single><multiple>sub verbis</multiple></term><term name="verse"><single>vers</single><multiple>versen</multiple></term><term name="volume"><single>volume</single><multiple>volumes</multiple></term><term name="book" form="short">bk.</term><term name="chapter" form="short">hfdst.</term><term name="column" form="short">col.</term><term name="figure" form="short">fig.</term><term name="folio" form="short">f.</term><term name="issue" form="short">nr.</term><term name="line" form="short">l.</term><term name="note" form="short">n.</term><term name="opus" form="short">op.</term><term name="page" form="short"><single>p.</single><multiple>pp.</multiple></term><term name="number-of-pages" form="short"><single>p.</single><multiple>pp.</multiple></term><term name="paragraph" form="short">par.</term><term name="part" form="short">deel</term><term name="section" form="short">sec.</term><term name="sub verbo" form="short"><single>s.v.</single><multiple>s.vv.</multiple></term><term name="verse" form="short"><single>v.</single><multiple>vv.</multiple></term><term name="volume" form="short"><single>vol.</single><multiple>vols.</multiple></term><term name="paragraph" form="symbol"><single>¶</single><multiple>¶¶</multiple></term><term name="section" form="symbol"><single>§</single><multiple>§§</multiple></term><term name="director"><single>regisseur</single><multiple>regisseurs</multiple></term><term name="editor"><single>redacteur</single><multiple>redacteuren</multiple></term><term name="editorial-director"><single>redacteur</single><multiple>redacteuren</multiple></term><term name="illustrator"><single>illustrator</single><multiple>illustrators</multiple></term><term name="translator"><single>vertaler</single><multiple>vertalers</multiple></term><term name="editortranslator"><single>redacteur &amp; vertaler</single><multiple>redacteuren &amp; vertalers</multiple></term><term name="director" form="short"><single>reg.</single><multiple>reg.</multiple></term><term name="editor" form="short"><single>red.</single><multiple>red.</multiple></term><term name="editorial-director" form="short"><single>red.</single><multiple>red.</multiple></term><term name="illustrator" form="short"><single>ill.</single><multiple>ill.</multiple></term><term name="translator" form="short"><single>vert.</single><multiple>vert.</multiple></term><term name="editortranslator" form="short"><single>red. &amp; vert.</single><multiple>red. &amp; vert.</multiple></term><term name="container-author" form="verb">door</term><term name="director" form="verb">geregisseerd door</term><term name="editor" form="verb">bewerkt door</term><term name="editorial-director" form="verb">bewerkt door</term><term name="illustrator" form="verb">geïllustreerd door</term><term name="interviewer" form="verb">geïnterviewd door</term><term name="recipient" form="verb">ontvangen door</term><term name="reviewed-author" form="verb">door</term><term name="translator" form="verb">vertaald door</term><term name="editortranslator" form="verb">bewerkt &amp; vertaald door</term><term name="director" form="verb-short">geregisseerd door</term><term name="editor" form="verb-short">bewerkt door</term><term name="editorial-director" form="verb-short">bewerkt door</term><term name="illustrator" form="verb-short">geïllustreerd door</term><term name="translator" form="verb-short">vertaald door</term><term name="editortranslator" form="verb-short">bewerkt &amp; vertaald door</term>\n<term name="month-01">januari</term><term name="month-02">februari</term><term name="month-03">maart</term><term name="month-04">april</term><term name="month-05">mei</term><term name="month-06">juni</term><term name="month-07">juli</term><term name="month-08">augustus</term><term name="month-09">september</term><term name="month-10">oktober</term><term name="month-11">november</term><term name="month-12">december</term><term name="month-01" form="short">jan.</term><term name="month-02" form="short">feb.</term><term name="month-03" form="short">mrt.</term><term name="month-04" form="short">apr.</term><term name="month-05" form="short">mei</term><term name="month-06" form="short">jun.</term><term name="month-07" form="short">jul.</term><term name="month-08" form="short">aug.</term><term name="month-09" form="short">sep.</term><term name="month-10" form="short">okt.</term><term name="month-11" form="short">nov.</term><term name="month-12" form="short">dec.</term><term name="season-01">lente</term><term name="season-02">zomer</term><term name="season-03">herst</term><term name="season-04">winter</term></terms></locale>',"fr-FR":'<?xml version="1.0" encoding="utf-8"?><locale xmlns="http://purl.org/net/xbiblio/csl" version="1.0" xml:lang="fr-FR"><info><translator><name>Grégoire Colly</name></translator><rights license="http://creativecommons.org/licenses/by-sa/3.0/">This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 License</rights><updated>2012-07-04T23:31:02+00:00</updated></info><style-options punctuation-in-quote="false" limit-day-ordinals-to-day-1="true"/><date form="text"><date-part name="day" suffix=" "/><date-part name="month" suffix=" "/><date-part name="year"/></date><date form="numeric"><date-part name="day" form="numeric-leading-zeros" suffix="/"/><date-part name="month" form="numeric-leading-zeros" suffix="/"/><date-part name="year"/></date><terms><term name="accessed">consulté le</term><term name="and">et</term><term name="and others">et autres</term><term name="anonymous">anonyme</term><term name="anonymous" form="short">anon.</term><term name="at">sur</term><term name="available at">disponible sur</term><term name="by">par</term><term name="circa">vers</term><term name="circa" form="short">v.</term><term name="cited">cité</term><term name="edition" gender="feminine"><single>édition</single><multiple>éditions</multiple></term><term name="edition" form="short">éd.</term><term name="et-al">et al.</term><term name="forthcoming">à paraître</term><term name="from">à l\'adresse</term><term name="ibid">ibid.</term><term name="in">in</term><term name="in press">sous presse</term><term name="internet">Internet</term><term name="interview">entretien</term><term name="letter">lettre</term><term name="no date">sans date</term><term name="no date" form="short">s.&#160;d.</term><term name="online">en ligne</term><term name="presented at">présenté à</term><term name="reference"><single>référence</single><multiple>références</multiple></term><term name="reference" form="short"><single>réf.</single><multiple>réf.</multiple></term><term name="retrieved">consulté</term><term name="scale">échelle</term><term name="version">version</term><term name="ad">apr. J.-C.</term><term name="bc">av. J.-C.</term><term name="open-quote">«&#160;</term><term name="close-quote">&#160;»</term><term name="open-inner-quote">“</term><term name="close-inner-quote">”</term><term name="page-range-delimiter">&#8209;</term><term name="ordinal">ᵉ</term><term name="ordinal-01" gender-form="feminine" match="whole-number">ʳᵉ</term><term name="ordinal-01" gender-form="masculine" match="whole-number">ᵉʳ</term><term name="long-ordinal-01">premier</term><term name="long-ordinal-02">deuxième</term><term name="long-ordinal-03">troisième</term><term name="long-ordinal-04">quatrième</term><term name="long-ordinal-05">cinquième</term><term name="long-ordinal-06">sixième</term><term name="long-ordinal-07">septième</term><term name="long-ordinal-08">huitième</term><term name="long-ordinal-09">neuvième</term><term name="long-ordinal-10">dixième</term><term name="book"><single>livre</single><multiple>livres</multiple></term><term name="chapter"><single>chapitre</single><multiple>chapitres</multiple></term><term name="column"><single>colonne</single><multiple>colonnes</multiple></term><term name="figure"><single>figure</single><multiple>figures</multiple></term><term name="folio"><single>folio</single><multiple>folios</multiple></term><term name="issue" gender="masculine"><single>numéro</single><multiple>numéros</multiple></term><term name="line"><single>ligne</single><multiple>lignes</multiple></term><term name="note"><single>note</single><multiple>notes</multiple></term><term name="opus"><single>opus</single><multiple>opus</multiple></term><term name="page"><single>page</single><multiple>pages</multiple></term><term name="number-of-pages"><single>page</single><multiple>pages</multiple></term><term name="paragraph"><single>paragraphe</single><multiple>paragraphes</multiple></term><term name="part"><single>partie</single><multiple>parties</multiple></term><term name="section"><single>section</single><multiple>sections</multiple>\n</term><term name="sub verbo"><single>sub verbo</single><multiple>sub verbis</multiple></term><term name="verse"><single>verset</single><multiple>versets</multiple></term><term name="volume" gender="masculine"><single>volume</single><multiple>volumes</multiple></term><term name="book" form="short">liv.</term><term name="chapter" form="short">chap.</term><term name="column" form="short">col.</term><term name="figure" form="short">fig.</term><term name="folio" form="short"><single>fᵒ</single><multiple>fᵒˢ</multiple></term><term name="issue" form="short"><single>nᵒ</single><multiple>nᵒˢ</multiple></term><term name="line" form="short">l.</term><term name="note" form="short">n.</term><term name="opus" form="short">op.</term><term name="page" form="short"><single>p.</single><multiple>p.</multiple></term><term name="number-of-pages" form="short"><single>p.</single><multiple>p.</multiple></term><term name="paragraph" form="short">paragr.</term><term name="part" form="short">part.</term><term name="section" form="short">sect.</term><term name="sub verbo" form="short"><single>s.&#160;v.</single><multiple>s.&#160;vv.</multiple></term><term name="verse" form="short"><single>v.</single><multiple>v.</multiple></term><term name="volume" form="short"><single>vol.</single><multiple>vol.</multiple></term><term name="paragraph" form="symbol"><single>§</single><multiple>§</multiple></term><term name="section" form="symbol"><single>§</single><multiple>§</multiple></term><term name="director"><single>réalisateur</single><multiple>réalisateurs</multiple></term><term name="editor"><single>éditeur</single><multiple>éditeurs</multiple></term><term name="editorial-director"><single>directeur</single><multiple>directeurs</multiple></term><term name="illustrator"><single>illustrateur</single><multiple>illustrateurs</multiple></term><term name="translator"><single>traducteur</single><multiple>traducteurs</multiple></term><term name="editortranslator"><single>éditeur et traducteur</single><multiple>éditeurs et traducteurs</multiple></term><term name="director" form="short"><single>réal.</single><multiple>réal.</multiple></term><term name="editor" form="short"><single>éd.</single><multiple>éd.</multiple></term><term name="editorial-director" form="short"><single>dir.</single><multiple>dir.</multiple></term><term name="illustrator" form="short"><single>ill.</single><multiple>ill.</multiple></term><term name="translator" form="short"><single>trad.</single><multiple>trad.</multiple></term><term name="editortranslator" form="short"><single>éd. et trad.</single><multiple>éd. et trad.</multiple></term><term name="container-author" form="verb">par</term><term name="director" form="verb">réalisé par</term><term name="editor" form="verb">édité par</term><term name="editorial-director" form="verb">sous la direction de</term><term name="illustrator" form="verb">illustré par</term><term name="interviewer" form="verb">entretien réalisé par</term><term name="recipient" form="verb">à</term><term name="reviewed-author" form="verb">par</term><term name="translator" form="verb">traduit par</term><term name="editortranslator" form="verb">édité et traduit par</term><term name="director" form="verb-short">réal. par</term><term name="editor" form="verb-short">éd. par</term><term name="editorial-director" form="verb-short">ss la dir. de</term><term name="illustrator" form="verb-short">ill. par</term><term name="translator" form="verb-short">trad. par</term><term name="editortranslator" form="verb-short">éd. et trad. par</term><term name="month-01" gender="masculine">janvier</term><term name="month-02" gender="masculine">février</term><term name="month-03" gender="masculine">mars</term><term name="month-04" gender="masculine">avril</term><term name="month-05" gender="masculine">mai</term><term name="month-06" gender="masculine">juin</term><term name="month-07" gender="masculine">juillet</term><term name="month-08" gender="masculine">août</term><term name="month-09" gender="masculine">septembre</term><term name="month-10" gender="masculine">\noctobre</term><term name="month-11" gender="masculine">novembre</term><term name="month-12" gender="masculine">décembre</term><term name="month-01" form="short">janv.</term><term name="month-02" form="short">févr.</term><term name="month-03" form="short">mars</term><term name="month-04" form="short">avr.</term><term name="month-05" form="short">mai</term><term name="month-06" form="short">juin</term><term name="month-07" form="short">juill.</term><term name="month-08" form="short">août</term><term name="month-09" form="short">sept.</term><term name="month-10" form="short">oct.</term><term name="month-11" form="short">nov.</term><term name="month-12" form="short">déc.</term><term name="season-01">printemps</term><term name="season-02">été</term><term name="season-03">automne</term><term name="season-04">hiver</term></terms></locale>',"de-DE":'<?xml version="1.0" encoding="utf-8"?><locale xmlns="http://purl.org/net/xbiblio/csl" version="1.0" xml:lang="de-DE"><info><rights license="http://creativecommons.org/licenses/by-sa/3.0/">This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 License</rights><updated>2012-07-04T23:31:02+00:00</updated></info><style-options punctuation-in-quote="false"/><date form="text"><date-part name="day" form="ordinal" suffix=" "/><date-part name="month" suffix=" "/><date-part name="year"/></date><date form="numeric"><date-part name="day" form="numeric-leading-zeros" suffix="."/><date-part name="month" form="numeric-leading-zeros" suffix="."/><date-part name="year"/></date><terms><term name="accessed">zugegriffen</term><term name="and">und</term><term name="and others">und andere</term><term name="anonymous">ohne Autor</term><term name="anonymous" form="short">o.&#160;A.</term><term name="at">auf</term><term name="available at">verfügbar unter</term><term name="by">von</term><term name="circa">circa</term><term name="circa" form="short">ca.</term><term name="cited">zitiert</term><term name="edition"><single>Auflage</single><multiple>Auflagen</multiple></term><term name="edition" form="short">Aufl.</term><term name="et-al">u.&#160;a.</term><term name="forthcoming">i.&#160;E.</term><term name="from">von</term><term name="ibid">ebd.</term><term name="in">in</term><term name="in press">im Druck</term><term name="internet">Internet</term><term name="interview">Interview</term><term name="letter">Brief</term><term name="no date">ohne Datum</term><term name="no date" form="short">o.&#160;J.</term><term name="online">online</term><term name="presented at">gehalten auf der</term><term name="reference"><single>Referenz</single><multiple>Referenzen</multiple></term><term name="reference" form="short"><single>Ref.</single><multiple>Ref.</multiple></term><term name="retrieved">abgerufen</term><term name="scale">Maßstab</term><term name="version">Version</term><term name="ad">n.&#160;Chr.</term><term name="bc">v.&#160;Chr.</term><term name="open-quote">„</term><term name="close-quote">“</term><term name="open-inner-quote">‚</term><term name="close-inner-quote">‘</term><term name="page-range-delimiter">–</term><term name="ordinal">.</term><term name="long-ordinal-01">erster</term><term name="long-ordinal-02">zweiter</term><term name="long-ordinal-03">dritter</term><term name="long-ordinal-04">vierter</term><term name="long-ordinal-05">fünfter</term><term name="long-ordinal-06">sechster</term><term name="long-ordinal-07">siebter</term><term name="long-ordinal-08">achter</term><term name="long-ordinal-09">neunter</term><term name="long-ordinal-10">zehnter</term><term name="book"><single>Buch</single><multiple>Bücher</multiple></term><term name="chapter"><single>Kapitel</single><multiple>Kapitel</multiple></term><term name="column"><single>Spalte</single><multiple>Spalten</multiple></term><term name="figure"><single>Abbildung</single><multiple>Abbildungen</multiple></term><term name="folio"><single>Blatt</single><multiple>Blätter</multiple></term><term name="issue"><single>Nummer</single><multiple>Nummern</multiple></term><term name="line"><single>Zeile</single><multiple>Zeilen</multiple></term><term name="note"><single>Note</single><multiple>Noten</multiple></term><term name="opus"><single>Opus</single><multiple>Opera</multiple></term><term name="page"><single>Seite</single><multiple>Seiten</multiple></term><term name="number-of-pages"><single>Seite</single><multiple>Seiten</multiple></term><term name="paragraph"><single>Absatz</single><multiple>Absätze</multiple></term><term name="part"><single>Teil</single><multiple>Teile</multiple></term><term name="section"><single>Abschnitt</single><multiple>Abschnitte</multiple></term><term name="sub verbo"><single>sub verbo</single><multiple>sub verbis</multiple></term><term name="verse"><single>Vers</single><multiple>Verse</multiple></term><term name="volume"><single>Band</single><multiple>Bände</multiple></term><term name="book" form="short">B.</term>\n<term name="chapter" form="short">Kap.</term><term name="column" form="short">Sp.</term><term name="figure" form="short">Abb.</term><term name="folio" form="short">Fol.</term><term name="issue" form="short">Nr.</term><term name="line" form="short">Z.</term><term name="note" form="short">N.</term><term name="opus" form="short">op.</term><term name="page" form="short"><single>S.</single><multiple>S.</multiple></term><term name="number-of-pages" form="short"><single>S.</single><multiple>S.</multiple></term><term name="paragraph" form="short">Abs.</term><term name="part" form="short">Teil</term><term name="section" form="short">Abschn.</term><term name="sub verbo" form="short"><single>s.&#160;v.</single><multiple>s.&#160;vv.</multiple></term><term name="verse" form="short"><single>V.</single><multiple>V.</multiple></term><term name="volume" form="short"><single>Bd.</single><multiple>Bde.</multiple></term><term name="paragraph" form="symbol"><single>¶</single><multiple>¶¶</multiple></term><term name="section" form="symbol"><single>§</single><multiple>§§</multiple></term><term name="director"><single>Regisseur</single><multiple>Regisseure</multiple></term><term name="editor"><single>Herausgeber</single><multiple>Herausgeber</multiple></term><term name="collection-editor"><single>Reihenherausgeber</single><multiple>Reihenherausgeber</multiple></term><term name="editorial-director"><single>Herausgeber</single><multiple>Herausgeber</multiple></term><term name="illustrator"><single>Illustrator</single><multiple>Illustratoren</multiple></term><term name="translator"><single>Übersetzer</single><multiple>Übersetzer</multiple></term><term name="editortranslator"><single>Herausgeber&#160;&amp; Übersetzer</single><multiple>Herausgeber&#160;&amp; Übersetzer</multiple></term><term name="director" form="short"><single>Reg.</single><multiple>Reg.</multiple></term><term name="editor" form="short"><single>Hrsg.</single><multiple>Hrsg.</multiple></term><term name="collection-editor" form="short"><single>Hrsg.</single><multiple>Hrsg.</multiple></term><term name="editorial-director" form="short"><single>Hrsg.</single><multiple>Hrsg.</multiple></term><term name="illustrator" form="short"><single>Ill.</single><multiple>Ill.</multiple></term><term name="translator" form="short"><single>Übers.</single><multiple>Übers.</multiple></term><term name="editortranslator" form="short"><single>Hrsg.&#160;&amp; Übers.</single><multiple>Hrsg.&#160;&amp; Übers</multiple></term><term name="container-author" form="verb">von</term><term name="director" form="verb">Regie von</term><term name="editor" form="verb">herausgegeben von</term><term name="collection-editor" form="verb">herausgegeben von</term><term name="editorial-director" form="verb">herausgegeben von</term><term name="illustrator" form="verb">illustriert von</term><term name="interviewer" form="verb">interviewt von</term><term name="recipient" form="verb">an</term><term name="reviewed-author" form="verb">von</term><term name="translator" form="verb">übersetzt von</term><term name="editortranslator" form="verb">herausgegeben und übersetzt von</term><term name="director" form="verb-short">Reg.</term><term name="editor" form="verb-short">hg. von</term><term name="collection-editor" form="verb-short">hg. von</term><term name="editorial-director" form="verb-short">hg. von</term><term name="illustrator" form="verb-short">illus. von</term><term name="translator" form="verb-short">übers. von</term><term name="editortranslator" form="verb-short">hg.&#160;&amp; übers. von</term><term name="month-01">Januar</term><term name="month-02">Februar</term><term name="month-03">März</term><term name="month-04">April</term><term name="month-05">Mai</term><term name="month-06">Juni</term><term name="month-07">Juli</term><term name="month-08">August</term><term name="month-09">September</term><term name="month-10">Oktober</term><term name="month-11">November</term><term name="month-12">Dezember</term><term name="month-01" form="short">Jan.</term><term name="month-02" form="short">Feb.</term>\n<term name="month-03" form="short">März</term><term name="month-04" form="short">Apr.</term><term name="month-05" form="short">Mai</term><term name="month-06" form="short">Juni</term><term name="month-07" form="short">Juli</term><term name="month-08" form="short">Aug.</term><term name="month-09" form="short">Sep.</term><term name="month-10" form="short">Okt.</term><term name="month-11" form="short">Nov.</term><term name="month-12" form="short">Dez.</term><term name="season-01">Frühjahr</term><term name="season-02">Sommer</term><term name="season-03">Herbst</term><term name="season-04">Winter</term></terms></locale>',"es-ES":'<?xml version="1.0" encoding="utf-8"?><locale xmlns="http://purl.org/net/xbiblio/csl" version="1.0" xml:lang="es-ES"><info><rights license="http://creativecommons.org/licenses/by-sa/3.0/">This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 License</rights><updated>2012-07-04T23:31:02+00:00</updated></info><style-options punctuation-in-quote="false"/><date form="text"><date-part name="day" suffix=" de "/><date-part name="month" suffix=" de "/><date-part name="year"/></date><date form="numeric"><date-part name="day" form="numeric-leading-zeros" suffix="/"/><date-part name="month" form="numeric-leading-zeros" suffix="/"/><date-part name="year"/></date><terms><term name="accessed">accedido</term><term name="and">y</term><term name="and others">y otros</term><term name="anonymous">anónimo</term><term name="anonymous" form="short">anón.</term><term name="at">en</term><term name="available at">disponible en</term><term name="by">de</term><term name="circa">circa</term><term name="circa" form="short">c.</term><term name="cited">citado</term><term name="edition"><single>edición</single><multiple>ediciones</multiple></term><term name="edition" form="short">ed.</term><term name="et-al">et&#160;al.</term><term name="forthcoming">previsto</term><term name="from">a partir de</term><term name="ibid">ibid.</term><term name="in">en</term><term name="in press">en imprenta</term><term name="internet">internet</term><term name="interview">entrevista</term><term name="letter">carta</term><term name="no date">sin fecha</term><term name="no date" form="short">s.&#160;f.</term><term name="online">en línea</term><term name="presented at">presentado en</term><term name="reference"><single>referencia</single><multiple>referencias</multiple></term><term name="reference" form="short"><single>ref.</single><multiple>refs.</multiple></term><term name="retrieved">recuperado</term><term name="scale">escala</term><term name="version">versión</term><term name="ad">d.&#160;C.</term><term name="bc">a.&#160;C.</term><term name="open-quote">«</term><term name="close-quote">»</term><term name="open-inner-quote">“</term><term name="close-inner-quote">”</term><term name="page-range-delimiter">-</term><term name="ordinal">.ª</term><term name="long-ordinal-01">primera</term><term name="long-ordinal-02">segunda</term><term name="long-ordinal-03">tercera</term><term name="long-ordinal-04">cuarta</term><term name="long-ordinal-05">quinta</term><term name="long-ordinal-06">sexta</term><term name="long-ordinal-07">séptima</term><term name="long-ordinal-08">octava</term><term name="long-ordinal-09">novena</term><term name="long-ordinal-10">décima</term><term name="book"><single>libro</single><multiple>libros</multiple></term><term name="chapter"><single>capítulo</single><multiple>capítulos</multiple></term><term name="column"><single>columna</single><multiple>columnas</multiple></term><term name="figure"><single>figura</single><multiple>figuras</multiple></term><term name="folio"><single>folio</single><multiple>folios</multiple></term><term name="issue"><single>número</single><multiple>números</multiple></term><term name="line"><single>línea</single><multiple>líneas</multiple></term><term name="note"><single>nota</single><multiple>notas</multiple></term><term name="opus"><single>opus</single><multiple>opera</multiple></term><term name="page"><single>página</single><multiple>páginas</multiple></term><term name="number-of-pages"><single>página</single><multiple>páginas</multiple></term><term name="paragraph"><single>párrafo</single><multiple>párrafos</multiple></term><term name="part"><single>parte</single><multiple>partes</multiple></term><term name="section"><single>sección</single><multiple>secciones</multiple></term><term name="sub verbo"><single>sub voce</single><multiple>sub vocibus</multiple></term><term name="verse"><single>verso</single><multiple>versos</multiple></term><term name="volume"><single>volumen</single><multiple>volúmenes</multiple></term><term name="book" form="short">lib.</term>\n<term name="chapter" form="short">cap.</term><term name="column" form="short">col.</term><term name="figure" form="short">fig.</term><term name="folio" form="short">f.</term><term name="issue" form="short">n.º</term><term name="line" form="short">l.</term><term name="note" form="short">n.</term><term name="opus" form="short">op.</term><term name="page" form="short"><single>p.</single><multiple>pp.</multiple></term><term name="number-of-pages" form="short"><single>p.</single><multiple>pp.</multiple></term><term name="paragraph" form="short">párr.</term><term name="part" form="short">pt.</term><term name="section" form="short">sec.</term><term name="sub verbo" form="short"><single>s.&#160;v.</single><multiple>s.&#160;vv.</multiple></term><term name="verse" form="short"><single>v.</single><multiple>vv.</multiple></term><term name="volume" form="short"><single>vol.</single><multiple>vols.</multiple></term><term name="paragraph" form="symbol"><single>§</single><multiple>§</multiple></term><term name="section" form="symbol"><single>§</single><multiple>§</multiple></term><term name="director"><single>director</single><multiple>directores</multiple></term><term name="editor"><single>editor</single><multiple>editores</multiple></term><term name="editorial-director"><single>editor</single><multiple>editores</multiple></term><term name="illustrator"><single>ilustrador</single><multiple>ilustradores</multiple></term><term name="translator"><single>traductor</single><multiple>traductores</multiple></term><term name="editortranslator"><single>editor y traductor</single><multiple>editores y traductores</multiple></term><term name="director" form="short"><single>dir.</single><multiple>dirs.</multiple></term><term name="editor" form="short"><single>ed.</single><multiple>eds.</multiple></term><term name="editorial-director" form="short"><single>ed.</single><multiple>eds.</multiple></term><term name="illustrator" form="short"><single>ilust.</single><multiple>ilusts.</multiple></term><term name="translator" form="short"><single>trad.</single><multiple>trads.</multiple></term><term name="editortranslator" form="short"><single>ed. y trad.</single><multiple>eds. y trads.</multiple></term><term name="container-author" form="verb">de</term><term name="director" form="verb">dirigido por</term><term name="editor" form="verb">editado por</term><term name="editorial-director" form="verb">editado por</term><term name="illustrator" form="verb">ilustrado por</term><term name="interviewer" form="verb">entrevistado por</term><term name="recipient" form="verb">a</term><term name="reviewed-author" form="verb">por</term><term name="translator" form="verb">traducido por</term><term name="editortranslator" form="verb">editado y traducido por</term><term name="director" form="verb-short">dir.</term><term name="editor" form="verb-short">ed.</term><term name="editorial-director" form="verb-short">ed.</term><term name="illustrator" form="verb-short">ilust.</term><term name="translator" form="verb-short">trad.</term><term name="editortranslator" form="verb-short">ed. y trad.</term><term name="month-01">enero</term><term name="month-02">febrero</term><term name="month-03">marzo</term><term name="month-04">abril</term><term name="month-05">mayo</term><term name="month-06">junio</term><term name="month-07">julio</term><term name="month-08">agosto</term><term name="month-09">septiembre</term><term name="month-10">octubre</term><term name="month-11">noviembre</term><term name="month-12">diciembre</term><term name="month-01" form="short">ene.</term><term name="month-02" form="short">feb.</term><term name="month-03" form="short">mar.</term><term name="month-04" form="short">abr.</term><term name="month-05" form="short">may</term><term name="month-06" form="short">jun.</term><term name="month-07" form="short">jul.</term><term name="month-08" form="short">ago.</term><term name="month-09" form="short">sep.</term><term name="month-10" form="short">oct.</term><term name="month-11" form="short">nov.</term><term name="month-12" form="short">\ndic.</term><term name="season-01">primavera</term><term name="season-02">verano</term><term name="season-03">otoño</term><term name="season-04">invierno</term></terms></locale>'}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.csl=e.json=e.name=e.date=e.doi=e.bibjson=e.bibtxt=e.bibtex=e.wikidata=e.input=void 0;var r=d(n(916)),i=d(n(937)),o=d(n(939)),a=d(n(370)),s=d(n(940)),u=f(n(367)),l=f(n(141)),c=f(n(86)),h=f(n(374)),p=f(n(379));function f(t){return t&&t.__esModule?t:{default:t}}function d(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}e.input=r,e.wikidata=i,e.bibtex=o,e.bibtxt=a,e.bibjson=u.default,e.doi=s,e.date=l.default,e.name=c.default,e.json=h.default,e.csl=p.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.async=e.chainLink=e.chain=e.data=e.type=void 0;var r=u(n(99)),i=u(n(138)),o=u(n(218)),a=u(n(933)),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(934));function u(t){return t&&t.__esModule?t:{default:t}}e.type=r.default,e.data=i.default,e.chain=o.default,e.chainLink=a.default,e.async=s},function(t,e,n){"use strict";function r(t,e,n,r){if("number"!=typeof t)throw new TypeError("statusCode must be a number but was "+typeof t);if(null===e)throw new TypeError("headers cannot be null");if("object"!=typeof e)throw new TypeError("headers must be an object but was "+typeof e);this.statusCode=t,this.headers={};for(var i in e)this.headers[i.toLowerCase()]=e[i];this.body=n,this.url=r}t.exports=r,r.prototype.getBody=function(t){if(this.statusCode>=300){var e=new Error("Server responded with status code "+this.statusCode+":\n"+this.body.toString());throw e.statusCode=this.statusCode,e.headers=this.headers,e.body=this.body,e.url=this.url,e}return t?this.body.toString(t):this.body}},function(t,e,n){"use strict";var r=n(349).parse,i=n(349).stringify;t.exports=function(t,e){var n=(t=t.split("?"))[0],o=(t[1]||"").split("#")[0],a=t[1]&&t[1].split("#").length>1?"#"+t[1].split("#")[1]:"",s=r(o);for(var u in e)s[u]=e[u];""!==(o=i(s))&&(o="?"+o);return n+o+a}},function(t,e,n){"use strict";var r=n(350),i=n(351),o={brackets:function(t){return t+"[]"},indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},a=Date.prototype.toISOString,s={delimiter:"&",encode:!0,encoder:r.encode,serializeDate:function(t){return a.call(t)},skipNulls:!1,strictNullHandling:!1},u=function t(e,n,i,o,a,s,u,l,c,h,p){var f=e;if("function"==typeof u)f=u(n,f);else if(f instanceof Date)f=h(f);else if(null===f){if(o)return s?s(n):n;f=""}if("string"==typeof f||"number"==typeof f||"boolean"==typeof f||r.isBuffer(f))return s?[p(s(n))+"="+p(s(f))]:[p(n)+"="+p(String(f))];var d,m=[];if(void 0===f)return m;if(Array.isArray(u))d=u;else{var g=Object.keys(f);d=l?g.sort(l):g}for(var v=0;v<d.length;++v){var y=d[v];a&&null===f[y]||(m=Array.isArray(f)?m.concat(t(f[y],i(n,y),i,o,a,s,u,l,c,h,p)):m.concat(t(f[y],n+(c?"."+y:"["+y+"]"),i,o,a,s,u,l,c,h,p)))}return m};t.exports=function(t,e){var n=t,r=e||{};if(null!==r.encoder&&void 0!==r.encoder&&"function"!=typeof r.encoder)throw new TypeError("Encoder has to be a function.");var a=void 0===r.delimiter?s.delimiter:r.delimiter,l="boolean"==typeof r.strictNullHandling?r.strictNullHandling:s.strictNullHandling,c="boolean"==typeof r.skipNulls?r.skipNulls:s.skipNulls,h=("boolean"==typeof r.encode?r.encode:s.encode)?"function"==typeof r.encoder?r.encoder:s.encoder:null,p="function"==typeof r.sort?r.sort:null,f=void 0!==r.allowDots&&r.allowDots,d="function"==typeof r.serializeDate?r.serializeDate:s.serializeDate;if(void 0===r.format)r.format=i.default;else if(!Object.prototype.hasOwnProperty.call(i.formatters,r.format))throw new TypeError("Unknown format option provided.");var m,g,v=i.formatters[r.format];"function"==typeof r.filter?n=(g=r.filter)("",n):Array.isArray(r.filter)&&(m=g=r.filter);var y,b=[];if("object"!=typeof n||null===n)return"";y=r.arrayFormat in o?r.arrayFormat:"indices"in r?r.indices?"indices":"repeat":"indices";var _=o[y];m||(m=Object.keys(n)),p&&m.sort(p);for(var x=0;x<m.length;++x){var w=m[x];c&&null===n[w]||(b=b.concat(u(n[w],w,_,l,c,h,g,p,f,d,v)))}return b.join(a)}},function(t,e,n){"use strict";var r=n(350),i=Object.prototype.hasOwnProperty,o={allowDots:!1,allowPrototypes:!1,arrayLimit:20,decoder:r.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:!1,strictNullHandling:!1},a=function(t,e,n){if(!t.length)return e;var r,i=t.shift();if("[]"===i)r=(r=[]).concat(a(t,e,n));else{r=n.plainObjects?Object.create(null):{};var o="["===i.charAt(0)&&"]"===i.charAt(i.length-1)?i.slice(1,-1):i,s=parseInt(o,10);!isNaN(s)&&i!==o&&String(s)===o&&s>=0&&n.parseArrays&&s<=n.arrayLimit?(r=[])[s]=a(t,e,n):r[o]=a(t,e,n)}return r},s=function(t,e,n){if(t){var r=n.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,o=/(\[[^[\]]*])/g,s=/(\[[^[\]]*])/.exec(r),u=s?r.slice(0,s.index):r,l=[];if(u){if(!n.plainObjects&&i.call(Object.prototype,u)&&!n.allowPrototypes)return;l.push(u)}for(var c=0;null!==(s=o.exec(r))&&c<n.depth;){if(c+=1,!n.plainObjects&&i.call(Object.prototype,s[1].slice(1,-1))&&!n.allowPrototypes)return;l.push(s[1])}return s&&l.push("["+r.slice(s.index)+"]"),a(l,e,n)}};t.exports=function(t,e){var n=e||{};if(null!==n.decoder&&void 0!==n.decoder&&"function"!=typeof n.decoder)throw new TypeError("Decoder has to be a function.");if(n.delimiter="string"==typeof n.delimiter||r.isRegExp(n.delimiter)?n.delimiter:o.delimiter,n.depth="number"==typeof n.depth?n.depth:o.depth,n.arrayLimit="number"==typeof n.arrayLimit?n.arrayLimit:o.arrayLimit,n.parseArrays=!1!==n.parseArrays,n.decoder="function"==typeof n.decoder?n.decoder:o.decoder,n.allowDots="boolean"==typeof n.allowDots?n.allowDots:o.allowDots,n.plainObjects="boolean"==typeof n.plainObjects?n.plainObjects:o.plainObjects,n.allowPrototypes="boolean"==typeof n.allowPrototypes?n.allowPrototypes:o.allowPrototypes,n.parameterLimit="number"==typeof n.parameterLimit?n.parameterLimit:o.parameterLimit,n.strictNullHandling="boolean"==typeof n.strictNullHandling?n.strictNullHandling:o.strictNullHandling,""===t||null===t||void 0===t)return n.plainObjects?Object.create(null):{};for(var a="string"==typeof t?function(t,e){for(var n={},r=t.split(e.delimiter,e.parameterLimit===1/0?void 0:e.parameterLimit),o=0;o<r.length;++o){var a,s,u=r[o],l=-1===u.indexOf("]=")?u.indexOf("="):u.indexOf("]=")+1;-1===l?(a=e.decoder(u),s=e.strictNullHandling?null:""):(a=e.decoder(u.slice(0,l)),s=e.decoder(u.slice(l+1))),i.call(n,a)?n[a]=[].concat(n[a]).concat(s):n[a]=s}return n}(t,n):t,u=n.plainObjects?Object.create(null):{},l=Object.keys(a),c=0;c<l.length;++c){var h=l[c],p=s(h,a[h],n);u=r.merge(u,p,n)}return r.compact(u)}},function(t,e,n){const r=n(139),{isPlainObject:i}=n(53);t.exports=function(t,e,n,o,a){if(i(t)){const r=t;t=r.search,e=r.language,n=r.limit,o=r.format,a=r.uselang}if(!(t&&t.length>0))throw new Error("search can't be empty");return e=e||"en",a=a||e,r({action:"wbsearchentities",search:t,language:e,limit:n=n||"20",format:o=o||"json",uselang:a})}},function(t,e){t.exports={stringify:function(t){var e="";for(let n in t){let r=t[n];r&&(e+=`&${n}=${r}`)}return e=e.slice(1),encodeURI?encodeURI(e):e}}},function(t,e,n){const r=n(354),{isPlainObject:i}=n(53);t.exports=function(t,e,n,a){if(i(t)&&({ids:t,languages:e,props:n,format:a}=t),!(t instanceof Array))throw new Error("getManyEntities expects an array of ids");return o(t).map(t=>r(t,e,n,a))};const o=function(t){const e=[];for(;t.length>0;){let n=t.slice(0,50);t=t.slice(50),e.push(n)}return e}},function(t,e,n){const r=n(139),{isPlainObject:i,forceArray:o,shortLang:a}=n(53);t.exports=function(t,e,n,u,l){if(i(t)){const r=t;t=r.titles,e=r.sites,n=r.languages,u=r.props,l=r.format}if(l=l||"json",!(t&&t.length>0))throw new Error("no title provided");e&&e.length>0||(e=["enwiki"]),t=o(t),e=o(e).map(s),u=o(u);const c={action:"wbgetentities",titles:t.join("|"),sites:e.join("|"),format:l};return 1===e.length&&1===t.length&&(c.normalize=!0),n&&(n=o(n).map(a),c.languages=n.join("|")),u&&u.length>0&&(c.props=u.join("|")),r(c)};const s=t=>2===t.length?`${t}wiki`:t},function(t,e,n){const r=n(140),i=n(355);function o(t,e,n,r){return`SELECT DISTINCT ?subject WHERE {\n    ?subject ${t} ${e} .\n    ${n}\n  }\n  LIMIT ${r}`}function a(t,e,n,r){return`SELECT DISTINCT ?subject WHERE {\n    ?subject ${t} ?value .\n    FILTER (lcase(?value) = ${e.toLowerCase()})\n    ${n}\n  }\n  LIMIT ${r}`}t.exports=function(t,e,n={}){var{limit:u,caseInsensitive:l,keepProperties:c}=n;u=u||1e3;const h=l?a:o,p=function(t){r.isItemId(t)?t=`wd:${t}`:"string"==typeof t&&(t=`'${t}'`);return t}(e),f=c?"":"FILTER NOT EXISTS { ?subject rdf:type wikibase:Property . } ",d=h(t=t instanceof Array?t.map(s).join("|"):s(t),p,f,u);return i(d)};const s=t=>"wdt:"+t},function(t,e){t.exports=function(t){const e=t[0],r=t.slice(1),i=n(e,r);return"Invalid Date"===i.toString()?o(e,r):i};const n=function(t,e){return"-"===t?i(e):r(e)},r=t=>new Date(t),i=function(t){const e=`-00${t}`;return new Date(e)},o=function(t,e){const r=e.split("T")[0].split("-")[0];return n(t,r)}},function(t,e,n){const r=n(139),{forceArray:i}=n(53);t.exports=function(t,e={}){const n=1===(t=i(t)).length,a={action:"query",prop:"revisions"};return a.titles=t.join("|"),a.format=e.format||"json",n&&(a.rvlimit=e.limit||"max"),n&&e.start&&(a.rvstart=o(e.start)),n&&e.end&&(a.rvend=o(e.end)),r(a)};const o=function(t){return"number"==typeof t&&t<a?t:Math.trunc(new Date(t).getTime()/1e3)},a=new Date("2000-01-01").getTime()},function(t,e,n){const r=n(356);t.exports={wd:{entities:function(t){t=t.body||t;const{entities:e}=t;return Object.keys(e).forEach(t=>{e[t]=r(e[t])}),e}}}},function(t,e,n){const{wikidataTimeToISOString:r,wikidataTimeToEpochTime:i}=n(140),o=t=>t.value,a={item:"Q",property:"P"},s=function(t,e){const{value:n}=t,r=n.id||a[n["entity-type"]]+n["numeric-id"];return"string"==typeof e?`${e}:${r}`:r},u=(t="iso")=>l[t],l={iso:r,epoch:i,none:t=>t},c={string:o,commonsMedia:o,url:o,"external-id":o,math:o,monolingualtext:(t,e)=>e.keepRichValues?t.value:t.value.text,"wikibase-item":(t,e)=>s(t,e.entityPrefix),"wikibase-property":(t,e)=>s(t,e.propertyPrefix),time:(t,e)=>u(e.timeConverter)(t.value.time),quantity:(t,e)=>{const{value:n}=t,r=parseFloat(n.amount);return e.keepRichValues?{amount:parseFloat(n.amount),unit:n.unit.replace("http://www.wikidata.org/entity/",""),upperBound:parseFloat(n.upperBound),lowerBound:parseFloat(n.lowerBound)}:r},"globe-coordinate":t=>[t.value.latitude,t.value.longitude],"geo-shape":o,"tabular-data":o};t.exports=((t,e,n)=>c[t](e,n))},function(t,e){t.exports=["aa","ab","ace","ady","af","ak","als","am","an","ang","ar","arc","arz","as","ast","atj","av","ay","az","azb","ba","bar","bat_smg","bcl","be","be_x_old","bg","bh","bi","bjn","bm","bn","bo","bpy","br","bs","bug","bxr","ca","cbk_zam","cdo","ce","ceb","ch","cho","chr","chy","ckb","co","commons","cr","crh","cs","csb","cu","cv","cy","da","de","din","diq","dsb","dty","dv","dz","ee","el","eml","en","eo","es","et","eu","ext","fa","ff","fi","fiu_vro","fj","fo","fr","frp","frr","fur","fy","ga","gag","gan","gd","gl","glk","gn","gom","got","gu","gv","ha","hak","haw","he","hi","hif","ho","hr","hsb","ht","hu","hy","hz","ia","id","ie","ig","ii","ik","ilo","io","is","it","iu","ja","jam","jbo","jv","ka","kaa","kab","kbd","kbp","kg","ki","kj","kk","kl","km","kn","ko","koi","kr","krc","ks","ksh","ku","kv","kw","ky","la","lad","lb","lbe","lez","lg","li","lij","lmo","ln","lo","lrc","lt","ltg","lv","mai","map_bms","mdf","mediawiki","meta","mg","mh","mhr","mi","min","mk","ml","mn","mo","mr","mrj","ms","mt","mus","mwl","my","myv","mzn","na","nah","nap","nds","nds_nl","ne","new","ng","nl","nn","no","nov","nrm","nso","nv","ny","oc","olo","om","or","os","pa","pag","pam","pap","pcd","pdc","pfl","pi","pih","pl","pms","pnb","pnt","ps","pt","qu","rm","rmy","rn","ro","roa_rup","roa_tara","ru","rue","rw","sa","sah","sc","scn","sco","sd","se","sg","sh","si","simple","sk","sl","sm","sn","so","species","sq","sr","srn","ss","st","stq","su","sv","sw","szl","ta","tcy","te","tet","tg","th","ti","tk","tl","tn","to","tpi","tr","ts","tt","tum","tw","ty","tyv","udm","ug","uk","ur","uz","ve","vec","vep","vi","vls","vo","wa","war","wo","wuu","xal","xh","xmf","yi","yo","za","zea","zh","zh_classical","zh_min_nan","zh_yue","zu"]},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={"journal-article":"article-journal","book-chapter":"chapter","posted-content":"manuscript","proceedings-article":"paper-conference"};e.default=function(t){return r[t]||t}},function(t,e){t.exports={"\\url":"","\\href":"","{\\textexclamdown}":"¡","{\\textcent}":"¢","{\\textsterling}":"£","{\\textyen}":"¥","{\\textbrokenbar}":"¦","{\\textsection}":"§","{\\textasciidieresis}":"¨","{\\textcopyright}":"©","{\\textordfeminine}":"ª","{\\guillemotleft}":"«","{\\textlnot}":"¬","{\\textregistered}":"®","{\\textasciimacron}":"¯","{\\textdegree}":"°","{\\textpm}":"±","{\\texttwosuperior}":"²","{\\textthreesuperior}":"³","{\\textasciiacute}":"´","{\\textmu}":"µ","{\\textparagraph}":"¶","{\\textperiodcentered}":"·","{\\c\\ }":"¸","{\\textonesuperior}":"¹","{\\textordmasculine}":"º","{\\guillemotright}":"»","{\\textonequarter}":"¼","{\\textonehalf}":"½","{\\textthreequarters}":"¾","{\\textquestiondown}":"¿","{\\AE}":"Æ","{\\DH}":"Ð","{\\texttimes}":"×","{\\O}":"Ø","{\\TH}":"Þ","{\\ss}":"ß","{\\ae}":"æ","{\\dh}":"ð","{\\textdiv}":"÷","{\\o}":"ø","{\\th}":"þ","{\\i}":"ı","{\\NG}":"Ŋ","{\\ng}":"ŋ","{\\OE}":"Œ","{\\oe}":"œ","{\\textasciicircum}":"ˆ","{\\textacutedbl}":"˝","$\\Gamma$":"Γ","$\\Delta$":"Δ","$\\Theta$":"Θ","$\\Lambda$":"Λ","$\\Xi$":"Ξ","$\\Pi$":"Π","$\\Sigma$":"Σ","$\\Phi$":"Φ","$\\Psi$":"Ψ","$\\Omega$":"Ω","$\\alpha$":"α","$\\beta$":"β","$\\gamma$":"γ","$\\delta$":"δ","$\\varepsilon$":"ε","$\\zeta$":"ζ","$\\eta$":"η","$\\theta$":"θ","$\\iota$":"ι","$\\kappa$":"κ","$\\lambda$":"λ","$\\mu$":"μ","$\\nu$":"ν","$\\xi$":"ξ","$\\pi$":"π","$\\rho$":"ρ","$\\varsigma$":"ς","$\\sigma$":"σ","$\\tau$":"τ","$\\upsilon$":"υ","$\\varphi$":"φ","$\\chi$":"χ","$\\psi$":"ψ","$\\omega$":"ω","$\\vartheta$":"ϑ","$\\Upsilon$":"ϒ","$\\phi$":"ϕ","$\\varpi$":"ϖ","$\\varrho$":"ϱ","$\\epsilon$":"ϵ","{\\textendash}":"–","{\\textemdash}":"—","---":"—","--":"–","{\\textbardbl}":"‖","{\\textunderscore}":"‗","{\\textquoteleft}":"‘","{\\textquoteright}":"’","{\\quotesinglbase}":"‚","{\\textquotedblleft}":"“","{\\textquotedblright}":"”","{\\quotedblbase}":"„","{\\textdagger}":"†","{\\textdaggerdbl}":"‡","{\\textbullet}":"•","{\\textellipsis}":"…","{\\textperthousand}":"‰","'''":"‴","''":"”","``":"“","```":"‷","{\\guilsinglleft}":"‹","{\\guilsinglright}":"›","!!":"‼","{\\textfractionsolidus}":"⁄","?!":"⁈","!?":"⁉","$^{0}$":"⁰","$^{4}$":"⁴","$^{5}$":"⁵","$^{6}$":"⁶","$^{7}$":"⁷","$^{8}$":"⁸","$^{9}$":"⁹","$^{+}$":"⁺","$^{-}$":"⁻","$^{=}$":"⁼","$^{(}$":"⁽","$^{)}$":"⁾","$^{n}$":"ⁿ","$_{0}$":"₀","$_{1}$":"₁","$_{2}$":"₂","$_{3}$":"₃","$_{4}$":"₄","$_{5}$":"₅","$_{6}$":"₆","$_{7}$":"₇","$_{8}$":"₈","$_{9}$":"₉","$_{+}$":"₊","$_{-}$":"₋","$_{=}$":"₌","$_{(}$":"₍","$_{)}$":"₎","{\\texteuro}":"€","{\\textcelsius}":"℃","{\\textnumero}":"№","{\\textcircledP}":"℗","{\\textservicemark}":"℠","{TEL}":"℡","{\\texttrademark}":"™","{\\textohm}":"Ω","{\\textestimated}":"℮","{\\`A}":"À","{\\'A}":"Á","{\\^A}":"Â","{\\~A}":"Ã",'{\\"A}':"Ä","{\\r A}":"Å","{\\c C}":"Ç","{\\`E}":"È","{\\'E}":"É","{\\^E}":"Ê",'{\\"E}':"Ë","{\\`I}":"Ì","{\\'I}":"Í","{\\^I}":"Î",'{\\"I}':"Ï","{\\~N}":"Ñ","{\\`O}":"Ò","{\\'O}":"Ó","{\\^O}":"Ô","{\\~O}":"Õ",'{\\"O}':"Ö","{\\`U}":"Ù","{\\'U}":"Ú","{\\^U}":"Û",'{\\"U}':"Ü","{\\'Y}":"Ý","{\\`a}":"à","{\\'a}":"á","{\\^a}":"â","{\\~a}":"ã",'{\\"a}':"ä","{\\r a}":"å","{\\c c}":"ç","{\\`e}":"è","{\\'e}":"é","{\\^e}":"ê",'{\\"e}':"ë","{\\`i}":"ì","{\\'i}":"í","{\\^i}":"î",'{\\"i}':"ï","{\\~n}":"ñ","{\\`o}":"ò","{\\'o}":"ó","{\\^o}":"ô","{\\~o}":"õ",'{\\"o}':"ö","{\\`u}":"ù","{\\'u}":"ú","{\\^u}":"û",'{\\"u}':"ü","{\\'y}":"ý",'{\\"y}':"ÿ","{\\=A}":"Ā","{\\=a}":"ā","{\\u A}":"Ă","{\\u a}":"ă","{\\k A}":"Ą","{\\k a}":"ą","{\\'C}":"Ć","{\\'c}":"ć","{\\^C}":"Ĉ","{\\^c}":"ĉ","{\\.C}":"Ċ","{\\.c}":"ċ","{\\v C}":"Č","{\\v c}":"č","{\\v D}":"Ď","{\\v d}":"ď","{\\=E}":"Ē","{\\=e}":"ē","{\\u E}":"Ĕ","{\\u e}":"ĕ","{\\.E}":"Ė","{\\.e}":"ė","{\\k E}":"Ę","{\\k e}":"ę","{\\v E}":"Ě","{\\v e}":"ě","{\\^G}":"Ĝ","{\\^g}":"ĝ","{\\u G}":"Ğ","{\\u g}":"ğ","{\\.G}":"Ġ","{\\.g}":"ġ","{\\c G}":"Ģ","{\\c g}":"ģ","{\\^H}":"Ĥ","{\\^h}":"ĥ","{\\~I}":"Ĩ","{\\~i}":"ĩ","{\\=I}":"Ī","{\\=i}":"ī","{\\=\\i}":"ī","{\\u I}":"Ĭ","{\\u i}":"ĭ","{\\k I}":"Į","{\\k i}":"į","{\\.I}":"İ","{\\^J}":"Ĵ","{\\^j}":"ĵ","{\\c K}":"Ķ","{\\c k}":"ķ","{\\'L}":"Ĺ","{\\'l}":"ĺ","{\\c L}":"Ļ","{\\c l}":"ļ","{\\v L}":"Ľ","{\\v l}":"ľ","{\\L }":"Ł","{\\l }":"ł","{\\'N}":"Ń","{\\'n}":"ń","{\\c N}":"Ņ","{\\c n}":"ņ","{\\v N}":"Ň","{\\v n}":"ň","{\\=O}":"Ō","{\\=o}":"ō","{\\u O}":"Ŏ","{\\u o}":"ŏ","{\\H O}":"Ő","{\\H o}":"ő","{\\'R}":"Ŕ","{\\'r}":"ŕ","{\\c R}":"Ŗ","{\\c r}":"ŗ","{\\v R}":"Ř","{\\v r}":"ř","{\\'S}":"Ś","{\\'s}":"ś","{\\^S}":"Ŝ","{\\^s}":"ŝ","{\\c S}":"Ş","{\\c s}":"ş","{\\v S}":"Š","{\\v s}":"š","{\\c T}":"Ţ","{\\c t}":"ţ","{\\v T}":"Ť","{\\v t}":"ť","{\\~U}":"Ũ","{\\~u}":"ũ","{\\=U}":"Ū","{\\=u}":"ū","{\\u U}":"Ŭ","{\\u u}":"ŭ","{\\r U}":"Ů","{\\r u}":"ů","{\\H U}":"Ű","{\\H u}":"ű","{\\k U}":"Ų","{\\k u}":"ų","{\\^W}":"Ŵ","{\\^w}":"ŵ","{\\^Y}":"Ŷ","{\\^y}":"ŷ",'{\\"Y}':"Ÿ","{\\'Z}":"Ź","{\\'z}":"ź","{\\.Z}":"Ż","{\\.z}":"ż","{\\v Z}":"Ž","{\\v z}":"ž","{\\v A}":"Ǎ","{\\v a}":"ǎ","{\\v I}":"Ǐ","{\\v i}":"ǐ","{\\v O}":"Ǒ","{\\v o}":"ǒ","{\\v U}":"Ǔ","{\\v u}":"ǔ","{\\v G}":"Ǧ","{\\v g}":"ǧ","{\\v K}":"Ǩ","{\\v k}":"ǩ","{\\k O}":"Ǫ","{\\k o}":"ǫ","{\\v j}":"ǰ","{\\'G}":"Ǵ","{\\'g}":"ǵ","{\\.B}":"Ḃ","{\\.b}":"ḃ","{\\d B}":"Ḅ","{\\d b}":"ḅ","{\\b B}":"Ḇ","{\\b b}":"ḇ","{\\.D}":"Ḋ","{\\.d}":"ḋ","{\\d D}":"Ḍ","{\\d d}":"ḍ","{\\b D}":"Ḏ","{\\b d}":"ḏ","{\\c D}":"Ḑ","{\\c d}":"ḑ","{\\.F}":"Ḟ","{\\.f}":"ḟ","{\\=G}":"Ḡ","{\\=g}":"ḡ","{\\.H}":"Ḣ","{\\.h}":"ḣ","{\\d H}":"Ḥ","{\\d h}":"ḥ",'{\\"H}':"Ḧ",'{\\"h}':"ḧ","{\\c H}":"Ḩ","{\\c h}":"ḩ","{\\'K}":"Ḱ","{\\'k}":"ḱ","{\\d K}":"Ḳ","{\\d k}":"ḳ","{\\b K}":"Ḵ","{\\b k}":"ḵ","{\\d L}":"Ḷ","{\\d l}":"ḷ","{\\b L}":"Ḻ","{\\b l}":"ḻ","{\\'M}":"Ḿ","{\\'m}":"ḿ","{\\.M}":"Ṁ","{\\.m}":"ṁ","{\\d M}":"Ṃ","{\\d m}":"ṃ","{\\.N}":"Ṅ","{\\.n}":"ṅ","{\\d N}":"Ṇ","{\\d n}":"ṇ","{\\b N}":"Ṉ","{\\b n}":"ṉ","{\\'P}":"Ṕ","{\\'p}":"ṕ","{\\.P}":"Ṗ","{\\.p}":"ṗ","{\\.R}":"Ṙ","{\\.r}":"ṙ","{\\d R}":"Ṛ","{\\d r}":"ṛ","{\\b R}":"Ṟ","{\\b r}":"ṟ","{\\.S}":"Ṡ","{\\.s}":"ṡ","{\\d S}":"Ṣ","{\\d s}":"ṣ","{\\.T}":"Ṫ","{\\.t}":"ṫ","{\\d T}":"Ṭ","{\\d t}":"ṭ","{\\b T}":"Ṯ","{\\b t}":"ṯ","{\\~V}":"Ṽ","{\\~v}":"ṽ","{\\d V}":"Ṿ","{\\d v}":"ṿ","{\\`W}":"Ẁ","{\\`w}":"ẁ","{\\'W}":"Ẃ","{\\'w}":"ẃ",'{\\"W}':"Ẅ",'{\\"w}':"ẅ","{\\.W}":"Ẇ","{\\.w}":"ẇ","{\\d W}":"Ẉ","{\\d w}":"ẉ","{\\.X}":"Ẋ","{\\.x}":"ẋ",'{\\"X}':"Ẍ",'{\\"x}':"ẍ","{\\.Y}":"Ẏ","{\\.y}":"ẏ","{\\^Z}":"Ẑ","{\\^z}":"ẑ","{\\d Z}":"Ẓ","{\\d z}":"ẓ","{\\b Z}":"Ẕ","{\\b z}":"ẕ","{\\b h}":"ẖ",'{\\"t}':"ẗ","{\\r w}":"ẘ","{\\r y}":"ẙ","{\\d A}":"Ạ","{\\d a}":"ạ","{\\d E}":"Ẹ","{\\d e}":"ẹ","{\\~E}":"Ẽ","{\\~e}":"ẽ","{\\d I}":"Ị","{\\d i}":"ị","{\\d O}":"Ọ","{\\d o}":"ọ","{\\d U}":"Ụ","{\\d u}":"ụ","{\\`Y}":"Ỳ","{\\`y}":"ỳ","{\\d Y}":"Ỵ","{\\d y}":"ỵ","{\\~Y}":"Ỹ","{\\~y}":"ỹ","{\\~}":"∼","~":" "}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a(n(100)),i=a(n(99)),o=a(n(138));function a(t){return t&&t.__esModule?t:{default:t}}e.default=function(t){var e=t,n=(0,i.default)(t);return n.match(/^(array|object)\//)&&(e=(0,r.default)(e)),(0,o.default)(e,n)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.chainLink=e.chain=e.data=void 0;var r=a(n(220)),i=a(n(142)),o=a(n(936));function a(t){return t&&t.__esModule?t:{default:t}}e.data=r.default,e.chain=i.default,e.chainLink=o.default},function(t,e){!function(t){"use strict";if(!t.fetch){var e={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(e.arrayBuffer)var n=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],r=function(t){return t&&DataView.prototype.isPrototypeOf(t)},i=ArrayBuffer.isView||function(t){return t&&n.indexOf(Object.prototype.toString.call(t))>-1};c.prototype.append=function(t,e){t=s(t),e=u(e);var n=this.map[t];this.map[t]=n?n+","+e:e},c.prototype.delete=function(t){delete this.map[s(t)]},c.prototype.get=function(t){return t=s(t),this.has(t)?this.map[t]:null},c.prototype.has=function(t){return this.map.hasOwnProperty(s(t))},c.prototype.set=function(t,e){this.map[s(t)]=u(e)},c.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},c.prototype.keys=function(){var t=[];return this.forEach(function(e,n){t.push(n)}),l(t)},c.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),l(t)},c.prototype.entries=function(){var t=[];return this.forEach(function(e,n){t.push([n,e])}),l(t)},e.iterable&&(c.prototype[Symbol.iterator]=c.prototype.entries);var o=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];g.prototype.clone=function(){return new g(this,{body:this._bodyInit})},m.call(g.prototype),m.call(y.prototype),y.prototype.clone=function(){return new y(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new c(this.headers),url:this.url})},y.error=function(){var t=new y(null,{status:0,statusText:""});return t.type="error",t};var a=[301,302,303,307,308];y.redirect=function(t,e){if(-1===a.indexOf(e))throw new RangeError("Invalid status code");return new y(null,{status:e,headers:{location:t}})},t.Headers=c,t.Request=g,t.Response=y,t.fetch=function(t,n){return new Promise(function(r,i){var o=new g(t,n),a=new XMLHttpRequest;a.onload=function(){var t,e,n={status:a.status,statusText:a.statusText,headers:(t=a.getAllResponseHeaders()||"",e=new c,t.split(/\r?\n/).forEach(function(t){var n=t.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();e.append(r,i)}}),e)};n.url="responseURL"in a?a.responseURL:n.headers.get("X-Request-URL");var i="response"in a?a.response:a.responseText;r(new y(i,n))},a.onerror=function(){i(new TypeError("Network request failed"))},a.ontimeout=function(){i(new TypeError("Network request failed"))},a.open(o.method,o.url,!0),"include"===o.credentials&&(a.withCredentials=!0),"responseType"in a&&e.blob&&(a.responseType="blob"),o.headers.forEach(function(t,e){a.setRequestHeader(e,t)}),a.send(void 0===o._bodyInit?null:o._bodyInit)})},t.fetch.polyfill=!0}function s(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function u(t){return"string"!=typeof t&&(t=String(t)),t}function l(t){var n={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return e.iterable&&(n[Symbol.iterator]=function(){return n}),n}function c(t){this.map={},t instanceof c?t.forEach(function(t,e){this.append(e,t)},this):Array.isArray(t)?t.forEach(function(t){this.append(t[0],t[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function h(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function p(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function f(t){var e=new FileReader,n=p(e);return e.readAsArrayBuffer(t),n}function d(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function m(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,t)if("string"==typeof t)this._bodyText=t;else if(e.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(e.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(e.searchParams&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(e.arrayBuffer&&e.blob&&r(t))this._bodyArrayBuffer=d(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!e.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t)&&!i(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=d(t)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):e.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},e.blob&&(this.blob=function(){var t=h(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?h(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(f)}),this.text=function(){var t,e,n,r=h(this);if(r)return r;if(this._bodyBlob)return t=this._bodyBlob,e=new FileReader,n=p(e),e.readAsText(t),n;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},e.formData&&(this.formData=function(){return this.text().then(v)}),this.json=function(){return this.text().then(JSON.parse)},this}function g(t,e){var n,r,i=(e=e||{}).body;if(t instanceof g){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new c(t.headers)),this.method=t.method,this.mode=t.mode,i||null==t._bodyInit||(i=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new c(e.headers)),this.method=(n=e.method||this.method||"GET",r=n.toUpperCase(),o.indexOf(r)>-1?r:n),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function v(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var n=t.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(i))}}),e}function y(t,e){e||(e={}),this.type="default",this.status="status"in e?e.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new c(e.headers),this.url=e.url||"",this._initBody(t)}}("undefined"!=typeof self?self:this)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a(n(100)),i=a(n(220)),o=a(n(99));function a(t){return t&&t.__esModule?t:{default:t}}var s,u,l=(s=regeneratorRuntime.mark(function t(e){var n,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e,(a=(0,o.default)(e)).match(/^(array|object)\//)&&(n=(0,r.default)(n)),t.abrupt("return",(0,i.default)(n,a));case 4:case"end":return t.stop()}},t,this)}),u=function(){var t=s.apply(this,arguments);return new Promise(function(e,n){return function r(i,o){try{var a=t[i](o),s=a.value}catch(t){return void n(t)}if(!a.done)return Promise.resolve(s).then(function(t){r("next",t)},function(t){r("throw",t)});e(s)}("next")})},function(t){return u.apply(this,arguments)});e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.async=e.type=e.prop=e.json=e.list=void 0;var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(938)),i=u(n(353)),o=u(n(362)),a=u(n(219)),s=u(n(363));function u(t){return t&&t.__esModule?t:{default:t}}e.list=i.default,e.json=o.default,e.prop=a.default,e.type=s.default,e.async=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.prop=e.json=void 0;var r=o(n(376)),i=o(n(377));function o(t){return t&&t.__esModule?t:{default:t}}e.json=r.default,e.prop=i.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.type=e.prop=e.text=e.json=void 0;var r=s(n(368)),i=s(n(371)),o=s(n(372)),a=s(n(373));function s(t){return t&&t.__esModule?t:{default:t}}e.json=i.default,e.text=r.default,e.prop=o.default,e.type=a.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.async=e.api=e.id=void 0;var r=a(n(364)),i=a(n(365)),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(941));function a(t){return t&&t.__esModule?t:{default:t}}e.id=r.default,e.api=i.default,e.async=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.api=void 0;var r,i=n(378),o=(r=i)&&r.__esModule?r:{default:r};e.api=o.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TokenStack=e.fetchId=e.fetchFileAsync=e.fetchFile=e.deepCopy=e.attr=void 0;var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(380)),i=l(n(100)),o=l(n(217)),a=l(n(221)),s=l(n(381)),u=l(n(369));function l(t){return t&&t.__esModule?t:{default:t}}e.attr=r,e.deepCopy=i.default,e.fetchFile=o.default,e.fetchFileAsync=a.default,e.fetchId=s.default,e.TokenStack=u.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.citeproc=e.cite=void 0;var r,i=n(944),o=n(95);var a=((r=o)&&r.__esModule?r:{default:r}).default.PROCESSOR_VERSION;e.cite=i.version,e.citeproc=a},function(t,e){t.exports={_args:[["citation-js@0.3.4","/Users/rawbin/Documents/Projets/collaborations/ensad-publishing/prototype/metis-frontoffice"]],_from:"citation-js@0.3.4",_id:"citation-js@0.3.4",_inBundle:!1,_integrity:"sha512-LinQKWshLDcZBdf4FLFw0V3z7n2NU8odUzOClLUHEmZpbzR+S2qauggrHQUZ7Gq4bqVckil1vdl6Edpr/aDE2A==",_location:"/citation-js",_phantomChildren:{},_requested:{type:"version",registry:!0,raw:"citation-js@0.3.4",name:"citation-js",escapedName:"citation-js",rawSpec:"0.3.4",saveSpec:null,fetchSpec:"0.3.4"},_requiredBy:["/metis-shared"],_resolved:"https://registry.npmjs.org/citation-js/-/citation-js-0.3.4.tgz",_spec:"0.3.4",_where:"/Users/rawbin/Documents/Projets/collaborations/ensad-publishing/prototype/metis-frontoffice",author:{name:"Lars Willighagen",url:"https://larsgw.github.io"},bin:{"citation-js":"bin/cmd.js"},bugs:{url:"https://github.com/larsgw/citation.js/issues"},dependencies:{"babel-polyfill":"^6.23.0",citeproc:"^2.0.2",commander:"~2.11.0","deep-freeze":"0.0.1","isomorphic-fetch":"^2.2.1",striptags:"^3.0.1","sync-request":"^4.1.0","wikidata-sdk":"^5.2.2"},description:"Citation.js converts formats like BibTeX, Wikidata JSON and ContentMine JSON to CSL-JSON to convert to other formats like APA, Vancouver and back to BibTeX.",devDependencies:{"babel-cli":"^6.24.1","babel-core":"^6.25.0","babel-eslint":"^7.2.3","babel-plugin-istanbul":"^4.1.4","babel-plugin-transform-unicode-property-regex":"^2.0.4","babel-preset-env":"^1.4.0","babel-preset-es2015":"^6.24.1","babel-preset-stage-0":"^6.24.1","babel-register":"^6.24.1",babelify:"^7.3.0",browserify:"^14.3.0","cross-env":"^5.0.1",disc:"^1.3.2","expect.js":"^0.3.1",jsdoc:"^3.5.3",mocha:"^3.4.2",nock:"^9.0.14","npm-run-all":"^4.0.2",nyc:"^11.0.3",standard:"^10.0.2","uglify-es":"^3.0.4"},directories:{doc:"docs/api/",test:"test/",lib:"src/"},engines:{node:">=6.0.0"},homepage:"https://citation.js.org/",keywords:["citation","bibtex","wikidata","contentmine","quickscrape","csl","citeproc"],license:"MIT",main:"lib/index.js",man:["bin/man/citation-js.1"],name:"citation-js",nyc:{require:["babel-register"],sourceMap:!1,instrument:!1},repository:{type:"git",url:"git+https://github.com/larsgw/citation.js.git"},scripts:{"--1--":"lint","--2--":"test","--3--":"compile","--4--":"distributions","--5--":"generate","--6--":"dev",compile:"babel src -d lib --copy-files","compile:test":"babel src/test -d lib/test --copy-files",coverage:"npm-run-all coverage:*","coverage:report":"nyc report --reporter=lcov > coverage.lcov","coverage:test":"cross-env NODE_ENV=test nyc npm test",dev:"npm-run-all dev:*","dev:test":"npm run compile && npm run test","dev:test-browser":"npm run compile && npm run dist:regular","dist:minify":"uglifyjs build/citation.js --ie8 -c -o build/citation.min.js","dist:minify-test":"uglifyjs build/test.citation.js --ie8 -c -o build/test.citation.min.js","dist:regular":"browserify -r ./src/index.js:citation-js -o build/citation.js -g [ babelify --ignore=citeproc --presets [ env ] ]","dist:regular-test":"browserify -r expect.js -e test/wrapper.js -x expect.js -o build/test.citation.js -g [ babelify --ignore=citeproc --presets [ es2015 env ] ]",generate:"npm-run-all generate:*","generate:disc":"browserify -e ./src/index.js -o build/tmp.js --full-paths -g [ babelify --ignore=citeproc --presets [ env ] ] && node tools/disc.js","generate:docs":"jsdoc ./src README.md -c .jsdoc.json","generate:files":"npm-run-all dist:*",lint:"npm-run-all lint:*","lint:bin":'standard "bin/**/*.js"',"lint:src":'standard "src/**/*.js"',"lint:test":'standard "test/**/*.js"',"lint:tools":'standard "tools/**/*.js"',test:"cross-env MOCHA=1 mocha --check-leaks -r babel-register -R dot test/*.spec.js"},standard:{parser:"babel-eslint"},version:"0.3.4"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=o(n(142)),i=o(n(222));function o(t){return t&&t.__esModule?t:{default:t}}var a,s,u=(a=regeneratorRuntime.mark(function t(e,n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=i.default,t.next=3,e;case 3:return t.t1=t.sent,t.t2=n,t.abrupt("return",new t.t0(t.t1,t.t2));case 6:case"end":return t.stop()}},t,this)}),s=function(){var t=a.apply(this,arguments);return new Promise(function(e,n){return function r(i,o){try{var a=t[i](o),s=a.value}catch(t){return void n(t)}if(!a.done)return Promise.resolve(s).then(function(t){r("next",t)},function(t){r("throw",t)});e(s)}("next")})},function(t,e){return s.apply(this,arguments)});e.default=function(t,e,n){var o=(0,r.default)(t);return"function"!=typeof e||n||(n=e),"function"==typeof n?void o.then(function(t){return n(new i.default(t,e))}):u(o,e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.save=e.undo=e.retrieveLastVersion=e.retrieveVersion=e.currentVersion=void 0;var r,i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=n(222),a=(r=o)&&r.__esModule?r:{default:r};e.currentVersion=function(){return this.log.length},e.retrieveVersion=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(t<=0||t>this.currentVersion())return null;var e=i(this.log[t-1],2),n=e[0],r=e[1],o=new a.default(JSON.parse(n),JSON.parse(r));return o.log=this.log.slice(0,t),o},e.retrieveLastVersion=function(){return this.retrieveVersion(this.currentVersion())},e.undo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.retrieveVersion(this.currentVersion()-t)},e.save=function(){return this.log.push([JSON.stringify(this.data),JSON.stringify(this._options)]),this}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.options=function(t,e){return e&&this.save(),Object.assign(this._options,t),this},e.defaultOptions={format:"real",type:"json",style:"csl",lang:"en-US"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.reset=e.setAsync=e.set=e.addAsync=e.add=void 0;var r=a(n(218)),i=a(n(142)),o=a(n(381));function a(t){return t&&t.__esModule?t:{default:t}}function s(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function r(i,o){try{var a=e[i](o),s=a.value}catch(t){return void n(t)}if(!a.done)return Promise.resolve(s).then(function(t){r("next",t)},function(t){r("throw",t)});t(s)}("next")})}}function u(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var l,c,h=(l=s(regeneratorRuntime.mark(function t(e){var n,r=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return!0!==a&&!0!==s||this.save(),t.t0=(n=this.data).push,t.t1=n,t.t2=u,t.next=6,(0,i.default)(e,a);case 6:return t.t3=t.sent,t.t4=(0,t.t2)(t.t3),t.t0.apply.call(t.t0,t.t1,t.t4),this.data.filter(function(t){return!t.hasOwnProperty("id")}).forEach(function(t){t.id=(0,o.default)(r.getIds(),"temp_id_")}),t.abrupt("return",this);case 11:case"end":return t.stop()}},t,this)})),function(t){return l.apply(this,arguments)}),p=(c=s(regeneratorRuntime.mark(function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return!0!==n&&!0!==r||this.save(),this.data=[],t.abrupt("return","boolean"!=typeof n?this.addAsync(e,n):this.addAsync(e));case 3:case"end":return t.stop()}},t,this)})),function(t){return c.apply(this,arguments)});e.add=function(t){var e,n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!0!==i&&!0!==a||this.save(),(e=this.data).push.apply(e,u((0,r.default)(t,i))),this.data.filter(function(t){return!t.hasOwnProperty("id")}).forEach(function(t){t.id=(0,o.default)(n.getIds(),"temp_id_")}),this},e.addAsync=h,e.set=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!0!==e&&!0!==n||this.save(),this.data=[],"boolean"!=typeof e?this.add(t,e):this.add(t)},e.setAsync=p,e.reset=function(t){return t&&this.save(),this.data=[],this._options={},this}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sort=void 0;var r=o(n(343)),i=o(n(214));function o(t){return t&&t.__esModule?t:{default:t}}var a=function(t,e){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"label"===e)?(0,r.default)(t):t[e];switch(e){case"author":case"editor":return n.map(function(t){return t.literal||t.family||(0,i.default)(t)});case"accessed":case"issued":return n["date-parts"][0];case"page":return n.split("-").map(function(t){return parseInt(t)});case"edition":case"issue":case"volume":return n=parseInt(n),isNaN(n)?-1/0:n;default:return n||-1/0}},s=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:/^!/.test(n);n=n.replace(/^!/,"");var i=a(t,n),o=a(e,n);return i===o?0:r!==i>o?1:-1};e.sort=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return arguments[1]&&this.save(),this.data.sort("function"==typeof t?t:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t,n){for(var r=e.slice(),i=0;!i&&r.length;)i=s(t,n,r.shift());return i}}.apply(void 0,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(t).concat(["label"]))),this}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.get=e.getIds=void 0;var r=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=m(n(951)),o=n(380),a=m(n(136)),s=m(n(340)),u=m(n(341)),l=m(n(342)),c=m(n(379)),h=m(n(346)),p=m(n(344)),f=m(n(345)),d=m(n(347));function m(t){return t&&t.__esModule?t:{default:t}}e.getIds=function(){return this.data.map(function(t){return t.id})},e.get=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=Object.assign({},this.defaultOptions,this._options.output,e),m=n.format,g=n.type,v=n.style,y=n.lang,b=n.append,_=n.prepend,x=v.match(/^([^-]+)(?:-(.+))?$/),w=r(x,3),E=w[1],S=w[2],T=(0,c.default)(this.data),O=void 0;switch([g,E].join()){case"html,citation":var A=(0,f.default)(y)?y:"en-US",M=(0,p.default)(S),C=(0,d.default)(T),k=(0,h.default)(S,A,M,C,f.default),P=k.updateItems(this.getIds()),R=k.makeBibliography(),L=r(R,2),I=L[0],D=I.bibstart,N=I.bibend,j=L[1].map(function(t,e){return(0,o.getPrefixedEntry)(t,P[e])});if(b||_){var U=P.map(function(e){return t.data.find(function(t){return t.id===e})});j=j.map(function(t,e){return(0,o.getWrappedEntry)(t,U[e],{append:b,prepend:_})})}O=""+D+j.join("<br />")+N;break;case"html,csl":O=(0,l.default)(T);break;case"html,bibtex":O=(0,s.default)(T,!0);break;case"string,bibtex":O=(0,s.default)(T,!1);break;case"html,bibtxt":O=(0,u.default)(T,!0);break;case"string,bibtxt":O=(0,u.default)(T,!1);break;case"string,citation":O=(0,i.default)(this.get(Object.assign({},e,{type:"html"})));break;case"string,csl":case"json,csl":O=JSON.stringify(T);break;case"json,bibtex":case"json,bibtxt":O=JSON.stringify(T.map(a.default));break;case"json,citation":console.error("[get]","Combination type/style of json/citation-* is not valid: "+g+"/"+v);break;default:console.error("[get]","Invalid options")}if("real"===m)if("json"===g)O=JSON.parse(O);else if("html"===g&&"undefined"!=typeof document&&document.createElement){var F=document.createElement("div");F.innerHTML=O,O=F.firstChild}return O}},function(t,e,n){"use strict";var r;!function(i){if("function"!=typeof o){var o=function(t){return t};o.nonNative=!0}const a=o("plaintext"),s=o("html"),u=o("comment"),l=/<(\w*)>/g,c=/<\/?([^\s\/>]+)/;function h(t,e,n){return f(t=t||"",p(e=e||[],n=n||""))}function p(t,e){return{allowable_tags:t=function(t){let e,n=new Set;if("string"==typeof t)for(;e=l.exec(t);)n.add(e[1]);else o.nonNative||"function"!=typeof t[o.iterator]?"function"==typeof t.forEach&&t.forEach(n.add,n):n=new Set(t);return n}(t),tag_replacement:e,state:a,tag_buffer:"",depth:0,in_quote_char:""}}function f(t,e){let n=e.allowable_tags,r=e.tag_replacement,i=e.state,o=e.tag_buffer,l=e.depth,c=e.in_quote_char,h="";for(let e=0,p=t.length;e<p;e++){let p=t[e];if(i===a)switch(p){case"<":i=s,o+=p;break;default:h+=p}else if(i===s)switch(p){case"<":if(c)break;l++;break;case">":if(c)break;if(l){l--;break}c="",i=a,o+=">",n.has(d(o))?h+=o:h+=r,o="";break;case'"':case"'":c=p===c?"":c||p,o+=p;break;case"-":"<!-"===o&&(i=u),o+=p;break;case" ":case"\n":if("<"===o){i=a,h+="< ",o="";break}o+=p;break;default:o+=p}else if(i===u)switch(p){case">":"--"==o.slice(-2)&&(i=a),o="";break;default:o+=p}}return e.state=i,e.tag_buffer=o,e.depth=l,e.in_quote_char=c,h}function d(t){let e=c.exec(t);return e?e[1].toLowerCase():null}h.init_streaming_mode=function(t,e){let n=p(t=t||[],e=e||"");return function(t){return f(t||"",n)}},void 0===(r=function(){return h}.call(e,n,e,t))||(t.exports=r)}()}],[466]);
            return { page: comp.default }
          })
        